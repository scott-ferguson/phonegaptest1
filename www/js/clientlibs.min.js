/*! jQuery v1.10.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
*/
(function(e,t){var n,r,i=typeof t,o=e.location,a=e.document,s=a.documentElement,l=e.jQuery,u=e.$,c={},p=[],f="1.10.2",d=p.concat,h=p.push,g=p.slice,m=p.indexOf,y=c.toString,v=c.hasOwnProperty,b=f.trim,x=function(e,t){return new x.fn.init(e,t,r)
},w=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,T=/\S+/g,C=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,N=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,k=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,E=/^[\],:{}\s]*$/,S=/(?:^|:|,)(?:\s*\[)+/g,A=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,j=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,D=/^-ms-/,L=/-([\da-z])/gi,H=function(e,t){return t.toUpperCase()
},q=function(e){(a.addEventListener||"load"===e.type||"complete"===a.readyState)&&(_(),x.ready())
},_=function(){a.addEventListener?(a.removeEventListener("DOMContentLoaded",q,!1),e.removeEventListener("load",q,!1)):(a.detachEvent("onreadystatechange",q),e.detachEvent("onload",q))
};
x.fn=x.prototype={jquery:f,constructor:x,init:function(e,n,r){var i,o;
if(!e){return this
}if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:N.exec(e),!i||!i[1]&&n){return !n||n.jquery?(n||r).find(e):this.constructor(n).find(e)
}if(i[1]){if(n=n instanceof x?n[0]:n,x.merge(this,x.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:a,!0)),k.test(i[1])&&x.isPlainObject(n)){for(i in n){x.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i])
}}return this
}if(o=a.getElementById(i[2]),o&&o.parentNode){if(o.id!==i[2]){return r.find(e)
}this.length=1,this[0]=o
}return this.context=a,this.selector=e,this
}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))
},selector:"",length:0,toArray:function(){return g.call(this)
},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]
},pushStack:function(e){var t=x.merge(this.constructor(),e);
return t.prevObject=this,t.context=this.context,t
},each:function(e,t){return x.each(this,e,t)
},ready:function(e){return x.ready.promise().done(e),this
},slice:function(){return this.pushStack(g.apply(this,arguments))
},first:function(){return this.eq(0)
},last:function(){return this.eq(-1)
},eq:function(e){var t=this.length,n=+e+(0>e?t:0);
return this.pushStack(n>=0&&t>n?[this[n]]:[])
},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)
}))
},end:function(){return this.prevObject||this.constructor(null)
},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,n,r,i,o,a,s=arguments[0]||{},l=1,u=arguments.length,c=!1;
for("boolean"==typeof s&&(c=s,s=arguments[1]||{},l=2),"object"==typeof s||x.isFunction(s)||(s={}),u===l&&(s=this,--l);
u>l;
l++){if(null!=(o=arguments[l])){for(i in o){e=s[i],r=o[i],s!==r&&(c&&r&&(x.isPlainObject(r)||(n=x.isArray(r)))?(n?(n=!1,a=e&&x.isArray(e)?e:[]):a=e&&x.isPlainObject(e)?e:{},s[i]=x.extend(c,a,r)):r!==t&&(s[i]=r))
}}}return s
},x.extend({expando:"jQuery"+(f+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=l),x
},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)
},ready:function(e){if(e===!0?!--x.readyWait:!x.isReady){if(!a.body){return setTimeout(x.ready)
}x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(a,[x]),x.fn.trigger&&x(a).trigger("ready").off("ready"))
}},isFunction:function(e){return"function"===x.type(e)
},isArray:Array.isArray||function(e){return"array"===x.type(e)
},isWindow:function(e){return null!=e&&e==e.window
},isNumeric:function(e){return !isNaN(parseFloat(e))&&isFinite(e)
},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?c[y.call(e)]||"object":typeof e
},isPlainObject:function(e){var n;
if(!e||"object"!==x.type(e)||e.nodeType||x.isWindow(e)){return !1
}try{if(e.constructor&&!v.call(e,"constructor")&&!v.call(e.constructor.prototype,"isPrototypeOf")){return !1
}}catch(r){return !1
}if(x.support.ownLast){for(n in e){return v.call(e,n)
}}for(n in e){}return n===t||v.call(e,n)
},isEmptyObject:function(e){var t;
for(t in e){return !1
}return !0
},error:function(e){throw Error(e)
},parseHTML:function(e,t,n){if(!e||"string"!=typeof e){return null
}"boolean"==typeof t&&(n=t,t=!1),t=t||a;
var r=k.exec(e),i=!n&&[];
return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))
},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=x.trim(n),n&&E.test(n.replace(A,"@").replace(j,"]").replace(S,"")))?Function("return "+n)():(x.error("Invalid JSON: "+n),t)
},parseXML:function(n){var r,i;
if(!n||"string"!=typeof n){return null
}try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))
}catch(o){r=t
}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||x.error("Invalid XML: "+n),r
},noop:function(){},globalEval:function(t){t&&x.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)
})(t)
},camelCase:function(e){return e.replace(D,"ms-").replace(L,H)
},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()
},each:function(e,t,n){var r,i=0,o=e.length,a=M(e);
if(n){if(a){for(;
o>i;
i++){if(r=t.apply(e[i],n),r===!1){break
}}}else{for(i in e){if(r=t.apply(e[i],n),r===!1){break
}}}}else{if(a){for(;
o>i;
i++){if(r=t.call(e[i],i,e[i]),r===!1){break
}}}else{for(i in e){if(r=t.call(e[i],i,e[i]),r===!1){break
}}}}return e
},trim:b&&!b.call("\ufeff\u00a0")?function(e){return null==e?"":b.call(e)
}:function(e){return null==e?"":(e+"").replace(C,"")
},makeArray:function(e,t){var n=t||[];
return null!=e&&(M(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n
},inArray:function(e,t,n){var r;
if(t){if(m){return m.call(t,e,n)
}for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;
r>n;
n++){if(n in t&&t[n]===e){return n
}}}return -1
},merge:function(e,n){var r=n.length,i=e.length,o=0;
if("number"==typeof r){for(;
r>o;
o++){e[i++]=n[o]
}}else{while(n[o]!==t){e[i++]=n[o++]
}}return e.length=i,e
},grep:function(e,t,n){var r,i=[],o=0,a=e.length;
for(n=!!n;
a>o;
o++){r=!!t(e[o],o),n!==r&&i.push(e[o])
}return i
},map:function(e,t,n){var r,i=0,o=e.length,a=M(e),s=[];
if(a){for(;
o>i;
i++){r=t(e[i],i,n),null!=r&&(s[s.length]=r)
}}else{for(i in e){r=t(e[i],i,n),null!=r&&(s[s.length]=r)
}}return d.apply([],s)
},guid:1,proxy:function(e,n){var r,i,o;
return"string"==typeof n&&(o=e[n],n=e,e=o),x.isFunction(e)?(r=g.call(arguments,2),i=function(){return e.apply(n||this,r.concat(g.call(arguments)))
},i.guid=e.guid=e.guid||x.guid++,i):t
},access:function(e,n,r,i,o,a,s){var l=0,u=e.length,c=null==r;
if("object"===x.type(r)){o=!0;
for(l in r){x.access(e,n,l,r[l],!0,a,s)
}}else{if(i!==t&&(o=!0,x.isFunction(i)||(s=!0),c&&(s?(n.call(e,i),n=null):(c=n,n=function(e,t,n){return c.call(x(e),n)
})),n)){for(;
u>l;
l++){n(e[l],r,s?i:i.call(e[l],l,n(e[l],r)))
}}}return o?e:c?n.call(e):u?n(e[0],r):a
},now:function(){return(new Date).getTime()
},swap:function(e,t,n,r){var i,o,a={};
for(o in t){a[o]=e.style[o],e.style[o]=t[o]
}i=n.apply(e,r||[]);
for(o in t){e.style[o]=a[o]
}return i
}}),x.ready.promise=function(t){if(!n){if(n=x.Deferred(),"complete"===a.readyState){setTimeout(x.ready)
}else{if(a.addEventListener){a.addEventListener("DOMContentLoaded",q,!1),e.addEventListener("load",q,!1)
}else{a.attachEvent("onreadystatechange",q),e.attachEvent("onload",q);
var r=!1;
try{r=null==e.frameElement&&a.documentElement
}catch(i){}r&&r.doScroll&&function o(){if(!x.isReady){try{r.doScroll("left")
}catch(e){return setTimeout(o,50)
}_(),x.ready()
}}()
}}}return n.promise(t)
},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()
});
function M(e){var t=e.length,n=x.type(e);
return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)
}r=x(a),function(e,t){var n,r,i,o,a,s,l,u,c,p,f,d,h,g,m,y,v,b="sizzle"+-new Date,w=e.document,T=0,C=0,N=st(),k=st(),E=st(),S=!1,A=function(e,t){return e===t?(S=!0,0):0
},j=typeof t,D=1<<31,L={}.hasOwnProperty,H=[],q=H.pop,_=H.push,M=H.push,O=H.slice,F=H.indexOf||function(e){var t=0,n=this.length;
for(;
n>t;
t++){if(this[t]===e){return t
}}return -1
},B="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",R="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",W=R.replace("w","w#"),$="\\["+P+"*("+R+")"+P+"*(?:([*^$|!~]?=)"+P+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+W+")|)|)"+P+"*\\]",I=":("+R+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+$.replace(3,8)+")*)|.*)\\)|)",z=RegExp("^"+P+"+|((?:^|[^\\\\])(?:\\\\.)*)"+P+"+$","g"),X=RegExp("^"+P+"*,"+P+"*"),U=RegExp("^"+P+"*([>+~]|"+P+")"+P+"*"),V=RegExp(P+"*[+~]"),Y=RegExp("="+P+"*([^\\]'\"]*)"+P+"*\\]","g"),J=RegExp(I),G=RegExp("^"+W+"$"),Q={ID:RegExp("^#("+R+")"),CLASS:RegExp("^\\.("+R+")"),TAG:RegExp("^("+R.replace("w","w*")+")"),ATTR:RegExp("^"+$),PSEUDO:RegExp("^"+I),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+P+"*(even|odd|(([+-]|)(\\d*)n|)"+P+"*(?:([+-]|)"+P+"*(\\d+)|))"+P+"*\\)|)","i"),bool:RegExp("^(?:"+B+")$","i"),needsContext:RegExp("^"+P+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+P+"*((?:-\\d)?\\d*)"+P+"*\\)|)(?=[^-]|$)","i")},K=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+P+"?|("+P+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;
return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)
};
try{M.apply(H=O.call(w.childNodes),w.childNodes),H[w.childNodes.length].nodeType
}catch(ot){M={apply:H.length?function(e,t){_.apply(e,O.call(t))
}:function(e,t){var n=e.length,r=0;
while(e[n++]=t[r++]){}e.length=n-1
}}
}function at(e,t,n,i){var o,a,s,l,u,c,d,m,y,x;
if((t?t.ownerDocument||t:w)!==f&&p(t),t=t||f,n=n||[],!e||"string"!=typeof e){return n
}if(1!==(l=t.nodeType)&&9!==l){return[]
}if(h&&!i){if(o=Z.exec(e)){if(s=o[1]){if(9===l){if(a=t.getElementById(s),!a||!a.parentNode){return n
}if(a.id===s){return n.push(a),n
}}else{if(t.ownerDocument&&(a=t.ownerDocument.getElementById(s))&&v(t,a)&&a.id===s){return n.push(a),n
}}}else{if(o[2]){return M.apply(n,t.getElementsByTagName(e)),n
}if((s=o[3])&&r.getElementsByClassName&&t.getElementsByClassName){return M.apply(n,t.getElementsByClassName(s)),n
}}}if(r.qsa&&(!g||!g.test(e))){if(m=d=b,y=t,x=9===l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){c=mt(e),(d=t.getAttribute("id"))?m=d.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",u=c.length;
while(u--){c[u]=m+yt(c[u])
}y=V.test(e)&&t.parentNode||t,x=c.join(",")
}if(x){try{return M.apply(n,y.querySelectorAll(x)),n
}catch(T){}finally{d||t.removeAttribute("id")
}}}}return kt(e.replace(z,"$1"),t,n,i)
}function st(){var e=[];
function t(n,r){return e.push(n+=" ")>o.cacheLength&&delete t[e.shift()],t[n]=r
}return t
}function lt(e){return e[b]=!0,e
}function ut(e){var t=f.createElement("div");
try{return !!e(t)
}catch(n){return !1
}finally{t.parentNode&&t.parentNode.removeChild(t),t=null
}}function ct(e,t){var n=e.split("|"),r=e.length;
while(r--){o.attrHandle[n[r]]=t
}}function pt(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||D)-(~e.sourceIndex||D);
if(r){return r
}if(n){while(n=n.nextSibling){if(n===t){return -1
}}}return e?1:-1
}function ft(e){return function(t){var n=t.nodeName.toLowerCase();
return"input"===n&&t.type===e
}
}function dt(e){return function(t){var n=t.nodeName.toLowerCase();
return("input"===n||"button"===n)&&t.type===e
}
}function ht(e){return lt(function(t){return t=+t,lt(function(n,r){var i,o=e([],n.length,t),a=o.length;
while(a--){n[i=o[a]]&&(n[i]=!(r[i]=n[i]))
}})
})
}s=at.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;
return t?"HTML"!==t.nodeName:!1
},r=at.support={},p=at.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.defaultView;
return n!==f&&9===n.nodeType&&n.documentElement?(f=n,d=n.documentElement,h=!s(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){p()
}),r.attributes=ut(function(e){return e.className="i",!e.getAttribute("className")
}),r.getElementsByTagName=ut(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length
}),r.getElementsByClassName=ut(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length
}),r.getById=ut(function(e){return d.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length
}),r.getById?(o.find.ID=function(e,t){if(typeof t.getElementById!==j&&h){var n=t.getElementById(e);
return n&&n.parentNode?[n]:[]
}},o.filter.ID=function(e){var t=e.replace(rt,it);
return function(e){return e.getAttribute("id")===t
}
}):(delete o.find.ID,o.filter.ID=function(e){var t=e.replace(rt,it);
return function(e){var n=typeof e.getAttributeNode!==j&&e.getAttributeNode("id");
return n&&n.value===t
}
}),o.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==j?n.getElementsByTagName(e):t
}:function(e,t){var n,r=[],i=0,o=t.getElementsByTagName(e);
if("*"===e){while(n=o[i++]){1===n.nodeType&&r.push(n)
}return r
}return o
},o.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==j&&h?n.getElementsByClassName(e):t
},m=[],g=[],(r.qsa=K.test(n.querySelectorAll))&&(ut(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||g.push("\\["+P+"*(?:value|"+B+")"),e.querySelectorAll(":checked").length||g.push(":checked")
}),ut(function(e){var t=n.createElement("input");
t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&g.push("[*^$]="+P+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||g.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),g.push(",.*:")
})),(r.matchesSelector=K.test(y=d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ut(function(e){r.disconnectedMatch=y.call(e,"div"),y.call(e,"[s!='']:x"),m.push("!=",I)
}),g=g.length&&RegExp(g.join("|")),m=m.length&&RegExp(m.join("|")),v=K.test(d.contains)||d.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;
return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))
}:function(e,t){if(t){while(t=t.parentNode){if(t===e){return !0
}}}return !1
},A=d.compareDocumentPosition?function(e,t){if(e===t){return S=!0,0
}var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);
return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||v(w,e)?-1:t===n||v(w,t)?1:c?F.call(c,e)-F.call(c,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1
}:function(e,t){var r,i=0,o=e.parentNode,a=t.parentNode,s=[e],l=[t];
if(e===t){return S=!0,0
}if(!o||!a){return e===n?-1:t===n?1:o?-1:a?1:c?F.call(c,e)-F.call(c,t):0
}if(o===a){return pt(e,t)
}r=e;
while(r=r.parentNode){s.unshift(r)
}r=t;
while(r=r.parentNode){l.unshift(r)
}while(s[i]===l[i]){i++
}return i?pt(s[i],l[i]):s[i]===w?-1:l[i]===w?1:0
},n):f
},at.matches=function(e,t){return at(e,null,null,t)
},at.matchesSelector=function(e,t){if((e.ownerDocument||e)!==f&&p(e),t=t.replace(Y,"='$1']"),!(!r.matchesSelector||!h||m&&m.test(t)||g&&g.test(t))){try{var n=y.call(e,t);
if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType){return n
}}catch(i){}}return at(t,f,null,[e]).length>0
},at.contains=function(e,t){return(e.ownerDocument||e)!==f&&p(e),v(e,t)
},at.attr=function(e,n){(e.ownerDocument||e)!==f&&p(e);
var i=o.attrHandle[n.toLowerCase()],a=i&&L.call(o.attrHandle,n.toLowerCase())?i(e,n,!h):t;
return a===t?r.attributes||!h?e.getAttribute(n):(a=e.getAttributeNode(n))&&a.specified?a.value:null:a
},at.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)
},at.uniqueSort=function(e){var t,n=[],i=0,o=0;
if(S=!r.detectDuplicates,c=!r.sortStable&&e.slice(0),e.sort(A),S){while(t=e[o++]){t===e[o]&&(i=n.push(o))
}while(i--){e.splice(n[i],1)
}}return e
},a=at.getText=function(e){var t,n="",r=0,i=e.nodeType;
if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent){return e.textContent
}for(e=e.firstChild;
e;
e=e.nextSibling){n+=a(e)
}}else{if(3===i||4===i){return e.nodeValue
}}}else{for(;
t=e[r];
r++){n+=a(t)
}}return n
},o=at.selectors={cacheLength:50,createPseudo:lt,match:Q,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)
},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||at.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&at.error(e[0]),e
},PSEUDO:function(e){var n,r=!e[5]&&e[2];
return Q.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&J.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))
}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();
return"*"===e?function(){return !0
}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t
}
},CLASS:function(e){var t=N[e+" "];
return t||(t=RegExp("(^|"+P+")"+e+"("+P+"|$)"))&&N(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==j&&e.getAttribute("class")||"")
})
},ATTR:function(e,t,n){return function(r){var i=at.attr(r,e);
return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0
}
},CHILD:function(e,t,n,r,i){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;
return 1===r&&0===i?function(e){return !!e.parentNode
}:function(t,n,l){var u,c,p,f,d,h,g=o!==a?"nextSibling":"previousSibling",m=t.parentNode,y=s&&t.nodeName.toLowerCase(),v=!l&&!s;
if(m){if(o){while(g){p=t;
while(p=p[g]){if(s?p.nodeName.toLowerCase()===y:1===p.nodeType){return !1
}}h=g="only"===e&&!h&&"nextSibling"
}return !0
}if(h=[a?m.firstChild:m.lastChild],a&&v){c=m[b]||(m[b]={}),u=c[e]||[],d=u[0]===T&&u[1],f=u[0]===T&&u[2],p=d&&m.childNodes[d];
while(p=++d&&p&&p[g]||(f=d=0)||h.pop()){if(1===p.nodeType&&++f&&p===t){c[e]=[T,d,f];
break
}}}else{if(v&&(u=(t[b]||(t[b]={}))[e])&&u[0]===T){f=u[1]
}else{while(p=++d&&p&&p[g]||(f=d=0)||h.pop()){if((s?p.nodeName.toLowerCase()===y:1===p.nodeType)&&++f&&(v&&((p[b]||(p[b]={}))[e]=[T,f]),p===t)){break
}}}}return f-=i,f===r||0===f%r&&f/r>=0
}}
},PSEUDO:function(e,t){var n,r=o.pseudos[e]||o.setFilters[e.toLowerCase()]||at.error("unsupported pseudo: "+e);
return r[b]?r(t):r.length>1?(n=[e,e,"",t],o.setFilters.hasOwnProperty(e.toLowerCase())?lt(function(e,n){var i,o=r(e,t),a=o.length;
while(a--){i=F.call(e,o[a]),e[i]=!(n[i]=o[a])
}}):function(e){return r(e,0,n)
}):r
}},pseudos:{not:lt(function(e){var t=[],n=[],r=l(e.replace(z,"$1"));
return r[b]?lt(function(e,t,n,i){var o,a=r(e,null,i,[]),s=e.length;
while(s--){(o=a[s])&&(e[s]=!(t[s]=o))
}}):function(e,i,o){return t[0]=e,r(t,null,o,n),!n.pop()
}
}),has:lt(function(e){return function(t){return at(e,t).length>0
}
}),contains:lt(function(e){return function(t){return(t.textContent||t.innerText||a(t)).indexOf(e)>-1
}
}),lang:lt(function(e){return G.test(e||"")||at.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;
do{if(n=h?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang")){return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-")
}}while((t=t.parentNode)&&1===t.nodeType);
return !1
}
}),target:function(t){var n=e.location&&e.location.hash;
return n&&n.slice(1)===t.id
},root:function(e){return e===d
},focus:function(e){return e===f.activeElement&&(!f.hasFocus||f.hasFocus())&&!!(e.type||e.href||~e.tabIndex)
},enabled:function(e){return e.disabled===!1
},disabled:function(e){return e.disabled===!0
},checked:function(e){var t=e.nodeName.toLowerCase();
return"input"===t&&!!e.checked||"option"===t&&!!e.selected
},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0
},empty:function(e){for(e=e.firstChild;
e;
e=e.nextSibling){if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType){return !1
}}return !0
},parent:function(e){return !o.pseudos.empty(e)
},header:function(e){return tt.test(e.nodeName)
},input:function(e){return et.test(e.nodeName)
},button:function(e){var t=e.nodeName.toLowerCase();
return"input"===t&&"button"===e.type||"button"===t
},text:function(e){var t;
return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)
},first:ht(function(){return[0]
}),last:ht(function(e,t){return[t-1]
}),eq:ht(function(e,t,n){return[0>n?n+t:n]
}),even:ht(function(e,t){var n=0;
for(;
t>n;
n+=2){e.push(n)
}return e
}),odd:ht(function(e,t){var n=1;
for(;
t>n;
n+=2){e.push(n)
}return e
}),lt:ht(function(e,t,n){var r=0>n?n+t:n;
for(;
--r>=0;
){e.push(r)
}return e
}),gt:ht(function(e,t,n){var r=0>n?n+t:n;
for(;
t>++r;
){e.push(r)
}return e
})}},o.pseudos.nth=o.pseudos.eq;
for(n in {radio:!0,checkbox:!0,file:!0,password:!0,image:!0}){o.pseudos[n]=ft(n)
}for(n in {submit:!0,reset:!0}){o.pseudos[n]=dt(n)
}function gt(){}gt.prototype=o.filters=o.pseudos,o.setFilters=new gt;
function mt(e,t){var n,r,i,a,s,l,u,c=k[e+" "];
if(c){return t?0:c.slice(0)
}s=e,l=[],u=o.preFilter;
while(s){(!n||(r=X.exec(s)))&&(r&&(s=s.slice(r[0].length)||s),l.push(i=[])),n=!1,(r=U.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(z," ")}),s=s.slice(n.length));
for(a in o.filter){!(r=Q[a].exec(s))||u[a]&&!(r=u[a](r))||(n=r.shift(),i.push({value:n,type:a,matches:r}),s=s.slice(n.length))
}if(!n){break
}}return t?s.length:s?at.error(e):k(e,l).slice(0)
}function yt(e){var t=0,n=e.length,r="";
for(;
n>t;
t++){r+=e[t].value
}return r
}function vt(e,t,n){var r=t.dir,o=n&&"parentNode"===r,a=C++;
return t.first?function(t,n,i){while(t=t[r]){if(1===t.nodeType||o){return e(t,n,i)
}}}:function(t,n,s){var l,u,c,p=T+" "+a;
if(s){while(t=t[r]){if((1===t.nodeType||o)&&e(t,n,s)){return !0
}}}else{while(t=t[r]){if(1===t.nodeType||o){if(c=t[b]||(t[b]={}),(u=c[r])&&u[0]===p){if((l=u[1])===!0||l===i){return l===!0
}}else{if(u=c[r]=[p],u[1]=e(t,n,s)||i,u[1]===!0){return !0
}}}}}}
}function bt(e){return e.length>1?function(t,n,r){var i=e.length;
while(i--){if(!e[i](t,n,r)){return !1
}}return !0
}:e[0]
}function xt(e,t,n,r,i){var o,a=[],s=0,l=e.length,u=null!=t;
for(;
l>s;
s++){(o=e[s])&&(!n||n(o,r,i))&&(a.push(o),u&&t.push(s))
}return a
}function wt(e,t,n,r,i,o){return r&&!r[b]&&(r=wt(r)),i&&!i[b]&&(i=wt(i,o)),lt(function(o,a,s,l){var u,c,p,f=[],d=[],h=a.length,g=o||Nt(t||"*",s.nodeType?[s]:s,[]),m=!e||!o&&t?g:xt(g,f,e,s,l),y=n?i||(o?e:h||r)?[]:a:m;
if(n&&n(m,y,s,l),r){u=xt(y,d),r(u,[],s,l),c=u.length;
while(c--){(p=u[c])&&(y[d[c]]=!(m[d[c]]=p))
}}if(o){if(i||e){if(i){u=[],c=y.length;
while(c--){(p=y[c])&&u.push(m[c]=p)
}i(null,y=[],u,l)
}c=y.length;
while(c--){(p=y[c])&&(u=i?F.call(o,p):f[c])>-1&&(o[u]=!(a[u]=p))
}}}else{y=xt(y===a?y.splice(h,y.length):y),i?i(null,a,y,l):M.apply(a,y)
}})
}function Tt(e){var t,n,r,i=e.length,a=o.relative[e[0].type],s=a||o.relative[" "],l=a?1:0,c=vt(function(e){return e===t
},s,!0),p=vt(function(e){return F.call(t,e)>-1
},s,!0),f=[function(e,n,r){return !a&&(r||n!==u)||((t=n).nodeType?c(e,n,r):p(e,n,r))
}];
for(;
i>l;
l++){if(n=o.relative[e[l].type]){f=[vt(bt(f),n)]
}else{if(n=o.filter[e[l].type].apply(null,e[l].matches),n[b]){for(r=++l;
i>r;
r++){if(o.relative[e[r].type]){break
}}return wt(l>1&&bt(f),l>1&&yt(e.slice(0,l-1).concat({value:" "===e[l-2].type?"*":""})).replace(z,"$1"),n,r>l&&Tt(e.slice(l,r)),i>r&&Tt(e=e.slice(r)),i>r&&yt(e))
}f.push(n)
}}return bt(f)
}function Ct(e,t){var n=0,r=t.length>0,a=e.length>0,s=function(s,l,c,p,d){var h,g,m,y=[],v=0,b="0",x=s&&[],w=null!=d,C=u,N=s||a&&o.find.TAG("*",d&&l.parentNode||l),k=T+=null==C?1:Math.random()||0.1;
for(w&&(u=l!==f&&l,i=n);
null!=(h=N[b]);
b++){if(a&&h){g=0;
while(m=e[g++]){if(m(h,l,c)){p.push(h);
break
}}w&&(T=k,i=++n)
}r&&((h=!m&&h)&&v--,s&&x.push(h))
}if(v+=b,r&&b!==v){g=0;
while(m=t[g++]){m(x,y,l,c)
}if(s){if(v>0){while(b--){x[b]||y[b]||(y[b]=q.call(p))
}}y=xt(y)
}M.apply(p,y),w&&!s&&y.length>0&&v+t.length>1&&at.uniqueSort(p)
}return w&&(T=k,u=C),x
};
return r?lt(s):s
}l=at.compile=function(e,t){var n,r=[],i=[],o=E[e+" "];
if(!o){t||(t=mt(e)),n=t.length;
while(n--){o=Tt(t[n]),o[b]?r.push(o):i.push(o)
}o=E(e,Ct(i,r))
}return o
};
function Nt(e,t,n){var r=0,i=t.length;
for(;
i>r;
r++){at(e,t[r],n)
}return n
}function kt(e,t,n,i){var a,s,u,c,p,f=mt(e);
if(!i&&1===f.length){if(s=f[0]=f[0].slice(0),s.length>2&&"ID"===(u=s[0]).type&&r.getById&&9===t.nodeType&&h&&o.relative[s[1].type]){if(t=(o.find.ID(u.matches[0].replace(rt,it),t)||[])[0],!t){return n
}e=e.slice(s.shift().value.length)
}a=Q.needsContext.test(e)?0:s.length;
while(a--){if(u=s[a],o.relative[c=u.type]){break
}if((p=o.find[c])&&(i=p(u.matches[0].replace(rt,it),V.test(s[0].type)&&t.parentNode||t))){if(s.splice(a,1),e=i.length&&yt(s),!e){return M.apply(n,i),n
}break
}}}return l(e,f)(i,t,!h,n,V.test(e)),n
}r.sortStable=b.split("").sort(A).join("")===b,r.detectDuplicates=S,p(),r.sortDetached=ut(function(e){return 1&e.compareDocumentPosition(f.createElement("div"))
}),ut(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")
})||ct("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)
}),r.attributes&&ut(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")
})||ct("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue
}),ut(function(e){return null==e.getAttribute("disabled")
})||ct(B,function(e,n,r){var i;
return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null
}),x.find=at,x.expr=at.selectors,x.expr[":"]=x.expr.pseudos,x.unique=at.uniqueSort,x.text=at.getText,x.isXMLDoc=at.isXML,x.contains=at.contains
}(e);
var O={};
function F(e){var t=O[e]={};
return x.each(e.match(T)||[],function(e,n){t[n]=!0
}),t
}x.Callbacks=function(e){e="string"==typeof e?O[e]||F(e):x.extend({},e);
var n,r,i,o,a,s,l=[],u=!e.once&&[],c=function(t){for(r=e.memory&&t,i=!0,a=s||0,s=0,o=l.length,n=!0;
l&&o>a;
a++){if(l[a].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;
break
}}n=!1,l&&(u?u.length&&c(u.shift()):r?l=[]:p.disable())
},p={add:function(){if(l){var t=l.length;
(function i(t){x.each(t,function(t,n){var r=x.type(n);
"function"===r?e.unique&&p.has(n)||l.push(n):n&&n.length&&"string"!==r&&i(n)
})
})(arguments),n?o=l.length:r&&(s=t,c(r))
}return this
},remove:function(){return l&&x.each(arguments,function(e,t){var r;
while((r=x.inArray(t,l,r))>-1){l.splice(r,1),n&&(o>=r&&o--,a>=r&&a--)
}}),this
},has:function(e){return e?x.inArray(e,l)>-1:!(!l||!l.length)
},empty:function(){return l=[],o=0,this
},disable:function(){return l=u=r=t,this
},disabled:function(){return !l
},lock:function(){return u=t,r||p.disable(),this
},locked:function(){return !u
},fireWith:function(e,t){return !l||i&&!u||(t=t||[],t=[e,t.slice?t.slice():t],n?u.push(t):c(t)),this
},fire:function(){return p.fireWith(this,arguments),this
},fired:function(){return !!i
}};
return p
},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n
},always:function(){return i.done(arguments).fail(arguments),this
},then:function(){var e=arguments;
return x.Deferred(function(n){x.each(t,function(t,o){var a=o[0],s=x.isFunction(e[t])&&e[t];
i[o[1]](function(){var e=s&&s.apply(this,arguments);
e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[a+"With"](this===r?n.promise():this,s?[e]:arguments)
})
}),e=null
}).promise()
},promise:function(e){return null!=e?x.extend(e,r):r
}},i={};
return r.pipe=r.then,x.each(t,function(e,o){var a=o[2],s=o[3];
r[o[1]]=a.add,s&&a.add(function(){n=s
},t[1^e][2].disable,t[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this
},i[o[0]+"With"]=a.fireWith
}),r.promise(i),e&&e.call(i,i),i
},when:function(e){var t=0,n=g.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,o=1===i?e:x.Deferred(),a=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?g.call(arguments):r,n===s?o.notifyWith(t,n):--i||o.resolveWith(t,n)
}
},s,l,u;
if(r>1){for(s=Array(r),l=Array(r),u=Array(r);
r>t;
t++){n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(a(t,u,n)).fail(o.reject).progress(a(t,l,s)):--i
}}return i||o.resolveWith(u,n),o.promise()
}}),x.support=function(t){var n,r,o,s,l,u,c,p,f,d=a.createElement("div");
if(d.setAttribute("className","t"),d.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=d.getElementsByTagName("*")||[],r=d.getElementsByTagName("a")[0],!r||!r.style||!n.length){return t
}s=a.createElement("select"),u=s.appendChild(a.createElement("option")),o=d.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==d.className,t.leadingWhitespace=3===d.firstChild.nodeType,t.tbody=!d.getElementsByTagName("tbody").length,t.htmlSerialize=!!d.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized="/a"===r.getAttribute("href"),t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!o.value,t.optSelected=u.selected,t.enctype=!!a.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==a.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,o.checked=!0,t.noCloneChecked=o.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled;
try{delete d.test
}catch(h){t.deleteExpando=!1
}o=a.createElement("input"),o.setAttribute("value",""),t.input=""===o.getAttribute("value"),o.value="t",o.setAttribute("type","radio"),t.radioValue="t"===o.value,o.setAttribute("checked","t"),o.setAttribute("name","t"),l=a.createDocumentFragment(),l.appendChild(o),t.appendChecked=o.checked,t.checkClone=l.cloneNode(!0).cloneNode(!0).lastChild.checked,d.attachEvent&&(d.attachEvent("onclick",function(){t.noCloneEvent=!1
}),d.cloneNode(!0).click());
for(f in {submit:!0,change:!0,focusin:!0}){d.setAttribute(c="on"+f,"t"),t[f+"Bubbles"]=c in e||d.attributes[c].expando===!1
}d.style.backgroundClip="content-box",d.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===d.style.backgroundClip;
for(f in x(t)){break
}return t.ownLast="0"!==f,x(function(){var n,r,o,s="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",l=a.getElementsByTagName("body")[0];
l&&(n=a.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",l.appendChild(n).appendChild(d),d.innerHTML="<table><tr><td></td><td>t</td></tr></table>",o=d.getElementsByTagName("td"),o[0].style.cssText="padding:0;margin:0;border:0;display:none",p=0===o[0].offsetHeight,o[0].style.display="",o[1].style.display="none",t.reliableHiddenOffsets=p&&0===o[0].offsetHeight,d.innerHTML="",d.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",x.swap(l,null!=l.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===d.offsetWidth
}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(d,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(d,null)||{width:"4px"}).width,r=d.appendChild(a.createElement("div")),r.style.cssText=d.style.cssText=s,r.style.marginRight=r.style.width="0",d.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof d.style.zoom!==i&&(d.innerHTML="",d.style.cssText=s+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===d.offsetWidth,d.style.display="block",d.innerHTML="<div></div>",d.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==d.offsetWidth,t.inlineBlockNeedsLayout&&(l.style.zoom=1)),l.removeChild(n),n=d=o=r=null)
}),n=s=l=u=r=o=null,t
}({});
var B=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,P=/([A-Z])/g;
function R(e,n,r,i){if(x.acceptData(e)){var o,a,s=x.expando,l=e.nodeType,u=l?x.cache:e,c=l?e[s]:e[s]&&s;
if(c&&u[c]&&(i||u[c].data)||r!==t||"string"!=typeof n){return c||(c=l?e[s]=p.pop()||x.guid++:s),u[c]||(u[c]=l?{}:{toJSON:x.noop}),("object"==typeof n||"function"==typeof n)&&(i?u[c]=x.extend(u[c],n):u[c].data=x.extend(u[c].data,n)),a=u[c],i||(a.data||(a.data={}),a=a.data),r!==t&&(a[x.camelCase(n)]=r),"string"==typeof n?(o=a[n],null==o&&(o=a[x.camelCase(n)])):o=a,o
}}}function W(e,t,n){if(x.acceptData(e)){var r,i,o=e.nodeType,a=o?x.cache:e,s=o?e[x.expando]:x.expando;
if(a[s]){if(t&&(r=n?a[s]:a[s].data)){x.isArray(t)?t=t.concat(x.map(t,x.camelCase)):t in r?t=[t]:(t=x.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;
while(i--){delete r[t[i]]
}if(n?!I(r):!x.isEmptyObject(r)){return
}}(n||(delete a[s].data,I(a[s])))&&(o?x.cleanData([e],!0):x.support.deleteExpando||a!=a.window?delete a[s]:a[s]=null)
}}}x.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?x.cache[e[x.expando]]:e[x.expando],!!e&&!I(e)
},data:function(e,t,n){return R(e,t,n)
},removeData:function(e,t){return W(e,t)
},_data:function(e,t,n){return R(e,t,n,!0)
},_removeData:function(e,t){return W(e,t,!0)
},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType){return !1
}var t=e.nodeName&&x.noData[e.nodeName.toLowerCase()];
return !t||t!==!0&&e.getAttribute("classid")===t
}}),x.fn.extend({data:function(e,n){var r,i,o=null,a=0,s=this[0];
if(e===t){if(this.length&&(o=x.data(s),1===s.nodeType&&!x._data(s,"parsedAttrs"))){for(r=s.attributes;
r.length>a;
a++){i=r[a].name,0===i.indexOf("data-")&&(i=x.camelCase(i.slice(5)),$(s,i,o[i]))
}x._data(s,"parsedAttrs",!0)
}return o
}return"object"==typeof e?this.each(function(){x.data(this,e)
}):arguments.length>1?this.each(function(){x.data(this,e,n)
}):s?$(s,e,x.data(s,e)):null
},removeData:function(e){return this.each(function(){x.removeData(this,e)
})
}});
function $(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(P,"-$1").toLowerCase();
if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:B.test(r)?x.parseJSON(r):r
}catch(o){}x.data(e,n,r)
}else{r=t
}}return r
}function I(e){var t;
for(t in e){if(("data"!==t||!x.isEmptyObject(e[t]))&&"toJSON"!==t){return !1
}}return !0
}x.extend({queue:function(e,n,r){var i;
return e?(n=(n||"fx")+"queue",i=x._data(e,n),r&&(!i||x.isArray(r)?i=x._data(e,n,x.makeArray(r)):i.push(r)),i||[]):t
},dequeue:function(e,t){t=t||"fx";
var n=x.queue(e,t),r=n.length,i=n.shift(),o=x._queueHooks(e,t),a=function(){x.dequeue(e,t)
};
"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,a,o)),!r&&o&&o.empty.fire()
},_queueHooks:function(e,t){var n=t+"queueHooks";
return x._data(e,n)||x._data(e,n,{empty:x.Callbacks("once memory").add(function(){x._removeData(e,t+"queue"),x._removeData(e,n)
})})
}}),x.fn.extend({queue:function(e,n){var r=2;
return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?x.queue(this[0],e):n===t?this:this.each(function(){var t=x.queue(this,e,n);
x._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&x.dequeue(this,e)
})
},dequeue:function(e){return this.each(function(){x.dequeue(this,e)
})
},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);
n.stop=function(){clearTimeout(r)
}
})
},clearQueue:function(e){return this.queue(e||"fx",[])
},promise:function(e,n){var r,i=1,o=x.Deferred(),a=this,s=this.length,l=function(){--i||o.resolveWith(a,[a])
};
"string"!=typeof e&&(n=e,e=t),e=e||"fx";
while(s--){r=x._data(a[s],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(l))
}return l(),o.promise(n)
}});
var z,X,U=/[\t\r\n\f]/g,V=/\r/g,Y=/^(?:input|select|textarea|button|object)$/i,J=/^(?:a|area)$/i,G=/^(?:checked|selected)$/i,Q=x.support.getSetAttribute,K=x.support.input;
x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)
},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)
})
},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)
},removeProp:function(e){return e=x.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]
}catch(n){}})
},addClass:function(e){var t,n,r,i,o,a=0,s=this.length,l="string"==typeof e&&e;
if(x.isFunction(e)){return this.each(function(t){x(this).addClass(e.call(this,t,this.className))
})
}if(l){for(t=(e||"").match(T)||[];
s>a;
a++){if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):" ")){o=0;
while(i=t[o++]){0>r.indexOf(" "+i+" ")&&(r+=i+" ")
}n.className=x.trim(r)
}}}return this
},removeClass:function(e){var t,n,r,i,o,a=0,s=this.length,l=0===arguments.length||"string"==typeof e&&e;
if(x.isFunction(e)){return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))
})
}if(l){for(t=(e||"").match(T)||[];
s>a;
a++){if(n=this[a],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(U," "):"")){o=0;
while(i=t[o++]){while(r.indexOf(" "+i+" ")>=0){r=r.replace(" "+i+" "," ")
}}n.className=e?x.trim(r):""
}}}return this
},toggleClass:function(e,t){var n=typeof e;
return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)
}):this.each(function(){if("string"===n){var t,r=0,o=x(this),a=e.match(T)||[];
while(t=a[r++]){o.hasClass(t)?o.removeClass(t):o.addClass(t)
}}else{(n===i||"boolean"===n)&&(this.className&&x._data(this,"__className__",this.className),this.className=this.className||e===!1?"":x._data(this,"__className__")||"")
}})
},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;
for(;
r>n;
n++){if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(U," ").indexOf(t)>=0){return !0
}}return !1
},val:function(e){var n,r,i,o=this[0];
if(arguments.length){return i=x.isFunction(e),this.each(function(n){var o;
1===this.nodeType&&(o=i?e.call(this,n,x(this).val()):e,null==o?o="":"number"==typeof o?o+="":x.isArray(o)&&(o=x.map(o,function(e){return null==e?"":e+""
})),r=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],r&&"set" in r&&r.set(this,o,"value")!==t||(this.value=o))
})
}if(o){return r=x.valHooks[o.type]||x.valHooks[o.nodeName.toLowerCase()],r&&"get" in r&&(n=r.get(o,"value"))!==t?n:(n=o.value,"string"==typeof n?n.replace(V,""):null==n?"":n)
}}}),x.extend({valHooks:{option:{get:function(e){var t=x.find.attr(e,"value");
return null!=t?t:e.text
}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,o="select-one"===e.type||0>i,a=o?null:[],s=o?i+1:r.length,l=0>i?s:o?i:0;
for(;
s>l;
l++){if(n=r[l],!(!n.selected&&l!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),o){return t
}a.push(t)
}}return a
},set:function(e,t){var n,r,i=e.options,o=x.makeArray(t),a=i.length;
while(a--){r=i[a],(r.selected=x.inArray(x(r).val(),o)>=0)&&(n=!0)
}return n||(e.selectedIndex=-1),o
}}},attr:function(e,n,r){var o,a,s=e.nodeType;
if(e&&3!==s&&8!==s&&2!==s){return typeof e.getAttribute===i?x.prop(e,n,r):(1===s&&x.isXMLDoc(e)||(n=n.toLowerCase(),o=x.attrHooks[n]||(x.expr.match.bool.test(n)?X:z)),r===t?o&&"get" in o&&null!==(a=o.get(e,n))?a:(a=x.find.attr(e,n),null==a?t:a):null!==r?o&&"set" in o&&(a=o.set(e,r,n))!==t?a:(e.setAttribute(n,r+""),r):(x.removeAttr(e,n),t))
}},removeAttr:function(e,t){var n,r,i=0,o=t&&t.match(T);
if(o&&1===e.nodeType){while(n=o[i++]){r=x.propFix[n]||n,x.expr.match.bool.test(n)?K&&Q||!G.test(n)?e[r]=!1:e[x.camelCase("default-"+n)]=e[r]=!1:x.attr(e,n,""),e.removeAttribute(Q?n:r)
}}},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;
return e.setAttribute("type",t),n&&(e.value=n),t
}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,o,a,s=e.nodeType;
if(e&&3!==s&&8!==s&&2!==s){return a=1!==s||!x.isXMLDoc(e),a&&(n=x.propFix[n]||n,o=x.propHooks[n]),r!==t?o&&"set" in o&&(i=o.set(e,r,n))!==t?i:e[n]=r:o&&"get" in o&&null!==(i=o.get(e,n))?i:e[n]
}},propHooks:{tabIndex:{get:function(e){var t=x.find.attr(e,"tabindex");
return t?parseInt(t,10):Y.test(e.nodeName)||J.test(e.nodeName)&&e.href?0:-1
}}}}),X={set:function(e,t,n){return t===!1?x.removeAttr(e,n):K&&Q||!G.test(n)?e.setAttribute(!Q&&x.propFix[n]||n,n):e[x.camelCase("default-"+n)]=e[n]=!0,n
}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,n){var r=x.expr.attrHandle[n]||x.find.attr;
x.expr.attrHandle[n]=K&&Q||!G.test(n)?function(e,n,i){var o=x.expr.attrHandle[n],a=i?t:(x.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;
return x.expr.attrHandle[n]=o,a
}:function(e,n,r){return r?t:e[x.camelCase("default-"+n)]?n.toLowerCase():null
}
}),K&&Q||(x.attrHooks.value={set:function(e,n,r){return x.nodeName(e,"input")?(e.defaultValue=n,t):z&&z.set(e,n,r)
}}),Q||(z={set:function(e,n,r){var i=e.getAttributeNode(r);
return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t
}},x.expr.attrHandle.id=x.expr.attrHandle.name=x.expr.attrHandle.coords=function(e,n,r){var i;
return r?t:(i=e.getAttributeNode(n))&&""!==i.value?i.value:null
},x.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);
return r&&r.specified?r.value:t
},set:z.set},x.attrHooks.contenteditable={set:function(e,t,n){z.set(e,""===t?!1:t,n)
}},x.each(["width","height"],function(e,n){x.attrHooks[n]={set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t
}}
})),x.support.hrefNormalized||x.each(["href","src"],function(e,t){x.propHooks[t]={get:function(e){return e.getAttribute(t,4)
}}
}),x.support.style||(x.attrHooks.style={get:function(e){return e.style.cssText||t
},set:function(e,t){return e.style.cssText=t+""
}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;
return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null
}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this
}),x.support.enctype||(x.propFix.enctype="encoding"),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,n){return x.isArray(n)?e.checked=x.inArray(x(e).val(),n)>=0:t
}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value
})
});
var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;
function it(){return !0
}function ot(){return !1
}function at(){try{return a.activeElement
}catch(e){}}x.event={global:{},add:function(e,n,r,o,a){var s,l,u,c,p,f,d,h,g,m,y,v=x._data(e);
if(v){r.handler&&(c=r,r=c.handler,a=c.selector),r.guid||(r.guid=x.guid++),(l=v.events)||(l=v.events={}),(f=v.handle)||(f=v.handle=function(e){return typeof x===i||e&&x.event.triggered===e.type?t:x.event.dispatch.apply(f.elem,arguments)
},f.elem=e),n=(n||"").match(T)||[""],u=n.length;
while(u--){s=rt.exec(n[u])||[],g=y=s[1],m=(s[2]||"").split(".").sort(),g&&(p=x.event.special[g]||{},g=(a?p.delegateType:p.bindType)||g,p=x.event.special[g]||{},d=x.extend({type:g,origType:y,data:o,handler:r,guid:r.guid,selector:a,needsContext:a&&x.expr.match.needsContext.test(a),namespace:m.join(".")},c),(h=l[g])||(h=l[g]=[],h.delegateCount=0,p.setup&&p.setup.call(e,o,m,f)!==!1||(e.addEventListener?e.addEventListener(g,f,!1):e.attachEvent&&e.attachEvent("on"+g,f))),p.add&&(p.add.call(e,d),d.handler.guid||(d.handler.guid=r.guid)),a?h.splice(h.delegateCount++,0,d):h.push(d),x.event.global[g]=!0)
}e=null
}},remove:function(e,t,n,r,i){var o,a,s,l,u,c,p,f,d,h,g,m=x.hasData(e)&&x._data(e);
if(m&&(c=m.events)){t=(t||"").match(T)||[""],u=t.length;
while(u--){if(s=rt.exec(t[u])||[],d=g=s[1],h=(s[2]||"").split(".").sort(),d){p=x.event.special[d]||{},d=(r?p.delegateType:p.bindType)||d,f=c[d]||[],s=s[2]&&RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=o=f.length;
while(o--){a=f[o],!i&&g!==a.origType||n&&n.guid!==a.guid||s&&!s.test(a.namespace)||r&&r!==a.selector&&("**"!==r||!a.selector)||(f.splice(o,1),a.selector&&f.delegateCount--,p.remove&&p.remove.call(e,a))
}l&&!f.length&&(p.teardown&&p.teardown.call(e,h,m.handle)!==!1||x.removeEvent(e,d,m.handle),delete c[d])
}else{for(d in c){x.event.remove(e,d+t[u],n,r,!0)
}}}x.isEmptyObject(c)&&(delete m.handle,x._removeData(e,"events"))
}},trigger:function(n,r,i,o){var s,l,u,c,p,f,d,h=[i||a],g=v.call(n,"type")?n.type:n,m=v.call(n,"namespace")?n.namespace.split("."):[];
if(u=f=i=i||a,3!==i.nodeType&&8!==i.nodeType&&!nt.test(g+x.event.triggered)&&(g.indexOf(".")>=0&&(m=g.split("."),g=m.shift(),m.sort()),l=0>g.indexOf(":")&&"on"+g,n=n[x.expando]?n:new x.Event(g,"object"==typeof n&&n),n.isTrigger=o?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:x.makeArray(r,[n]),p=x.event.special[g]||{},o||!p.trigger||p.trigger.apply(i,r)!==!1)){if(!o&&!p.noBubble&&!x.isWindow(i)){for(c=p.delegateType||g,nt.test(c+g)||(u=u.parentNode);
u;
u=u.parentNode){h.push(u),f=u
}f===(i.ownerDocument||a)&&h.push(f.defaultView||f.parentWindow||e)
}d=0;
while((u=h[d++])&&!n.isPropagationStopped()){n.type=d>1?c:p.bindType||g,s=(x._data(u,"events")||{})[n.type]&&x._data(u,"handle"),s&&s.apply(u,r),s=l&&u[l],s&&x.acceptData(u)&&s.apply&&s.apply(u,r)===!1&&n.preventDefault()
}if(n.type=g,!o&&!n.isDefaultPrevented()&&(!p._default||p._default.apply(h.pop(),r)===!1)&&x.acceptData(i)&&l&&i[g]&&!x.isWindow(i)){f=i[l],f&&(i[l]=null),x.event.triggered=g;
try{i[g]()
}catch(y){}x.event.triggered=t,f&&(i[l]=f)
}return n.result
}},dispatch:function(e){e=x.event.fix(e);
var n,r,i,o,a,s=[],l=g.call(arguments),u=(x._data(this,"events")||{})[e.type]||[],c=x.event.special[e.type]||{};
if(l[0]=e,e.delegateTarget=this,!c.preDispatch||c.preDispatch.call(this,e)!==!1){s=x.event.handlers.call(this,e,u),n=0;
while((o=s[n++])&&!e.isPropagationStopped()){e.currentTarget=o.elem,a=0;
while((i=o.handlers[a++])&&!e.isImmediatePropagationStopped()){(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((x.event.special[i.origType]||{}).handle||i.handler).apply(o.elem,l),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))
}}return c.postDispatch&&c.postDispatch.call(this,e),e.result
}},handlers:function(e,n){var r,i,o,a,s=[],l=n.delegateCount,u=e.target;
if(l&&u.nodeType&&(!e.button||"click"!==e.type)){for(;
u!=this;
u=u.parentNode||this){if(1===u.nodeType&&(u.disabled!==!0||"click"!==e.type)){for(o=[],a=0;
l>a;
a++){i=n[a],r=i.selector+" ",o[r]===t&&(o[r]=i.needsContext?x(r,this).index(u)>=0:x.find(r,this,null,[u]).length),o[r]&&o.push(i)
}o.length&&s.push({elem:u,handlers:o})
}}}return n.length>l&&s.push({elem:this,handlers:n.slice(l)}),s
},fix:function(e){if(e[x.expando]){return e
}var t,n,r,i=e.type,o=e,s=this.fixHooks[i];
s||(this.fixHooks[i]=s=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,e=new x.Event(o),t=r.length;
while(t--){n=r[t],e[n]=o[n]
}return e.target||(e.target=o.srcElement||a),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,s.filter?s.filter(e,o):e
},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e
}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,o,s=n.button,l=n.fromElement;
return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||a,o=i.documentElement,r=i.body,e.pageX=n.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&l&&(e.relatedTarget=l===e.target?n.toElement:l),e.which||s===t||(e.which=1&s?1:2&s?3:4&s?2:0),e
}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==at()&&this.focus){try{return this.focus(),!1
}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){return this===at()&&this.blur?(this.blur(),!1):t
},delegateType:"focusout"},click:{trigger:function(){return x.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t
},_default:function(e){return x.nodeName(e.target,"a")
}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)
}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});
r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()
}},x.removeEvent=a.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)
}:function(e,t,n){var r="on"+t;
e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))
},x.Event=function(e,n){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:ot):this.type=e,n&&x.extend(this,n),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,t):new x.Event(e,n)
},x.Event.prototype={isDefaultPrevented:ot,isPropagationStopped:ot,isImmediatePropagationStopped:ot,preventDefault:function(){var e=this.originalEvent;
this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)
},stopPropagation:function(){var e=this.originalEvent;
this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)
},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()
}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,o=e.handleObj;
return(!i||i!==r&&!x.contains(r,i))&&(e.type=o.origType,n=o.handler.apply(this,arguments),e.type=t),n
}}
}),x.support.submitBubbles||(x.event.special.submit={setup:function(){return x.nodeName(this,"form")?!1:(x.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=x.nodeName(n,"input")||x.nodeName(n,"button")?n.form:t;
r&&!x._data(r,"submitBubbles")&&(x.event.add(r,"submit._submit",function(e){e._submit_bubble=!0
}),x._data(r,"submitBubbles",!0))
}),t)
},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&x.event.simulate("submit",this.parentNode,e,!0))
},teardown:function(){return x.nodeName(this,"form")?!1:(x.event.remove(this,"._submit"),t)
}}),x.support.changeBubbles||(x.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(x.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)
}),x.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),x.event.simulate("change",this,e,!0)
})),!1):(x.event.add(this,"beforeactivate._change",function(e){var t=e.target;
Z.test(t.nodeName)&&!x._data(t,"changeBubbles")&&(x.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||x.event.simulate("change",this.parentNode,e,!0)
}),x._data(t,"changeBubbles",!0))
}),t)
},handle:function(e){var n=e.target;
return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t
},teardown:function(){return x.event.remove(this,"._change"),!Z.test(this.nodeName)
}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)
};
x.event.special[t]={setup:function(){0===n++&&a.addEventListener(e,r,!0)
},teardown:function(){0===--n&&a.removeEventListener(e,r,!0)
}}
}),x.fn.extend({on:function(e,n,r,i,o){var a,s;
if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);
for(a in e){this.on(a,n,r,e[a],o)
}return this
}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1){i=ot
}else{if(!i){return this
}}return 1===o&&(s=i,i=function(e){return x().off(e),s.apply(this,arguments)
},i.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,i,r,n)
})
},one:function(e,t,n,r){return this.on(e,t,n,r,1)
},off:function(e,n,r){var i,o;
if(e&&e.preventDefault&&e.handleObj){return i=e.handleObj,x(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this
}if("object"==typeof e){for(o in e){this.off(o,n,e[o])
}return this
}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=ot),this.each(function(){x.event.remove(this,e,r,n)
})
},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)
})
},triggerHandler:function(e,n){var r=this[0];
return r?x.event.trigger(e,n,r,!0):t
}});
var st=/^.[^:#\[\.,]*$/,lt=/^(?:parents|prev(?:Until|All))/,ut=x.expr.match.needsContext,ct={children:!0,contents:!0,next:!0,prev:!0};
x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;
if("string"!=typeof e){return this.pushStack(x(e).filter(function(){for(t=0;
i>t;
t++){if(x.contains(r[t],this)){return !0
}}}))
}for(t=0;
i>t;
t++){x.find(e,r[t],n)
}return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n
},has:function(e){var t,n=x(e,this),r=n.length;
return this.filter(function(){for(t=0;
r>t;
t++){if(x.contains(this,n[t])){return !0
}}})
},not:function(e){return this.pushStack(ft(this,e||[],!0))
},filter:function(e){return this.pushStack(ft(this,e||[],!1))
},is:function(e){return !!ft(this,"string"==typeof e&&ut.test(e)?x(e):e||[],!1).length
},closest:function(e,t){var n,r=0,i=this.length,o=[],a=ut.test(e)||"string"!=typeof e?x(e,t||this.context):0;
for(;
i>r;
r++){for(n=this[r];
n&&n!==t;
n=n.parentNode){if(11>n.nodeType&&(a?a.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=o.push(n);
break
}}}return this.pushStack(o.length>1?x.unique(o):o)
},index:function(e){return e?"string"==typeof e?x.inArray(this[0],x(e)):x.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1
},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);
return this.pushStack(x.unique(r))
},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))
}});
function pt(e,t){do{e=e[t]
}while(e&&1!==e.nodeType);
return e
}x.each({parent:function(e){var t=e.parentNode;
return t&&11!==t.nodeType?t:null
},parents:function(e){return x.dir(e,"parentNode")
},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)
},next:function(e){return pt(e,"nextSibling")
},prev:function(e){return pt(e,"previousSibling")
},nextAll:function(e){return x.dir(e,"nextSibling")
},prevAll:function(e){return x.dir(e,"previousSibling")
},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)
},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)
},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)
},children:function(e){return x.sibling(e.firstChild)
},contents:function(e){return x.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:x.merge([],e.childNodes)
}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);
return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(ct[e]||(i=x.unique(i)),lt.test(e)&&(i=i.reverse())),this.pushStack(i)
}
}),x.extend({filter:function(e,t,n){var r=t[0];
return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType
}))
},dir:function(e,n,r){var i=[],o=e[n];
while(o&&9!==o.nodeType&&(r===t||1!==o.nodeType||!x(o).is(r))){1===o.nodeType&&i.push(o),o=o[n]
}return i
},sibling:function(e,t){var n=[];
for(;
e;
e=e.nextSibling){1===e.nodeType&&e!==t&&n.push(e)
}return n
}});
function ft(e,t,n){if(x.isFunction(t)){return x.grep(e,function(e,r){return !!t.call(e,r,e)!==n
})
}if(t.nodeType){return x.grep(e,function(e){return e===t!==n
})
}if("string"==typeof t){if(st.test(t)){return x.filter(t,e,n)
}t=x.filter(t,e)
}return x.grep(e,function(e){return x.inArray(e,t)>=0!==n
})
}function dt(e){var t=ht.split("|"),n=e.createDocumentFragment();
if(n.createElement){while(t.length){n.createElement(t.pop())
}}return n
}var ht="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+ht+")[\\s/>]","i"),yt=/^\s+/,vt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,xt=/<tbody/i,wt=/<|&#?\w+;/,Tt=/<(?:script|style|link)/i,Ct=/^(?:checkbox|radio)$/i,Nt=/checked\s*(?:[^=]|=\s*.checked.)/i,kt=/^$|\/(?:java|ecma)script/i,Et=/^true\/(.*)/,St=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,At={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:x.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},jt=dt(a),Dt=jt.appendChild(a.createElement("div"));
At.optgroup=At.option,At.tbody=At.tfoot=At.colgroup=At.caption=At.thead,At.th=At.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===t?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||a).createTextNode(e))
},null,e,arguments.length)
},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);
t.appendChild(e)
}})
},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Lt(this,e);
t.insertBefore(e,t.firstChild)
}})
},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)
})
},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)
})
},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;
for(;
null!=(n=r[i]);
i++){t||1!==n.nodeType||x.cleanData(Ft(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&_t(Ft(n,"script")),n.parentNode.removeChild(n))
}return this
},empty:function(){var e,t=0;
for(;
null!=(e=this[t]);
t++){1===e.nodeType&&x.cleanData(Ft(e,!1));
while(e.firstChild){e.removeChild(e.firstChild)
}e.options&&x.nodeName(e,"select")&&(e.options.length=0)
}return this
},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)
})
},html:function(e){return x.access(this,function(e){var n=this[0]||{},r=0,i=this.length;
if(e===t){return 1===n.nodeType?n.innerHTML.replace(gt,""):t
}if(!("string"!=typeof e||Tt.test(e)||!x.support.htmlSerialize&&mt.test(e)||!x.support.leadingWhitespace&&yt.test(e)||At[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(vt,"<$1></$2>");
try{for(;
i>r;
r++){n=this[r]||{},1===n.nodeType&&(x.cleanData(Ft(n,!1)),n.innerHTML=e)
}n=0
}catch(o){}}n&&this.empty().append(e)
},null,e,arguments.length)
},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]
}),t=0;
return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];
i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))
},!0),t?this:this.remove()
},detach:function(e){return this.remove(e,!0)
},domManip:function(e,t,n){e=d.apply([],e);
var r,i,o,a,s,l,u=0,c=this.length,p=this,f=c-1,h=e[0],g=x.isFunction(h);
if(g||!(1>=c||"string"!=typeof h||x.support.checkClone)&&Nt.test(h)){return this.each(function(r){var i=p.eq(r);
g&&(e[0]=h.call(this,r,i.html())),i.domManip(e,t,n)
})
}if(c&&(l=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=l.firstChild,1===l.childNodes.length&&(l=r),r)){for(a=x.map(Ft(l,"script"),Ht),o=a.length;
c>u;
u++){i=l,u!==f&&(i=x.clone(i,!0,!0),o&&x.merge(a,Ft(i,"script"))),t.call(this[u],i,u)
}if(o){for(s=a[a.length-1].ownerDocument,x.map(a,qt),u=0;
o>u;
u++){i=a[u],kt.test(i.type||"")&&!x._data(i,"globalEval")&&x.contains(s,i)&&(i.src?x._evalUrl(i.src):x.globalEval((i.text||i.textContent||i.innerHTML||"").replace(St,"")))
}}l=r=null
}return this
}});
function Lt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e
}function Ht(e){return e.type=(null!==x.find.attr(e,"type"))+"/"+e.type,e
}function qt(e){var t=Et.exec(e.type);
return t?e.type=t[1]:e.removeAttribute("type"),e
}function _t(e,t){var n,r=0;
for(;
null!=(n=e[r]);
r++){x._data(n,"globalEval",!t||x._data(t[r],"globalEval"))
}}function Mt(e,t){if(1===t.nodeType&&x.hasData(e)){var n,r,i,o=x._data(e),a=x._data(t,o),s=o.events;
if(s){delete a.handle,a.events={};
for(n in s){for(r=0,i=s[n].length;
i>r;
r++){x.event.add(t,n,s[n][r])
}}}a.data&&(a.data=x.extend({},a.data))
}}function Ot(e,t){var n,r,i;
if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!x.support.noCloneEvent&&t[x.expando]){i=x._data(t);
for(r in i.events){x.removeEvent(t,r,i.handle)
}t.removeAttribute(x.expando)
}"script"===n&&t.text!==e.text?(Ht(t).text=e.text,qt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),x.support.html5Clone&&e.innerHTML&&!x.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&Ct.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)
}}x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=0,i=[],o=x(e),a=o.length-1;
for(;
a>=r;
r++){n=r===a?this:this.clone(!0),x(o[r])[t](n),h.apply(i,n.get())
}return this.pushStack(i)
}
});
function Ft(e,n){var r,o,a=0,s=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;
if(!s){for(s=[],r=e.childNodes||e;
null!=(o=r[a]);
a++){!n||x.nodeName(o,n)?s.push(o):x.merge(s,Ft(o,n))
}}return n===t||n&&x.nodeName(e,n)?x.merge([e],s):s
}function Bt(e){Ct.test(e.type)&&(e.defaultChecked=e.checked)
}x.extend({clone:function(e,t,n){var r,i,o,a,s,l=x.contains(e.ownerDocument,e);
if(x.support.html5Clone||x.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?o=e.cloneNode(!0):(Dt.innerHTML=e.outerHTML,Dt.removeChild(o=Dt.firstChild)),!(x.support.noCloneEvent&&x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e))){for(r=Ft(o),s=Ft(e),a=0;
null!=(i=s[a]);
++a){r[a]&&Ot(i,r[a])
}}if(t){if(n){for(s=s||Ft(e),r=r||Ft(o),a=0;
null!=(i=s[a]);
a++){Mt(i,r[a])
}}else{Mt(e,o)
}}return r=Ft(o,"script"),r.length>0&&_t(r,!l&&Ft(e,"script")),r=s=i=null,o
},buildFragment:function(e,t,n,r){var i,o,a,s,l,u,c,p=e.length,f=dt(t),d=[],h=0;
for(;
p>h;
h++){if(o=e[h],o||0===o){if("object"===x.type(o)){x.merge(d,o.nodeType?[o]:o)
}else{if(wt.test(o)){s=s||f.appendChild(t.createElement("div")),l=(bt.exec(o)||["",""])[1].toLowerCase(),c=At[l]||At._default,s.innerHTML=c[1]+o.replace(vt,"<$1></$2>")+c[2],i=c[0];
while(i--){s=s.lastChild
}if(!x.support.leadingWhitespace&&yt.test(o)&&d.push(t.createTextNode(yt.exec(o)[0])),!x.support.tbody){o="table"!==l||xt.test(o)?"<table>"!==c[1]||xt.test(o)?0:s:s.firstChild,i=o&&o.childNodes.length;
while(i--){x.nodeName(u=o.childNodes[i],"tbody")&&!u.childNodes.length&&o.removeChild(u)
}}x.merge(d,s.childNodes),s.textContent="";
while(s.firstChild){s.removeChild(s.firstChild)
}s=f.lastChild
}else{d.push(t.createTextNode(o))
}}}}s&&f.removeChild(s),x.support.appendChecked||x.grep(Ft(d,"input"),Bt),h=0;
while(o=d[h++]){if((!r||-1===x.inArray(o,r))&&(a=x.contains(o.ownerDocument,o),s=Ft(f.appendChild(o),"script"),a&&_t(s),n)){i=0;
while(o=s[i++]){kt.test(o.type||"")&&n.push(o)
}}}return s=null,f
},cleanData:function(e,t){var n,r,o,a,s=0,l=x.expando,u=x.cache,c=x.support.deleteExpando,f=x.event.special;
for(;
null!=(n=e[s]);
s++){if((t||x.acceptData(n))&&(o=n[l],a=o&&u[o])){if(a.events){for(r in a.events){f[r]?x.event.remove(n,r):x.removeEvent(n,r,a.handle)
}}u[o]&&(delete u[o],c?delete n[l]:typeof n.removeAttribute!==i?n.removeAttribute(l):n[l]=null,p.push(o))
}}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})
}}),x.fn.extend({wrapAll:function(e){if(x.isFunction(e)){return this.each(function(t){x(this).wrapAll(e.call(this,t))
})
}if(this[0]){var t=x(e,this[0].ownerDocument).eq(0).clone(!0);
this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;
while(e.firstChild&&1===e.firstChild.nodeType){e=e.firstChild
}return e
}).append(this)
}return this
},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))
}):this.each(function(){var t=x(this),n=t.contents();
n.length?n.wrapAll(e):t.append(e)
})
},wrap:function(e){var t=x.isFunction(e);
return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)
})
},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)
}).end()
}});
var Pt,Rt,Wt,$t=/alpha\([^)]*\)/i,It=/opacity\s*=\s*([^)]*)/,zt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Ut=/^margin/,Vt=RegExp("^("+w+")(.*)$","i"),Yt=RegExp("^("+w+")(?!px)[a-z%]+$","i"),Jt=RegExp("^([+-])=("+w+")","i"),Gt={BODY:"block"},Qt={position:"absolute",visibility:"hidden",display:"block"},Kt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];
function tn(e,t){if(t in e){return t
}var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;
while(i--){if(t=en[i]+n,t in e){return t
}}return r
}function nn(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)
}function rn(e,t){var n,r,i,o=[],a=0,s=e.length;
for(;
s>a;
a++){r=e[a],r.style&&(o[a]=x._data(r,"olddisplay"),n=r.style.display,t?(o[a]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(o[a]=x._data(r,"olddisplay",ln(r.nodeName)))):o[a]||(i=nn(r),(n&&"none"!==n||!i)&&x._data(r,"olddisplay",i?n:x.css(r,"display"))))
}for(a=0;
s>a;
a++){r=e[a],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?o[a]||"":"none"))
}return e
}x.fn.extend({css:function(e,n){return x.access(this,function(e,n,r){var i,o,a={},s=0;
if(x.isArray(n)){for(o=Rt(e),i=n.length;
i>s;
s++){a[n[s]]=x.css(e,n[s],!1,o)
}return a
}return r!==t?x.style(e,n,r):x.css(e,n)
},e,n,arguments.length>1)
},show:function(){return rn(this,!0)
},hide:function(){return rn(this)
},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){nn(this)?x(this).show():x(this).hide()
})
}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Wt(e,"opacity");
return""===n?"1":n
}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":x.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,s,l=x.camelCase(n),u=e.style;
if(n=x.cssProps[l]||(x.cssProps[l]=tn(u,l)),s=x.cssHooks[n]||x.cssHooks[l],r===t){return s&&"get" in s&&(o=s.get(e,!1,i))!==t?o:u[n]
}if(a=typeof r,"string"===a&&(o=Jt.exec(r))&&(r=(o[1]+1)*o[2]+parseFloat(x.css(e,n)),a="number"),!(null==r||"number"===a&&isNaN(r)||("number"!==a||x.cssNumber[l]||(r+="px"),x.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(u[n]="inherit"),s&&"set" in s&&(r=s.set(e,r,i))===t))){try{u[n]=r
}catch(c){}}}},css:function(e,n,r,i){var o,a,s,l=x.camelCase(n);
return n=x.cssProps[l]||(x.cssProps[l]=tn(e.style,l)),s=x.cssHooks[n]||x.cssHooks[l],s&&"get" in s&&(a=s.get(e,!0,r)),a===t&&(a=Wt(e,n,i)),"normal"===a&&n in Kt&&(a=Kt[n]),""===r||r?(o=parseFloat(a),r===!0||x.isNumeric(o)?o||0:a):a
}}),e.getComputedStyle?(Rt=function(t){return e.getComputedStyle(t,null)
},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s.getPropertyValue(n)||s[n]:t,u=e.style;
return s&&(""!==l||x.contains(e.ownerDocument,e)||(l=x.style(e,n)),Yt.test(l)&&Ut.test(n)&&(i=u.width,o=u.minWidth,a=u.maxWidth,u.minWidth=u.maxWidth=u.width=l,l=s.width,u.width=i,u.minWidth=o,u.maxWidth=a)),l
}):a.documentElement.currentStyle&&(Rt=function(e){return e.currentStyle
},Wt=function(e,n,r){var i,o,a,s=r||Rt(e),l=s?s[n]:t,u=e.style;
return null==l&&u&&u[n]&&(l=u[n]),Yt.test(l)&&!zt.test(n)&&(i=u.left,o=e.runtimeStyle,a=o&&o.left,a&&(o.left=e.currentStyle.left),u.left="fontSize"===n?"1em":l,l=u.pixelLeft+"px",u.left=i,a&&(o.left=a)),""===l?"auto":l
});
function on(e,t,n){var r=Vt.exec(t);
return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t
}function an(e,t,n,r,i){var o=n===(r?"border":"content")?4:"width"===t?1:0,a=0;
for(;
4>o;
o+=2){"margin"===n&&(a+=x.css(e,n+Zt[o],!0,i)),r?("content"===n&&(a-=x.css(e,"padding"+Zt[o],!0,i)),"margin"!==n&&(a-=x.css(e,"border"+Zt[o]+"Width",!0,i))):(a+=x.css(e,"padding"+Zt[o],!0,i),"padding"!==n&&(a+=x.css(e,"border"+Zt[o]+"Width",!0,i)))
}return a
}function sn(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,o=Rt(e),a=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,o);
if(0>=i||null==i){if(i=Wt(e,t,o),(0>i||null==i)&&(i=e.style[t]),Yt.test(i)){return i
}r=a&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0
}return i+an(e,t,n||(a?"border":"content"),r,o)+"px"
}function ln(e){var t=a,n=Gt[e];
return n||(n=un(e,t),"none"!==n&&n||(Pt=(Pt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(Pt[0].contentWindow||Pt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=un(e,t),Pt.detach()),Gt[e]=n),n
}function un(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");
return n.remove(),r
}x.each(["height","width"],function(e,n){x.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(x.css(e,"display"))?x.swap(e,Qt,function(){return sn(e,n,i)
}):sn(e,n,i):t
},set:function(e,t,r){var i=r&&Rt(e);
return on(e,t,r?an(e,n,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)
}}
}),x.support.opacity||(x.cssHooks.opacity={get:function(e,t){return It.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?0.01*parseFloat(RegExp.$1)+"":t?"1":""
},set:function(e,t){var n=e.style,r=e.currentStyle,i=x.isNumeric(t)?"alpha(opacity="+100*t+")":"",o=r&&r.filter||n.filter||"";
n.zoom=1,(t>=1||""===t)&&""===x.trim(o.replace($t,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=$t.test(o)?o.replace($t,i):o+" "+i)
}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,n){return n?x.swap(e,{display:"inline-block"},Wt,[e,"marginRight"]):t
}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,n){x.cssHooks[n]={get:function(e,r){return r?(r=Wt(e,n),Yt.test(r)?x(e).position()[n]+"px":r):t
}}
})
}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!x.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||x.css(e,"display"))
},x.expr.filters.visible=function(e){return !x.expr.filters.hidden(e)
}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},o="string"==typeof n?n.split(" "):[n];
for(;
4>r;
r++){i[e+Zt[r]+t]=o[r]||o[r-2]||o[0]
}return i
}},Ut.test(e)||(x.cssHooks[e+t].set=on)
});
var cn=/%20/g,pn=/\[\]$/,fn=/\r?\n/g,dn=/^(?:submit|button|image|reset|file)$/i,hn=/^(?:input|select|textarea|keygen)/i;
x.fn.extend({serialize:function(){return x.param(this.serializeArray())
},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");
return e?x.makeArray(e):this
}).filter(function(){var e=this.type;
return this.name&&!x(this).is(":disabled")&&hn.test(this.nodeName)&&!dn.test(e)&&(this.checked||!Ct.test(e))
}).map(function(e,t){var n=x(this).val();
return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(fn,"\r\n")}
}):{name:t.name,value:n.replace(fn,"\r\n")}
}).get()
}}),x.param=function(e,n){var r,i=[],o=function(e,t){t=x.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)
};
if(n===t&&(n=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e)){x.each(e,function(){o(this.name,this.value)
})
}else{for(r in e){gn(r,e[r],n,o)
}}return i.join("&").replace(cn,"+")
};
function gn(e,t,n,r){var i;
if(x.isArray(t)){x.each(t,function(t,i){n||pn.test(e)?r(e,i):gn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)
})
}else{if(n||"object"!==x.type(t)){r(e,t)
}else{for(i in t){gn(e+"["+i+"]",t[i],n,r)
}}}}x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)
}
}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)
},bind:function(e,t,n){return this.on(e,null,t,n)
},unbind:function(e,t){return this.off(e,null,t)
},delegate:function(e,t,n,r){return this.on(t,e,n,r)
},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)
}});
var mn,yn,vn=x.now(),bn=/\?/,xn=/#.*$/,wn=/([?&])_=[^&]*/,Tn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Cn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Nn=/^(?:GET|HEAD)$/,kn=/^\/\//,En=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Sn=x.fn.load,An={},jn={},Dn="*/".concat("*");
try{yn=o.href
}catch(Ln){yn=a.createElement("a"),yn.href="",yn=yn.href
}mn=En.exec(yn.toLowerCase())||[];
function Hn(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");
var r,i=0,o=t.toLowerCase().match(T)||[];
if(x.isFunction(n)){while(r=o[i++]){"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)
}}}
}function qn(e,n,r,i){var o={},a=e===jn;
function s(l){var u;
return o[l]=!0,x.each(e[l]||[],function(e,l){var c=l(n,r,i);
return"string"!=typeof c||a||o[c]?a?!(u=c):t:(n.dataTypes.unshift(c),s(c),!1)
}),u
}return s(n.dataTypes[0])||!o["*"]&&s("*")
}function _n(e,n){var r,i,o=x.ajaxSettings.flatOptions||{};
for(i in n){n[i]!==t&&((o[i]?e:r||(r={}))[i]=n[i])
}return r&&x.extend(!0,e,r),e
}x.fn.load=function(e,n,r){if("string"!=typeof e&&Sn){return Sn.apply(this,arguments)
}var i,o,a,s=this,l=e.indexOf(" ");
return l>=0&&(i=e.slice(l,e.length),e=e.slice(0,l)),x.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(a="POST"),s.length>0&&x.ajax({url:e,type:a,dataType:"html",data:n}).done(function(e){o=arguments,s.html(i?x("<div>").append(x.parseHTML(e)).find(i):e)
}).complete(r&&function(e,t){s.each(r,o||[e.responseText,t,e])
}),this
},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)
}
}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:yn,type:"GET",isLocal:Cn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Dn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?_n(_n(e,x.ajaxSettings),t):_n(x.ajaxSettings,e)
},ajaxPrefilter:Hn(An),ajaxTransport:Hn(jn),ajax:function(e,n){"object"==typeof e&&(n=e,e=t),n=n||{};
var r,i,o,a,s,l,u,c,p=x.ajaxSetup({},n),f=p.context||p,d=p.context&&(f.nodeType||f.jquery)?x(f):x.event,h=x.Deferred(),g=x.Callbacks("once memory"),m=p.statusCode||{},y={},v={},b=0,w="canceled",C={readyState:0,getResponseHeader:function(e){var t;
if(2===b){if(!c){c={};
while(t=Tn.exec(a)){c[t[1].toLowerCase()]=t[2]
}}t=c[e.toLowerCase()]
}return null==t?null:t
},getAllResponseHeaders:function(){return 2===b?a:null
},setRequestHeader:function(e,t){var n=e.toLowerCase();
return b||(e=v[n]=v[n]||e,y[e]=t),this
},overrideMimeType:function(e){return b||(p.mimeType=e),this
},statusCode:function(e){var t;
if(e){if(2>b){for(t in e){m[t]=[m[t],e[t]]
}}else{C.always(e[C.status])
}}return this
},abort:function(e){var t=e||w;
return u&&u.abort(t),k(0,t),this
}};
if(h.promise(C).complete=g.add,C.success=C.done,C.error=C.fail,p.url=((e||p.url||yn)+"").replace(xn,"").replace(kn,mn[1]+"//"),p.type=n.method||n.type||p.method||p.type,p.dataTypes=x.trim(p.dataType||"*").toLowerCase().match(T)||[""],null==p.crossDomain&&(r=En.exec(p.url.toLowerCase()),p.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(mn[3]||("http:"===mn[1]?"80":"443")))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=x.param(p.data,p.traditional)),qn(An,p,n,C),2===b){return C
}l=p.global,l&&0===x.active++&&x.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!Nn.test(p.type),o=p.url,p.hasContent||(p.data&&(o=p.url+=(bn.test(o)?"&":"?")+p.data,delete p.data),p.cache===!1&&(p.url=wn.test(o)?o.replace(wn,"$1_="+vn++):o+(bn.test(o)?"&":"?")+"_="+vn++)),p.ifModified&&(x.lastModified[o]&&C.setRequestHeader("If-Modified-Since",x.lastModified[o]),x.etag[o]&&C.setRequestHeader("If-None-Match",x.etag[o])),(p.data&&p.hasContent&&p.contentType!==!1||n.contentType)&&C.setRequestHeader("Content-Type",p.contentType),C.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+Dn+"; q=0.01":""):p.accepts["*"]);
for(i in p.headers){C.setRequestHeader(i,p.headers[i])
}if(p.beforeSend&&(p.beforeSend.call(f,C,p)===!1||2===b)){return C.abort()
}w="abort";
for(i in {success:1,error:1,complete:1}){C[i](p[i])
}if(u=qn(jn,p,n,C)){C.readyState=1,l&&d.trigger("ajaxSend",[C,p]),p.async&&p.timeout>0&&(s=setTimeout(function(){C.abort("timeout")
},p.timeout));
try{b=1,u.send(y,k)
}catch(N){if(!(2>b)){throw N
}k(-1,N)
}}else{k(-1,"No Transport")
}function k(e,n,r,i){var c,y,v,w,T,N=n;
2!==b&&(b=2,s&&clearTimeout(s),u=t,a=i||"",C.readyState=e>0?4:0,c=e>=200&&300>e||304===e,r&&(w=Mn(p,C,r)),w=On(p,w,C,c),c?(p.ifModified&&(T=C.getResponseHeader("Last-Modified"),T&&(x.lastModified[o]=T),T=C.getResponseHeader("etag"),T&&(x.etag[o]=T)),204===e||"HEAD"===p.type?N="nocontent":304===e?N="notmodified":(N=w.state,y=w.data,v=w.error,c=!v)):(v=N,(e||!N)&&(N="error",0>e&&(e=0))),C.status=e,C.statusText=(n||N)+"",c?h.resolveWith(f,[y,N,C]):h.rejectWith(f,[C,N,v]),C.statusCode(m),m=t,l&&d.trigger(c?"ajaxSuccess":"ajaxError",[C,p,c?y:v]),g.fireWith(f,[C,N]),l&&(d.trigger("ajaxComplete",[C,p]),--x.active||x.event.trigger("ajaxStop")))
}return C
},getJSON:function(e,t,n){return x.get(e,t,n,"json")
},getScript:function(e,n){return x.get(e,t,n,"script")
}}),x.each(["get","post"],function(e,n){x[n]=function(e,r,i,o){return x.isFunction(r)&&(o=o||i,i=r,r=t),x.ajax({url:e,type:n,dataType:o,data:r,success:i})
}
});
function Mn(e,n,r){var i,o,a,s,l=e.contents,u=e.dataTypes;
while("*"===u[0]){u.shift(),o===t&&(o=e.mimeType||n.getResponseHeader("Content-Type"))
}if(o){for(s in l){if(l[s]&&l[s].test(o)){u.unshift(s);
break
}}}if(u[0] in r){a=u[0]
}else{for(s in r){if(!u[0]||e.converters[s+" "+u[0]]){a=s;
break
}i||(i=s)
}a=a||i
}return a?(a!==u[0]&&u.unshift(a),r[a]):t
}function On(e,t,n,r){var i,o,a,s,l,u={},c=e.dataTypes.slice();
if(c[1]){for(a in e.converters){u[a.toLowerCase()]=e.converters[a]
}}o=c.shift();
while(o){if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=o,o=c.shift()){if("*"===o){o=l
}else{if("*"!==l&&l!==o){if(a=u[l+" "+o]||u["* "+o],!a){for(i in u){if(s=i.split(" "),s[1]===o&&(a=u[l+" "+s[0]]||u["* "+s[0]])){a===!0?a=u[i]:u[i]!==!0&&(o=s[0],c.unshift(s[1]));
break
}}}if(a!==!0){if(a&&e["throws"]){t=a(t)
}else{try{t=a(t)
}catch(p){return{state:"parsererror",error:a?p:"No conversion from "+l+" to "+o}
}}}}}}}return{state:"success",data:t}
}x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e
}}}),x.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)
}),x.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=a.head||x("head")[0]||a.documentElement;
return{send:function(t,i){n=a.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))
},r.insertBefore(n,r.firstChild)
},abort:function(){n&&n.onload(t,!0)
}}
}});
var Fn=[],Bn=/(=)\?(?=&|$)|\?\?/;
x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Fn.pop()||x.expando+"_"+vn++;
return this[e]=!0,e
}}),x.ajaxPrefilter("json jsonp",function(n,r,i){var o,a,s,l=n.jsonp!==!1&&(Bn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bn.test(n.data)&&"data");
return l||"jsonp"===n.dataTypes[0]?(o=n.jsonpCallback=x.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,l?n[l]=n[l].replace(Bn,"$1"+o):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+o),n.converters["script json"]=function(){return s||x.error(o+" was not called"),s[0]
},n.dataTypes[0]="json",a=e[o],e[o]=function(){s=arguments
},i.always(function(){e[o]=a,n[o]&&(n.jsonpCallback=r.jsonpCallback,Fn.push(o)),s&&x.isFunction(a)&&a(s[0]),s=a=t
}),"script"):t
});
var Pn,Rn,Wn=0,$n=e.ActiveXObject&&function(){var e;
for(e in Pn){Pn[e](t,!0)
}};
function In(){try{return new e.XMLHttpRequest
}catch(t){}}function zn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")
}catch(t){}}x.ajaxSettings.xhr=e.ActiveXObject?function(){return !this.isLocal&&In()||zn()
}:In,Rn=x.ajaxSettings.xhr(),x.support.cors=!!Rn&&"withCredentials" in Rn,Rn=x.support.ajax=!!Rn,Rn&&x.ajaxTransport(function(n){if(!n.crossDomain||x.support.cors){var r;
return{send:function(i,o){var a,s,l=n.xhr();
if(n.username?l.open(n.type,n.url,n.async,n.username,n.password):l.open(n.type,n.url,n.async),n.xhrFields){for(s in n.xhrFields){l[s]=n.xhrFields[s]
}}n.mimeType&&l.overrideMimeType&&l.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");
try{for(s in i){l.setRequestHeader(s,i[s])
}}catch(u){}l.send(n.hasContent&&n.data||null),r=function(e,i){var s,u,c,p;
try{if(r&&(i||4===l.readyState)){if(r=t,a&&(l.onreadystatechange=x.noop,$n&&delete Pn[a]),i){4!==l.readyState&&l.abort()
}else{p={},s=l.status,u=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(p.text=l.responseText);
try{c=l.statusText
}catch(f){c=""
}s||!n.isLocal||n.crossDomain?1223===s&&(s=204):s=p.text?200:404
}}}catch(d){i||o(-1,d)
}p&&o(s,c,p,u)
},n.async?4===l.readyState?setTimeout(r):(a=++Wn,$n&&(Pn||(Pn={},x(e).unload($n)),Pn[a]=r),l.onreadystatechange=r):r()
},abort:function(){r&&r(t,!0)
}}
}});
var Xn,Un,Vn=/^(?:toggle|show|hide)$/,Yn=RegExp("^(?:([+-])=|)("+w+")([a-z%]*)$","i"),Jn=/queueHooks$/,Gn=[nr],Qn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Yn.exec(t),o=i&&i[3]||(x.cssNumber[e]?"":"px"),a=(x.cssNumber[e]||"px"!==o&&+r)&&Yn.exec(x.css(n.elem,e)),s=1,l=20;
if(a&&a[3]!==o){o=o||a[3],i=i||[],a=+r||1;
do{s=s||".5",a/=s,x.style(n.elem,e,a+o)
}while(s!==(s=n.cur()/r)&&1!==s&&--l)
}return i&&(a=n.start=+a||+r||0,n.unit=o,n.end=i[1]?a+(i[1]+1)*i[2]:+i[2]),n
}]};
function Kn(){return setTimeout(function(){Xn=t
}),Xn=x.now()
}function Zn(e,t,n){var r,i=(Qn[t]||[]).concat(Qn["*"]),o=0,a=i.length;
for(;
a>o;
o++){if(r=i[o].call(n,t,e)){return r
}}}function er(e,t,n){var r,i,o=0,a=Gn.length,s=x.Deferred().always(function(){delete l.elem
}),l=function(){if(i){return !1
}var t=Xn||Kn(),n=Math.max(0,u.startTime+u.duration-t),r=n/u.duration||0,o=1-r,a=0,l=u.tweens.length;
for(;
l>a;
a++){u.tweens[a].run(o)
}return s.notifyWith(e,[u,o,n]),1>o&&l?n:(s.resolveWith(e,[u]),!1)
},u=s.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Kn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);
return u.tweens.push(r),r
},stop:function(t){var n=0,r=t?u.tweens.length:0;
if(i){return this
}for(i=!0;
r>n;
n++){u.tweens[n].run(1)
}return t?s.resolveWith(e,[u,t]):s.rejectWith(e,[u,t]),this
}}),c=u.props;
for(tr(c,u.opts.specialEasing);
a>o;
o++){if(r=Gn[o].call(u,e,c,u.opts)){return r
}}return x.map(c,Zn,u),x.isFunction(u.opts.start)&&u.opts.start.call(e,u),x.fx.timer(x.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)
}function tr(e,t){var n,r,i,o,a;
for(n in e){if(r=x.camelCase(n),i=t[r],o=e[n],x.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),a=x.cssHooks[r],a&&"expand" in a){o=a.expand(o),delete e[r];
for(n in o){n in e||(e[n]=o[n],t[n]=i)
}}else{t[r]=i
}}}x.Animation=x.extend(er,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");
var n,r=0,i=e.length;
for(;
i>r;
r++){n=e[r],Qn[n]=Qn[n]||[],Qn[n].unshift(t)
}},prefilter:function(e,t){t?Gn.unshift(e):Gn.push(e)
}});
function nr(e,t,n){var r,i,o,a,s,l,u=this,c={},p=e.style,f=e.nodeType&&nn(e),d=x._data(e,"fxshow");
n.queue||(s=x._queueHooks(e,"fx"),null==s.unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()
}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,x.queue(e,"fx").length||s.empty.fire()
})
})),1===e.nodeType&&("height" in t||"width" in t)&&(n.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(x.support.inlineBlockNeedsLayout&&"inline"!==ln(e.nodeName)?p.zoom=1:p.display="inline-block")),n.overflow&&(p.overflow="hidden",x.support.shrinkWrapBlocks||u.always(function(){p.overflow=n.overflow[0],p.overflowX=n.overflow[1],p.overflowY=n.overflow[2]
}));
for(r in t){if(i=t[r],Vn.exec(i)){if(delete t[r],o=o||"toggle"===i,i===(f?"hide":"show")){continue
}c[r]=d&&d[r]||x.style(e,r)
}}if(!x.isEmptyObject(c)){d?"hidden" in d&&(f=d.hidden):d=x._data(e,"fxshow",{}),o&&(d.hidden=!f),f?x(e).show():u.done(function(){x(e).hide()
}),u.done(function(){var t;
x._removeData(e,"fxshow");
for(t in c){x.style(e,t,c[t])
}});
for(r in c){a=Zn(f?d[r]:0,r,u),r in d||(d[r]=a.start,f&&(a.end=a.start,a.start="width"===r||"height"===r?1:0))
}}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)
}x.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(x.cssNumber[n]?"":"px")
},cur:function(){var e=rr.propHooks[this.prop];
return e&&e.get?e.get(this):rr.propHooks._default.get(this)
},run:function(e){var t,n=rr.propHooks[this.prop];
return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this
}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;
return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]
},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now
}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)
}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];
x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)
}
}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)
},animate:function(e,t,n,r){var i=x.isEmptyObject(e),o=x.speed(t,n,r),a=function(){var t=er(this,x.extend({},e),o);
(i||x._data(this,"finish"))&&t.stop(!0)
};
return a.finish=a,i||o.queue===!1?this.each(a):this.queue(o.queue,a)
},stop:function(e,n,r){var i=function(e){var t=e.stop;
delete e.stop,t(r)
};
return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",o=x.timers,a=x._data(this);
if(n){a[n]&&a[n].stop&&i(a[n])
}else{for(n in a){a[n]&&a[n].stop&&Jn.test(n)&&i(a[n])
}}for(n=o.length;
n--;
){o[n].elem!==this||null!=e&&o[n].queue!==e||(o[n].anim.stop(r),t=!1,o.splice(n,1))
}(t||!r)&&x.dequeue(this,e)
})
},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=x._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],o=x.timers,a=r?r.length:0;
for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=o.length;
t--;
){o[t].elem===this&&o[t].queue===e&&(o[t].anim.stop(!0),o.splice(t,1))
}for(t=0;
a>t;
t++){r[t]&&r[t].finish&&r[t].finish.call(this)
}delete n.finish
})
}});
function ir(e,t){var n,r={height:e},i=0;
for(t=t?1:0;
4>i;
i+=2-t){n=Zt[i],r["margin"+n]=r["padding"+n]=e
}return t&&(r.opacity=r.width=e),r
}x.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)
}
}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};
return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)
},r
},x.easing={linear:function(e){return e
},swing:function(e){return 0.5-Math.cos(e*Math.PI)/2
}},x.timers=[],x.fx=rr.prototype.init,x.fx.tick=function(){var e,n=x.timers,r=0;
for(Xn=x.now();
n.length>r;
r++){e=n[r],e()||n[r]!==e||n.splice(r--,1)
}n.length||x.fx.stop(),Xn=t
},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()
},x.fx.interval=13,x.fx.start=function(){Un||(Un=setInterval(x.fx.tick,x.fx.interval))
},x.fx.stop=function(){clearInterval(Un),Un=null
},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem
}).length
}),x.fn.offset=function(e){if(arguments.length){return e===t?this:this.each(function(t){x.offset.setOffset(this,e,t)
})
}var n,r,o={top:0,left:0},a=this[0],s=a&&a.ownerDocument;
if(s){return n=s.documentElement,x.contains(n,a)?(typeof a.getBoundingClientRect!==i&&(o=a.getBoundingClientRect()),r=or(s),{top:o.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:o.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):o
}},x.offset={setOffset:function(e,t,n){var r=x.css(e,"position");
"static"===r&&(e.style.position="relative");
var i=x(e),o=i.offset(),a=x.css(e,"top"),s=x.css(e,"left"),l=("absolute"===r||"fixed"===r)&&x.inArray("auto",[a,s])>-1,u={},c={},p,f;
l?(c=i.position(),p=c.top,f=c.left):(p=parseFloat(a)||0,f=parseFloat(s)||0),x.isFunction(t)&&(t=t.call(e,n,o)),null!=t.top&&(u.top=t.top-o.top+p),null!=t.left&&(u.left=t.left-o.left+f),"using" in t?t.using.call(e,u):i.css(u)
}},x.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];
return"fixed"===x.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(n=e.offset()),n.top+=x.css(e[0],"borderTopWidth",!0),n.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-x.css(r,"marginTop",!0),left:t.left-n.left-x.css(r,"marginLeft",!0)}
}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;
while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position")){e=e.offsetParent
}return e||s
})
}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);
x.fn[e]=function(i){return x.access(this,function(e,i,o){var a=or(e);
return o===t?a?n in a?a[n]:a.document.documentElement[i]:e[i]:(a?a.scrollTo(r?x(a).scrollLeft():o,r?o:x(a).scrollTop()):e[i]=o,t)
},e,i,arguments.length,null)
}
});
function or(e){return x.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1
}x.each({Height:"height",Width:"width"},function(e,n){x.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){x.fn[i]=function(i,o){var a=arguments.length&&(r||"boolean"!=typeof i),s=r||(i===!0||o===!0?"margin":"border");
return x.access(this,function(n,r,i){var o;
return x.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(o=n.documentElement,Math.max(n.body["scroll"+e],o["scroll"+e],n.body["offset"+e],o["offset"+e],o["client"+e])):i===t?x.css(n,r,s):x.style(n,r,i,s)
},n,a?i:t,a,null)
}
})
}),x.fn.size=function(){return this.length
},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:(e.jQuery=e.$=x,"function"==typeof define&&define.amd&&define("jquery",[],function(){return x
}))
})(window);
!function(d){var c=function(f){this.messages={defaultMessage:"This value seems to be invalid.",type:{email:"This value should be a valid email.",url:"This value should be a valid url.",urlstrict:"This value should be a valid url.",number:"This value should be a valid number.",digits:"This value should be digits.",dateIso:"This value should be a valid date (YYYY-MM-DD).",alphanum:"This value should be alphanumeric.",phone:"This value should be a valid phone number."},notnull:"This value should not be null.",notblank:"This value should not be blank.",required:"This value is required.",regexp:"This value seems to be invalid.",min:"This value should be greater than or equal to %s.",max:"This value should be lower than or equal to %s.",range:"This value should be between %s and %s.",minlength:"This value is too short. It should have %s characters or more.",maxlength:"This value is too long. It should have %s characters or less.",rangelength:"This value length is invalid. It should be between %s and %s characters long.",mincheck:"You must select at least %s choices.",maxcheck:"You must select %s choices or less.",rangecheck:"You must select between %s and %s choices.",equalto:"This value should be the same."},this.init(f)
};
c.prototype={constructor:c,validators:{notnull:function(f){return f.length>0
},notblank:function(f){return"string"===typeof f&&""!==f.replace(/^\s+/g,"").replace(/\s+$/g,"")
},required:function(g){if("object"===typeof g){for(var f in g){if(this.required(g[f])){return true
}}return false
}return this.notnull(g)&&this.notblank(g)
},type:function(h,g){var f;
switch(g){case"number":f=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;
break;
case"digits":f=/^\d+$/;
break;
case"alphanum":f=/^\w+$/;
break;
case"email":f=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))){2,6}$/i;
break;
case"url":h=new RegExp("(https?|s?ftp|git)","i").test(h)?h:"http://"+h;
case"urlstrict":f=/^(https?|s?ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;
break;
case"dateIso":f=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;
break;
case"phone":f=/^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$/;
break;
default:return false
}return""!==h?f.test(h):false
},regexp:function(h,g,f){return new RegExp(g,f.options.regexpFlag||"").test(h)
},minlength:function(g,f){return g.length>=f
},maxlength:function(g,f){return g.length<=f
},rangelength:function(g,f){return this.minlength(g,f[0])&&this.maxlength(g,f[1])
},min:function(g,f){return Number(g)>=f
},max:function(g,f){return Number(g)<=f
},range:function(g,f){return g>=f[0]&&g<=f[1]
},equalto:function(h,g,f){f.options.validateIfUnchanged=true;
return h===d(g).val()
},remote:function(h,f,m){var n=null,i={},k={};
i[m.$element.attr("name")]=h;
if("undefined"!==typeof m.options.remoteDatatype){k={dataType:m.options.remoteDatatype}
}var g=function(p,o){if("undefined"!==typeof o&&"undefined"!==typeof m.Validator.messages.remote&&o!==m.Validator.messages.remote){d(m.ulError+" .remote").remove()
}m.updtConstraint({name:"remote",valid:p},o);
m.manageValidationResult()
};
var j=function(o){if("object"===typeof o){return o
}try{o=d.parseJSON(o)
}catch(p){}return o
};
var l=function(o){return"object"===typeof o&&null!==o?("undefined"!==typeof o.error?o.error:("undefined"!==typeof o.message?o.message:null)):null
};
d.ajax(d.extend({},{url:f,data:i,type:m.options.remoteMethod||"GET",success:function(o){o=j(o);
g(1===o||true===o||("object"===typeof o&&null!==o&&"undefined"!==typeof o.success),l(o))
},error:function(o){o=j(o);
g(false,l(o))
}},k));
return n
},mincheck:function(f,g){return this.minlength(f,g)
},maxcheck:function(f,g){return this.maxlength(f,g)
},rangecheck:function(g,f){return this.rangelength(g,f)
}},init:function(f){var i=f.validators,h=f.messages;
var g;
for(g in i){this.addValidator(g,i[g])
}for(g in h){this.addMessage(g,h[g])
}},formatMesssage:function(h,f){if("object"===typeof f){for(var g in f){h=this.formatMesssage(h,f[g])
}return h
}return"string"===typeof h?h.replace(new RegExp("%s","i"),f):""
},addValidator:function(f,g){this.validators[f]=g
},addMessage:function(g,j,h){if("undefined"!==typeof h&&true===h){this.messages.type[g]=j;
return
}if("type"===g){for(var f in j){this.messages.type[f]=j[f]
}return
}this.messages[g]=j
}};
var b=function(g,f,h){this.options=f;
this.Validator=new c(f);
if(h==="ParsleyFieldMultiple"){return this
}this.init(g,h||"ParsleyField")
};
b.prototype={constructor:b,init:function(f,g){this.type=g;
this.valid=true;
this.element=f;
this.validatedOnce=false;
this.$element=d(f);
this.val=this.$element.val();
this.isRequired=false;
this.constraints={};
if("undefined"===typeof this.isRadioOrCheckbox){this.isRadioOrCheckbox=false;
this.hash=this.generateHash();
this.errorClassHandler=this.options.errors.classHandler(f,this.isRadioOrCheckbox)||this.$element
}this.ulErrorManagement();
this.bindHtml5Constraints();
this.addConstraints();
if(this.hasConstraints()){this.bindValidationEvents()
}},setParent:function(f){this.$parent=d(f)
},getParent:function(){return this.$parent
},bindHtml5Constraints:function(){if(this.$element.hasClass("required")||this.$element.prop("required")){this.options.required=true
}if("undefined"!==typeof this.$element.attr("type")&&new RegExp(this.$element.attr("type"),"i").test("email url number range")){this.options.type=this.$element.attr("type");
if(new RegExp(this.options.type,"i").test("number range")){this.options.type="number";
if("undefined"!==typeof this.$element.attr("min")&&this.$element.attr("min").length){this.options.min=this.$element.attr("min")
}if("undefined"!==typeof this.$element.attr("max")&&this.$element.attr("max").length){this.options.max=this.$element.attr("max")
}}}if("string"===typeof this.$element.attr("pattern")&&this.$element.attr("pattern").length){this.options.regexp=this.$element.attr("pattern")
}},addConstraints:function(){for(var g in this.options){var f={};
f[g]=this.options[g];
this.addConstraint(f,true)
}},addConstraint:function(h,f){for(var g in h){g=g.toLowerCase();
if("function"===typeof this.Validator.validators[g]){this.constraints[g]={name:g,requirements:h[g],valid:null};
if(g==="required"){this.isRequired=true
}this.addCustomConstraintMessage(g)
}}if("undefined"===typeof f){this.bindValidationEvents()
}},updateConstraint:function(h,g){for(var f in h){this.updtConstraint({name:f,requirements:h[f],valid:null},g)
}},updtConstraint:function(g,f){this.constraints[g.name]=d.extend(true,this.constraints[g.name],g);
if("string"===typeof f){this.Validator.messages[g.name]=f
}this.bindValidationEvents()
},removeConstraint:function(f){var f=f.toLowerCase();
delete this.constraints[f];
if(f==="required"){this.isRequired=false
}if(!this.hasConstraints()){if("ParsleyForm"===typeof this.getParent()){this.getParent().removeItem(this.$element);
return
}this.destroy();
return
}this.bindValidationEvents()
},addCustomConstraintMessage:function(g){var f=g+("type"===g&&"undefined"!==typeof this.options[g]?this.options[g].charAt(0).toUpperCase()+this.options[g].substr(1):"")+"Message";
if("undefined"!==typeof this.options[f]){this.Validator.addMessage("type"===g?this.options[g]:g,this.options[f],"type"===g)
}},bindValidationEvents:function(){this.valid=null;
this.$element.addClass("parsley-validated");
this.$element.off("."+this.type);
if(this.options.remote&&!new RegExp("change","i").test(this.options.trigger)){this.options.trigger=!this.options.trigger?"change":" change"
}var f=(!this.options.trigger?"":this.options.trigger)+(new RegExp("key","i").test(this.options.trigger)?"":" keyup");
if(this.$element.is("select")){f+=new RegExp("change","i").test(f)?"":" change"
}f=f.replace(/^\s+/g,"").replace(/\s+$/g,"");
this.$element.on((f+" ").split(" ").join("."+this.type+" "),false,d.proxy(this.eventValidation,this))
},generateHash:function(){return"parsley-"+(Math.random()+"").substring(2)
},getHash:function(){return this.hash
},getVal:function(){return this.$element.data("value")||this.$element.val()
},eventValidation:function(f){var g=this.getVal();
if(f.type==="keyup"&&!/keyup/i.test(this.options.trigger)&&!this.validatedOnce){return true
}if(f.type==="change"&&!/change/i.test(this.options.trigger)&&!this.validatedOnce){return true
}if(!this.isRadioOrCheckbox&&this.getLength(g)<this.options.validationMinlength&&!this.validatedOnce){return true
}this.validate()
},getLength:function(f){if(!f||!f.hasOwnProperty("length")){return 0
}return f.length
},isValid:function(){return this.validate(false)
},hasConstraints:function(){for(var f in this.constraints){return true
}return false
},validate:function(f){var h=this.getVal(),g=null;
if(!this.hasConstraints()){return null
}if(this.options.listeners.onFieldValidate(this.element,this)||(""===h&&!this.isRequired)){this.reset();
return null
}if(!this.needsValidation(h)){return this.valid
}g=this.applyValidators();
if("undefined"!==typeof f?f:this.options.showErrors){this.manageValidationResult()
}return g
},needsValidation:function(f){if(!this.options.validateIfUnchanged&&this.valid!==null&&this.val===f&&this.validatedOnce){return false
}this.val=f;
return this.validatedOnce=true
},applyValidators:function(){var g=null;
for(var h in this.constraints){var f=this.Validator.validators[this.constraints[h].name](this.val,this.constraints[h].requirements,this);
if(false===f){g=false;
this.constraints[h].valid=g
}else{if(true===f){this.constraints[h].valid=true;
g=false!==g
}}}if(false===g){this.options.listeners.onFieldError(this.element,this.constraints,this)
}else{if(true===g&&false===this.options.listeners.onFieldSuccess(this.element,this.constraints,this)){g=false
}}return g
},manageValidationResult:function(){var f=null;
for(var g in this.constraints){if(false===this.constraints[g].valid){this.manageError(this.constraints[g]);
f=false
}else{if(true===this.constraints[g].valid){this.removeError(this.constraints[g].name);
f=false!==f
}}}this.valid=f;
if(true===this.valid){this.removeErrors();
this.errorClassHandler.removeClass(this.options.errorClass).addClass(this.options.successClass);
return true
}else{if(false===this.valid){this.errorClassHandler.removeClass(this.options.successClass).addClass(this.options.errorClass);
return false
}}if(this.ulError&&d(this.ulError).children().length===0){this.removeErrors()
}return f
},ulErrorManagement:function(){this.ulError="#"+this.hash;
this.ulTemplate=d(this.options.errors.errorsWrapper).attr("id",this.hash).addClass("parsley-error-list")
},removeError:function(f){var g=this.ulError+" ."+f,h=this;
this.options.animate?d(g).fadeOut(this.options.animateDuration,function(){d(this).remove();
if(h.ulError&&d(h.ulError).children().length===0){h.removeErrors()
}}):d(g).remove()
},addError:function(g){for(var h in g){var f=d(this.options.errors.errorElem).addClass(h);
d(this.ulError).append(this.options.animate?d(f).html(g[h]).hide().fadeIn(this.options.animateDuration):d(f).html(g[h]))
}},removeErrors:function(){this.options.animate?d(this.ulError).fadeOut(this.options.animateDuration,function(){d(this).remove()
}):d(this.ulError).remove()
},reset:function(){this.valid=null;
this.removeErrors();
this.validatedOnce=false;
this.errorClassHandler.removeClass(this.options.successClass).removeClass(this.options.errorClass);
for(var f in this.constraints){this.constraints[f].valid=null
}return this
},manageError:function(j){if(!d(this.ulError).length){this.manageErrorContainer()
}if("required"===j.name&&null!==this.getVal()&&this.getVal().length>0){return
}else{if(this.isRequired&&"required"!==j.name&&(null===this.getVal()||0===this.getVal().length)){this.removeError(j.name);
return
}}var f=j.name,i=false!==this.options.errorMessage?"custom-error-message":f,g={},h=false!==this.options.errorMessage?this.options.errorMessage:(j.name==="type"?this.Validator.messages[f][j.requirements]:("undefined"===typeof this.Validator.messages[f]?this.Validator.messages.defaultMessage:this.Validator.formatMesssage(this.Validator.messages[f],j.requirements)));
if(!d(this.ulError+" ."+i).length){g[i]=h;
this.addError(g)
}},manageErrorContainer:function(){var f=this.options.errorContainer||this.options.errors.container(this.element,this.isRadioOrCheckbox),g=this.options.animate?this.ulTemplate.show():this.ulTemplate;
if("undefined"!==typeof f){d(f).append(g);
return
}!this.isRadioOrCheckbox?this.$element.after(g):this.$element.parent().after(g)
},addListener:function(f){for(var g in f){this.options.listeners[g]=f[g]
}},destroy:function(){this.$element.removeClass("parsley-validated");
this.reset().$element.off("."+this.type).removeData(this.type)
}};
var e=function(g,f,h){this.initMultiple(g,f);
this.inherit(g,f);
this.Validator=new c(f);
this.init(g,h||"ParsleyFieldMultiple")
};
e.prototype={constructor:e,initMultiple:function(g,f){this.element=g;
this.$element=d(g);
this.group=f.group||false;
this.hash=this.getName();
this.siblings=this.group?'[data-group="'+this.group+'"]':'input[name="'+this.$element.attr("name")+'"]';
this.isRadioOrCheckbox=true;
this.isRadio=this.$element.is("input[type=radio]");
this.isCheckbox=this.$element.is("input[type=checkbox]");
this.errorClassHandler=f.errors.classHandler(g,this.isRadioOrCheckbox)||this.$element.parent()
},inherit:function(g,f){var i=new b(g,f,"ParsleyFieldMultiple");
for(var h in i){if("undefined"===typeof this[h]){this[h]=i[h]
}}},getName:function(){if(this.group){return"parsley-"+this.group
}if("undefined"===typeof this.$element.attr("name")){throw"A radio / checkbox input must have a data-group attribute or a name to be Parsley validated !"
}return"parsley-"+this.$element.attr("name").replace(/(:|\.|\[|\])/g,"")
},getVal:function(){if(this.isRadio){return d(this.siblings+":checked").val()||""
}if(this.isCheckbox){var f=[];
d(this.siblings+":checked").each(function(){f.push(d(this).val())
});
return f
}},bindValidationEvents:function(){this.valid=null;
this.$element.addClass("parsley-validated");
this.$element.off("."+this.type);
var f=this,g=(!this.options.trigger?"":this.options.trigger)+(new RegExp("change","i").test(this.options.trigger)?"":" change");
g=g.replace(/^\s+/g,"").replace(/\s+$/g,"");
d(this.siblings).each(function(){d(this).on(g.split(" ").join("."+f.type+" "),false,d.proxy(f.eventValidation,f))
})
}};
var a=function(g,f,h){this.init(g,f,h||"parsleyForm")
};
a.prototype={constructor:a,init:function(h,g,i){this.type=i;
this.items=[];
this.$element=d(h);
this.options=g;
var f=this;
this.$element.find(g.inputs).each(function(){f.addItem(this)
});
this.$element.on("submit."+this.type,false,d.proxy(this.validate,this))
},addListener:function(f){for(var h in f){if(new RegExp("Field").test(h)){for(var g=0;
g<this.items.length;
g++){this.items[g].addListener(f)
}}else{this.options.listeners[h]=f[h]
}}},addItem:function(g){if(d(g).is(this.options.excluded)){return false
}var f=d(g).parsley(this.options);
f.setParent(this);
this.items.push(f)
},removeItem:function(h){var f=d(h).parsley();
for(var g=0;
g<this.items.length;
g++){if(this.items[g].hash===f.hash){this.items[g].destroy();
this.items.splice(g,1);
return true
}}return false
},validate:function(i){var h=true;
this.focusedField=false;
for(var g=0;
g<this.items.length;
g++){if("undefined"!==typeof this.items[g]&&false===this.items[g].validate()){h=false;
if(!this.focusedField&&"first"===this.options.focus||"last"===this.options.focus){this.focusedField=this.items[g].$element
}}}if(this.focusedField&&!h){if(this.options.scrollDuration>0){var f=this,k=this.focusedField.offset().top-d(window).height()/2;
d("html, body").animate({scrollTop:k},this.options.scrollDuration,function(){f.focusedField.focus()
})
}else{this.focusedField.focus()
}}var j=this.options.listeners.onFormSubmit(h,i,this);
if("undefined"!==typeof j){return j
}return h
},isValid:function(){for(var f=0;
f<this.items.length;
f++){if(false===this.items[f].isValid()){return false
}}return true
},removeErrors:function(){for(var f=0;
f<this.items.length;
f++){this.items[f].parsley("reset")
}},destroy:function(){for(var f=0;
f<this.items.length;
f++){this.items[f].destroy()
}this.$element.off("."+this.type).removeData(this.type)
},reset:function(){for(var f=0;
f<this.items.length;
f++){this.items[f].reset()
}}};
d.fn.parsley=function(i,h){var f=d.extend(true,{},d.fn.parsley.defaults,"undefined"!==typeof window.ParsleyConfig?window.ParsleyConfig:{},i,this.data()),g=null;
function j(l,m){var n=d(l).data(m);
if(!n){switch(m){case"parsleyForm":n=new a(l,f,"parsleyForm");
break;
case"parsleyField":n=new b(l,f,"parsleyField");
break;
case"parsleyFieldMultiple":n=new e(l,f,"parsleyFieldMultiple");
break;
default:return
}d(l).data(m,n)
}if("string"===typeof i&&"function"===typeof n[i]){var k=n[i](h);
return"undefined"!==typeof k?k:d(l)
}return n
}if(d(this).is("form")||true===d(this).data("bind")){g=j(d(this),"parsleyForm")
}else{if(d(this).is(f.inputs)&&!d(this).is(f.excluded)){g=j(d(this),!d(this).is("input[type=radio], input[type=checkbox]")?"parsleyField":"parsleyFieldMultiple")
}}return"function"===typeof h?h():g
};
d.fn.parsley.Constructor=a;
d.fn.parsley.defaults={inputs:"input, textarea, select",excluded:"input[type=hidden], input[type=file], :disabled",trigger:false,animate:true,animateDuration:300,scrollDuration:500,focus:"first",validationMinlength:3,successClass:"parsley-success",errorClass:"parsley-error",errorMessage:false,validators:{},showErrors:true,messages:{},validateIfUnchanged:false,errors:{classHandler:function(g,f){},container:function(g,f){},errorsWrapper:"<ul></ul>",errorElem:"<li></li>"},listeners:{onFieldValidate:function(g,f){return false
},onFormSubmit:function(h,g,f){},onFieldError:function(g,h,f){},onFieldSuccess:function(g,h,f){}}};
d(window).on("load",function(){d('[data-validate="parsley"]').each(function(){d(this).parsley()
})
})
}(window.jQuery||window.Zepto);
/*! Hammer.JS - v1.0.5 - 2013-04-07
 * http://eightmedia.github.com/hammer.js
 *
 * Copyright (c) 2013 Jorik Tangelder <j.tangelder@gmail.com>;
 * Licensed under the MIT license */
(function(b,f){function h(){if(!a.READY){a.event.determineEventTypes();
for(var e in a.gestures){a.gestures.hasOwnProperty(e)&&a.detection.register(a.gestures[e])
}a.event.onTouch(a.DOCUMENT,a.EVENT_MOVE,a.detection.detect),a.event.onTouch(a.DOCUMENT,a.EVENT_END,a.detection.detect),a.READY=!0
}}var a=function(i,j){return new a.Instance(i,j||{})
};
a.defaults={stop_browser_behavior:{userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},a.HAS_POINTEREVENTS=navigator.pointerEnabled||navigator.msPointerEnabled,a.HAS_TOUCHEVENTS="ontouchstart" in b,a.MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,a.NO_MOUSEEVENTS=a.HAS_TOUCHEVENTS&&navigator.userAgent.match(a.MOBILE_REGEX),a.EVENT_TYPES={},a.DIRECTION_DOWN="down",a.DIRECTION_LEFT="left",a.DIRECTION_UP="up",a.DIRECTION_RIGHT="right",a.POINTER_MOUSE="mouse",a.POINTER_TOUCH="touch",a.POINTER_PEN="pen",a.EVENT_START="start",a.EVENT_MOVE="move",a.EVENT_END="end",a.DOCUMENT=document,a.plugins={},a.READY=!1,a.Instance=function(i,k){var j=this;
return h(),this.element=i,this.enabled=!0,this.options=a.utils.extend(a.utils.extend({},a.defaults),k||{}),this.options.stop_browser_behavior&&a.utils.stopDefaultBrowserBehavior(this.element,this.options.stop_browser_behavior),a.event.onTouch(i,a.EVENT_START,function(e){j.enabled&&a.detection.startDetect(j,e)
}),this
},a.Instance.prototype={on:function(k,l){for(var m=k.split(" "),j=0;
m.length>j;
j++){this.element.addEventListener(m[j],l,!1)
}return this
},off:function(k,l){for(var m=k.split(" "),j=0;
m.length>j;
j++){this.element.removeEventListener(m[j],l,!1)
}return this
},trigger:function(i,k){var l=a.DOCUMENT.createEvent("Event");
l.initEvent(i,!0,!0),l.gesture=k;
var j=this.element;
return a.utils.hasParent(k.target,j)&&(j=k.target),j.dispatchEvent(l),this
},enable:function(e){return this.enabled=e,this
}};
var d=null,g=!1,c=!1;
a.event={bindDom:function(k,m,o){for(var j=m.split(" "),l=0;
j.length>l;
l++){k.addEventListener(j[l],o,!1)
}},onTouch:function(j,k,l){var i=this;
this.bindDom(j,a.EVENT_TYPES[k],function(n){var e=n.type.toLowerCase();
if(!e.match(/mouse/)||!c){(e.match(/touch/)||e.match(/pointerdown/)||e.match(/mouse/)&&1===n.which)&&(g=!0),e.match(/touch|pointer/)&&(c=!0);
var m=0;
g&&(a.HAS_POINTEREVENTS&&k!=a.EVENT_END?m=a.PointerEvent.updatePointer(k,n):e.match(/touch/)?m=n.touches.length:c||(m=e.match(/up/)?0:1),m>0&&k==a.EVENT_END?k=a.EVENT_MOVE:m||(k=a.EVENT_END),m||null===d?d=n:n=d,l.call(a.detection,i.collectEventData(j,k,n)),a.HAS_POINTEREVENTS&&k==a.EVENT_END&&(m=a.PointerEvent.updatePointer(k,n))),m||(d=null,g=!1,c=!1,a.PointerEvent.reset())
}})
},determineEventTypes:function(){var e;
e=a.HAS_POINTEREVENTS?a.PointerEvent.getEvents():a.NO_MOUSEEVENTS?["touchstart","touchmove","touchend touchcancel"]:["touchstart mousedown","touchmove mousemove","touchend touchcancel mouseup"],a.EVENT_TYPES[a.EVENT_START]=e[0],a.EVENT_TYPES[a.EVENT_MOVE]=e[1],a.EVENT_TYPES[a.EVENT_END]=e[2]
},getTouchList:function(e){return a.HAS_POINTEREVENTS?a.PointerEvent.getTouchList():e.touches?e.touches:[{identifier:1,pageX:e.pageX,pageY:e.pageY,target:e.target}]
},collectEventData:function(i,k,m){var j=this.getTouchList(m,k),l=a.POINTER_TOUCH;
return(m.type.match(/mouse/)||a.PointerEvent.matchType(a.POINTER_MOUSE,m))&&(l=a.POINTER_MOUSE),{center:a.utils.getCenter(j),timeStamp:(new Date).getTime(),target:m.target,touches:j,eventType:k,pointerType:l,srcEvent:m,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault&&this.srcEvent.preventDefault()
},stopPropagation:function(){this.srcEvent.stopPropagation()
},stopDetect:function(){return a.detection.stopDetect()
}}
}},a.PointerEvent={pointers:{},getTouchList:function(){var i=this,j=[];
return Object.keys(i.pointers).sort().forEach(function(e){j.push(i.pointers[e])
}),j
},updatePointer:function(i,j){return i==a.EVENT_END?this.pointers={}:(j.identifier=j.pointerId,this.pointers[j.pointerId]=j),Object.keys(this.pointers).length
},matchType:function(i,j){if(!j.pointerType){return !1
}var k={};
return k[a.POINTER_MOUSE]=j.pointerType==j.MSPOINTER_TYPE_MOUSE||j.pointerType==a.POINTER_MOUSE,k[a.POINTER_TOUCH]=j.pointerType==j.MSPOINTER_TYPE_TOUCH||j.pointerType==a.POINTER_TOUCH,k[a.POINTER_PEN]=j.pointerType==j.MSPOINTER_TYPE_PEN||j.pointerType==a.POINTER_PEN,k[i]
},getEvents:function(){return["pointerdown MSPointerDown","pointermove MSPointerMove","pointerup pointercancel MSPointerUp MSPointerCancel"]
},reset:function(){this.pointers={}
}},a.utils={extend:function(j,l,e){for(var k in l){j[k]!==f&&e||(j[k]=l[k])
}return j
},hasParent:function(i,j){for(;
i;
){if(i==j){return !0
}i=i.parentNode
}return !1
},getCenter:function(k){for(var m=[],o=[],j=0,l=k.length;
l>j;
j++){m.push(k[j].pageX),o.push(k[j].pageY)
}return{pageX:(Math.min.apply(Math,m)+Math.max.apply(Math,m))/2,pageY:(Math.min.apply(Math,o)+Math.max.apply(Math,o))/2}
},getVelocity:function(i,j,k){return{x:Math.abs(j/i)||0,y:Math.abs(k/i)||0}
},getAngle:function(k,l){var m=l.pageY-k.pageY,j=l.pageX-k.pageX;
return 180*Math.atan2(m,j)/Math.PI
},getDirection:function(i,k){var l=Math.abs(i.pageX-k.pageX),j=Math.abs(i.pageY-k.pageY);
return l>=j?i.pageX-k.pageX>0?a.DIRECTION_LEFT:a.DIRECTION_RIGHT:i.pageY-k.pageY>0?a.DIRECTION_UP:a.DIRECTION_DOWN
},getDistance:function(k,l){var m=l.pageX-k.pageX,j=l.pageY-k.pageY;
return Math.sqrt(m*m+j*j)
},getScale:function(i,j){return i.length>=2&&j.length>=2?this.getDistance(j[0],j[1])/this.getDistance(i[0],i[1]):1
},getRotation:function(i,j){return i.length>=2&&j.length>=2?this.getAngle(j[1],j[0])-this.getAngle(i[1],i[0]):0
},isVertical:function(e){return e==a.DIRECTION_UP||e==a.DIRECTION_DOWN
},stopDefaultBrowserBehavior:function(k,m){var q,j=["webkit","khtml","moz","ms","o",""];
if(m&&k.style){for(var l=0;
j.length>l;
l++){for(var p in m){m.hasOwnProperty(p)&&(q=p,j[l]&&(q=j[l]+q.substring(0,1).toUpperCase()+q.substring(1)),k.style[q]=m[p])
}}"none"==m.userSelect&&(k.onselectstart=function(){return !1
})
}}},a.detection={gestures:[],current:null,previous:null,stopped:!1,startDetect:function(i,j){this.current||(this.stopped=!1,this.current={inst:i,startEvent:a.utils.extend({},j),lastEvent:!1,name:""},this.detect(j))
},detect:function(i){if(this.current&&!this.stopped){i=this.extendEventData(i);
for(var k=this.current.inst.options,m=0,j=this.gestures.length;
j>m;
m++){var l=this.gestures[m];
if(!this.stopped&&k[l.name]!==!1&&l.handler.call(l,i,this.current.inst)===!1){this.stopDetect();
break
}}return this.current&&(this.current.lastEvent=i),i.eventType==a.EVENT_END&&!i.touches.length-1&&this.stopDetect(),i
}},stopDetect:function(){this.previous=a.utils.extend({},this.current),this.current=null,this.stopped=!0
},extendEventData:function(j){var m=this.current.startEvent;
if(m&&(j.touches.length!=m.touches.length||j.touches===m.touches)){m.touches=[];
for(var u=0,l=j.touches.length;
l>u;
u++){m.touches.push(a.utils.extend({},j.touches[u]))
}}var p=j.timeStamp-m.timeStamp,k=j.center.pageX-m.center.pageX,i=j.center.pageY-m.center.pageY,q=a.utils.getVelocity(p,k,i);
return a.utils.extend(j,{deltaTime:p,deltaX:k,deltaY:i,velocityX:q.x,velocityY:q.y,distance:a.utils.getDistance(m.center,j.center),angle:a.utils.getAngle(m.center,j.center),direction:a.utils.getDirection(m.center,j.center),scale:a.utils.getScale(m.touches,j.touches),rotation:a.utils.getRotation(m.touches,j.touches),startEvent:m}),j
},register:function(e){var i=e.defaults||{};
return i[e.name]===f&&(i[e.name]=!0),a.utils.extend(a.defaults,i,!0),e.index=e.index||1000,this.gestures.push(e),this.gestures.sort(function(j,k){return j.index<k.index?-1:j.index>k.index?1:0
}),this.gestures
}},a.gestures=a.gestures||{},a.gestures.Hold={name:"hold",index:10,defaults:{hold_timeout:500,hold_threshold:1},timer:null,handler:function(i,j){switch(i.eventType){case a.EVENT_START:clearTimeout(this.timer),a.detection.current.name=this.name,this.timer=setTimeout(function(){"hold"==a.detection.current.name&&j.trigger("hold",i)
},j.options.hold_timeout);
break;
case a.EVENT_MOVE:i.distance>j.options.hold_threshold&&clearTimeout(this.timer);
break;
case a.EVENT_END:clearTimeout(this.timer)
}}},a.gestures.Tap={name:"tap",index:100,defaults:{tap_max_touchtime:250,tap_max_distance:10,tap_always:!0,doubletap_distance:20,doubletap_interval:300},handler:function(i,k){if(i.eventType==a.EVENT_END){var l=a.detection.previous,j=!1;
if(i.deltaTime>k.options.tap_max_touchtime||i.distance>k.options.tap_max_distance){return
}l&&"tap"==l.name&&i.timeStamp-l.lastEvent.timeStamp<k.options.doubletap_interval&&i.distance<k.options.doubletap_distance&&(k.trigger("doubletap",i),j=!0),(!j||k.options.tap_always)&&(a.detection.current.name="tap",k.trigger(a.detection.current.name,i))
}}},a.gestures.Swipe={name:"swipe",index:40,defaults:{swipe_max_touches:1,swipe_velocity:0.7},handler:function(i,j){if(i.eventType==a.EVENT_END){if(j.options.swipe_max_touches>0&&i.touches.length>j.options.swipe_max_touches){return
}(i.velocityX>j.options.swipe_velocity||i.velocityY>j.options.swipe_velocity)&&(j.trigger(this.name,i),j.trigger(this.name+i.direction,i))
}}},a.gestures.Drag={name:"drag",index:50,defaults:{drag_min_distance:10,drag_max_touches:1,drag_block_horizontal:!1,drag_block_vertical:!1,drag_lock_to_axis:!1,drag_lock_min_distance:25},triggered:!1,handler:function(e,j){if(a.detection.current.name!=this.name&&this.triggered){return j.trigger(this.name+"end",e),this.triggered=!1,f
}if(!(j.options.drag_max_touches>0&&e.touches.length>j.options.drag_max_touches)){switch(e.eventType){case a.EVENT_START:this.triggered=!1;
break;
case a.EVENT_MOVE:if(e.distance<j.options.drag_min_distance&&a.detection.current.name!=this.name){return
}a.detection.current.name=this.name,(a.detection.current.lastEvent.drag_locked_to_axis||j.options.drag_lock_to_axis&&j.options.drag_lock_min_distance<=e.distance)&&(e.drag_locked_to_axis=!0);
var i=a.detection.current.lastEvent.direction;
e.drag_locked_to_axis&&i!==e.direction&&(e.direction=a.utils.isVertical(i)?0>e.deltaY?a.DIRECTION_UP:a.DIRECTION_DOWN:0>e.deltaX?a.DIRECTION_LEFT:a.DIRECTION_RIGHT),this.triggered||(j.trigger(this.name+"start",e),this.triggered=!0),j.trigger(this.name,e),j.trigger(this.name+e.direction,e),(j.options.drag_block_vertical&&a.utils.isVertical(e.direction)||j.options.drag_block_horizontal&&!a.utils.isVertical(e.direction))&&e.preventDefault();
break;
case a.EVENT_END:this.triggered&&j.trigger(this.name+"end",e),this.triggered=!1
}}}},a.gestures.Transform={name:"transform",index:45,defaults:{transform_min_scale:0.01,transform_min_rotation:1,transform_always_block:!1},triggered:!1,handler:function(e,k){if(a.detection.current.name!=this.name&&this.triggered){return k.trigger(this.name+"end",e),this.triggered=!1,f
}if(!(2>e.touches.length)){switch(k.options.transform_always_block&&e.preventDefault(),e.eventType){case a.EVENT_START:this.triggered=!1;
break;
case a.EVENT_MOVE:var i=Math.abs(1-e.scale),j=Math.abs(e.rotation);
if(k.options.transform_min_scale>i&&k.options.transform_min_rotation>j){return
}a.detection.current.name=this.name,this.triggered||(k.trigger(this.name+"start",e),this.triggered=!0),k.trigger(this.name,e),j>k.options.transform_min_rotation&&k.trigger("rotate",e),i>k.options.transform_min_scale&&(k.trigger("pinch",e),k.trigger("pinch"+(1>e.scale?"in":"out"),e));
break;
case a.EVENT_END:this.triggered&&k.trigger(this.name+"end",e),this.triggered=!1
}}}},a.gestures.Touch={name:"touch",index:-1/0,defaults:{prevent_default:!1,prevent_mouseevents:!1},handler:function(e,i){return i.options.prevent_mouseevents&&e.pointerType==a.POINTER_MOUSE?(e.stopDetect(),f):(i.options.prevent_default&&e.preventDefault(),e.eventType==a.EVENT_START&&i.trigger(this.name,e),f)
}},a.gestures.Release={name:"release",index:1/0,handler:function(i,j){i.eventType==a.EVENT_END&&j.trigger(this.name,i)
}},"object"==typeof module&&"object"==typeof module.exports?module.exports=a:(b.Hammer=a,"function"==typeof b.define&&b.define.amd&&b.define("hammer",[],function(){return a
}))
})(this),function(a,b){a!==b&&(Hammer.event.bindDom=function(e,c,d){a(e).on(c,function(f){var g=f.originalEvent||f;
g.pageX===b&&(g.pageX=f.pageX,g.pageY=f.pageY),g.target||(g.target=f.target),g.which===b&&(g.which=g.button),g.preventDefault||(g.preventDefault=f.preventDefault),g.stopPropagation||(g.stopPropagation=f.stopPropagation),d.call(this,g)
})
},Hammer.Instance.prototype.on=function(c,d){return a(this.element).on(c,d)
},Hammer.Instance.prototype.off=function(c,d){return a(this.element).off(c,d)
},Hammer.Instance.prototype.trigger=function(d,f){var c=a(this.element);
return c.has(f.target).length&&(c=a(f.target)),c.trigger({type:d,gesture:f})
},a.fn.hammer=function(c){return this.each(function(){var e=a(this),d=e.data("hammer");
d?d&&c&&Hammer.utils.extend(d.options,c):e.data("hammer",new Hammer(this,c||{}))
})
})
}(window.jQuery||window.Zepto);
(function(d){var b=d.event,a,c;
a=b.special.debouncedresize={setup:function(){d(this).on("resize",a.handler)
},teardown:function(){d(this).off("resize",a.handler)
},handler:function(i,e){var h=this,g=arguments,f=function(){i.type="debouncedresize";
b.dispatch.apply(h,g)
};
if(c){clearTimeout(c)
}e?f():c=setTimeout(f,a.threshold)
},threshold:150}
})(jQuery);
(function(d){var c=d.event,a,e={_:0},f=0,g,b;
a=c.special.throttledresize={setup:function(){d(this).on("resize",a.handler)
},teardown:function(){d(this).off("resize",a.handler)
},handler:function(k,h){var j=this,i=arguments;
g=true;
if(!b){setInterval(function(){f++;
if(f>a.threshold&&g||h){k.type="throttledresize";
c.dispatch.apply(j,i);
g=false;
f=0
}if(f>9){d(e).stop();
b=false;
f=0
}},30);
b=true
}},threshold:0}
})(jQuery);
(function(){var aN;
var a8=0;
var aY={};
var m=+new Date+"";
var bJ=/<%=([\s\S]+?)%>/g;
var ak=/($^)/;
var bZ=/['\n\r\t\u2028\u2029\\]/g;
var be="[object Arguments]",aS="[object Array]",H="[object Boolean]",bp="[object Date]",a="[object Function]",bm="[object Number]",ap="[object Object]",aE="[object RegExp]",bg="[object String]";
var bS={"boolean":false,"function":true,object:true,number:false,string:false,"undefined":false};
var bu={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"};
var bR=(bS[typeof window]&&window)||this;
var aT=bS[typeof exports]&&exports&&!exports.nodeType&&exports;
var b=bS[typeof module]&&module&&!module.nodeType&&module;
var O=b&&b.exports===aT&&aT;
var P=bS[typeof global]&&global;
if(P&&(P.global===P||P.window===P)){bR=P
}function br(b9,b8,b6){var b5=(b6||0)-1,b7=b9?b9.length:0;
while(++b5<b7){if(b9[b5]===b8){return b5
}}return -1
}function aV(b7,b6){var ca=b7.criteria,cc=b6.criteria,b8=-1,b9=ca.length;
while(++b8<b9){var cb=ca[b8],b5=cc[b8];
if(cb!==b5){if(cb>b5||typeof cb=="undefined"){return 1
}if(cb<b5||typeof b5=="undefined"){return -1
}}}return b7.index-b6.index
}function bW(b5){return"\\"+bu[b5]
}function M(ca,b9,b6){b9||(b9=0);
if(typeof b6=="undefined"){b6=ca?ca.length:0
}var b7=-1,b8=b6-b9||0,b5=Array(b8<0?0:b8);
while(++b7<b8){b5[b7]=ca[b9+b7]
}return b5
}var ba=[];
var bG=Object.prototype;
var bP=bR._;
var w=bG.toString;
var a3=RegExp("^"+String(w).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$");
var Q=Math.ceil,bI=Math.floor,S=bG.hasOwnProperty,t=ba.push,k=bG.propertyIsEnumerable;
var r=a6(r=Object.create)&&r,ag=a6(ag=Array.isArray)&&ag,E=bR.isFinite,aF=bR.isNaN,bk=a6(bk=Object.keys)&&bk,bl=Math.max,j=Math.min,aK=Math.random;
function L(b5){return(b5 instanceof L)?b5:new bK(b5)
}function bK(b6,b5){this.__chain__=!!b5;
this.__wrapped__=b6
}bK.prototype=L.prototype;
var B={};
(function(){var b5={"0":1,length:1};
B.spliceObjects=(ba.splice.call(b5,0,1),!b5[0])
}(1));
L.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:bJ,variable:""};
function o(b9){var b8=b9[0],b6=b9[2],b5=b9[4];
function b7(){if(b6){var cc=M(b6);
t.apply(cc,arguments)
}if(this instanceof b7){var cb=a2(b8.prototype),ca=b8.apply(cb,cc||arguments);
return b3(ca)?ca:cb
}return b8.apply(b5,cc||arguments)
}return b7
}function a2(b5,b6){return b3(b5)?r(b5):{}
}if(!r){a2=(function(){function b5(){}return function(b7){if(b3(b7)){b5.prototype=b7;
var b6=new b5;
b5.prototype=null
}return b6||bR.Object()
}
}())
}function bt(b6,b5,b7){if(typeof b6!="function"){return aj
}if(typeof b5=="undefined"||!("prototype" in b6)){return b6
}switch(b7){case 1:return function(b8){return b6.call(b5,b8)
};
case 2:return function(b9,b8){return b6.call(b5,b9,b8)
};
case 3:return function(b9,b8,ca){return b6.call(b5,b9,b8,ca)
};
case 4:return function(b8,ca,b9,cb){return b6.call(b5,b8,ca,b9,cb)
}
}return a1(b6,b5)
}function am(b8){var ca=b8[0],b7=b8[1],cc=b8[2],b6=b8[3],cf=b8[4],b5=b8[5];
var b9=b7&1,ch=b7&2,ce=b7&4,cd=b7&8,cg=ca;
function cb(){var cj=b9?cf:this;
if(cc){var ck=M(cc);
t.apply(ck,arguments)
}if(b6||ce){ck||(ck=M(arguments));
if(b6){t.apply(ck,b6)
}if(ce&&ck.length<b5){b7|=16&~32;
return am([ca,(cd?b7:b7&~3),ck,null,cf,b5])
}}ck||(ck=arguments);
if(ch){ca=cj[cg]
}if(this instanceof cb){cj=a2(ca.prototype);
var ci=ca.apply(cj,ck);
return b3(ci)?ci:cj
}return ca.apply(cj,ck)
}return cb
}function b2(cb,b6){var b7=-1,b8=a7(),b9=cb?cb.length:0,b5=[];
while(++b7<b9){var ca=cb[b7];
if(b8(b6,ca)<0){b5.push(ca)
}}return b5
}function aW(b8,ca,b6,cb){var b7=(cb||0)-1,b5=b8?b8.length:0,cf=[];
while(++b7<b5){var cc=b8[b7];
if(cc&&typeof cc=="object"&&typeof cc.length=="number"&&(aD(cc)||X(cc))){if(!ca){cc=aW(cc,ca,b6)
}var ce=-1,b9=cc.length,cd=cf.length;
cf.length+=b9;
while(++ce<b9){cf[cd++]=cc[ce]
}}else{if(!b6){cf.push(cc)
}}}return cf
}function ae(cf,cd,b8,b7){if(cf===cd){return cf!==0||(1/cf==1/cd)
}var cb=typeof cf,cg=typeof cd;
if(cf===cf&&!(cf&&bS[cb])&&!(cd&&bS[cg])){return false
}if(cf==null||cd==null){return cf===cd
}var ca=w.call(cf),ch=w.call(cd);
if(ca!=ch){return false
}switch(ca){case H:case bp:return +cf==+cd;
case bm:return cf!=+cf?cd!=+cd:(cf==0?(1/cf==1/cd):cf==+cd);
case aE:case bg:return cf==String(cd)
}var b9=ca==aS;
if(!b9){var b5=cf instanceof L,ci=cd instanceof L;
if(b5||ci){return ae(b5?cf.__wrapped__:cf,ci?cd.__wrapped__:cd,b8,b7)
}if(ca!=ap){return false
}var ce=cf.constructor,cc=cd.constructor;
if(ce!=cc&&!(u(ce)&&ce instanceof ce&&u(cc)&&cc instanceof cc)&&("constructor" in cf&&"constructor" in cd)){return false
}}b8||(b8=[]);
b7||(b7=[]);
var b6=b8.length;
while(b6--){if(b8[b6]==cf){return b7[b6]==cd
}}var ck=true,cj=0;
b8.push(cf);
b7.push(cd);
if(b9){cj=cd.length;
ck=cj==cf.length;
if(ck){while(cj--){if(!(ck=ae(cf[cj],cd[cj],b8,b7))){break
}}}}else{f(cd,function(cn,cm,cl){if(S.call(cl,cm)){cj++;
return !(ck=S.call(cf,cm)&&ae(cf[cm],cn,b8,b7))&&aY
}});
if(ck){f(cf,function(cn,cm,cl){if(S.call(cl,cm)){return !(ck=--cj>-1)&&aY
}})
}}b8.pop();
b7.pop();
return ck
}function n(b6,b5){return b6+bI(aK()*(b5-b6+1))
}function d(ca,b7,cd){var b9=-1,cb=a7(),b6=ca?ca.length:0,ce=[],b5=cd?[]:ce;
while(++b9<b6){var cc=ca[b9],b8=cd?cd(cc,b9,ca):cc;
if(b7?!b9||b5[b5.length-1]!==b8:cb(b5,b8)<0){if(cd){b5.push(b8)
}ce.push(cc)
}}return ce
}function aU(b5){return function(cb,cc,b7){var b6={};
cc=A(cc,b7,3);
var b8=-1,b9=cb?cb.length:0;
if(typeof b9=="number"){while(++b8<b9){var ca=cb[b8];
b5(b6,ca,cc(ca,b8,cb),cb)
}}else{aO(cb,function(ce,cd,cf){b5(b6,ce,cc(ce,cd,cf),cf)
})
}return b6
}
}function bH(ca,b8,cb,b7,cg,b5){var b9=b8&1,ch=b8&2,ce=b8&4,cd=b8&8,b6=b8&16,cc=b8&32;
if(!ch&&!u(ca)){throw new TypeError
}if(b6&&!cb.length){b8&=~16;
b6=cb=false
}if(cc&&!b7.length){b8&=~32;
cc=b7=false
}var cf=(b8==1||b8===17)?o:am;
return cf([ca,b8,cb,b7,cg,b5])
}function an(b5){return K[b5]
}function a7(){var b5=(b5=L.indexOf)===bX?br:b5;
return b5
}function a6(b5){return typeof b5=="function"&&a3.test(b5)
}function ao(b5){return aX[b5]
}function X(b5){return b5&&typeof b5=="object"&&typeof b5.length=="number"&&w.call(b5)==be||false
}if(!X(arguments)){X=function(b5){return b5&&typeof b5=="object"&&typeof b5.length=="number"&&S.call(b5,"callee")&&!k.call(b5,"callee")||false
}
}var aD=ag||function(b5){return b5&&typeof b5=="object"&&typeof b5.length=="number"&&w.call(b5)==aS||false
};
var af=function(b7){var b6,b8=b7,b5=[];
if(!b8){return b5
}if(!(bS[typeof b7])){return b5
}for(b6 in b8){if(S.call(b8,b6)){b5.push(b6)
}}return b5
};
var bc=!bk?af:function(b5){if(!b3(b5)){return[]
}return bk(b5)
};
var K={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"};
var aX=a9(K);
var bd=RegExp("("+bc(aX).join("|")+")","g"),bi=RegExp("["+bc(K).join("")+"]","g");
function at(b6){if(!b6){return b6
}for(var b5=1,b8=arguments.length;
b5<b8;
b5++){var b9=arguments[b5];
if(b9){for(var b7 in b9){b6[b7]=b9[b7]
}}}return b6
}function bB(b5){return b3(b5)?(aD(b5)?M(b5):at({},b5)):b5
}function au(b6){if(!b6){return b6
}for(var b5=1,b8=arguments.length;
b5<b8;
b5++){var b9=arguments[b5];
if(b9){for(var b7 in b9){if(typeof b6[b7]=="undefined"){b6[b7]=b9[b7]
}}}}return b6
}var f=function(b8,b9){var b6,b7=b8,b5=b7;
if(!b7){return b5
}if(!bS[typeof b7]){return b5
}for(b6 in b7){if(b9(b7[b6],b6,b8)===aY){return b5
}}return b5
};
var aO=function(b8,b9){var b6,b7=b8,b5=b7;
if(!b7){return b5
}if(!bS[typeof b7]){return b5
}for(b6 in b7){if(S.call(b7,b6)){if(b9(b7[b6],b6,b8)===aY){return b5
}}}return b5
};
function bF(b6){var b5=[];
f(b6,function(b8,b7){if(u(b8)){b5.push(b7)
}});
return b5.sort()
}function bQ(b5,b6){return b5?S.call(b5,b6):false
}function a9(b7){var b6=-1,b9=bc(b7),ca=b9.length,b5={};
while(++b6<ca){var b8=b9[b6];
b5[b7[b8]]=b8
}return b5
}function aI(b5){return b5===true||b5===false||b5&&typeof b5=="object"&&w.call(b5)==H||false
}function aa(b5){return b5&&typeof b5=="object"&&w.call(b5)==bp||false
}function a4(b5){return b5&&b5.nodeType===1||false
}function bs(b6){if(!b6){return true
}if(aD(b6)||by(b6)){return !b6.length
}for(var b5 in b6){if(S.call(b6,b5)){return false
}}return true
}function a5(b6,b5){return ae(b6,b5)
}function F(b5){return E(b5)&&!aF(parseFloat(b5))
}function u(b5){return typeof b5=="function"
}if(u(/x/)){u=function(b5){return typeof b5=="function"&&w.call(b5)==a
}
}function b3(b5){return !!(b5&&bS[typeof b5])
}function aQ(b5){return ar(b5)&&b5!=+b5
}function bV(b5){return b5===null
}function ar(b5){return typeof b5=="number"||b5&&typeof b5=="object"&&w.call(b5)==bm||false
}function bL(b5){return b5&&bS[typeof b5]&&w.call(b5)==aE||false
}function by(b5){return typeof b5=="string"||b5&&typeof b5=="object"&&w.call(b5)==bg||false
}function a0(b5){return typeof b5=="undefined"
}function bv(b7){var b9=[];
f(b7,function(cc,cb){b9.push(cb)
});
b9=b2(b9,aW(arguments,true,false,1));
var b6=-1,ca=b9.length,b5={};
while(++b6<ca){var b8=b9[b6];
b5[b8]=b7[b8]
}return b5
}function aA(b7){var b6=-1,b9=bc(b7),ca=b9.length,b5=Array(ca);
while(++b6<ca){var b8=b9[b6];
b5[b6]=[b8,b7[b8]]
}return b5
}function aL(b7){var b6=-1,b9=aW(arguments,true,false,1),ca=b9.length,b5={};
while(++b6<ca){var b8=b9[b6];
if(b8 in b7){b5[b8]=b7[b8]
}}return b5
}function ax(b7){var b6=-1,b8=bc(b7),b9=b8.length,b5=Array(b9);
while(++b6<b9){b5[b6]=b7[b8[b6]]
}return b5
}function W(b9,b8){var b6=a7(),b7=b9?b9.length:0,b5=false;
if(b7&&typeof b7=="number"){b5=b6(b9,b8)>-1
}else{aO(b9,function(ca){return(b5=ca===b8)&&aY
})
}return b5
}var aJ=aU(function(b5,b7,b6){(S.call(b5,b6)?b5[b6]++:b5[b6]=1)
});
function v(b9,ca,b6){var b5=true;
ca=A(ca,b6,3);
var b7=-1,b8=b9?b9.length:0;
if(typeof b8=="number"){while(++b7<b8){if(!(b5=!!ca(b9[b7],b7,b9))){break
}}}else{aO(b9,function(cc,cb,cd){return !(b5=!!ca(cc,cb,cd))&&aY
})
}return b5
}function aP(ca,cb,b6){var b5=[];
cb=A(cb,b6,3);
var b7=-1,b8=ca?ca.length:0;
if(typeof b8=="number"){while(++b7<b8){var b9=ca[b7];
if(cb(b9,b7,ca)){b5.push(b9)
}}}else{aO(ca,function(cd,cc,ce){if(cb(cd,cc,ce)){b5.push(cd)
}})
}return b5
}function aH(ca,cb,b6){cb=A(cb,b6,3);
var b7=-1,b8=ca?ca.length:0;
if(typeof b8=="number"){while(++b7<b8){var b9=ca[b7];
if(cb(b9,b7,ca)){return b9
}}}else{var b5;
aO(ca,function(cd,cc,ce){if(cb(cd,cc,ce)){b5=cd;
return aY
}});
return b5
}}function D(b5,b6){return g(b5,b6,true)
}function aC(b8,b9,b5){var b6=-1,b7=b8?b8.length:0;
b9=b9&&typeof b5=="undefined"?b9:bt(b9,b5,3);
if(typeof b7=="number"){while(++b6<b7){if(b9(b8[b6],b6,b8)===aY){break
}}}else{aO(b8,b9)
}}function p(b7,b8){var b6=b7?b7.length:0;
if(typeof b6=="number"){while(b6--){if(b8(b7[b6],b6,b7)===false){break
}}}else{var b5=bc(b7);
b6=b5.length;
aO(b7,function(ca,b9,cb){b9=b5?b5[--b6]:--b6;
return b8(cb[b9],b9,cb)===false&&aY
})
}}var aq=aU(function(b5,b7,b6){(S.call(b5,b6)?b5[b6]:b5[b6]=[]).push(b7)
});
var bY=aU(function(b5,b7,b6){b5[b6]=b7
});
function C(cb,b6){var b8=M(arguments,2),b7=-1,ca=typeof b6=="function",b9=cb?cb.length:0,b5=Array(typeof b9=="number"?b9:0);
aC(cb,function(cc){b5[++b7]=(ca?b6:cc[b6]).apply(cc,b8)
});
return b5
}function al(b9,ca,b6){var b7=-1,b8=b9?b9.length:0;
ca=A(ca,b6,3);
if(typeof b8=="number"){var b5=Array(b8);
while(++b7<b8){b5[b7]=ca(b9[b7],b7,b9)
}}else{b5=[];
aO(b9,function(cc,cb,cd){b5[++b7]=ca(cc,cb,cd)
})
}return b5
}function ai(cb,cc,b6){var b9=-Infinity,b5=b9;
if(typeof cc!="function"&&b6&&b6[cc]===cb){cc=null
}var b7=-1,b8=cb?cb.length:0;
if(cc==null&&typeof b8=="number"){while(++b7<b8){var ca=cb[b7];
if(ca>b5){b5=ca
}}}else{cc=A(cc,b6,3);
aC(cb,function(ce,cd,cg){var cf=cc(ce,cd,cg);
if(cf>b9){b9=cf;
b5=ce
}})
}return b5
}function bo(cb,cc,b6){var b9=Infinity,b5=b9;
if(typeof cc!="function"&&b6&&b6[cc]===cb){cc=null
}var b7=-1,b8=cb?cb.length:0;
if(cc==null&&typeof b8=="number"){while(++b7<b8){var ca=cb[b7];
if(ca<b5){b5=ca
}}}else{cc=A(cc,b6,3);
aC(cb,function(ce,cd,cg){var cf=cc(ce,cd,cg);
if(cf<b9){b9=cf;
b5=ce
}})
}return b5
}var b1=al;
function bq(ca,cb,b6,b5){if(!ca){return b6
}var b8=arguments.length<3;
cb=A(cb,b5,4);
var b7=-1,b9=ca.length;
if(typeof b9=="number"){if(b8){b6=ca[++b7]
}while(++b7<b9){b6=cb(b6,ca[b7],b7,ca)
}}else{aO(ca,function(cd,cc,ce){b6=b8?(b8=false,cd):cb(b6,cd,cc,ce)
})
}return b6
}function bN(b8,b9,b6,b5){var b7=arguments.length<3;
b9=A(b9,b5,4);
p(b8,function(cb,ca,cc){b6=b7?(b7=false,cb):b9(b6,cb,ca,cc)
});
return b6
}function x(b6,b7,b5){b7=A(b7,b5,3);
return aP(b6,function(b9,b8,ca){return !b7(b9,b8,ca)
})
}function bM(b7,b8,b6){if(b7&&typeof b7.length!="number"){b7=ax(b7)
}if(b8==null||b6){return b7?b7[n(0,b7.length-1)]:aN
}var b5=ay(b7);
b5.length=j(bl(0,b8),b5.length);
return b5
}function ay(b8){var b6=-1,b7=b8?b8.length:0,b5=Array(typeof b7=="number"?b7:0);
aC(b8,function(ca){var b9=n(0,++b6);
b5[b6]=b5[b9];
b5[b9]=ca
});
return b5
}function Z(b6){var b5=b6?b6.length:0;
return typeof b5=="number"?b5:bc(b6).length
}function Y(b9,ca,b6){var b5;
ca=A(ca,b6,3);
var b7=-1,b8=b9?b9.length:0;
if(typeof b8=="number"){while(++b7<b8){if((b5=ca(b9[b7],b7,b9))){break
}}}else{aO(b9,function(cc,cb,cd){return(b5=ca(cc,cb,cd))&&aY
})
}return !!b5
}function ab(b9,ca,b6){var b7=-1,b8=b9?b9.length:0,b5=Array(typeof b8=="number"?b8:0);
ca=A(ca,b6,3);
aC(b9,function(cc,cb,cd){b5[++b7]={criteria:[ca(cc,cb,cd)],index:b7,value:cc}
});
b8=b5.length;
b5.sort(aV);
while(b8--){b5[b8]=b5[b8].value
}return b5
}function z(b5){if(aD(b5)){return M(b5)
}if(b5&&typeof b5.length=="number"){return al(b5)
}return ax(b5)
}function g(b7,b5,b6){return(b6&&bs(b5))?aN:(b6?aH:aP)(b7,b5)
}function G(b9){var b6=-1,b7=b9?b9.length:0,b5=[];
while(++b6<b7){var b8=b9[b6];
if(b8){b5.push(b8)
}}return b5
}function c(b5){return b2(b5,aW(arguments,true,true,1))
}function ah(ca,b9,b5){var b8=0,b7=ca?ca.length:0;
if(typeof b9!="number"&&b9!=null){var b6=-1;
b9=A(b9,b5,3);
while(++b6<b7&&b9(ca[b6],b6,ca)){b8++
}}else{b8=b9;
if(b8==null||b5){return ca?ca[0]:aN
}}return M(ca,0,j(bl(0,b8),b7))
}function bA(b6,b5){return aW(b6,b5)
}function bX(b9,b8,b6){if(typeof b6=="number"){var b7=b9?b9.length:0;
b6=(b6<0?bl(0,b7+b6):b6||0)
}else{if(b6){var b5=ac(b9,b8);
return b9[b5]===b8?b5:-1
}}return br(b9,b8,b6)
}function b0(ca,b9,b5){var b8=0,b7=ca?ca.length:0;
if(typeof b9!="number"&&b9!=null){var b6=b7;
b9=A(b9,b5,3);
while(b6--&&b9(ca[b6],b6,ca)){b8++
}}else{b8=(b9==null||b5)?1:b9||b8
}return M(ca,0,j(bl(0,b7-b8),b7))
}function bx(){var ca=[],b5=-1,b7=arguments.length;
while(++b5<b7){var cc=arguments[b5];
if(aD(cc)||X(cc)){ca.push(cc)
}}var b9=ca[0],b8=-1,cb=a7(),b6=b9?b9.length:0,cd=[];
outer:while(++b8<b6){cc=b9[b8];
if(cb(cd,cc)<0){var b5=b7;
while(--b5){if(cb(ca[b5],cc)<0){continue outer
}}cd.push(cc)
}}return cd
}function av(ca,b9,b5){var b8=0,b7=ca?ca.length:0;
if(typeof b9!="number"&&b9!=null){var b6=b7;
b9=A(b9,b5,3);
while(b6--&&b9(ca[b6],b6,ca)){b8++
}}else{b8=b9;
if(b8==null||b5){return ca?ca[b7-1]:aN
}}return M(ca,bl(0,b7-b8))
}function b4(b8,b7,b6){var b5=b8?b8.length:0;
if(typeof b6=="number"){b5=(b6<0?bl(0,b5+b6):j(b6,b5-1))+1
}while(b5--){if(b8[b5]===b7){return b5
}}return -1
}function R(ca,b6,b9){ca=+ca||0;
b9=(+b9||1);
if(b6==null){b6=ca;
ca=0
}var b7=-1,b8=bl(0,Q((b6-ca)/b9)),b5=Array(b8);
while(++b7<b8){b5[b7]=ca;
ca+=b9
}return b5
}function bb(ca,b9,b5){if(typeof b9!="number"&&b9!=null){var b8=0,b6=-1,b7=ca?ca.length:0;
b9=A(b9,b5,3);
while(++b6<b7&&b9(ca[b6],b6,ca)){b8++
}}else{b8=(b9==null||b5)?1:bl(0,b9)
}return M(ca,b8)
}function ac(cb,b9,ca,b6){var b5=0,b8=cb?cb.length:b5;
ca=ca?A(ca,b6,1):aj;
b9=ca(b9);
while(b5<b8){var b7=(b5+b8)>>>1;
(ca(cb[b7])<b9)?b5=b7+1:b8=b7
}return b5
}function q(){return d(aW(arguments,true,true))
}function aR(b8,b7,b6,b5){if(typeof b7!="boolean"&&b7!=null){b5=b6;
b6=(typeof b7!="function"&&b5&&b5[b7]===b8)?null:b7;
b7=false
}if(b6!=null){b6=A(b6,b5,3)
}return d(b8,b7,b6)
}function bU(b5){return b2(b5,M(arguments,1))
}function l(){var b6=-1,b7=ai(b1(arguments,"length")),b5=Array(b7<0?0:b7);
while(++b6<b7){b5[b6]=b1(arguments,b6)
}return b5
}function bC(ca,b6){var b7=-1,b9=ca?ca.length:0,b5={};
if(!b6&&b9&&!aD(ca[0])){b6=[]
}while(++b7<b9){var b8=ca[b7];
if(b6){b5[b8]=b6[b7]
}else{if(b8){b5[b8[0]]=b8[1]
}}}return b5
}function J(b6,b5){if(!u(b5)){throw new TypeError
}return function(){if(--b6<1){return b5.apply(this,arguments)
}}
}function a1(b6,b5){return arguments.length>2?bH(b6,17,M(arguments,2),null,b5):bH(b6,1,null,null,b5)
}function aw(b7){var b5=arguments.length>1?aW(arguments,true,false,1):bF(b7),b6=-1,b9=b5.length;
while(++b6<b9){var b8=b5[b6];
b7[b8]=bH(b7[b8],1,null,null,b7)
}return b7
}function bE(){var b5=arguments,b6=b5.length;
while(b6--){if(!u(b5[b6])){throw new TypeError
}}return function(){var b7=arguments,b8=b5.length;
while(b8--){b7=[b5[b8].apply(this,b7)]
}return b7[0]
}
}function bD(b8,cd,cj){var cf,cb,ck,b5,ch,ci,cg,cc=0,ca=false,ce=true;
if(!u(b8)){throw new TypeError
}cd=bl(0,cd)||0;
if(cj===true){var b7=true;
ce=false
}else{if(b3(cj)){b7=cj.leading;
ca="maxWait" in cj&&(bl(cd,cj.maxWait)||0);
ce="trailing" in cj?cj.trailing:ce
}}var b9=function(){var cm=cd-(bh()-b5);
if(cm<=0){if(cb){clearTimeout(cb)
}var cl=cg;
cb=ci=cg=aN;
if(cl){cc=bh();
ck=b8.apply(ch,cf);
if(!ci&&!cb){cf=ch=null
}}}else{ci=setTimeout(b9,cm)
}};
var b6=function(){if(ci){clearTimeout(ci)
}cb=ci=cg=aN;
if(ce||(ca!==cd)){cc=bh();
ck=b8.apply(ch,cf);
if(!ci&&!cb){cf=ch=null
}}};
return function(){cf=arguments;
b5=bh();
ch=this;
cg=ce&&(ci||!b7);
if(ca===false){var cl=b7&&!ci
}else{if(!cb&&!b7){cc=b5
}var cn=ca-(b5-cc),cm=cn<=0;
if(cm){if(cb){cb=clearTimeout(cb)
}cc=b5;
ck=b8.apply(ch,cf)
}else{if(!cb){cb=setTimeout(b6,cn)
}}}if(cm&&ci){ci=clearTimeout(ci)
}else{if(!ci&&cd!==ca){ci=setTimeout(b9,cd)
}}if(cl){cm=true;
ck=b8.apply(ch,cf)
}if(cm&&!ci&&!cb){cf=ch=null
}return ck
}
}function T(b6){if(!u(b6)){throw new TypeError
}var b5=M(arguments,1);
return setTimeout(function(){b6.apply(aN,b5)
},1)
}function aM(b6,b7){if(!u(b6)){throw new TypeError
}var b5=M(arguments,2);
return setTimeout(function(){b6.apply(aN,b5)
},b7)
}function V(b6,b7){var b5={};
return function(){var b8=b7?b7.apply(this,arguments):m+arguments[0];
return S.call(b5,b8)?b5[b8]:(b5[b8]=b6.apply(this,arguments))
}
}function bw(b7){var b6,b5;
if(!u(b7)){throw new TypeError
}return function(){if(b6){return b5
}b6=true;
b5=b7.apply(this,arguments);
b7=null;
return b5
}
}function bO(b5){return bH(b5,16,M(arguments,1))
}function bn(b6,b7,b5){var b9=true,b8=true;
if(!u(b6)){throw new TypeError
}if(b5===false){b9=false
}else{if(b3(b5)){b9="leading" in b5?b5.leading:b9;
b8="trailing" in b5?b5.trailing:b8
}}b5={};
b5.leading=b9;
b5.maxWait=b7;
b5.trailing=b8;
return bD(b6,b7,b5)
}function aZ(b5,b6){return bH(b6,16,[b5])
}function A(b8,b5,b9){var b7=typeof b8;
if(b8==null||b7=="function"){return bt(b8,b5,b9)
}if(b7!="object"){return U(b8)
}var b6=bc(b8);
return function(cb){var cc=b6.length,ca=false;
while(cc--){if(!(ca=cb[b6[cc]]===b8[b6[cc]])){break
}}return ca
}
}function ad(b5){return b5==null?"":String(b5).replace(bi,an)
}function aj(b5){return b5
}function y(b5){aC(bF(b5),function(b6){var b7=L[b6]=b5[b6];
L.prototype[b6]=function(){var b9=[this.__wrapped__];
t.apply(b9,arguments);
var b8=b7.apply(L,b9);
return this.__chain__?new bK(b8,true):b8
}
})
}function bT(){bR._=bP;
return this
}function e(){}var bh=a6(bh=Date.now)&&bh||function(){return new Date().getTime()
};
function U(b5){return function(b6){return b6[b5]
}
}function bf(b6,b5){if(b6==null&&b5==null){b5=1
}b6=+b6||0;
if(b5==null){b5=b6;
b6=0
}else{b5=+b5||0
}return b6+bI(aK()*(b5-b6+1))
}function I(b5,b6){if(b5){var b7=b5[b6];
return u(b7)?b5[b6]():b7
}}function aG(cc,b8,cf){var cb=L,b6=cb.templateSettings;
cc=String(cc||"");
cf=au({},cf,b6);
var b9=0,b5="__p += '",b7=cf.variable;
var ce=RegExp((cf.escape||ak).source+"|"+(cf.interpolate||ak).source+"|"+(cf.evaluate||ak).source+"|$","g");
cc.replace(ce,function(cg,cj,ch,ci,ck){b5+=cc.slice(b9,ck).replace(bZ,bW);
if(cj){b5+="' +\n_.escape("+cj+") +\n'"
}if(ci){b5+="';\n"+ci+";\n__p += '"
}if(ch){b5+="' +\n((__t = ("+ch+")) == null ? '' : __t) +\n'"
}b9=ck+cg.length;
return cg
});
b5+="';\n";
if(!b7){b7="obj";
b5="with ("+b7+" || {}) {\n"+b5+"\n}\n"
}b5="function("+b7+") {\nvar __t, __p = '', __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n"+b5+"return __p\n}";
try{var cd=Function("_","return "+b5)(cb)
}catch(ca){ca.source=b5;
throw ca
}if(b8){return cd(b8)
}cd.source=b5;
return cd
}function h(b9,b8,b6){b9=(b9=+b9)>-1?b9:0;
var b7=-1,b5=Array(b9);
b8=bt(b8,b6,1);
while(++b7<b9){b5[b7]=b8(b7)
}return b5
}function i(b5){return b5==null?"":String(b5).replace(bd,ao)
}function bj(b5){var b6=++a8+"";
return b5?b5+b6:b6
}function az(b5){b5=new bK(b5);
b5.__chain__=true;
return b5
}function bz(b5,b6){b6(b5);
return b5
}function aB(){this.__chain__=true;
return this
}function N(){return this.__wrapped__
}L.after=J;
L.bind=a1;
L.bindAll=aw;
L.chain=az;
L.compact=G;
L.compose=bE;
L.countBy=aJ;
L.debounce=bD;
L.defaults=au;
L.defer=T;
L.delay=aM;
L.difference=c;
L.filter=aP;
L.flatten=bA;
L.forEach=aC;
L.functions=bF;
L.groupBy=aq;
L.indexBy=bY;
L.initial=b0;
L.intersection=bx;
L.invert=a9;
L.invoke=C;
L.keys=bc;
L.map=al;
L.max=ai;
L.memoize=V;
L.min=bo;
L.omit=bv;
L.once=bw;
L.pairs=aA;
L.partial=bO;
L.pick=aL;
L.pluck=b1;
L.range=R;
L.reject=x;
L.rest=bb;
L.shuffle=ay;
L.sortBy=ab;
L.tap=bz;
L.throttle=bn;
L.times=h;
L.toArray=z;
L.union=q;
L.uniq=aR;
L.values=ax;
L.where=g;
L.without=bU;
L.wrap=aZ;
L.zip=l;
L.collect=al;
L.drop=bb;
L.each=aC;
L.extend=at;
L.methods=bF;
L.object=bC;
L.select=aP;
L.tail=bb;
L.unique=aR;
L.clone=bB;
L.contains=W;
L.escape=ad;
L.every=v;
L.find=aH;
L.has=bQ;
L.identity=aj;
L.indexOf=bX;
L.isArguments=X;
L.isArray=aD;
L.isBoolean=aI;
L.isDate=aa;
L.isElement=a4;
L.isEmpty=bs;
L.isEqual=a5;
L.isFinite=F;
L.isFunction=u;
L.isNaN=aQ;
L.isNull=bV;
L.isNumber=ar;
L.isObject=b3;
L.isRegExp=bL;
L.isString=by;
L.isUndefined=a0;
L.lastIndexOf=b4;
L.mixin=y;
L.noConflict=bT;
L.random=bf;
L.reduce=bq;
L.reduceRight=bN;
L.result=I;
L.size=Z;
L.some=Y;
L.sortedIndex=ac;
L.template=aG;
L.unescape=i;
L.uniqueId=bj;
L.all=v;
L.any=Y;
L.detect=aH;
L.findWhere=D;
L.foldl=bq;
L.foldr=bN;
L.include=W;
L.inject=bq;
L.first=ah;
L.last=av;
L.sample=bM;
L.take=ah;
L.head=ah;
y(L);
L.VERSION="2.4.1";
L.prototype.chain=aB;
L.prototype.value=N;
aC(["pop","push","reverse","shift","sort","splice","unshift"],function(b5){var b6=ba[b5];
L.prototype[b5]=function(){var b7=this.__wrapped__;
b6.apply(b7,arguments);
if(!B.spliceObjects&&b7.length===0){delete b7[0]
}return this
}
});
aC(["concat","join","slice"],function(b5){var b6=ba[b5];
L.prototype[b5]=function(){var b8=this.__wrapped__,b7=b6.apply(b8,arguments);
if(this.__chain__){b7=new bK(b7);
b7.__chain__=true
}return b7
}
});
if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){bR._=L;
define(function(){return L
})
}else{if(aT&&b){if(O){(b.exports=L)._=L
}else{aT._=L
}}else{bR._=L
}}}.call(this));
(function(z){var L,ar="2.4.0",Q=Math.round,U,t=0,e=1,aG=2,r=3,al=4,p=5,N=6,an={},ac=(typeof module!=="undefined"&&module.exports&&typeof require!=="undefined"),b=/^\/?Date\((\-?\d+)/i,aP=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,au=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,af=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,T=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,f=/\d\d?/,V=/\d{1,3}/,aO=/\d{3}/,aC=/\d{1,4}/,Y=/[+\-]?\d{1,6}/,aL=/\d+/,D=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,n=/Z|[\+\-]\d\d:?\d\d/i,j=/T/i,aD=/[\+\-]?\d+(\.\d{1,3})?/,az=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d:?\d\d|Z)?)?$/,O="YYYY-MM-DDTHH:mm:ssZ",aN=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],B=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],S=/([\+\-]|\d\d)/gi,aw="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),y={Milliseconds:1,Seconds:1000,Minutes:60000,Hours:3600000,Days:86400000,Months:2592000000,Years:31536000000},c={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},aK={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ab={},aF="DDD w W M D d".split(" "),ad="M D H h m s w W".split(" "),aH={M:function(){return this.month()+1
},MMM:function(i){return this.lang().monthsShort(this,i)
},MMMM:function(i){return this.lang().months(this,i)
},D:function(){return this.date()
},DDD:function(){return this.dayOfYear()
},d:function(){return this.day()
},dd:function(i){return this.lang().weekdaysMin(this,i)
},ddd:function(i){return this.lang().weekdaysShort(this,i)
},dddd:function(i){return this.lang().weekdays(this,i)
},w:function(){return this.week()
},W:function(){return this.isoWeek()
},YY:function(){return E(this.year()%100,2)
},YYYY:function(){return E(this.year(),4)
},YYYYY:function(){return E(this.year(),5)
},gg:function(){return E(this.weekYear()%100,2)
},gggg:function(){return this.weekYear()
},ggggg:function(){return E(this.weekYear(),5)
},GG:function(){return E(this.isoWeekYear()%100,2)
},GGGG:function(){return this.isoWeekYear()
},GGGGG:function(){return E(this.isoWeekYear(),5)
},e:function(){return this.weekday()
},E:function(){return this.isoWeekday()
},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),true)
},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),false)
},H:function(){return this.hours()
},h:function(){return this.hours()%12||12
},m:function(){return this.minutes()
},s:function(){return this.seconds()
},S:function(){return G(this.milliseconds()/100)
},SS:function(){return E(G(this.milliseconds()/10),2)
},SSS:function(){return E(this.milliseconds(),3)
},SSSS:function(){return E(this.milliseconds(),3)
},Z:function(){var aW=-this.zone(),i="+";
if(aW<0){aW=-aW;
i="-"
}return i+E(G(aW/60),2)+":"+E(G(aW)%60,2)
},ZZ:function(){var aW=-this.zone(),i="+";
if(aW<0){aW=-aW;
i="-"
}return i+E(G(10*aW/6),4)
},z:function(){return this.zoneAbbr()
},zz:function(){return this.zoneName()
},X:function(){return this.unix()
}},P=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];
function I(aW,i){return function(aX){return E(aW.call(this,aX),i)
}
}function g(i,aW){return function(aX){return this.lang().ordinal(i.call(this,aX),aW)
}
}while(aF.length){U=aF.pop();
aH[U+"o"]=g(aH[U],U)
}while(ad.length){U=ad.pop();
aH[U+U]=I(aH[U],2)
}aH.DDDD=I(aH.DDD,3);
function ax(){}function F(i){aT(i);
ap(this,i)
}function W(aY){var a1=l(aY),a0=a1.year||0,aW=a1.month||0,i=a1.week||0,a4=a1.day||0,a2=a1.hour||0,aZ=a1.minute||0,a3=a1.second||0,aX=a1.millisecond||0;
this._milliseconds=+aX+a3*1000+aZ*60000+a2*3600000;
this._days=+a4+i*7;
this._months=+aW+a0*12;
this._data={};
this._bubble()
}function ap(aX,aW){for(var aY in aW){if(aW.hasOwnProperty(aY)){aX[aY]=aW[aY]
}}if(aW.hasOwnProperty("toString")){aX.toString=aW.toString
}if(aW.hasOwnProperty("valueOf")){aX.valueOf=aW.valueOf
}return aX
}function k(i){if(i<0){return Math.ceil(i)
}else{return Math.floor(i)
}}function E(aX,aW){var i=aX+"";
while(i.length<aW){i="0"+i
}return i
}function A(aY,aX,a1,a0){var aW=aX._milliseconds,a3=aX._days,i=aX._months,aZ,a2;
if(aW){aY._d.setTime(+aY._d+aW*a1)
}if(a3||i){aZ=aY.minute();
a2=aY.hour()
}if(a3){aY.date(aY.date()+a3*a1)
}if(i){aY.month(aY.month()+i*a1)
}if(aW&&!a0){L.updateOffset(aY)
}if(a3||i){aY.minute(aZ);
aY.hour(a2)
}}function a(i){return Object.prototype.toString.call(i)==="[object Array]"
}function d(i){return Object.prototype.toString.call(i)==="[object Date]"||i instanceof Date
}function aE(a1,a0,aX){var aW=Math.min(a1.length,a0.length),aY=Math.abs(a1.length-a0.length),a2=0,aZ;
for(aZ=0;
aZ<aW;
aZ++){if((aX&&a1[aZ]!==a0[aZ])||(!aX&&G(a1[aZ])!==G(a0[aZ]))){a2++
}}return a2+aY
}function aJ(aW){if(aW){var i=aW.toLowerCase().replace(/(.)s$/,"$1");
aW=c[aW]||aK[i]||i
}return aW
}function l(aY){var aW={},i,aZ,aX;
for(aZ in aY){if(aY.hasOwnProperty(aZ)){i=aJ(aZ);
if(i){aW[i]=aY[aZ]
}}}return aW
}function ai(aW){var i,aX;
if(aW.indexOf("week")===0){i=7;
aX="day"
}else{if(aW.indexOf("month")===0){i=12;
aX="month"
}else{return
}}L[aW]=function(a2,aZ){var a1,aY,a3=L.fn._lang[aW],a0=[];
if(typeof a2==="number"){aZ=a2;
a2=z
}aY=function(a5){var a4=L().utc().set(aX,a5);
return a3.call(L.fn._lang,a4,a2||"")
};
if(aZ!=null){return aY(aZ)
}else{for(a1=0;
a1<i;
a1++){a0.push(aY(a1))
}return a0
}}
}function G(i){var aX=+i,aW=0;
if(aX!==0&&isFinite(aX)){if(aX>=0){aW=Math.floor(aX)
}else{aW=Math.ceil(aX)
}}return aW
}function aR(i,aW){return new Date(Date.UTC(i,aW+1,0)).getUTCDate()
}function aM(i){return aA(i)?366:365
}function aA(i){return(i%4===0&&i%100!==0)||i%400===0
}function aT(i){var aW;
if(i._a&&i._pf.overflow===-2){aW=i._a[e]<0||i._a[e]>11?e:i._a[aG]<1||i._a[aG]>aR(i._a[t],i._a[e])?aG:i._a[r]<0||i._a[r]>23?r:i._a[al]<0||i._a[al]>59?al:i._a[p]<0||i._a[p]>59?p:i._a[N]<0||i._a[N]>999?N:-1;
if(i._pf._overflowDayOfYear&&(aW<t||aW>aG)){aW=aG
}i._pf.overflow=aW
}}function av(i){i._pf={empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false}
}function aq(i){if(i._isValid==null){i._isValid=!isNaN(i._d.getTime())&&i._pf.overflow<0&&!i._pf.empty&&!i._pf.invalidMonth&&!i._pf.nullInput&&!i._pf.invalidFormat&&!i._pf.userInvalidated;
if(i._strict){i._isValid=i._isValid&&i._pf.charsLeftOver===0&&i._pf.unusedTokens.length===0
}}return i._isValid
}function x(i){return i?i.toLowerCase().replace("_","-"):i
}ap(ax.prototype,{set:function(aW){var aY,aX;
for(aX in aW){aY=aW[aX];
if(typeof aY==="function"){this[aX]=aY
}else{this["_"+aX]=aY
}}},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(i){return this._months[i.month()]
},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(i){return this._monthsShort[i.month()]
},monthsParse:function(aW){var aX,aZ,aY;
if(!this._monthsParse){this._monthsParse=[]
}for(aX=0;
aX<12;
aX++){if(!this._monthsParse[aX]){aZ=L.utc([2000,aX]);
aY="^"+this.months(aZ,"")+"|^"+this.monthsShort(aZ,"");
this._monthsParse[aX]=new RegExp(aY.replace(".",""),"i")
}if(this._monthsParse[aX].test(aW)){return aX
}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(i){return this._weekdays[i.day()]
},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(i){return this._weekdaysShort[i.day()]
},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(i){return this._weekdaysMin[i.day()]
},weekdaysParse:function(aZ){var aW,aY,aX;
if(!this._weekdaysParse){this._weekdaysParse=[]
}for(aW=0;
aW<7;
aW++){if(!this._weekdaysParse[aW]){aY=L([2000,1]).day(aW);
aX="^"+this.weekdays(aY,"")+"|^"+this.weekdaysShort(aY,"")+"|^"+this.weekdaysMin(aY,"");
this._weekdaysParse[aW]=new RegExp(aX.replace(".",""),"i")
}if(this._weekdaysParse[aW].test(aZ)){return aW
}}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(aW){var i=this._longDateFormat[aW];
if(!i&&this._longDateFormat[aW.toUpperCase()]){i=this._longDateFormat[aW.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(aX){return aX.slice(1)
});
this._longDateFormat[aW]=i
}return i
},isPM:function(i){return((i+"").toLowerCase().charAt(0)==="p")
},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(i,aW,aX){if(i>11){return aX?"pm":"PM"
}else{return aX?"am":"AM"
}},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(aW,aX){var i=this._calendar[aW];
return typeof i==="function"?i.apply(aX):i
},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(aY,aX,aW,aZ){var i=this._relativeTime[aW];
return(typeof i==="function")?i(aY,aX,aW,aZ):i.replace(/%d/i,aY)
},pastFuture:function(aX,i){var aW=this._relativeTime[aX>0?"future":"past"];
return typeof aW==="function"?aW(i):aW.replace(/%s/i,i)
},ordinal:function(i){return this._ordinal.replace("%d",i)
},_ordinal:"%d",preparse:function(i){return i
},postformat:function(i){return i
},week:function(i){return w(i,this._week.dow,this._week.doy).week
},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate
}});
function aa(aW,i){i.abbr=aW;
if(!an[aW]){an[aW]=new ax()
}an[aW].set(i);
return an[aW]
}function aQ(i){delete an[i]
}function ao(a0){var aZ=0,aX,a2,a1,aY,aW=function(i){if(!an[i]&&ac){try{require("./lang/"+i)
}catch(a3){}}return an[i]
};
if(!a0){return L.fn._lang
}if(!a(a0)){a2=aW(a0);
if(a2){return a2
}a0=[a0]
}while(aZ<a0.length){aY=x(a0[aZ]).split("-");
aX=aY.length;
a1=x(a0[aZ+1]);
a1=a1?a1.split("-"):null;
while(aX>0){a2=aW(aY.slice(0,aX).join("-"));
if(a2){return a2
}if(a1&&a1.length>=aX&&aE(aY,a1,true)>=aX-1){break
}aX--
}aZ++
}return L.fn._lang
}function Z(i){if(i.match(/\[[\s\S]/)){return i.replace(/^\[|\]$/g,"")
}return i.replace(/\\/g,"")
}function o(aY){var aZ=aY.match(af),aW,aX;
for(aW=0,aX=aZ.length;
aW<aX;
aW++){if(aH[aZ[aW]]){aZ[aW]=aH[aZ[aW]]
}else{aZ[aW]=Z(aZ[aW])
}}return function(a0){var i="";
for(aW=0;
aW<aX;
aW++){i+=aZ[aW] instanceof Function?aZ[aW].call(a0,aY):aZ[aW]
}return i
}
}function ae(i,aW){if(!i.isValid()){return i.lang().invalidDate()
}aW=aV(aW,i.lang());
if(!ab[aW]){ab[aW]=o(aW)
}return ab[aW](i)
}function aV(aY,aZ){var aW=5;
function aX(i){return aZ.longDateFormat(i)||i
}T.lastIndex=0;
while(aW>=0&&T.test(aY)){aY=aY.replace(T,aX);
T.lastIndex=0;
aW-=1
}return aY
}function ah(aX,aW){var i;
switch(aX){case"DDDD":return aO;
case"YYYY":case"GGGG":case"gggg":return aC;
case"YYYYY":case"GGGGG":case"ggggg":return Y;
case"S":case"SS":case"SSS":case"DDD":return V;
case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return D;
case"a":case"A":return ao(aW._l)._meridiemParse;
case"X":return aD;
case"Z":case"ZZ":return n;
case"T":return j;
case"SSSS":return aL;
case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return f;
default:i=new RegExp(aU(ak(aX.replace("\\","")),"i"));
return i
}}function u(aW){var i=(n.exec(aW)||[])[0],aY=(i+"").match(S)||["-",0,0],aX=+(aY[1]*60)+G(aY[2]);
return aY[0]==="+"?-aX:aX
}function aj(aZ,aX,aY){var aW,i=aY._a;
switch(aZ){case"M":case"MM":if(aX!=null){i[e]=G(aX)-1
}break;
case"MMM":case"MMMM":aW=ao(aY._l).monthsParse(aX);
if(aW!=null){i[e]=aW
}else{aY._pf.invalidMonth=aX
}break;
case"D":case"DD":if(aX!=null){i[aG]=G(aX)
}break;
case"DDD":case"DDDD":if(aX!=null){aY._dayOfYear=G(aX)
}break;
case"YY":i[t]=G(aX)+(G(aX)>68?1900:2000);
break;
case"YYYY":case"YYYYY":i[t]=G(aX);
break;
case"a":case"A":aY._isPm=ao(aY._l).isPM(aX);
break;
case"H":case"HH":case"h":case"hh":i[r]=G(aX);
break;
case"m":case"mm":i[al]=G(aX);
break;
case"s":case"ss":i[p]=G(aX);
break;
case"S":case"SS":case"SSS":case"SSSS":i[N]=G(("0."+aX)*1000);
break;
case"X":aY._d=new Date(parseFloat(aX)*1000);
break;
case"Z":case"ZZ":aY._useUTC=true;
aY._tzm=u(aX);
break;
case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":aZ=aZ.substr(0,1);
case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":aZ=aZ.substr(0,2);
if(aX){aY._w=aY._w||{};
aY._w[aZ]=aX
}break
}}function X(a0){var a2,a1,a5=[],aY,a4,aX,a6,a7,aZ,a3,aW;
if(a0._d){return
}aY=m(a0);
if(a0._w&&a0._a[aG]==null&&a0._a[e]==null){aX=function(i){return i?(i.length<3?(parseInt(i,10)>68?"19"+i:"20"+i):i):(a0._a[t]==null?L().weekYear():a0._a[t])
};
a6=a0._w;
if(a6.GG!=null||a6.W!=null||a6.E!=null){a7=q(aX(a6.GG),a6.W||1,a6.E,4,1)
}else{aZ=ao(a0._l);
a3=a6.d!=null?aS(a6.d,aZ):(a6.e!=null?parseInt(a6.e,10)+aZ._week.dow:0);
aW=parseInt(a6.w,10)||1;
if(a6.d!=null&&a3<aZ._week.dow){aW++
}a7=q(aX(a6.gg),aW,a3,aZ._week.doy,aZ._week.dow)
}a0._a[t]=a7.year;
a0._dayOfYear=a7.dayOfYear
}if(a0._dayOfYear){a4=a0._a[t]==null?aY[t]:a0._a[t];
if(a0._dayOfYear>aM(a4)){a0._pf._overflowDayOfYear=true
}a1=C(a4,0,a0._dayOfYear);
a0._a[e]=a1.getUTCMonth();
a0._a[aG]=a1.getUTCDate()
}for(a2=0;
a2<3&&a0._a[a2]==null;
++a2){a0._a[a2]=a5[a2]=aY[a2]
}for(;
a2<7;
a2++){a0._a[a2]=a5[a2]=(a0._a[a2]==null)?(a2===2?1:0):a0._a[a2]
}a5[r]+=G((a0._tzm||0)/60);
a5[al]+=G((a0._tzm||0)%60);
a0._d=(a0._useUTC?C:ag).apply(null,a5)
}function at(aW){var i;
if(aW._d){return
}i=l(aW._i);
aW._a=[i.year,i.month,i.day,i.hour,i.minute,i.second,i.millisecond];
X(aW)
}function m(aW){var i=new Date();
if(aW._useUTC){return[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()]
}else{return[i.getFullYear(),i.getMonth(),i.getDate()]
}}function K(aZ){aZ._a=[];
aZ._pf.empty=true;
var aY=ao(aZ._l),a2=""+aZ._i,a1,aX,a5,a0,a4,aW=a2.length,a3=0;
a5=aV(aZ._f,aY).match(af)||[];
for(a1=0;
a1<a5.length;
a1++){a0=a5[a1];
aX=(ah(a0,aZ).exec(a2)||[])[0];
if(aX){a4=a2.substr(0,a2.indexOf(aX));
if(a4.length>0){aZ._pf.unusedInput.push(a4)
}a2=a2.slice(a2.indexOf(aX)+aX.length);
a3+=aX.length
}if(aH[a0]){if(aX){aZ._pf.empty=false
}else{aZ._pf.unusedTokens.push(a0)
}aj(a0,aX,aZ)
}else{if(aZ._strict&&!aX){aZ._pf.unusedTokens.push(a0)
}}}aZ._pf.charsLeftOver=aW-a3;
if(a2.length>0){aZ._pf.unusedInput.push(a2)
}if(aZ._isPm&&aZ._a[r]<12){aZ._a[r]+=12
}if(aZ._isPm===false&&aZ._a[r]===12){aZ._a[r]=0
}X(aZ);
aT(aZ)
}function ak(i){return i.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(aW,a0,aZ,aY,aX){return a0||aZ||aY||aX
})
}function aU(i){return i.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")
}function aI(aW){var a0,aY,aZ,aX,a1;
if(aW._f.length===0){aW._pf.invalidFormat=true;
aW._d=new Date(NaN);
return
}for(aX=0;
aX<aW._f.length;
aX++){a1=0;
a0=ap({},aW);
av(a0);
a0._f=aW._f[aX];
K(a0);
if(!aq(a0)){continue
}a1+=a0._pf.charsLeftOver;
a1+=a0._pf.unusedTokens.length*10;
a0._pf.score=a1;
if(aZ==null||a1<aZ){aZ=a1;
aY=a0
}}ap(aW,aY||a0)
}function h(aY){var aZ,aX=aY._i,aW=az.exec(aX);
if(aW){aY._pf.iso=true;
for(aZ=4;
aZ>0;
aZ--){if(aW[aZ]){aY._f=aN[aZ-1]+(aW[6]||" ");
break
}}for(aZ=0;
aZ<4;
aZ++){if(B[aZ][1].exec(aX)){aY._f+=B[aZ][0];
break
}}if(n.exec(aX)){aY._f+="Z"
}K(aY)
}else{aY._d=new Date(aX)
}}function J(aX){var aW=aX._i,i=b.exec(aW);
if(aW===z){aX._d=new Date()
}else{if(i){aX._d=new Date(+i[1])
}else{if(typeof aW==="string"){h(aX)
}else{if(a(aW)){aX._a=aW.slice(0);
X(aX)
}else{if(d(aW)){aX._d=new Date(+aW)
}else{if(typeof(aW)==="object"){at(aX)
}else{aX._d=new Date(aW)
}}}}}}}function ag(a2,i,a0,aZ,a1,aY,aX){var aW=new Date(a2,i,a0,aZ,a1,aY,aX);
if(a2<1970){aW.setFullYear(a2)
}return aW
}function C(aW){var i=new Date(Date.UTC.apply(null,arguments));
if(aW<1970){i.setUTCFullYear(aW)
}return i
}function aS(i,aW){if(typeof i==="string"){if(!isNaN(i)){i=parseInt(i,10)
}else{i=aW.weekdaysParse(i);
if(typeof i!=="number"){return null
}}}return i
}function ay(i,aX,aW,aY,aZ){return aZ.relativeTime(aX||1,!!aW,i,aY)
}function v(aX,i,aW){var a2=Q(Math.abs(aX)/1000),aY=Q(a2/60),a1=Q(aY/60),a3=Q(a1/24),aZ=Q(a3/365),a0=a2<45&&["s",a2]||aY===1&&["m"]||aY<45&&["mm",aY]||a1===1&&["h"]||a1<22&&["hh",a1]||a3===1&&["d"]||a3<=25&&["dd",a3]||a3<=45&&["M"]||a3<345&&["MM",Q(a3/30)]||aZ===1&&["y"]||["yy",aZ];
a0[2]=i;
a0[3]=aX>0;
a0[4]=aW;
return ay.apply({},a0)
}function w(aZ,aX,a0){var aW=a0-aX,i=a0-aZ.day(),aY;
if(i>aW){i-=7
}if(i<aW-7){i+=7
}aY=L(aZ).add("d",i);
return{week:Math.ceil(aY.dayOfYear()/7),year:aY.year()}
}function q(aZ,aY,a0,a2,i){var a1=new Date(Date.UTC(aZ,0)).getUTCDay(),aX,aW;
a0=a0!=null?a0:i;
aX=i-a1+(a1>a2?7:0);
aW=7*(aY-1)+(a0-i)+aX+1;
return{year:aW>0?aZ:aZ-1,dayOfYear:aW>0?aW:aM(aZ-1)+aW}
}function H(aW){var i=aW._i,aX=aW._f;
if(typeof aW._pf==="undefined"){av(aW)
}if(i===null){return L.invalid({nullInput:true})
}if(typeof i==="string"){aW._i=i=ao().preparse(i)
}if(L.isMoment(i)){aW=ap({},i);
aW._d=new Date(+i._d)
}else{if(aX){if(a(aX)){aI(aW)
}else{K(aW)
}}else{J(aW)
}}return new F(aW)
}L=function(aW,aX,aY,i){if(typeof(aY)==="boolean"){i=aY;
aY=z
}return H({_i:aW,_f:aX,_l:aY,_strict:i,_isUTC:false})
};
L.utc=function(aX,aY,aZ,aW){var i;
if(typeof(aZ)==="boolean"){aW=aZ;
aZ=z
}i=H({_useUTC:true,_isUTC:true,_l:aZ,_i:aX,_f:aY,_strict:aW}).utc();
return i
};
L.unix=function(i){return L(i*1000)
};
L.duration=function(a1,a3){var aY=a1,aZ=null,aX,a0,aW,a2,i;
if(L.isDuration(a1)){aY={ms:a1._milliseconds,d:a1._days,M:a1._months}
}else{if(typeof a1==="number"){aY={};
if(a3){aY[a3]=a1
}else{aY.milliseconds=a1
}}else{if(!!(aZ=aP.exec(a1))){aX=(aZ[1]==="-")?-1:1;
aY={y:0,d:G(aZ[aG])*aX,h:G(aZ[r])*aX,m:G(aZ[al])*aX,s:G(aZ[p])*aX,ms:G(aZ[N])*aX}
}else{if(!!(aZ=au.exec(a1))){aX=(aZ[1]==="-")?-1:1;
aW=function(a5){var a4=a5&&parseFloat(a5.replace(",","."));
return(isNaN(a4)?0:a4)*aX
};
aY={y:aW(aZ[2]),M:aW(aZ[3]),d:aW(aZ[4]),h:aW(aZ[5]),m:aW(aZ[6]),s:aW(aZ[7]),w:aW(aZ[8])}
}}}}a0=new W(aY);
if(L.isDuration(a1)&&a1.hasOwnProperty("_lang")){a0._lang=a1._lang
}return a0
};
L.version=ar;
L.defaultFormat=O;
L.updateOffset=function(){};
L.lang=function(aW,i){var aX;
if(!aW){return L.fn._lang._abbr
}if(i){aa(x(aW),i)
}else{if(i===null){aQ(aW);
aW="en"
}else{if(!an[aW]){ao(aW)
}}}aX=L.duration.fn._lang=L.fn._lang=ao(aW);
return aX._abbr
};
L.langData=function(i){if(i&&i._lang&&i._lang._abbr){i=i._lang._abbr
}return ao(i)
};
L.isMoment=function(i){return i instanceof F
};
L.isDuration=function(i){return i instanceof W
};
for(U=P.length-1;
U>=0;
--U){ai(P[U])
}L.normalizeUnits=function(i){return aJ(i)
};
L.invalid=function(aW){var i=L.utc(NaN);
if(aW!=null){ap(i._pf,aW)
}else{i._pf.userInvalidated=true
}return i
};
L.parseZone=function(i){return L(i).parseZone()
};
ap(L.fn=F.prototype,{clone:function(){return L(this)
},valueOf:function(){return +this._d+((this._offset||0)*60000)
},unix:function(){return Math.floor(+this/1000)
},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")
},toDate:function(){return this._offset?new Date(+this):this._d
},toISOString:function(){return ae(L(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")
},toArray:function(){var i=this;
return[i.year(),i.month(),i.date(),i.hours(),i.minutes(),i.seconds(),i.milliseconds()]
},isValid:function(){return aq(this)
},isDSTShifted:function(){if(this._a){return this.isValid()&&aE(this._a,(this._isUTC?L.utc(this._a):L(this._a)).toArray())>0
}return false
},parsingFlags:function(){return ap({},this._pf)
},invalidAt:function(){return this._pf.overflow
},utc:function(){return this.zone(0)
},local:function(){this.zone(0);
this._isUTC=false;
return this
},format:function(aW){var i=ae(this,aW||L.defaultFormat);
return this.lang().postformat(i)
},add:function(i,aX){var aW;
if(typeof i==="string"){aW=L.duration(+aX,i)
}else{aW=L.duration(i,aX)
}A(this,aW,1);
return this
},subtract:function(i,aX){var aW;
if(typeof i==="string"){aW=L.duration(+aX,i)
}else{aW=L.duration(i,aX)
}A(this,aW,-1);
return this
},diff:function(aZ,aY,i){var a0=this._isUTC?L(aZ).zone(this._offset||0):L(aZ).local(),aW=(this.zone()-a0.zone())*60000,a1,aX;
aY=aJ(aY);
if(aY==="year"||aY==="month"){a1=(this.daysInMonth()+a0.daysInMonth())*43200000;
aX=((this.year()-a0.year())*12)+(this.month()-a0.month());
aX+=((this-L(this).startOf("month"))-(a0-L(a0).startOf("month")))/a1;
aX-=((this.zone()-L(this).startOf("month").zone())-(a0.zone()-L(a0).startOf("month").zone()))*60000/a1;
if(aY==="year"){aX=aX/12
}}else{a1=(this-a0);
aX=aY==="second"?a1/1000:aY==="minute"?a1/60000:aY==="hour"?a1/3600000:aY==="day"?(a1-aW)/86400000:aY==="week"?(a1-aW)/604800000:a1
}return i?aX:k(aX)
},from:function(aW,i){return L.duration(this.diff(aW)).lang(this.lang()._abbr).humanize(!i)
},fromNow:function(i){return this.from(L(),i)
},calendar:function(){var aW=this.diff(L().zone(this.zone()).startOf("day"),"days",true),i=aW<-6?"sameElse":aW<-1?"lastWeek":aW<0?"lastDay":aW<1?"sameDay":aW<2?"nextDay":aW<7?"nextWeek":"sameElse";
return this.format(this.lang().calendar(i,this))
},isLeapYear:function(){return aA(this.year())
},isDST:function(){return(this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone())
},day:function(aW){var i=this._isUTC?this._d.getUTCDay():this._d.getDay();
if(aW!=null){aW=aS(aW,this.lang());
return this.add({d:aW-i})
}else{return i
}},month:function(i){var aW=this._isUTC?"UTC":"",aX;
if(i!=null){if(typeof i==="string"){i=this.lang().monthsParse(i);
if(typeof i!=="number"){return this
}}aX=this.date();
this.date(1);
this._d["set"+aW+"Month"](i);
this.date(Math.min(aX,this.daysInMonth()));
L.updateOffset(this);
return this
}else{return this._d["get"+aW+"Month"]()
}},startOf:function(i){i=aJ(i);
switch(i){case"year":this.month(0);
case"month":this.date(1);
case"week":case"isoWeek":case"day":this.hours(0);
case"hour":this.minutes(0);
case"minute":this.seconds(0);
case"second":this.milliseconds(0)
}if(i==="week"){this.weekday(0)
}else{if(i==="isoWeek"){this.isoWeekday(1)
}}return this
},endOf:function(i){i=aJ(i);
return this.startOf(i).add((i==="isoWeek"?"week":i),1).subtract("ms",1)
},isAfter:function(aW,i){i=typeof i!=="undefined"?i:"millisecond";
return +this.clone().startOf(i)>+L(aW).startOf(i)
},isBefore:function(aW,i){i=typeof i!=="undefined"?i:"millisecond";
return +this.clone().startOf(i)<+L(aW).startOf(i)
},isSame:function(aW,i){i=typeof i!=="undefined"?i:"millisecond";
return +this.clone().startOf(i)===+L(aW).startOf(i)
},min:function(i){i=L.apply(null,arguments);
return i<this?this:i
},max:function(i){i=L.apply(null,arguments);
return i>this?this:i
},zone:function(i){var aW=this._offset||0;
if(i!=null){if(typeof i==="string"){i=u(i)
}if(Math.abs(i)<16){i=i*60
}this._offset=i;
this._isUTC=true;
if(aW!==i){A(this,L.duration(aW-i,"m"),1,true)
}}else{return this._isUTC?aW:this._d.getTimezoneOffset()
}return this
},zoneAbbr:function(){return this._isUTC?"UTC":""
},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""
},parseZone:function(){if(typeof this._i==="string"){this.zone(this._i)
}return this
},hasAlignedHourOffset:function(i){if(!i){i=0
}else{i=L(i).zone()
}return(this.zone()-i)%60===0
},daysInMonth:function(){return aR(this.year(),this.month())
},dayOfYear:function(i){var aW=Q((L(this).startOf("day")-L(this).startOf("year"))/86400000)+1;
return i==null?aW:this.add("d",(i-aW))
},weekYear:function(i){var aW=w(this,this.lang()._week.dow,this.lang()._week.doy).year;
return i==null?aW:this.add("y",(i-aW))
},isoWeekYear:function(i){var aW=w(this,1,4).year;
return i==null?aW:this.add("y",(i-aW))
},week:function(i){var aW=this.lang().week(this);
return i==null?aW:this.add("d",(i-aW)*7)
},isoWeek:function(i){var aW=w(this,1,4).week;
return i==null?aW:this.add("d",(i-aW)*7)
},weekday:function(i){var aW=(this.day()+7-this.lang()._week.dow)%7;
return i==null?aW:this.add("d",i-aW)
},isoWeekday:function(i){return i==null?this.day()||7:this.day(this.day()%7?i:i-7)
},get:function(i){i=aJ(i);
return this[i]()
},set:function(i,aW){i=aJ(i);
if(typeof this[i]==="function"){this[i](aW)
}return this
},lang:function(i){if(i===z){return this._lang
}else{this._lang=ao(i);
return this
}}});
function aB(i,aW){L.fn[i]=L.fn[i+"s"]=function(aX){var aY=this._isUTC?"UTC":"";
if(aX!=null){this._d["set"+aY+aW](aX);
L.updateOffset(this);
return this
}else{return this._d["get"+aY+aW]()
}}
}for(U=0;
U<aw.length;
U++){aB(aw[U].toLowerCase().replace(/s$/,""),aw[U])
}aB("year","FullYear");
L.fn.days=L.fn.day;
L.fn.months=L.fn.month;
L.fn.weeks=L.fn.week;
L.fn.isoWeeks=L.fn.isoWeek;
L.fn.toJSON=L.fn.toISOString;
ap(L.duration.fn=W.prototype,{_bubble:function(){var aX=this._milliseconds,a2=this._days,i=this._months,a0=this._data,a1,aZ,aW,aY;
a0.milliseconds=aX%1000;
a1=k(aX/1000);
a0.seconds=a1%60;
aZ=k(a1/60);
a0.minutes=aZ%60;
aW=k(aZ/60);
a0.hours=aW%24;
a2+=k(aW/24);
a0.days=a2%30;
i+=k(a2/30);
a0.months=i%12;
aY=k(i/12);
a0.years=aY
},weeks:function(){return k(this.days()/7)
},valueOf:function(){return this._milliseconds+this._days*86400000+(this._months%12)*2592000000+G(this._months/12)*31536000000
},humanize:function(aW){var aX=+this,i=v(aX,!aW,this.lang());
if(aW){i=this.lang().pastFuture(aX,i)
}return this.lang().postformat(i)
},add:function(i,aX){var aW=L.duration(i,aX);
this._milliseconds+=aW._milliseconds;
this._days+=aW._days;
this._months+=aW._months;
this._bubble();
return this
},subtract:function(i,aX){var aW=L.duration(i,aX);
this._milliseconds-=aW._milliseconds;
this._days-=aW._days;
this._months-=aW._months;
this._bubble();
return this
},get:function(i){i=aJ(i);
return this[i.toLowerCase()+"s"]()
},as:function(i){i=aJ(i);
return this["as"+i.charAt(0).toUpperCase()+i.slice(1)+"s"]()
},lang:L.fn.lang,toIsoString:function(){var aY=Math.abs(this.years()),i=Math.abs(this.months()),a0=Math.abs(this.days()),aW=Math.abs(this.hours()),aX=Math.abs(this.minutes()),aZ=Math.abs(this.seconds()+this.milliseconds()/1000);
if(!this.asSeconds()){return"P0D"
}return(this.asSeconds()<0?"-":"")+"P"+(aY?aY+"Y":"")+(i?i+"M":"")+(a0?a0+"D":"")+((aW||aX||aZ)?"T":"")+(aW?aW+"H":"")+(aX?aX+"M":"")+(aZ?aZ+"S":"")
}});
function R(i){L.duration.fn[i]=function(){return this._data[i]
}
}function am(i,aW){L.duration.fn["as"+i]=function(){return +this/aW
}
}for(U in y){if(y.hasOwnProperty(U)){am(U,y[U]);
R(U.toLowerCase())
}}am("Weeks",604800000);
L.duration.fn.asMonths=function(){return(+this-this.years()*31536000000)/2592000000+this.years()*12
};
L.lang("en",{ordinal:function(aX){var i=aX%10,aW=(G(aX%100/10)===1)?"th":(i===1)?"st":(i===2)?"nd":(i===3)?"rd":"th";
return aX+aW
}});
function M(aW){var i=false,aX=L;
if(typeof ender!=="undefined"){return
}if(aW){this.moment=function(){if(!i&&console&&console.warn){i=true;
console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")
}return aX.apply(null,arguments)
}
}else{this["moment"]=L
}}if(ac){module.exports=L;
M(true)
}else{if(typeof define==="function"&&define.amd){define("moment",function(aW,i,aX){if(aX.config().noGlobal!==true){M(aX.config().noGlobal===z)
}return L
})
}else{M()
}}}).call(this);
(function(X,l,n){var L=function(h){var j=function(e){function o(a,b){var c=j.defaults.columns,d=a.aoColumns.length,c=h.extend({},j.models.oColumn,c,{sSortingClass:a.oClasses.sSortable,sSortingClassJUI:a.oClasses.sSortJUI,nTh:b?b:l.createElement("th"),sTitle:c.sTitle?c.sTitle:b?b.innerHTML:"",aDataSort:c.aDataSort?c.aDataSort:[d],mData:c.mData?c.oDefaults:d});
a.aoColumns.push(c);
if(a.aoPreSearchCols[d]===n||null===a.aoPreSearchCols[d]){a.aoPreSearchCols[d]=h.extend({},j.models.oSearch)
}else{if(c=a.aoPreSearchCols[d],c.bRegex===n&&(c.bRegex=!0),c.bSmart===n&&(c.bSmart=!0),c.bCaseInsensitive===n){c.bCaseInsensitive=!0
}}m(a,d,null)
}function m(a,b,c){var d=a.aoColumns[b];
c!==n&&null!==c&&(c.mDataProp&&!c.mData&&(c.mData=c.mDataProp),c.sType!==n&&(d.sType=c.sType,d._bAutoType=!1),h.extend(d,c),p(d,c,"sWidth","sWidthOrig"),c.iDataSort!==n&&(d.aDataSort=[c.iDataSort]),p(d,c,"aDataSort"));
var i=d.mRender?Q(d.mRender):null,f=Q(d.mData);
d.fnGetData=function(a,b){var c=f(a,b);
return d.mRender&&b&&""!==b?i(c,b,a):c
};
d.fnSetData=L(d.mData);
a.oFeatures.bSort||(d.bSortable=!1);
!d.bSortable||-1==h.inArray("asc",d.asSorting)&&-1==h.inArray("desc",d.asSorting)?(d.sSortingClass=a.oClasses.sSortableNone,d.sSortingClassJUI=""):-1==h.inArray("asc",d.asSorting)&&-1==h.inArray("desc",d.asSorting)?(d.sSortingClass=a.oClasses.sSortable,d.sSortingClassJUI=a.oClasses.sSortJUI):-1!=h.inArray("asc",d.asSorting)&&-1==h.inArray("desc",d.asSorting)?(d.sSortingClass=a.oClasses.sSortableAsc,d.sSortingClassJUI=a.oClasses.sSortJUIAscAllowed):-1==h.inArray("asc",d.asSorting)&&-1!=h.inArray("desc",d.asSorting)&&(d.sSortingClass=a.oClasses.sSortableDesc,d.sSortingClassJUI=a.oClasses.sSortJUIDescAllowed)
}function k(a){if(!1===a.oFeatures.bAutoWidth){return !1
}da(a);
for(var b=0,c=a.aoColumns.length;
b<c;
b++){a.aoColumns[b].nTh.style.width=a.aoColumns[b].sWidth
}}function G(a,b){var c=r(a,"bVisible");
return"number"===typeof c[b]?c[b]:null
}function R(a,b){var c=r(a,"bVisible"),c=h.inArray(b,c);
return -1!==c?c:null
}function t(a){return r(a,"bVisible").length
}function r(a,b){var c=[];
h.map(a.aoColumns,function(a,i){a[b]&&c.push(i)
});
return c
}function B(a){for(var b=j.ext.aTypes,c=b.length,d=0;
d<c;
d++){var i=b[d](a);
if(null!==i){return i
}}return"string"
}function u(a,b){for(var c=b.split(","),d=[],i=0,f=a.aoColumns.length;
i<f;
i++){for(var g=0;
g<f;
g++){if(a.aoColumns[i].sName==c[g]){d.push(g);
break
}}}return d
}function M(a){for(var b="",c=0,d=a.aoColumns.length;
c<d;
c++){b+=a.aoColumns[c].sName+","
}return b.length==d?"":b.slice(0,-1)
}function ta(a,b,c,d){var i,f,g,e,w;
if(b){for(i=b.length-1;
0<=i;
i--){var j=b[i].aTargets;
h.isArray(j)||D(a,1,"aTargets must be an array of targets, not a "+typeof j);
f=0;
for(g=j.length;
f<g;
f++){if("number"===typeof j[f]&&0<=j[f]){for(;
a.aoColumns.length<=j[f];
){o(a)
}d(j[f],b[i])
}else{if("number"===typeof j[f]&&0>j[f]){d(a.aoColumns.length+j[f],b[i])
}else{if("string"===typeof j[f]){e=0;
for(w=a.aoColumns.length;
e<w;
e++){("_all"==j[f]||h(a.aoColumns[e].nTh).hasClass(j[f]))&&d(e,b[i])
}}}}}}}if(c){i=0;
for(a=c.length;
i<a;
i++){d(i,c[i])
}}}function H(a,b){var c;
c=h.isArray(b)?b.slice():h.extend(!0,{},b);
var d=a.aoData.length,i=h.extend(!0,{},j.models.oRow);
i._aData=c;
a.aoData.push(i);
for(var f,i=0,g=a.aoColumns.length;
i<g;
i++){c=a.aoColumns[i],"function"===typeof c.fnRender&&c.bUseRendered&&null!==c.mData?F(a,d,i,S(a,d,i)):F(a,d,i,v(a,d,i)),c._bAutoType&&"string"!=c.sType&&(f=v(a,d,i,"type"),null!==f&&""!==f&&(f=B(f),null===c.sType?c.sType=f:c.sType!=f&&"html"!=c.sType&&(c.sType="string")))
}a.aiDisplayMaster.push(d);
a.oFeatures.bDeferRender||ea(a,d);
return d
}function ua(a){var b,c,d,i,f,g,e;
if(a.bDeferLoading||null===a.sAjaxSource){for(b=a.nTBody.firstChild;
b;
){if("TR"==b.nodeName.toUpperCase()){c=a.aoData.length;
b._DT_RowIndex=c;
a.aoData.push(h.extend(!0,{},j.models.oRow,{nTr:b}));
a.aiDisplayMaster.push(c);
f=b.firstChild;
for(d=0;
f;
){g=f.nodeName.toUpperCase();
if("TD"==g||"TH"==g){F(a,c,d,h.trim(f.innerHTML)),d++
}f=f.nextSibling
}}b=b.nextSibling
}}i=T(a);
d=[];
b=0;
for(c=i.length;
b<c;
b++){for(f=i[b].firstChild;
f;
){g=f.nodeName.toUpperCase(),("TD"==g||"TH"==g)&&d.push(f),f=f.nextSibling
}}c=0;
for(i=a.aoColumns.length;
c<i;
c++){e=a.aoColumns[c];
null===e.sTitle&&(e.sTitle=e.nTh.innerHTML);
var w=e._bAutoType,o="function"===typeof e.fnRender,k=null!==e.sClass,n=e.bVisible,m,p;
if(w||o||k||!n){g=0;
for(b=a.aoData.length;
g<b;
g++){f=a.aoData[g],m=d[g*i+c],w&&"string"!=e.sType&&(p=v(a,g,c,"type"),""!==p&&(p=B(p),null===e.sType?e.sType=p:e.sType!=p&&"html"!=e.sType&&(e.sType="string"))),e.mRender?m.innerHTML=v(a,g,c,"display"):e.mData!==c&&(m.innerHTML=v(a,g,c,"display")),o&&(p=S(a,g,c),m.innerHTML=p,e.bUseRendered&&F(a,g,c,p)),k&&(m.className+=" "+e.sClass),n?f._anHidden[c]=null:(f._anHidden[c]=m,m.parentNode.removeChild(m)),e.fnCreatedCell&&e.fnCreatedCell.call(a.oInstance,m,v(a,g,c,"display"),f._aData,g,c)
}}}if(0!==a.aoRowCreatedCallback.length){b=0;
for(c=a.aoData.length;
b<c;
b++){f=a.aoData[b],A(a,"aoRowCreatedCallback",null,[f.nTr,f._aData,b])
}}}function I(a,b){return b._DT_RowIndex!==n?b._DT_RowIndex:null
}function fa(a,b,c){for(var b=J(a,b),d=0,a=a.aoColumns.length;
d<a;
d++){if(b[d]===c){return d
}}return -1
}function Y(a,b,c,d){for(var i=[],f=0,g=d.length;
f<g;
f++){i.push(v(a,b,d[f],c))
}return i
}function v(a,b,c,d){var i=a.aoColumns[c];
if((c=i.fnGetData(a.aoData[b]._aData,d))===n){return a.iDrawError!=a.iDraw&&null===i.sDefaultContent&&(D(a,0,"Requested unknown parameter "+("function"==typeof i.mData?"{mData function}":"'"+i.mData+"'")+" from the data source for row "+b),a.iDrawError=a.iDraw),i.sDefaultContent
}if(null===c&&null!==i.sDefaultContent){c=i.sDefaultContent
}else{if("function"===typeof c){return c()
}}return"display"==d&&null===c?"":c
}function F(a,b,c,d){a.aoColumns[c].fnSetData(a.aoData[b]._aData,d)
}function Q(a){if(null===a){return function(){return null
}
}if("function"===typeof a){return function(b,d,i){return a(b,d,i)
}
}if("string"===typeof a&&(-1!==a.indexOf(".")||-1!==a.indexOf("["))){var b=function(a,d,i){var f=i.split("."),g;
if(""!==i){var e=0;
for(g=f.length;
e<g;
e++){if(i=f[e].match(U)){f[e]=f[e].replace(U,"");
""!==f[e]&&(a=a[f[e]]);
g=[];
f.splice(0,e+1);
for(var f=f.join("."),e=0,h=a.length;
e<h;
e++){g.push(b(a[e],d,f))
}a=i[0].substring(1,i[0].length-1);
a=""===a?g:g.join(a);
break
}if(null===a||a[f[e]]===n){return n
}a=a[f[e]]
}}return a
};
return function(c,d){return b(c,d,a)
}
}return function(b){return b[a]
}
}function L(a){if(null===a){return function(){}
}if("function"===typeof a){return function(b,d){a(b,"set",d)
}
}if("string"===typeof a&&(-1!==a.indexOf(".")||-1!==a.indexOf("["))){var b=function(a,d,i){var i=i.split("."),f,g,e=0;
for(g=i.length-1;
e<g;
e++){if(f=i[e].match(U)){i[e]=i[e].replace(U,"");
a[i[e]]=[];
f=i.slice();
f.splice(0,e+1);
g=f.join(".");
for(var h=0,j=d.length;
h<j;
h++){f={},b(f,d[h],g),a[i[e]].push(f)
}return
}if(null===a[i[e]]||a[i[e]]===n){a[i[e]]={}
}a=a[i[e]]
}a[i[i.length-1].replace(U,"")]=d
};
return function(c,d){return b(c,d,a)
}
}return function(b,d){b[a]=d
}
}function Z(a){for(var b=[],c=a.aoData.length,d=0;
d<c;
d++){b.push(a.aoData[d]._aData)
}return b
}function ga(a){a.aoData.splice(0,a.aoData.length);
a.aiDisplayMaster.splice(0,a.aiDisplayMaster.length);
a.aiDisplay.splice(0,a.aiDisplay.length);
y(a)
}function ha(a,b){for(var c=-1,d=0,i=a.length;
d<i;
d++){a[d]==b?c=d:a[d]>b&&a[d]--
}-1!=c&&a.splice(c,1)
}function S(a,b,c){var d=a.aoColumns[c];
return d.fnRender({iDataRow:b,iDataColumn:c,oSettings:a,aData:a.aoData[b]._aData,mDataProp:d.mData},v(a,b,c,"display"))
}function ea(a,b){var c=a.aoData[b],d;
if(null===c.nTr){c.nTr=l.createElement("tr");
c.nTr._DT_RowIndex=b;
c._aData.DT_RowId&&(c.nTr.id=c._aData.DT_RowId);
c._aData.DT_RowClass&&(c.nTr.className=c._aData.DT_RowClass);
for(var i=0,f=a.aoColumns.length;
i<f;
i++){var g=a.aoColumns[i];
d=l.createElement(g.sCellType);
d.innerHTML="function"===typeof g.fnRender&&(!g.bUseRendered||null===g.mData)?S(a,b,i):v(a,b,i,"display");
null!==g.sClass&&(d.className=g.sClass);
g.bVisible?(c.nTr.appendChild(d),c._anHidden[i]=null):c._anHidden[i]=d;
g.fnCreatedCell&&g.fnCreatedCell.call(a.oInstance,d,v(a,b,i,"display"),c._aData,b,i)
}A(a,"aoRowCreatedCallback",null,[c.nTr,c._aData,b])
}}function va(a){var b,c,d;
if(0!==h("th, td",a.nTHead).length){b=0;
for(d=a.aoColumns.length;
b<d;
b++){if(c=a.aoColumns[b].nTh,c.setAttribute("role","columnheader"),a.aoColumns[b].bSortable&&(c.setAttribute("tabindex",a.iTabIndex),c.setAttribute("aria-controls",a.sTableId)),null!==a.aoColumns[b].sClass&&h(c).addClass(a.aoColumns[b].sClass),a.aoColumns[b].sTitle!=c.innerHTML){c.innerHTML=a.aoColumns[b].sTitle
}}}else{var i=l.createElement("tr");
b=0;
for(d=a.aoColumns.length;
b<d;
b++){c=a.aoColumns[b].nTh,c.innerHTML=a.aoColumns[b].sTitle,c.setAttribute("tabindex","0"),null!==a.aoColumns[b].sClass&&h(c).addClass(a.aoColumns[b].sClass),i.appendChild(c)
}h(a.nTHead).html("")[0].appendChild(i);
V(a.aoHeader,a.nTHead)
}h(a.nTHead).children("tr").attr("role","row");
if(a.bJUI){b=0;
for(d=a.aoColumns.length;
b<d;
b++){c=a.aoColumns[b].nTh;
i=l.createElement("div");
i.className=a.oClasses.sSortJUIWrapper;
h(c).contents().appendTo(i);
var f=l.createElement("span");
f.className=a.oClasses.sSortIcon;
i.appendChild(f);
c.appendChild(i)
}}if(a.oFeatures.bSort){for(b=0;
b<a.aoColumns.length;
b++){!1!==a.aoColumns[b].bSortable?ia(a,a.aoColumns[b].nTh,b):h(a.aoColumns[b].nTh).addClass(a.oClasses.sSortableNone)
}}""!==a.oClasses.sFooterTH&&h(a.nTFoot).children("tr").children("th").addClass(a.oClasses.sFooterTH);
if(null!==a.nTFoot){c=N(a,null,a.aoFooter);
b=0;
for(d=a.aoColumns.length;
b<d;
b++){c[b]&&(a.aoColumns[b].nTf=c[b],a.aoColumns[b].sClass&&h(c[b]).addClass(a.aoColumns[b].sClass))
}}}function W(a,b,c){var d,i,f,g=[],e=[],h=a.aoColumns.length,j;
c===n&&(c=!1);
d=0;
for(i=b.length;
d<i;
d++){g[d]=b[d].slice();
g[d].nTr=b[d].nTr;
for(f=h-1;
0<=f;
f--){!a.aoColumns[f].bVisible&&!c&&g[d].splice(f,1)
}e.push([])
}d=0;
for(i=g.length;
d<i;
d++){if(a=g[d].nTr){for(;
f=a.firstChild;
){a.removeChild(f)
}}f=0;
for(b=g[d].length;
f<b;
f++){if(j=h=1,e[d][f]===n){a.appendChild(g[d][f].cell);
for(e[d][f]=1;
g[d+h]!==n&&g[d][f].cell==g[d+h][f].cell;
){e[d+h][f]=1,h++
}for(;
g[d][f+j]!==n&&g[d][f].cell==g[d][f+j].cell;
){for(c=0;
c<h;
c++){e[d+c][f+j]=1
}j++
}g[d][f].cell.rowSpan=h;
g[d][f].cell.colSpan=j
}}}}function x(a){var b=A(a,"aoPreDrawCallback","preDraw",[a]);
if(-1!==h.inArray(!1,b)){E(a,!1)
}else{var c,d,b=[],i=0,f=a.asStripeClasses.length;
c=a.aoOpenRows.length;
a.bDrawing=!0;
a.iInitDisplayStart!==n&&-1!=a.iInitDisplayStart&&(a._iDisplayStart=a.oFeatures.bServerSide?a.iInitDisplayStart:a.iInitDisplayStart>=a.fnRecordsDisplay()?0:a.iInitDisplayStart,a.iInitDisplayStart=-1,y(a));
if(a.bDeferLoading){a.bDeferLoading=!1,a.iDraw++
}else{if(a.oFeatures.bServerSide){if(!a.bDestroying&&!wa(a)){return
}}else{a.iDraw++
}}if(0!==a.aiDisplay.length){var g=a._iDisplayStart;
d=a._iDisplayEnd;
a.oFeatures.bServerSide&&(g=0,d=a.aoData.length);
for(;
g<d;
g++){var e=a.aoData[a.aiDisplay[g]];
null===e.nTr&&ea(a,a.aiDisplay[g]);
var j=e.nTr;
if(0!==f){var o=a.asStripeClasses[i%f];
e._sRowStripe!=o&&(h(j).removeClass(e._sRowStripe).addClass(o),e._sRowStripe=o)
}A(a,"aoRowCallback",null,[j,a.aoData[a.aiDisplay[g]]._aData,i,g]);
b.push(j);
i++;
if(0!==c){for(e=0;
e<c;
e++){if(j==a.aoOpenRows[e].nParent){b.push(a.aoOpenRows[e].nTr);
break
}}}}}else{b[0]=l.createElement("tr"),a.asStripeClasses[0]&&(b[0].className=a.asStripeClasses[0]),c=a.oLanguage,f=c.sZeroRecords,1==a.iDraw&&null!==a.sAjaxSource&&!a.oFeatures.bServerSide?f=c.sLoadingRecords:c.sEmptyTable&&0===a.fnRecordsTotal()&&(f=c.sEmptyTable),c=l.createElement("td"),c.setAttribute("valign","top"),c.colSpan=t(a),c.className=a.oClasses.sRowEmpty,c.innerHTML=ja(a,f),b[i].appendChild(c)
}A(a,"aoHeaderCallback","header",[h(a.nTHead).children("tr")[0],Z(a),a._iDisplayStart,a.fnDisplayEnd(),a.aiDisplay]);
A(a,"aoFooterCallback","footer",[h(a.nTFoot).children("tr")[0],Z(a),a._iDisplayStart,a.fnDisplayEnd(),a.aiDisplay]);
i=l.createDocumentFragment();
c=l.createDocumentFragment();
if(a.nTBody){f=a.nTBody.parentNode;
c.appendChild(a.nTBody);
if(!a.oScroll.bInfinite||!a._bInitComplete||a.bSorted||a.bFiltered){for(;
c=a.nTBody.firstChild;
){a.nTBody.removeChild(c)
}}c=0;
for(d=b.length;
c<d;
c++){i.appendChild(b[c])
}a.nTBody.appendChild(i);
null!==f&&f.appendChild(a.nTBody)
}A(a,"aoDrawCallback","draw",[a]);
a.bSorted=!1;
a.bFiltered=!1;
a.bDrawing=!1;
a.oFeatures.bServerSide&&(E(a,!1),a._bInitComplete||$(a))
}}function aa(a){a.oFeatures.bSort?O(a,a.oPreviousSearch):a.oFeatures.bFilter?K(a,a.oPreviousSearch):(y(a),x(a))
}function xa(a){var b=h("<div></div>")[0];
a.nTable.parentNode.insertBefore(b,a.nTable);
a.nTableWrapper=h('<div id="'+a.sTableId+'_wrapper" class="'+a.oClasses.sWrapper+'" role="grid"></div>')[0];
a.nTableReinsertBefore=a.nTable.nextSibling;
for(var c=a.nTableWrapper,d=a.sDom.split(""),i,f,g,e,w,o,k,m=0;
m<d.length;
m++){f=0;
g=d[m];
if("<"==g){e=h("<div></div>")[0];
w=d[m+1];
if("'"==w||'"'==w){o="";
for(k=2;
d[m+k]!=w;
){o+=d[m+k],k++
}"H"==o?o=a.oClasses.sJUIHeader:"F"==o&&(o=a.oClasses.sJUIFooter);
-1!=o.indexOf(".")?(w=o.split("."),e.id=w[0].substr(1,w[0].length-1),e.className=w[1]):"#"==o.charAt(0)?e.id=o.substr(1,o.length-1):e.className=o;
m+=k
}c.appendChild(e);
c=e
}else{if(">"==g){c=c.parentNode
}else{if("l"==g&&a.oFeatures.bPaginate&&a.oFeatures.bLengthChange){i=ya(a),f=1
}else{if("f"==g&&a.oFeatures.bFilter){i=za(a),f=1
}else{if("r"==g&&a.oFeatures.bProcessing){i=Aa(a),f=1
}else{if("t"==g){i=Ba(a),f=1
}else{if("i"==g&&a.oFeatures.bInfo){i=Ca(a),f=1
}else{if("p"==g&&a.oFeatures.bPaginate){i=Da(a),f=1
}else{if(0!==j.ext.aoFeatures.length){e=j.ext.aoFeatures;
k=0;
for(w=e.length;
k<w;
k++){if(g==e[k].cFeature){(i=e[k].fnInit(a))&&(f=1);
break
}}}}}}}}}}}1==f&&null!==i&&("object"!==typeof a.aanFeatures[g]&&(a.aanFeatures[g]=[]),a.aanFeatures[g].push(i),c.appendChild(i))
}b.parentNode.replaceChild(a.nTableWrapper,b)
}function V(a,b){var c=h(b).children("tr"),d,i,f,g,e,j,o,k,m,p;
a.splice(0,a.length);
f=0;
for(j=c.length;
f<j;
f++){a.push([])
}f=0;
for(j=c.length;
f<j;
f++){d=c[f];
for(i=d.firstChild;
i;
){if("TD"==i.nodeName.toUpperCase()||"TH"==i.nodeName.toUpperCase()){k=1*i.getAttribute("colspan");
m=1*i.getAttribute("rowspan");
k=!k||0===k||1===k?1:k;
m=!m||0===m||1===m?1:m;
g=0;
for(e=a[f];
e[g];
){g++
}o=g;
p=1===k?!0:!1;
for(e=0;
e<k;
e++){for(g=0;
g<m;
g++){a[f+g][o+e]={cell:i,unique:p},a[f+g].nTr=d
}}}i=i.nextSibling
}}}function N(a,b,c){var d=[];
c||(c=a.aoHeader,b&&(c=[],V(c,b)));
for(var b=0,i=c.length;
b<i;
b++){for(var f=0,g=c[b].length;
f<g;
f++){if(c[b][f].unique&&(!d[f]||!a.bSortCellsTop)){d[f]=c[b][f].cell
}}}return d
}function wa(a){if(a.bAjaxDataGet){a.iDraw++;
E(a,!0);
var b=Ea(a);
ka(a,b);
a.fnServerData.call(a.oInstance,a.sAjaxSource,b,function(b){Fa(a,b)
},a);
return !1
}return !0
}function Ea(a){var b=a.aoColumns.length,c=[],d,i,f,g;
c.push({name:"sEcho",value:a.iDraw});
c.push({name:"iColumns",value:b});
c.push({name:"sColumns",value:M(a)});
c.push({name:"iDisplayStart",value:a._iDisplayStart});
c.push({name:"iDisplayLength",value:!1!==a.oFeatures.bPaginate?a._iDisplayLength:-1});
for(f=0;
f<b;
f++){d=a.aoColumns[f].mData,c.push({name:"mDataProp_"+f,value:"function"===typeof d?"function":d})
}if(!1!==a.oFeatures.bFilter){c.push({name:"sSearch",value:a.oPreviousSearch.sSearch});
c.push({name:"bRegex",value:a.oPreviousSearch.bRegex});
for(f=0;
f<b;
f++){c.push({name:"sSearch_"+f,value:a.aoPreSearchCols[f].sSearch}),c.push({name:"bRegex_"+f,value:a.aoPreSearchCols[f].bRegex}),c.push({name:"bSearchable_"+f,value:a.aoColumns[f].bSearchable})
}}if(!1!==a.oFeatures.bSort){var e=0;
d=null!==a.aaSortingFixed?a.aaSortingFixed.concat(a.aaSorting):a.aaSorting.slice();
for(f=0;
f<d.length;
f++){i=a.aoColumns[d[f][0]].aDataSort;
for(g=0;
g<i.length;
g++){c.push({name:"iSortCol_"+e,value:i[g]}),c.push({name:"sSortDir_"+e,value:d[f][1]}),e++
}}c.push({name:"iSortingCols",value:e});
for(f=0;
f<b;
f++){c.push({name:"bSortable_"+f,value:a.aoColumns[f].bSortable})
}}return c
}function ka(a,b){A(a,"aoServerParams","serverParams",[b])
}function Fa(a,b){if(b.sEcho!==n){if(1*b.sEcho<a.iDraw){return
}a.iDraw=1*b.sEcho
}(!a.oScroll.bInfinite||a.oScroll.bInfinite&&(a.bSorted||a.bFiltered))&&ga(a);
a._iRecordsTotal=parseInt(b.iTotalRecords,10);
a._iRecordsDisplay=parseInt(b.iTotalDisplayRecords,10);
var c=M(a),c=b.sColumns!==n&&""!==c&&b.sColumns!=c,d;
c&&(d=u(a,b.sColumns));
for(var i=Q(a.sAjaxDataProp)(b),f=0,g=i.length;
f<g;
f++){if(c){for(var e=[],h=0,j=a.aoColumns.length;
h<j;
h++){e.push(i[f][d[h]])
}H(a,e)
}else{H(a,i[f])
}}a.aiDisplay=a.aiDisplayMaster.slice();
a.bAjaxDataGet=!1;
x(a);
a.bAjaxDataGet=!0;
E(a,!1)
}function za(a){var b=a.oPreviousSearch,c=a.oLanguage.sSearch,c=-1!==c.indexOf("_INPUT_")?c.replace("_INPUT_",'<input type="text" />'):""===c?'<input type="text" />':c+' <input type="text" />',d=l.createElement("div");
d.className=a.oClasses.sFilter;
d.innerHTML="<label>"+c+"</label>";
a.aanFeatures.f||(d.id=a.sTableId+"_filter");
c=h('input[type="text"]',d);
d._DT_Input=c[0];
c.val(b.sSearch.replace('"',"&quot;"));
c.bind("keyup.DT",function(){for(var c=a.aanFeatures.f,d=this.value===""?"":this.value,g=0,e=c.length;
g<e;
g++){c[g]!=h(this).parents("div.dataTables_filter")[0]&&h(c[g]._DT_Input).val(d)
}d!=b.sSearch&&K(a,{sSearch:d,bRegex:b.bRegex,bSmart:b.bSmart,bCaseInsensitive:b.bCaseInsensitive})
});
c.attr("aria-controls",a.sTableId).bind("keypress.DT",function(a){if(a.keyCode==13){return false
}});
return d
}function K(a,b,c){var d=a.oPreviousSearch,i=a.aoPreSearchCols,f=function(a){d.sSearch=a.sSearch;
d.bRegex=a.bRegex;
d.bSmart=a.bSmart;
d.bCaseInsensitive=a.bCaseInsensitive
};
if(a.oFeatures.bServerSide){f(b)
}else{Ga(a,b.sSearch,c,b.bRegex,b.bSmart,b.bCaseInsensitive);
f(b);
for(b=0;
b<a.aoPreSearchCols.length;
b++){Ha(a,i[b].sSearch,b,i[b].bRegex,i[b].bSmart,i[b].bCaseInsensitive)
}Ia(a)
}a.bFiltered=!0;
h(a.oInstance).trigger("filter",a);
a._iDisplayStart=0;
y(a);
x(a);
la(a,0)
}function Ia(a){for(var b=j.ext.afnFiltering,c=r(a,"bSearchable"),d=0,i=b.length;
d<i;
d++){for(var f=0,g=0,e=a.aiDisplay.length;
g<e;
g++){var h=a.aiDisplay[g-f];
b[d](a,Y(a,h,"filter",c),h)||(a.aiDisplay.splice(g-f,1),f++)
}}}function Ha(a,b,c,d,i,f){if(""!==b){for(var g=0,b=ma(b,d,i,f),d=a.aiDisplay.length-1;
0<=d;
d--){i=Ja(v(a,a.aiDisplay[d],c,"filter"),a.aoColumns[c].sType),b.test(i)||(a.aiDisplay.splice(d,1),g++)
}}}function Ga(a,b,c,d,i,f){d=ma(b,d,i,f);
i=a.oPreviousSearch;
c||(c=0);
0!==j.ext.afnFiltering.length&&(c=1);
if(0>=b.length){a.aiDisplay.splice(0,a.aiDisplay.length),a.aiDisplay=a.aiDisplayMaster.slice()
}else{if(a.aiDisplay.length==a.aiDisplayMaster.length||i.sSearch.length>b.length||1==c||0!==b.indexOf(i.sSearch)){a.aiDisplay.splice(0,a.aiDisplay.length);
la(a,1);
for(b=0;
b<a.aiDisplayMaster.length;
b++){d.test(a.asDataSearch[b])&&a.aiDisplay.push(a.aiDisplayMaster[b])
}}else{for(b=c=0;
b<a.asDataSearch.length;
b++){d.test(a.asDataSearch[b])||(a.aiDisplay.splice(b-c,1),c++)
}}}}function la(a,b){if(!a.oFeatures.bServerSide){a.asDataSearch=[];
for(var c=r(a,"bSearchable"),d=1===b?a.aiDisplayMaster:a.aiDisplay,i=0,f=d.length;
i<f;
i++){a.asDataSearch[i]=na(a,Y(a,d[i],"filter",c))
}}}function na(a,b){var c=b.join("  ");
-1!==c.indexOf("&")&&(c=h("<div>").html(c).text());
return c.replace(/[\n\r]/g," ")
}function ma(a,b,c,d){if(c){return a=b?a.split(" "):oa(a).split(" "),a="^(?=.*?"+a.join(")(?=.*?")+").*$",RegExp(a,d?"i":"")
}a=b?a:oa(a);
return RegExp(a,d?"i":"")
}function Ja(a,b){return"function"===typeof j.ext.ofnSearch[b]?j.ext.ofnSearch[b](a):null===a?"":"html"==b?a.replace(/[\r\n]/g," ").replace(/<.*?>/g,""):"string"===typeof a?a.replace(/[\r\n]/g," "):a
}function oa(a){return a.replace(RegExp("(\\/|\\.|\\*|\\+|\\?|\\||\\(|\\)|\\[|\\]|\\{|\\}|\\\\|\\$|\\^|\\-)","g"),"\\$1")
}function Ca(a){var b=l.createElement("div");
b.className=a.oClasses.sInfo;
a.aanFeatures.i||(a.aoDrawCallback.push({fn:Ka,sName:"information"}),b.id=a.sTableId+"_info");
a.nTable.setAttribute("aria-describedby",a.sTableId+"_info");
return b
}function Ka(a){if(a.oFeatures.bInfo&&0!==a.aanFeatures.i.length){var b=a.oLanguage,c=a._iDisplayStart+1,d=a.fnDisplayEnd(),i=a.fnRecordsTotal(),f=a.fnRecordsDisplay(),g;
g=0===f?b.sInfoEmpty:b.sInfo;
f!=i&&(g+=" "+b.sInfoFiltered);
g+=b.sInfoPostFix;
g=ja(a,g);
null!==b.fnInfoCallback&&(g=b.fnInfoCallback.call(a.oInstance,a,c,d,i,f,g));
a=a.aanFeatures.i;
b=0;
for(c=a.length;
b<c;
b++){h(a[b]).html(g)
}}}function ja(a,b){var c=a.fnFormatNumber(a._iDisplayStart+1),d=a.fnDisplayEnd(),d=a.fnFormatNumber(d),i=a.fnRecordsDisplay(),i=a.fnFormatNumber(i),f=a.fnRecordsTotal(),f=a.fnFormatNumber(f);
a.oScroll.bInfinite&&(c=a.fnFormatNumber(1));
return b.replace(/_START_/g,c).replace(/_END_/g,d).replace(/_TOTAL_/g,i).replace(/_MAX_/g,f)
}function ba(a){var b,c,d=a.iInitDisplayStart;
if(!1===a.bInitialised){setTimeout(function(){ba(a)
},200)
}else{xa(a);
va(a);
W(a,a.aoHeader);
a.nTFoot&&W(a,a.aoFooter);
E(a,!0);
a.oFeatures.bAutoWidth&&da(a);
b=0;
for(c=a.aoColumns.length;
b<c;
b++){null!==a.aoColumns[b].sWidth&&(a.aoColumns[b].nTh.style.width=q(a.aoColumns[b].sWidth))
}a.oFeatures.bSort?O(a):a.oFeatures.bFilter?K(a,a.oPreviousSearch):(a.aiDisplay=a.aiDisplayMaster.slice(),y(a),x(a));
null!==a.sAjaxSource&&!a.oFeatures.bServerSide?(c=[],ka(a,c),a.fnServerData.call(a.oInstance,a.sAjaxSource,c,function(c){var f=a.sAjaxDataProp!==""?Q(a.sAjaxDataProp)(c):c;
for(b=0;
b<f.length;
b++){H(a,f[b])
}a.iInitDisplayStart=d;
if(a.oFeatures.bSort){O(a)
}else{a.aiDisplay=a.aiDisplayMaster.slice();
y(a);
x(a)
}E(a,false);
$(a,c)
},a)):a.oFeatures.bServerSide||(E(a,!1),$(a))
}}function $(a,b){a._bInitComplete=!0;
A(a,"aoInitComplete","init",[a,b])
}function pa(a){var b=j.defaults.oLanguage;
!a.sEmptyTable&&(a.sZeroRecords&&"No data available in table"===b.sEmptyTable)&&p(a,a,"sZeroRecords","sEmptyTable");
!a.sLoadingRecords&&(a.sZeroRecords&&"Loading..."===b.sLoadingRecords)&&p(a,a,"sZeroRecords","sLoadingRecords")
}function ya(a){if(a.oScroll.bInfinite){return null
}var b='<select size="1" '+('name="'+a.sTableId+'_length"')+">",c,d,i=a.aLengthMenu;
if(2==i.length&&"object"===typeof i[0]&&"object"===typeof i[1]){c=0;
for(d=i[0].length;
c<d;
c++){b+='<option value="'+i[0][c]+'">'+i[1][c]+"</option>"
}}else{c=0;
for(d=i.length;
c<d;
c++){b+='<option value="'+i[c]+'">'+i[c]+"</option>"
}}b+="</select>";
i=l.createElement("div");
a.aanFeatures.l||(i.id=a.sTableId+"_length");
i.className=a.oClasses.sLength;
i.innerHTML="<label>"+a.oLanguage.sLengthMenu.replace("_MENU_",b)+"</label>";
h('select option[value="'+a._iDisplayLength+'"]',i).attr("selected",!0);
h("select",i).bind("change.DT",function(){var b=h(this).val(),i=a.aanFeatures.l;
c=0;
for(d=i.length;
c<d;
c++){i[c]!=this.parentNode&&h("select",i[c]).val(b)
}a._iDisplayLength=parseInt(b,10);
y(a);
if(a.fnDisplayEnd()==a.fnRecordsDisplay()){a._iDisplayStart=a.fnDisplayEnd()-a._iDisplayLength;
if(a._iDisplayStart<0){a._iDisplayStart=0
}}if(a._iDisplayLength==-1){a._iDisplayStart=0
}x(a)
});
h("select",i).attr("aria-controls",a.sTableId);
return i
}function y(a){a._iDisplayEnd=!1===a.oFeatures.bPaginate?a.aiDisplay.length:a._iDisplayStart+a._iDisplayLength>a.aiDisplay.length||-1==a._iDisplayLength?a.aiDisplay.length:a._iDisplayStart+a._iDisplayLength
}function Da(a){if(a.oScroll.bInfinite){return null
}var b=l.createElement("div");
b.className=a.oClasses.sPaging+a.sPaginationType;
j.ext.oPagination[a.sPaginationType].fnInit(a,b,function(a){y(a);
x(a)
});
a.aanFeatures.p||a.aoDrawCallback.push({fn:function(a){j.ext.oPagination[a.sPaginationType].fnUpdate(a,function(a){y(a);
x(a)
})
},sName:"pagination"});
return b
}function qa(a,b){var c=a._iDisplayStart;
if("number"===typeof b){a._iDisplayStart=b*a._iDisplayLength,a._iDisplayStart>a.fnRecordsDisplay()&&(a._iDisplayStart=0)
}else{if("first"==b){a._iDisplayStart=0
}else{if("previous"==b){a._iDisplayStart=0<=a._iDisplayLength?a._iDisplayStart-a._iDisplayLength:0,0>a._iDisplayStart&&(a._iDisplayStart=0)
}else{if("next"==b){0<=a._iDisplayLength?a._iDisplayStart+a._iDisplayLength<a.fnRecordsDisplay()&&(a._iDisplayStart+=a._iDisplayLength):a._iDisplayStart=0
}else{if("last"==b){if(0<=a._iDisplayLength){var d=parseInt((a.fnRecordsDisplay()-1)/a._iDisplayLength,10)+1;
a._iDisplayStart=(d-1)*a._iDisplayLength
}else{a._iDisplayStart=0
}}else{D(a,0,"Unknown paging action: "+b)
}}}}}h(a.oInstance).trigger("page",a);
return c!=a._iDisplayStart
}function Aa(a){var b=l.createElement("div");
a.aanFeatures.r||(b.id=a.sTableId+"_processing");
b.innerHTML=a.oLanguage.sProcessing;
b.className=a.oClasses.sProcessing;
a.nTable.parentNode.insertBefore(b,a.nTable);
return b
}function E(a,b){if(a.oFeatures.bProcessing){for(var c=a.aanFeatures.r,d=0,i=c.length;
d<i;
d++){c[d].style.visibility=b?"visible":"hidden"
}}h(a.oInstance).trigger("processing",[a,b])
}function Ba(a){if(""===a.oScroll.sX&&""===a.oScroll.sY){return a.nTable
}var b=l.createElement("div"),c=l.createElement("div"),d=l.createElement("div"),i=l.createElement("div"),f=l.createElement("div"),g=l.createElement("div"),e=a.nTable.cloneNode(!1),j=a.nTable.cloneNode(!1),o=a.nTable.getElementsByTagName("thead")[0],k=0===a.nTable.getElementsByTagName("tfoot").length?null:a.nTable.getElementsByTagName("tfoot")[0],m=a.oClasses;
c.appendChild(d);
f.appendChild(g);
i.appendChild(a.nTable);
b.appendChild(c);
b.appendChild(i);
d.appendChild(e);
e.appendChild(o);
null!==k&&(b.appendChild(f),g.appendChild(j),j.appendChild(k));
b.className=m.sScrollWrapper;
c.className=m.sScrollHead;
d.className=m.sScrollHeadInner;
i.className=m.sScrollBody;
f.className=m.sScrollFoot;
g.className=m.sScrollFootInner;
a.oScroll.bAutoCss&&(c.style.overflow="hidden",c.style.position="relative",f.style.overflow="hidden",i.style.overflow="auto");
c.style.border="0";
c.style.width="100%";
f.style.border="0";
d.style.width=""!==a.oScroll.sXInner?a.oScroll.sXInner:"100%";
e.removeAttribute("id");
e.style.marginLeft="0";
a.nTable.style.marginLeft="0";
null!==k&&(j.removeAttribute("id"),j.style.marginLeft="0");
d=h(a.nTable).children("caption");
0<d.length&&(d=d[0],"top"===d._captionSide?e.appendChild(d):"bottom"===d._captionSide&&k&&j.appendChild(d));
""!==a.oScroll.sX&&(c.style.width=q(a.oScroll.sX),i.style.width=q(a.oScroll.sX),null!==k&&(f.style.width=q(a.oScroll.sX)),h(i).scroll(function(){c.scrollLeft=this.scrollLeft;
if(k!==null){f.scrollLeft=this.scrollLeft
}}));
""!==a.oScroll.sY&&(i.style.height=q(a.oScroll.sY));
a.aoDrawCallback.push({fn:La,sName:"scrolling"});
a.oScroll.bInfinite&&h(i).scroll(function(){if(!a.bDrawing&&h(this).scrollTop()!==0&&h(this).scrollTop()+h(this).height()>h(a.nTable).height()-a.oScroll.iLoadGap&&a.fnDisplayEnd()<a.fnRecordsDisplay()){qa(a,"next");
y(a);
x(a)
}});
a.nScrollHead=c;
a.nScrollFoot=f;
return b
}function La(a){var b=a.nScrollHead.getElementsByTagName("div")[0],c=b.getElementsByTagName("table")[0],d=a.nTable.parentNode,i,f,g,e,j,o,k,m,p=[],n=[],l=null!==a.nTFoot?a.nScrollFoot.getElementsByTagName("div")[0]:null,R=null!==a.nTFoot?l.getElementsByTagName("table")[0]:null,r=a.oBrowser.bScrollOversize,s=function(a){k=a.style;
k.paddingTop="0";
k.paddingBottom="0";
k.borderTopWidth="0";
k.borderBottomWidth="0";
k.height=0
};
h(a.nTable).children("thead, tfoot").remove();
i=h(a.nTHead).clone()[0];
a.nTable.insertBefore(i,a.nTable.childNodes[0]);
g=a.nTHead.getElementsByTagName("tr");
e=i.getElementsByTagName("tr");
null!==a.nTFoot&&(j=h(a.nTFoot).clone()[0],a.nTable.insertBefore(j,a.nTable.childNodes[1]),o=a.nTFoot.getElementsByTagName("tr"),j=j.getElementsByTagName("tr"));
""===a.oScroll.sX&&(d.style.width="100%",b.parentNode.style.width="100%");
var t=N(a,i);
i=0;
for(f=t.length;
i<f;
i++){m=G(a,i),t[i].style.width=a.aoColumns[m].sWidth
}null!==a.nTFoot&&C(function(a){a.style.width=""
},j);
a.oScroll.bCollapse&&""!==a.oScroll.sY&&(d.style.height=d.offsetHeight+a.nTHead.offsetHeight+"px");
i=h(a.nTable).outerWidth();
if(""===a.oScroll.sX){if(a.nTable.style.width="100%",r&&(h("tbody",d).height()>d.offsetHeight||"scroll"==h(d).css("overflow-y"))){a.nTable.style.width=q(h(a.nTable).outerWidth()-a.oScroll.iBarWidth)
}}else{""!==a.oScroll.sXInner?a.nTable.style.width=q(a.oScroll.sXInner):i==h(d).width()&&h(d).height()<h(a.nTable).height()?(a.nTable.style.width=q(i-a.oScroll.iBarWidth),h(a.nTable).outerWidth()>i-a.oScroll.iBarWidth&&(a.nTable.style.width=q(i))):a.nTable.style.width=q(i)
}i=h(a.nTable).outerWidth();
C(s,e);
C(function(a){p.push(q(h(a).width()))
},e);
C(function(a,b){a.style.width=p[b]
},g);
h(e).height(0);
null!==a.nTFoot&&(C(s,j),C(function(a){n.push(q(h(a).width()))
},j),C(function(a,b){a.style.width=n[b]
},o),h(j).height(0));
C(function(a,b){a.innerHTML="";
a.style.width=p[b]
},e);
null!==a.nTFoot&&C(function(a,b){a.innerHTML="";
a.style.width=n[b]
},j);
if(h(a.nTable).outerWidth()<i){g=d.scrollHeight>d.offsetHeight||"scroll"==h(d).css("overflow-y")?i+a.oScroll.iBarWidth:i;
if(r&&(d.scrollHeight>d.offsetHeight||"scroll"==h(d).css("overflow-y"))){a.nTable.style.width=q(g-a.oScroll.iBarWidth)
}d.style.width=q(g);
a.nScrollHead.style.width=q(g);
null!==a.nTFoot&&(a.nScrollFoot.style.width=q(g));
""===a.oScroll.sX?D(a,1,"The table cannot fit into the current element which will cause column misalignment. The table has been drawn at its minimum possible width."):""!==a.oScroll.sXInner&&D(a,1,"The table cannot fit into the current element which will cause column misalignment. Increase the sScrollXInner value or remove it to allow automatic calculation")
}else{d.style.width=q("100%"),a.nScrollHead.style.width=q("100%"),null!==a.nTFoot&&(a.nScrollFoot.style.width=q("100%"))
}""===a.oScroll.sY&&r&&(d.style.height=q(a.nTable.offsetHeight+a.oScroll.iBarWidth));
""!==a.oScroll.sY&&a.oScroll.bCollapse&&(d.style.height=q(a.oScroll.sY),r=""!==a.oScroll.sX&&a.nTable.offsetWidth>d.offsetWidth?a.oScroll.iBarWidth:0,a.nTable.offsetHeight<d.offsetHeight&&(d.style.height=q(a.nTable.offsetHeight+r)));
r=h(a.nTable).outerWidth();
c.style.width=q(r);
b.style.width=q(r);
c=h(a.nTable).height()>d.clientHeight||"scroll"==h(d).css("overflow-y");
b.style.paddingRight=c?a.oScroll.iBarWidth+"px":"0px";
null!==a.nTFoot&&(R.style.width=q(r),l.style.width=q(r),l.style.paddingRight=c?a.oScroll.iBarWidth+"px":"0px");
h(d).scroll();
if(a.bSorted||a.bFiltered){d.scrollTop=0
}}function C(a,b,c){for(var d=0,i=0,f=b.length,g,e;
i<f;
){g=b[i].firstChild;
for(e=c?c[i].firstChild:null;
g;
){1===g.nodeType&&(c?a(g,e,d):a(g,d),d++),g=g.nextSibling,e=c?e.nextSibling:null
}i++
}}function Ma(a,b){if(!a||null===a||""===a){return 0
}b||(b=l.body);
var c,d=l.createElement("div");
d.style.width=q(a);
b.appendChild(d);
c=d.offsetWidth;
b.removeChild(d);
return c
}function da(a){var b=0,c,d=0,i=a.aoColumns.length,f,e,j=h("th",a.nTHead),o=a.nTable.getAttribute("width");
e=a.nTable.parentNode;
for(f=0;
f<i;
f++){a.aoColumns[f].bVisible&&(d++,null!==a.aoColumns[f].sWidth&&(c=Ma(a.aoColumns[f].sWidthOrig,e),null!==c&&(a.aoColumns[f].sWidth=q(c)),b++))
}if(i==j.length&&0===b&&d==i&&""===a.oScroll.sX&&""===a.oScroll.sY){for(f=0;
f<a.aoColumns.length;
f++){c=h(j[f]).width(),null!==c&&(a.aoColumns[f].sWidth=q(c))
}}else{b=a.nTable.cloneNode(!1);
f=a.nTHead.cloneNode(!0);
d=l.createElement("tbody");
c=l.createElement("tr");
b.removeAttribute("id");
b.appendChild(f);
null!==a.nTFoot&&(b.appendChild(a.nTFoot.cloneNode(!0)),C(function(a){a.style.width=""
},b.getElementsByTagName("tr")));
b.appendChild(d);
d.appendChild(c);
d=h("thead th",b);
0===d.length&&(d=h("tbody tr:eq(0)>td",b));
j=N(a,f);
for(f=d=0;
f<i;
f++){var k=a.aoColumns[f];
k.bVisible&&null!==k.sWidthOrig&&""!==k.sWidthOrig?j[f-d].style.width=q(k.sWidthOrig):k.bVisible?j[f-d].style.width="":d++
}for(f=0;
f<i;
f++){a.aoColumns[f].bVisible&&(d=Na(a,f),null!==d&&(d=d.cloneNode(!0),""!==a.aoColumns[f].sContentPadding&&(d.innerHTML+=a.aoColumns[f].sContentPadding),c.appendChild(d)))
}e.appendChild(b);
""!==a.oScroll.sX&&""!==a.oScroll.sXInner?b.style.width=q(a.oScroll.sXInner):""!==a.oScroll.sX?(b.style.width="",h(b).width()<e.offsetWidth&&(b.style.width=q(e.offsetWidth))):""!==a.oScroll.sY?b.style.width=q(e.offsetWidth):o&&(b.style.width=q(o));
b.style.visibility="hidden";
Oa(a,b);
i=h("tbody tr:eq(0)",b).children();
0===i.length&&(i=N(a,h("thead",b)[0]));
if(""!==a.oScroll.sX){for(f=d=e=0;
f<a.aoColumns.length;
f++){a.aoColumns[f].bVisible&&(e=null===a.aoColumns[f].sWidthOrig?e+h(i[d]).outerWidth():e+(parseInt(a.aoColumns[f].sWidth.replace("px",""),10)+(h(i[d]).outerWidth()-h(i[d]).width())),d++)
}b.style.width=q(e);
a.nTable.style.width=q(e)
}for(f=d=0;
f<a.aoColumns.length;
f++){a.aoColumns[f].bVisible&&(e=h(i[d]).width(),null!==e&&0<e&&(a.aoColumns[f].sWidth=q(e)),d++)
}i=h(b).css("width");
a.nTable.style.width=-1!==i.indexOf("%")?i:q(h(b).outerWidth());
b.parentNode.removeChild(b)
}o&&(a.nTable.style.width=q(o))
}function Oa(a,b){""===a.oScroll.sX&&""!==a.oScroll.sY?(h(b).width(),b.style.width=q(h(b).outerWidth()-a.oScroll.iBarWidth)):""!==a.oScroll.sX&&(b.style.width=q(h(b).outerWidth()))
}function Na(a,b){var c=Pa(a,b);
if(0>c){return null
}if(null===a.aoData[c].nTr){var d=l.createElement("td");
d.innerHTML=v(a,c,b,"");
return d
}return J(a,c)[b]
}function Pa(a,b){for(var c=-1,d=-1,i=0;
i<a.aoData.length;
i++){var e=v(a,i,b,"display")+"",e=e.replace(/<.*?>/g,"");
e.length>c&&(c=e.length,d=i)
}return d
}function q(a){if(null===a){return"0px"
}if("number"==typeof a){return 0>a?"0px":a+"px"
}var b=a.charCodeAt(a.length-1);
return 48>b||57<b?a:a+"px"
}function Qa(){var a=l.createElement("p"),b=a.style;
b.width="100%";
b.height="200px";
b.padding="0px";
var c=l.createElement("div"),b=c.style;
b.position="absolute";
b.top="0px";
b.left="0px";
b.visibility="hidden";
b.width="200px";
b.height="150px";
b.padding="0px";
b.overflow="hidden";
c.appendChild(a);
l.body.appendChild(c);
b=a.offsetWidth;
c.style.overflow="scroll";
a=a.offsetWidth;
b==a&&(a=c.clientWidth);
l.body.removeChild(c);
return b-a
}function O(a,b){var c,d,i,e,g,k,o=[],m=[],p=j.ext.oSort,l=a.aoData,q=a.aoColumns,G=a.oLanguage.oAria;
if(!a.oFeatures.bServerSide&&(0!==a.aaSorting.length||null!==a.aaSortingFixed)){o=null!==a.aaSortingFixed?a.aaSortingFixed.concat(a.aaSorting):a.aaSorting.slice();
for(c=0;
c<o.length;
c++){if(d=o[c][0],i=R(a,d),e=a.aoColumns[d].sSortDataType,j.ext.afnSortData[e]){if(g=j.ext.afnSortData[e].call(a.oInstance,a,d,i),g.length===l.length){i=0;
for(e=l.length;
i<e;
i++){F(a,i,d,g[i])
}}else{D(a,0,"Returned data sort array (col "+d+") is the wrong length")
}}}c=0;
for(d=a.aiDisplayMaster.length;
c<d;
c++){m[a.aiDisplayMaster[c]]=c
}var r=o.length,s;
c=0;
for(d=l.length;
c<d;
c++){for(i=0;
i<r;
i++){s=q[o[i][0]].aDataSort;
g=0;
for(k=s.length;
g<k;
g++){e=q[s[g]].sType,e=p[(e?e:"string")+"-pre"],l[c]._aSortData[s[g]]=e?e(v(a,c,s[g],"sort")):v(a,c,s[g],"sort")
}}}a.aiDisplayMaster.sort(function(a,b){var c,d,e,i,f;
for(c=0;
c<r;
c++){f=q[o[c][0]].aDataSort;
d=0;
for(e=f.length;
d<e;
d++){if(i=q[f[d]].sType,i=p[(i?i:"string")+"-"+o[c][1]](l[a]._aSortData[f[d]],l[b]._aSortData[f[d]]),0!==i){return i
}}}return p["numeric-asc"](m[a],m[b])
})
}(b===n||b)&&!a.oFeatures.bDeferRender&&P(a);
c=0;
for(d=a.aoColumns.length;
c<d;
c++){e=q[c].sTitle.replace(/<.*?>/g,""),i=q[c].nTh,i.removeAttribute("aria-sort"),i.removeAttribute("aria-label"),q[c].bSortable?0<o.length&&o[0][0]==c?(i.setAttribute("aria-sort","asc"==o[0][1]?"ascending":"descending"),i.setAttribute("aria-label",e+("asc"==(q[c].asSorting[o[0][2]+1]?q[c].asSorting[o[0][2]+1]:q[c].asSorting[0])?G.sSortAscending:G.sSortDescending))):i.setAttribute("aria-label",e+("asc"==q[c].asSorting[0]?G.sSortAscending:G.sSortDescending)):i.setAttribute("aria-label",e)
}a.bSorted=!0;
h(a.oInstance).trigger("sort",a);
a.oFeatures.bFilter?K(a,a.oPreviousSearch,1):(a.aiDisplay=a.aiDisplayMaster.slice(),a._iDisplayStart=0,y(a),x(a))
}function ia(a,b,c,d){Ra(b,{},function(b){if(!1!==a.aoColumns[c].bSortable){var e=function(){var d,e;
if(b.shiftKey){for(var f=!1,h=0;
h<a.aaSorting.length;
h++){if(a.aaSorting[h][0]==c){f=!0;
d=a.aaSorting[h][0];
e=a.aaSorting[h][2]+1;
a.aoColumns[d].asSorting[e]?(a.aaSorting[h][1]=a.aoColumns[d].asSorting[e],a.aaSorting[h][2]=e):a.aaSorting.splice(h,1);
break
}}!1===f&&a.aaSorting.push([c,a.aoColumns[c].asSorting[0],0])
}else{1==a.aaSorting.length&&a.aaSorting[0][0]==c?(d=a.aaSorting[0][0],e=a.aaSorting[0][2]+1,a.aoColumns[d].asSorting[e]||(e=0),a.aaSorting[0][1]=a.aoColumns[d].asSorting[e],a.aaSorting[0][2]=e):(a.aaSorting.splice(0,a.aaSorting.length),a.aaSorting.push([c,a.aoColumns[c].asSorting[0],0]))
}O(a)
};
a.oFeatures.bProcessing?(E(a,!0),setTimeout(function(){e();
a.oFeatures.bServerSide||E(a,!1)
},0)):e();
"function"==typeof d&&d(a)
}})
}function P(a){var b,c,d,e,f,g=a.aoColumns.length,j=a.oClasses;
for(b=0;
b<g;
b++){a.aoColumns[b].bSortable&&h(a.aoColumns[b].nTh).removeClass(j.sSortAsc+" "+j.sSortDesc+" "+a.aoColumns[b].sSortingClass)
}c=null!==a.aaSortingFixed?a.aaSortingFixed.concat(a.aaSorting):a.aaSorting.slice();
for(b=0;
b<a.aoColumns.length;
b++){if(a.aoColumns[b].bSortable){f=a.aoColumns[b].sSortingClass;
e=-1;
for(d=0;
d<c.length;
d++){if(c[d][0]==b){f="asc"==c[d][1]?j.sSortAsc:j.sSortDesc;
e=d;
break
}}h(a.aoColumns[b].nTh).addClass(f);
a.bJUI&&(f=h("span."+j.sSortIcon,a.aoColumns[b].nTh),f.removeClass(j.sSortJUIAsc+" "+j.sSortJUIDesc+" "+j.sSortJUI+" "+j.sSortJUIAscAllowed+" "+j.sSortJUIDescAllowed),f.addClass(-1==e?a.aoColumns[b].sSortingClassJUI:"asc"==c[e][1]?j.sSortJUIAsc:j.sSortJUIDesc))
}else{h(a.aoColumns[b].nTh).addClass(a.aoColumns[b].sSortingClass)
}}f=j.sSortColumn;
if(a.oFeatures.bSort&&a.oFeatures.bSortClasses){a=J(a);
e=[];
for(b=0;
b<g;
b++){e.push("")
}b=0;
for(d=1;
b<c.length;
b++){j=parseInt(c[b][0],10),e[j]=f+d,3>d&&d++
}f=RegExp(f+"[123]");
var o;
b=0;
for(c=a.length;
b<c;
b++){j=b%g,d=a[b].className,o=e[j],j=d.replace(f,o),j!=d?a[b].className=h.trim(j):0<o.length&&-1==d.indexOf(o)&&(a[b].className=d+" "+o)
}}}function ra(a){if(a.oFeatures.bStateSave&&!a.bDestroying){var b,c;
b=a.oScroll.bInfinite;
var d={iCreate:(new Date).getTime(),iStart:b?0:a._iDisplayStart,iEnd:b?a._iDisplayLength:a._iDisplayEnd,iLength:a._iDisplayLength,aaSorting:h.extend(!0,[],a.aaSorting),oSearch:h.extend(!0,{},a.oPreviousSearch),aoSearchCols:h.extend(!0,[],a.aoPreSearchCols),abVisCols:[]};
b=0;
for(c=a.aoColumns.length;
b<c;
b++){d.abVisCols.push(a.aoColumns[b].bVisible)
}A(a,"aoStateSaveParams","stateSaveParams",[a,d]);
a.fnStateSave.call(a.oInstance,a,d)
}}function Sa(a,b){if(a.oFeatures.bStateSave){var c=a.fnStateLoad.call(a.oInstance,a);
if(c){var d=A(a,"aoStateLoadParams","stateLoadParams",[a,c]);
if(-1===h.inArray(!1,d)){a.oLoadedState=h.extend(!0,{},c);
a._iDisplayStart=c.iStart;
a.iInitDisplayStart=c.iStart;
a._iDisplayEnd=c.iEnd;
a._iDisplayLength=c.iLength;
a.aaSorting=c.aaSorting.slice();
a.saved_aaSorting=c.aaSorting.slice();
h.extend(a.oPreviousSearch,c.oSearch);
h.extend(!0,a.aoPreSearchCols,c.aoSearchCols);
b.saved_aoColumns=[];
for(d=0;
d<c.abVisCols.length;
d++){b.saved_aoColumns[d]={},b.saved_aoColumns[d].bVisible=c.abVisCols[d]
}A(a,"aoStateLoaded","stateLoaded",[a,c])
}}}}function s(a){for(var b=0;
b<j.settings.length;
b++){if(j.settings[b].nTable===a){return j.settings[b]
}}return null
}function T(a){for(var b=[],a=a.aoData,c=0,d=a.length;
c<d;
c++){null!==a[c].nTr&&b.push(a[c].nTr)
}return b
}function J(a,b){var c=[],d,e,f,g,h,j;
e=0;
var o=a.aoData.length;
b!==n&&(e=b,o=b+1);
for(f=e;
f<o;
f++){if(j=a.aoData[f],null!==j.nTr){e=[];
for(d=j.nTr.firstChild;
d;
){g=d.nodeName.toLowerCase(),("td"==g||"th"==g)&&e.push(d),d=d.nextSibling
}g=d=0;
for(h=a.aoColumns.length;
g<h;
g++){a.aoColumns[g].bVisible?c.push(e[g-d]):(c.push(j._anHidden[g]),d++)
}}}return c
}function D(a,b,c){a=null===a?"DataTables warning: "+c:"DataTables warning (table id = '"+a.sTableId+"'): "+c;
if(0===b){if("alert"==j.ext.sErrMode){alert(a)
}else{throw Error(a)
}}else{X.console&&console.log&&console.log(a)
}}function p(a,b,c,d){d===n&&(d=c);
b[c]!==n&&(a[d]=b[c])
}function Ta(a,b){var c,d;
for(d in b){b.hasOwnProperty(d)&&(c=b[d],"object"===typeof e[d]&&null!==c&&!1===h.isArray(c)?h.extend(!0,a[d],c):a[d]=c)
}return a
}function Ra(a,b,c){h(a).bind("click.DT",b,function(b){a.blur();
c(b)
}).bind("keypress.DT",b,function(a){13===a.which&&c(a)
}).bind("selectstart.DT",function(){return !1
})
}function z(a,b,c,d){c&&a[b].push({fn:c,sName:d})
}function A(a,b,c,d){for(var b=a[b],e=[],f=b.length-1;
0<=f;
f--){e.push(b[f].fn.apply(a.oInstance,d))
}null!==c&&h(a.oInstance).trigger(c,d);
return e
}function Ua(a){var b=h('<div style="position:absolute; top:0; left:0; height:1px; width:1px; overflow:hidden"><div style="position:absolute; top:1px; left:1px; width:100px; overflow:scroll;"><div id="DT_BrowserTest" style="width:100%; height:10px;"></div></div></div>')[0];
l.body.appendChild(b);
a.oBrowser.bScrollOversize=100===h("#DT_BrowserTest",b)[0].offsetWidth?!0:!1;
l.body.removeChild(b)
}function Va(a){return function(){var b=[s(this[j.ext.iApiIndex])].concat(Array.prototype.slice.call(arguments));
return j.ext.oApi[a].apply(this,b)
}
}var U=/\[.*?\]$/,Wa=X.JSON?JSON.stringify:function(a){var b=typeof a;
if("object"!==b||null===a){return"string"===b&&(a='"'+a+'"'),a+""
}var c,d,e=[],f=h.isArray(a);
for(c in a){d=a[c],b=typeof d,"string"===b?d='"'+d+'"':"object"===b&&null!==d&&(d=Wa(d)),e.push((f?"":'"'+c+'":')+d)
}return(f?"[":"{")+e+(f?"]":"}")
};
this.$=function(a,b){var c,d,e=[],f;
d=s(this[j.ext.iApiIndex]);
var g=d.aoData,o=d.aiDisplay,k=d.aiDisplayMaster;
b||(b={});
b=h.extend({},{filter:"none",order:"current",page:"all"},b);
if("current"==b.page){c=d._iDisplayStart;
for(d=d.fnDisplayEnd();
c<d;
c++){(f=g[o[c]].nTr)&&e.push(f)
}}else{if("current"==b.order&&"none"==b.filter){c=0;
for(d=k.length;
c<d;
c++){(f=g[k[c]].nTr)&&e.push(f)
}}else{if("current"==b.order&&"applied"==b.filter){c=0;
for(d=o.length;
c<d;
c++){(f=g[o[c]].nTr)&&e.push(f)
}}else{if("original"==b.order&&"none"==b.filter){c=0;
for(d=g.length;
c<d;
c++){(f=g[c].nTr)&&e.push(f)
}}else{if("original"==b.order&&"applied"==b.filter){c=0;
for(d=g.length;
c<d;
c++){f=g[c].nTr,-1!==h.inArray(c,o)&&f&&e.push(f)
}}else{D(d,1,"Unknown selection options")
}}}}}e=h(e);
c=e.filter(a);
e=e.find(a);
return h([].concat(h.makeArray(c),h.makeArray(e)))
};
this._=function(a,b){var c=[],d,e,f=this.$(a,b);
d=0;
for(e=f.length;
d<e;
d++){c.push(this.fnGetData(f[d]))
}return c
};
this.fnAddData=function(a,b){if(0===a.length){return[]
}var c=[],d,e=s(this[j.ext.iApiIndex]);
if("object"===typeof a[0]&&null!==a[0]){for(var f=0;
f<a.length;
f++){d=H(e,a[f]);
if(-1==d){return c
}c.push(d)
}}else{d=H(e,a);
if(-1==d){return c
}c.push(d)
}e.aiDisplay=e.aiDisplayMaster.slice();
(b===n||b)&&aa(e);
return c
};
this.fnAdjustColumnSizing=function(a){var b=s(this[j.ext.iApiIndex]);
k(b);
a===n||a?this.fnDraw(!1):(""!==b.oScroll.sX||""!==b.oScroll.sY)&&this.oApi._fnScrollDraw(b)
};
this.fnClearTable=function(a){var b=s(this[j.ext.iApiIndex]);
ga(b);
(a===n||a)&&x(b)
};
this.fnClose=function(a){for(var b=s(this[j.ext.iApiIndex]),c=0;
c<b.aoOpenRows.length;
c++){if(b.aoOpenRows[c].nParent==a){return(a=b.aoOpenRows[c].nTr.parentNode)&&a.removeChild(b.aoOpenRows[c].nTr),b.aoOpenRows.splice(c,1),0
}}return 1
};
this.fnDeleteRow=function(a,b,c){var d=s(this[j.ext.iApiIndex]),e,f,a="object"===typeof a?I(d,a):a,g=d.aoData.splice(a,1);
e=0;
for(f=d.aoData.length;
e<f;
e++){null!==d.aoData[e].nTr&&(d.aoData[e].nTr._DT_RowIndex=e)
}e=h.inArray(a,d.aiDisplay);
d.asDataSearch.splice(e,1);
ha(d.aiDisplayMaster,a);
ha(d.aiDisplay,a);
"function"===typeof b&&b.call(this,d,g);
d._iDisplayStart>=d.fnRecordsDisplay()&&(d._iDisplayStart-=d._iDisplayLength,0>d._iDisplayStart&&(d._iDisplayStart=0));
if(c===n||c){y(d),x(d)
}return g
};
this.fnDestroy=function(a){var b=s(this[j.ext.iApiIndex]),c=b.nTableWrapper.parentNode,d=b.nTBody,i,f,a=a===n?!1:a;
b.bDestroying=!0;
A(b,"aoDestroyCallback","destroy",[b]);
if(!a){i=0;
for(f=b.aoColumns.length;
i<f;
i++){!1===b.aoColumns[i].bVisible&&this.fnSetColumnVis(i,!0)
}}h(b.nTableWrapper).find("*").andSelf().unbind(".DT");
h("tbody>tr>td."+b.oClasses.sRowEmpty,b.nTable).parent().remove();
b.nTable!=b.nTHead.parentNode&&(h(b.nTable).children("thead").remove(),b.nTable.appendChild(b.nTHead));
b.nTFoot&&b.nTable!=b.nTFoot.parentNode&&(h(b.nTable).children("tfoot").remove(),b.nTable.appendChild(b.nTFoot));
b.nTable.parentNode.removeChild(b.nTable);
h(b.nTableWrapper).remove();
b.aaSorting=[];
b.aaSortingFixed=[];
P(b);
h(T(b)).removeClass(b.asStripeClasses.join(" "));
h("th, td",b.nTHead).removeClass([b.oClasses.sSortable,b.oClasses.sSortableAsc,b.oClasses.sSortableDesc,b.oClasses.sSortableNone].join(" "));
b.bJUI&&(h("th span."+b.oClasses.sSortIcon+", td span."+b.oClasses.sSortIcon,b.nTHead).remove(),h("th, td",b.nTHead).each(function(){var a=h("div."+b.oClasses.sSortJUIWrapper,this),c=a.contents();
h(this).append(c);
a.remove()
}));
!a&&b.nTableReinsertBefore?c.insertBefore(b.nTable,b.nTableReinsertBefore):a||c.appendChild(b.nTable);
i=0;
for(f=b.aoData.length;
i<f;
i++){null!==b.aoData[i].nTr&&d.appendChild(b.aoData[i].nTr)
}!0===b.oFeatures.bAutoWidth&&(b.nTable.style.width=q(b.sDestroyWidth));
if(f=b.asDestroyStripes.length){a=h(d).children("tr");
for(i=0;
i<f;
i++){a.filter(":nth-child("+f+"n + "+i+")").addClass(b.asDestroyStripes[i])
}}i=0;
for(f=j.settings.length;
i<f;
i++){j.settings[i]==b&&j.settings.splice(i,1)
}e=b=null
};
this.fnDraw=function(a){var b=s(this[j.ext.iApiIndex]);
!1===a?(y(b),x(b)):aa(b)
};
this.fnFilter=function(a,b,c,d,e,f){var g=s(this[j.ext.iApiIndex]);
if(g.oFeatures.bFilter){if(c===n||null===c){c=!1
}if(d===n||null===d){d=!0
}if(e===n||null===e){e=!0
}if(f===n||null===f){f=!0
}if(b===n||null===b){if(K(g,{sSearch:a+"",bRegex:c,bSmart:d,bCaseInsensitive:f},1),e&&g.aanFeatures.f){b=g.aanFeatures.f;
c=0;
for(d=b.length;
c<d;
c++){try{b[c]._DT_Input!=l.activeElement&&h(b[c]._DT_Input).val(a)
}catch(o){h(b[c]._DT_Input).val(a)
}}}}else{h.extend(g.aoPreSearchCols[b],{sSearch:a+"",bRegex:c,bSmart:d,bCaseInsensitive:f}),K(g,g.oPreviousSearch,1)
}}};
this.fnGetData=function(a,b){var c=s(this[j.ext.iApiIndex]);
if(a!==n){var d=a;
if("object"===typeof a){var e=a.nodeName.toLowerCase();
"tr"===e?d=I(c,a):"td"===e&&(d=I(c,a.parentNode),b=fa(c,d,a))
}return b!==n?v(c,d,b,""):c.aoData[d]!==n?c.aoData[d]._aData:null
}return Z(c)
};
this.fnGetNodes=function(a){var b=s(this[j.ext.iApiIndex]);
return a!==n?b.aoData[a]!==n?b.aoData[a].nTr:null:T(b)
};
this.fnGetPosition=function(a){var b=s(this[j.ext.iApiIndex]),c=a.nodeName.toUpperCase();
return"TR"==c?I(b,a):"TD"==c||"TH"==c?(c=I(b,a.parentNode),a=fa(b,c,a),[c,R(b,a),a]):null
};
this.fnIsOpen=function(a){for(var b=s(this[j.ext.iApiIndex]),c=0;
c<b.aoOpenRows.length;
c++){if(b.aoOpenRows[c].nParent==a){return !0
}}return !1
};
this.fnOpen=function(a,b,c){var d=s(this[j.ext.iApiIndex]),e=T(d);
if(-1!==h.inArray(a,e)){this.fnClose(a);
var e=l.createElement("tr"),f=l.createElement("td");
e.appendChild(f);
f.className=c;
f.colSpan=t(d);
"string"===typeof b?f.innerHTML=b:h(f).html(b);
b=h("tr",d.nTBody);
-1!=h.inArray(a,b)&&h(e).insertAfter(a);
d.aoOpenRows.push({nTr:e,nParent:a});
return e
}};
this.fnPageChange=function(a,b){var c=s(this[j.ext.iApiIndex]);
qa(c,a);
y(c);
(b===n||b)&&x(c)
};
this.fnSetColumnVis=function(a,b,c){var d=s(this[j.ext.iApiIndex]),e,f,g=d.aoColumns,h=d.aoData,o,m;
if(g[a].bVisible!=b){if(b){for(e=f=0;
e<a;
e++){g[e].bVisible&&f++
}m=f>=t(d);
if(!m){for(e=a;
e<g.length;
e++){if(g[e].bVisible){o=e;
break
}}}e=0;
for(f=h.length;
e<f;
e++){null!==h[e].nTr&&(m?h[e].nTr.appendChild(h[e]._anHidden[a]):h[e].nTr.insertBefore(h[e]._anHidden[a],J(d,e)[o]))
}}else{e=0;
for(f=h.length;
e<f;
e++){null!==h[e].nTr&&(o=J(d,e)[a],h[e]._anHidden[a]=o,o.parentNode.removeChild(o))
}}g[a].bVisible=b;
W(d,d.aoHeader);
d.nTFoot&&W(d,d.aoFooter);
e=0;
for(f=d.aoOpenRows.length;
e<f;
e++){d.aoOpenRows[e].nTr.colSpan=t(d)
}if(c===n||c){k(d),x(d)
}ra(d)
}};
this.fnSettings=function(){return s(this[j.ext.iApiIndex])
};
this.fnSort=function(a){var b=s(this[j.ext.iApiIndex]);
b.aaSorting=a;
O(b)
};
this.fnSortListener=function(a,b,c){ia(s(this[j.ext.iApiIndex]),a,b,c)
};
this.fnUpdate=function(a,b,c,d,e){var f=s(this[j.ext.iApiIndex]),b="object"===typeof b?I(f,b):b;
if(h.isArray(a)&&c===n){f.aoData[b]._aData=a.slice();
for(c=0;
c<f.aoColumns.length;
c++){this.fnUpdate(v(f,b,c),b,c,!1,!1)
}}else{if(h.isPlainObject(a)&&c===n){f.aoData[b]._aData=h.extend(!0,{},a);
for(c=0;
c<f.aoColumns.length;
c++){this.fnUpdate(v(f,b,c),b,c,!1,!1)
}}else{F(f,b,c,a);
var a=v(f,b,c,"display"),g=f.aoColumns[c];
null!==g.fnRender&&(a=S(f,b,c),g.bUseRendered&&F(f,b,c,a));
null!==f.aoData[b].nTr&&(J(f,b)[c].innerHTML=a)
}}c=h.inArray(b,f.aiDisplay);
f.asDataSearch[c]=na(f,Y(f,b,"filter",r(f,"bSearchable")));
(e===n||e)&&k(f);
(d===n||d)&&aa(f);
return 0
};
this.fnVersionCheck=j.ext.fnVersionCheck;
this.oApi={_fnExternApiFunc:Va,_fnInitialise:ba,_fnInitComplete:$,_fnLanguageCompat:pa,_fnAddColumn:o,_fnColumnOptions:m,_fnAddData:H,_fnCreateTr:ea,_fnGatherData:ua,_fnBuildHead:va,_fnDrawHead:W,_fnDraw:x,_fnReDraw:aa,_fnAjaxUpdate:wa,_fnAjaxParameters:Ea,_fnAjaxUpdateDraw:Fa,_fnServerParams:ka,_fnAddOptionsHtml:xa,_fnFeatureHtmlTable:Ba,_fnScrollDraw:La,_fnAdjustColumnSizing:k,_fnFeatureHtmlFilter:za,_fnFilterComplete:K,_fnFilterCustom:Ia,_fnFilterColumn:Ha,_fnFilter:Ga,_fnBuildSearchArray:la,_fnBuildSearchRow:na,_fnFilterCreateSearch:ma,_fnDataToSearch:Ja,_fnSort:O,_fnSortAttachListener:ia,_fnSortingClasses:P,_fnFeatureHtmlPaginate:Da,_fnPageChange:qa,_fnFeatureHtmlInfo:Ca,_fnUpdateInfo:Ka,_fnFeatureHtmlLength:ya,_fnFeatureHtmlProcessing:Aa,_fnProcessingDisplay:E,_fnVisibleToColumnIndex:G,_fnColumnIndexToVisible:R,_fnNodeToDataIndex:I,_fnVisbleColumns:t,_fnCalculateEnd:y,_fnConvertToWidth:Ma,_fnCalculateColumnWidths:da,_fnScrollingWidthAdjust:Oa,_fnGetWidestNode:Na,_fnGetMaxLenString:Pa,_fnStringToCss:q,_fnDetectType:B,_fnSettingsFromNode:s,_fnGetDataMaster:Z,_fnGetTrNodes:T,_fnGetTdNodes:J,_fnEscapeRegex:oa,_fnDeleteIndex:ha,_fnReOrderIndex:u,_fnColumnOrdering:M,_fnLog:D,_fnClearTable:ga,_fnSaveState:ra,_fnLoadState:Sa,_fnCreateCookie:function(a,b,c,d,e){var f=new Date;
f.setTime(f.getTime()+1000*c);
var c=X.location.pathname.split("/"),a=a+"_"+c.pop().replace(/[\/:]/g,"").toLowerCase(),g;
null!==e?(g="function"===typeof h.parseJSON?h.parseJSON(b):eval("("+b+")"),b=e(a,g,f.toGMTString(),c.join("/")+"/")):b=a+"="+encodeURIComponent(b)+"; expires="+f.toGMTString()+"; path="+c.join("/")+"/";
a=l.cookie.split(";");
e=b.split(";")[0].length;
f=[];
if(4096<e+l.cookie.length+10){for(var j=0,o=a.length;
j<o;
j++){if(-1!=a[j].indexOf(d)){var k=a[j].split("=");
try{(g=eval("("+decodeURIComponent(k[1])+")"))&&g.iCreate&&f.push({name:k[0],time:g.iCreate})
}catch(m){}}}for(f.sort(function(a,b){return b.time-a.time
});
4096<e+l.cookie.length+10;
){if(0===f.length){return
}d=f.pop();
l.cookie=d.name+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path="+c.join("/")+"/"
}}l.cookie=b
},_fnReadCookie:function(a){for(var b=X.location.pathname.split("/"),a=a+"_"+b[b.length-1].replace(/[\/:]/g,"").toLowerCase()+"=",b=l.cookie.split(";"),c=0;
c<b.length;
c++){for(var d=b[c];
" "==d.charAt(0);
){d=d.substring(1,d.length)
}if(0===d.indexOf(a)){return decodeURIComponent(d.substring(a.length,d.length))
}}return null
},_fnDetectHeader:V,_fnGetUniqueThs:N,_fnScrollBarWidth:Qa,_fnApplyToChildren:C,_fnMap:p,_fnGetRowData:Y,_fnGetCellData:v,_fnSetCellData:F,_fnGetObjectDataFn:Q,_fnSetObjectDataFn:L,_fnApplyColumnDefs:ta,_fnBindAction:Ra,_fnExtend:Ta,_fnCallbackReg:z,_fnCallbackFire:A,_fnJsonString:Wa,_fnRender:S,_fnNodeToColumnIndex:fa,_fnInfoMacros:ja,_fnBrowserDetect:Ua,_fnGetColumns:r};
h.extend(j.ext.oApi,this.oApi);
for(var sa in j.ext.oApi){sa&&(this[sa]=Va(sa))
}var ca=this;
this.each(function(){var a=0,b,c,d;
c=this.getAttribute("id");
var i=!1,f=!1;
if("table"!=this.nodeName.toLowerCase()){D(null,0,"Attempted to initialise DataTables on a node which is not a table: "+this.nodeName)
}else{a=0;
for(b=j.settings.length;
a<b;
a++){if(j.settings[a].nTable==this){if(e===n||e.bRetrieve){return j.settings[a].oInstance
}if(e.bDestroy){j.settings[a].oInstance.fnDestroy();
break
}else{D(j.settings[a],0,"Cannot reinitialise DataTable.\n\nTo retrieve the DataTables object for this table, pass no arguments or see the docs for bRetrieve and bDestroy");
return
}}if(j.settings[a].sTableId==this.id){j.settings.splice(a,1);
break
}}if(null===c||""===c){this.id=c="DataTables_Table_"+j.ext._oExternConfig.iNextUnique++
}var g=h.extend(!0,{},j.models.oSettings,{nTable:this,oApi:ca.oApi,oInit:e,sDestroyWidth:h(this).width(),sInstance:c,sTableId:c});
j.settings.push(g);
g.oInstance=1===ca.length?ca:h(this).dataTable();
e||(e={});
e.oLanguage&&pa(e.oLanguage);
e=Ta(h.extend(!0,{},j.defaults),e);
p(g.oFeatures,e,"bPaginate");
p(g.oFeatures,e,"bLengthChange");
p(g.oFeatures,e,"bFilter");
p(g.oFeatures,e,"bSort");
p(g.oFeatures,e,"bInfo");
p(g.oFeatures,e,"bProcessing");
p(g.oFeatures,e,"bAutoWidth");
p(g.oFeatures,e,"bSortClasses");
p(g.oFeatures,e,"bServerSide");
p(g.oFeatures,e,"bDeferRender");
p(g.oScroll,e,"sScrollX","sX");
p(g.oScroll,e,"sScrollXInner","sXInner");
p(g.oScroll,e,"sScrollY","sY");
p(g.oScroll,e,"bScrollCollapse","bCollapse");
p(g.oScroll,e,"bScrollInfinite","bInfinite");
p(g.oScroll,e,"iScrollLoadGap","iLoadGap");
p(g.oScroll,e,"bScrollAutoCss","bAutoCss");
p(g,e,"asStripeClasses");
p(g,e,"asStripClasses","asStripeClasses");
p(g,e,"fnServerData");
p(g,e,"fnFormatNumber");
p(g,e,"sServerMethod");
p(g,e,"aaSorting");
p(g,e,"aaSortingFixed");
p(g,e,"aLengthMenu");
p(g,e,"sPaginationType");
p(g,e,"sAjaxSource");
p(g,e,"sAjaxDataProp");
p(g,e,"iCookieDuration");
p(g,e,"sCookiePrefix");
p(g,e,"sDom");
p(g,e,"bSortCellsTop");
p(g,e,"iTabIndex");
p(g,e,"oSearch","oPreviousSearch");
p(g,e,"aoSearchCols","aoPreSearchCols");
p(g,e,"iDisplayLength","_iDisplayLength");
p(g,e,"bJQueryUI","bJUI");
p(g,e,"fnCookieCallback");
p(g,e,"fnStateLoad");
p(g,e,"fnStateSave");
p(g.oLanguage,e,"fnInfoCallback");
z(g,"aoDrawCallback",e.fnDrawCallback,"user");
z(g,"aoServerParams",e.fnServerParams,"user");
z(g,"aoStateSaveParams",e.fnStateSaveParams,"user");
z(g,"aoStateLoadParams",e.fnStateLoadParams,"user");
z(g,"aoStateLoaded",e.fnStateLoaded,"user");
z(g,"aoRowCallback",e.fnRowCallback,"user");
z(g,"aoRowCreatedCallback",e.fnCreatedRow,"user");
z(g,"aoHeaderCallback",e.fnHeaderCallback,"user");
z(g,"aoFooterCallback",e.fnFooterCallback,"user");
z(g,"aoInitComplete",e.fnInitComplete,"user");
z(g,"aoPreDrawCallback",e.fnPreDrawCallback,"user");
g.oFeatures.bServerSide&&g.oFeatures.bSort&&g.oFeatures.bSortClasses?z(g,"aoDrawCallback",P,"server_side_sort_classes"):g.oFeatures.bDeferRender&&z(g,"aoDrawCallback",P,"defer_sort_classes");
e.bJQueryUI?(h.extend(g.oClasses,j.ext.oJUIClasses),e.sDom===j.defaults.sDom&&"lfrtip"===j.defaults.sDom&&(g.sDom='<"H"lfr>t<"F"ip>')):h.extend(g.oClasses,j.ext.oStdClasses);
h(this).addClass(g.oClasses.sTable);
if(""!==g.oScroll.sX||""!==g.oScroll.sY){g.oScroll.iBarWidth=Qa()
}g.iInitDisplayStart===n&&(g.iInitDisplayStart=e.iDisplayStart,g._iDisplayStart=e.iDisplayStart);
e.bStateSave&&(g.oFeatures.bStateSave=!0,Sa(g,e),z(g,"aoDrawCallback",ra,"state_save"));
null!==e.iDeferLoading&&(g.bDeferLoading=!0,a=h.isArray(e.iDeferLoading),g._iRecordsDisplay=a?e.iDeferLoading[0]:e.iDeferLoading,g._iRecordsTotal=a?e.iDeferLoading[1]:e.iDeferLoading);
null!==e.aaData&&(f=!0);
""!==e.oLanguage.sUrl?(g.oLanguage.sUrl=e.oLanguage.sUrl,h.getJSON(g.oLanguage.sUrl,null,function(a){pa(a);
h.extend(true,g.oLanguage,e.oLanguage,a);
ba(g)
}),i=!0):h.extend(!0,g.oLanguage,e.oLanguage);
null===e.asStripeClasses&&(g.asStripeClasses=[g.oClasses.sStripeOdd,g.oClasses.sStripeEven]);
b=g.asStripeClasses.length;
g.asDestroyStripes=[];
if(b){c=!1;
d=h(this).children("tbody").children("tr:lt("+b+")");
for(a=0;
a<b;
a++){d.hasClass(g.asStripeClasses[a])&&(c=!0,g.asDestroyStripes.push(g.asStripeClasses[a]))
}c&&d.removeClass(g.asStripeClasses.join(" "))
}c=[];
a=this.getElementsByTagName("thead");
0!==a.length&&(V(g.aoHeader,a[0]),c=N(g));
if(null===e.aoColumns){d=[];
a=0;
for(b=c.length;
a<b;
a++){d.push(null)
}}else{d=e.aoColumns
}a=0;
for(b=d.length;
a<b;
a++){e.saved_aoColumns!==n&&e.saved_aoColumns.length==b&&(null===d[a]&&(d[a]={}),d[a].bVisible=e.saved_aoColumns[a].bVisible),o(g,c?c[a]:null)
}ta(g,e.aoColumnDefs,d,function(a,b){m(g,a,b)
});
a=0;
for(b=g.aaSorting.length;
a<b;
a++){g.aaSorting[a][0]>=g.aoColumns.length&&(g.aaSorting[a][0]=0);
var k=g.aoColumns[g.aaSorting[a][0]];
g.aaSorting[a][2]===n&&(g.aaSorting[a][2]=0);
e.aaSorting===n&&g.saved_aaSorting===n&&(g.aaSorting[a][1]=k.asSorting[0]);
c=0;
for(d=k.asSorting.length;
c<d;
c++){if(g.aaSorting[a][1]==k.asSorting[c]){g.aaSorting[a][2]=c;
break
}}}P(g);
Ua(g);
a=h(this).children("caption").each(function(){this._captionSide=h(this).css("caption-side")
});
b=h(this).children("thead");
0===b.length&&(b=[l.createElement("thead")],this.appendChild(b[0]));
g.nTHead=b[0];
b=h(this).children("tbody");
0===b.length&&(b=[l.createElement("tbody")],this.appendChild(b[0]));
g.nTBody=b[0];
g.nTBody.setAttribute("role","alert");
g.nTBody.setAttribute("aria-live","polite");
g.nTBody.setAttribute("aria-relevant","all");
b=h(this).children("tfoot");
if(0===b.length&&0<a.length&&(""!==g.oScroll.sX||""!==g.oScroll.sY)){b=[l.createElement("tfoot")],this.appendChild(b[0])
}0<b.length&&(g.nTFoot=b[0],V(g.aoFooter,g.nTFoot));
if(f){for(a=0;
a<e.aaData.length;
a++){H(g,e.aaData[a])
}}else{ua(g)
}g.aiDisplay=g.aiDisplayMaster.slice();
g.bInitialised=!0;
!1===i&&ba(g)
}});
ca=null;
return this
};
j.fnVersionCheck=function(e){for(var h=function(e,h){for(;
e.length<h;
){e+="0"
}return e
},m=j.ext.sVersion.split("."),e=e.split("."),k="",n="",l=0,t=e.length;
l<t;
l++){k+=h(m[l],3),n+=h(e[l],3)
}return parseInt(k,10)>=parseInt(n,10)
};
j.fnIsDataTable=function(e){for(var h=j.settings,m=0;
m<h.length;
m++){if(h[m].nTable===e||h[m].nScrollHead===e||h[m].nScrollFoot===e){return !0
}}return !1
};
j.fnTables=function(e){var o=[];
jQuery.each(j.settings,function(j,k){(!e||!0===e&&h(k.nTable).is(":visible"))&&o.push(k.nTable)
});
return o
};
j.version="1.9.4";
j.settings=[];
j.models={};
j.models.ext={afnFiltering:[],afnSortData:[],aoFeatures:[],aTypes:[],fnVersionCheck:j.fnVersionCheck,iApiIndex:0,ofnSearch:{},oApi:{},oStdClasses:{},oJUIClasses:{},oPagination:{},oSort:{},sVersion:j.version,sErrMode:"alert",_oExternConfig:{iNextUnique:0}};
j.models.oSearch={bCaseInsensitive:!0,sSearch:"",bRegex:!1,bSmart:!0};
j.models.oRow={nTr:null,_aData:[],_aSortData:[],_anHidden:[],_sRowStripe:""};
j.models.oColumn={aDataSort:null,asSorting:null,bSearchable:null,bSortable:null,bUseRendered:null,bVisible:null,_bAutoType:!0,fnCreatedCell:null,fnGetData:null,fnRender:null,fnSetData:null,mData:null,mRender:null,nTh:null,nTf:null,sClass:null,sContentPadding:null,sDefaultContent:null,sName:null,sSortDataType:"std",sSortingClass:null,sSortingClassJUI:null,sTitle:null,sType:null,sWidth:null,sWidthOrig:null};
j.defaults={aaData:null,aaSorting:[[0,"asc"]],aaSortingFixed:null,aLengthMenu:[10,25,50,100],aoColumns:null,aoColumnDefs:null,aoSearchCols:[],asStripeClasses:null,bAutoWidth:!0,bDeferRender:!1,bDestroy:!1,bFilter:!0,bInfo:!0,bJQueryUI:!1,bLengthChange:!0,bPaginate:!0,bProcessing:!1,bRetrieve:!1,bScrollAutoCss:!0,bScrollCollapse:!1,bScrollInfinite:!1,bServerSide:!1,bSort:!0,bSortCellsTop:!1,bSortClasses:!0,bStateSave:!1,fnCookieCallback:null,fnCreatedRow:null,fnDrawCallback:null,fnFooterCallback:null,fnFormatNumber:function(e){if(1000>e){return e
}for(var h=e+"",e=h.split(""),j="",h=h.length,k=0;
k<h;
k++){0===k%3&&0!==k&&(j=this.oLanguage.sInfoThousands+j),j=e[h-k-1]+j
}return j
},fnHeaderCallback:null,fnInfoCallback:null,fnInitComplete:null,fnPreDrawCallback:null,fnRowCallback:null,fnServerData:function(e,j,m,k){k.jqXHR=h.ajax({url:e,data:j,success:function(e){e.sError&&k.oApi._fnLog(k,0,e.sError);
h(k.oInstance).trigger("xhr",[k,e]);
m(e)
},dataType:"json",cache:!1,type:k.sServerMethod,error:function(e,h){"parsererror"==h&&k.oApi._fnLog(k,0,"DataTables warning: JSON data from server could not be parsed. This is caused by a JSON formatting error.")
}})
},fnServerParams:null,fnStateLoad:function(e){var e=this.oApi._fnReadCookie(e.sCookiePrefix+e.sInstance),j;
try{j="function"===typeof h.parseJSON?h.parseJSON(e):eval("("+e+")")
}catch(m){j=null
}return j
},fnStateLoadParams:null,fnStateLoaded:null,fnStateSave:function(e,h){this.oApi._fnCreateCookie(e.sCookiePrefix+e.sInstance,this.oApi._fnJsonString(h),e.iCookieDuration,e.sCookiePrefix,e.fnCookieCallback)
},fnStateSaveParams:null,iCookieDuration:7200,iDeferLoading:null,iDisplayLength:10,iDisplayStart:0,iScrollLoadGap:100,iTabIndex:0,oLanguage:{oAria:{sSortAscending:": activate to sort column ascending",sSortDescending:": activate to sort column descending"},oPaginate:{sFirst:"First",sLast:"Last",sNext:"Next",sPrevious:"Previous"},sEmptyTable:"No data available in table",sInfo:"Showing _START_ to _END_ of _TOTAL_ entries",sInfoEmpty:"Showing 0 to 0 of 0 entries",sInfoFiltered:"(filtered from _MAX_ total entries)",sInfoPostFix:"",sInfoThousands:",",sLengthMenu:"Show _MENU_ entries",sLoadingRecords:"Loading...",sProcessing:"Processing...",sSearch:"Search:",sUrl:"",sZeroRecords:"No matching records found"},oSearch:h.extend({},j.models.oSearch),sAjaxDataProp:"aaData",sAjaxSource:null,sCookiePrefix:"SpryMedia_DataTables_",sDom:"lfrtip",sPaginationType:"two_button",sScrollX:"",sScrollXInner:"",sScrollY:"",sServerMethod:"GET"};
j.defaults.columns={aDataSort:null,asSorting:["asc","desc"],bSearchable:!0,bSortable:!0,bUseRendered:!0,bVisible:!0,fnCreatedCell:null,fnRender:null,iDataSort:-1,mData:null,mRender:null,sCellType:"td",sClass:"",sContentPadding:"",sDefaultContent:null,sName:"",sSortDataType:"std",sTitle:null,sType:null,sWidth:null};
j.models.oSettings={oFeatures:{bAutoWidth:null,bDeferRender:null,bFilter:null,bInfo:null,bLengthChange:null,bPaginate:null,bProcessing:null,bServerSide:null,bSort:null,bSortClasses:null,bStateSave:null},oScroll:{bAutoCss:null,bCollapse:null,bInfinite:null,iBarWidth:0,iLoadGap:null,sX:null,sXInner:null,sY:null},oLanguage:{fnInfoCallback:null},oBrowser:{bScrollOversize:!1},aanFeatures:[],aoData:[],aiDisplay:[],aiDisplayMaster:[],aoColumns:[],aoHeader:[],aoFooter:[],asDataSearch:[],oPreviousSearch:{},aoPreSearchCols:[],aaSorting:null,aaSortingFixed:null,asStripeClasses:null,asDestroyStripes:[],sDestroyWidth:0,aoRowCallback:[],aoHeaderCallback:[],aoFooterCallback:[],aoDrawCallback:[],aoRowCreatedCallback:[],aoPreDrawCallback:[],aoInitComplete:[],aoStateSaveParams:[],aoStateLoadParams:[],aoStateLoaded:[],sTableId:"",nTable:null,nTHead:null,nTFoot:null,nTBody:null,nTableWrapper:null,bDeferLoading:!1,bInitialised:!1,aoOpenRows:[],sDom:null,sPaginationType:"two_button",iCookieDuration:0,sCookiePrefix:"",fnCookieCallback:null,aoStateSave:[],aoStateLoad:[],oLoadedState:null,sAjaxSource:null,sAjaxDataProp:null,bAjaxDataGet:!0,jqXHR:null,fnServerData:null,aoServerParams:[],sServerMethod:null,fnFormatNumber:null,aLengthMenu:null,iDraw:0,bDrawing:!1,iDrawError:-1,_iDisplayLength:10,_iDisplayStart:0,_iDisplayEnd:10,_iRecordsTotal:0,_iRecordsDisplay:0,bJUI:null,oClasses:{},bFiltered:!1,bSorted:!1,bSortCellsTop:null,oInit:null,aoDestroyCallback:[],fnRecordsTotal:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsTotal,10):this.aiDisplayMaster.length
},fnRecordsDisplay:function(){return this.oFeatures.bServerSide?parseInt(this._iRecordsDisplay,10):this.aiDisplay.length
},fnDisplayEnd:function(){return this.oFeatures.bServerSide?!1===this.oFeatures.bPaginate||-1==this._iDisplayLength?this._iDisplayStart+this.aiDisplay.length:Math.min(this._iDisplayStart+this._iDisplayLength,this._iRecordsDisplay):this._iDisplayEnd
},oInstance:null,sInstance:null,iTabIndex:0,nScrollHead:null,nScrollFoot:null};
j.ext=h.extend(!0,{},j.models.ext);
h.extend(j.ext.oStdClasses,{sTable:"dataTable",sPagePrevEnabled:"paginate_enabled_previous",sPagePrevDisabled:"paginate_disabled_previous",sPageNextEnabled:"paginate_enabled_next",sPageNextDisabled:"paginate_disabled_next",sPageJUINext:"",sPageJUIPrev:"",sPageButton:"paginate_button",sPageButtonActive:"paginate_active",sPageButtonStaticDisabled:"paginate_button paginate_button_disabled",sPageFirst:"first",sPagePrevious:"previous",sPageNext:"next",sPageLast:"last",sStripeOdd:"odd",sStripeEven:"even",sRowEmpty:"dataTables_empty",sWrapper:"dataTables_wrapper",sFilter:"dataTables_filter",sInfo:"dataTables_info",sPaging:"dataTables_paginate paging_",sLength:"dataTables_length",sProcessing:"dataTables_processing",sSortAsc:"sorting_asc",sSortDesc:"sorting_desc",sSortable:"sorting",sSortableAsc:"sorting_asc_disabled",sSortableDesc:"sorting_desc_disabled",sSortableNone:"sorting_disabled",sSortColumn:"sorting_",sSortJUIAsc:"",sSortJUIDesc:"",sSortJUI:"",sSortJUIAscAllowed:"",sSortJUIDescAllowed:"",sSortJUIWrapper:"",sSortIcon:"",sScrollWrapper:"dataTables_scroll",sScrollHead:"dataTables_scrollHead",sScrollHeadInner:"dataTables_scrollHeadInner",sScrollBody:"dataTables_scrollBody",sScrollFoot:"dataTables_scrollFoot",sScrollFootInner:"dataTables_scrollFootInner",sFooterTH:"",sJUIHeader:"",sJUIFooter:""});
h.extend(j.ext.oJUIClasses,j.ext.oStdClasses,{sPagePrevEnabled:"fg-button ui-button ui-state-default ui-corner-left",sPagePrevDisabled:"fg-button ui-button ui-state-default ui-corner-left ui-state-disabled",sPageNextEnabled:"fg-button ui-button ui-state-default ui-corner-right",sPageNextDisabled:"fg-button ui-button ui-state-default ui-corner-right ui-state-disabled",sPageJUINext:"ui-icon ui-icon-circle-arrow-e",sPageJUIPrev:"ui-icon ui-icon-circle-arrow-w",sPageButton:"fg-button ui-button ui-state-default",sPageButtonActive:"fg-button ui-button ui-state-default ui-state-disabled",sPageButtonStaticDisabled:"fg-button ui-button ui-state-default ui-state-disabled",sPageFirst:"first ui-corner-tl ui-corner-bl",sPageLast:"last ui-corner-tr ui-corner-br",sPaging:"dataTables_paginate fg-buttonset ui-buttonset fg-buttonset-multi ui-buttonset-multi paging_",sSortAsc:"ui-state-default",sSortDesc:"ui-state-default",sSortable:"ui-state-default",sSortableAsc:"ui-state-default",sSortableDesc:"ui-state-default",sSortableNone:"ui-state-default",sSortJUIAsc:"css_right ui-icon ui-icon-triangle-1-n",sSortJUIDesc:"css_right ui-icon ui-icon-triangle-1-s",sSortJUI:"css_right ui-icon ui-icon-carat-2-n-s",sSortJUIAscAllowed:"css_right ui-icon ui-icon-carat-1-n",sSortJUIDescAllowed:"css_right ui-icon ui-icon-carat-1-s",sSortJUIWrapper:"DataTables_sort_wrapper",sSortIcon:"DataTables_sort_icon",sScrollHead:"dataTables_scrollHead ui-state-default",sScrollFoot:"dataTables_scrollFoot ui-state-default",sFooterTH:"ui-state-default",sJUIHeader:"fg-toolbar ui-toolbar ui-widget-header ui-corner-tl ui-corner-tr ui-helper-clearfix",sJUIFooter:"fg-toolbar ui-toolbar ui-widget-header ui-corner-bl ui-corner-br ui-helper-clearfix"});
h.extend(j.ext.oPagination,{two_button:{fnInit:function(e,j,m){var k=e.oLanguage.oPaginate,n=function(h){e.oApi._fnPageChange(e,h.data.action)&&m(e)
},k=!e.bJUI?'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+k.sPrevious+'</a><a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button">'+k.sNext+"</a>":'<a class="'+e.oClasses.sPagePrevDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUIPrev+'"></span></a><a class="'+e.oClasses.sPageNextDisabled+'" tabindex="'+e.iTabIndex+'" role="button"><span class="'+e.oClasses.sPageJUINext+'"></span></a>';
h(j).append(k);
var l=h("a",j),k=l[0],l=l[1];
e.oApi._fnBindAction(k,{action:"previous"},n);
e.oApi._fnBindAction(l,{action:"next"},n);
e.aanFeatures.p||(j.id=e.sTableId+"_paginate",k.id=e.sTableId+"_previous",l.id=e.sTableId+"_next",k.setAttribute("aria-controls",e.sTableId),l.setAttribute("aria-controls",e.sTableId))
},fnUpdate:function(e){if(e.aanFeatures.p){for(var h=e.oClasses,j=e.aanFeatures.p,k,l=0,n=j.length;
l<n;
l++){if(k=j[l].firstChild){k.className=0===e._iDisplayStart?h.sPagePrevDisabled:h.sPagePrevEnabled,k=k.nextSibling,k.className=e.fnDisplayEnd()==e.fnRecordsDisplay()?h.sPageNextDisabled:h.sPageNextEnabled
}}}}},iFullNumbersShowPages:5,full_numbers:{fnInit:function(e,j,m){var k=e.oLanguage.oPaginate,l=e.oClasses,n=function(h){e.oApi._fnPageChange(e,h.data.action)&&m(e)
};
h(j).append('<a  tabindex="'+e.iTabIndex+'" class="'+l.sPageButton+" "+l.sPageFirst+'">'+k.sFirst+'</a><a  tabindex="'+e.iTabIndex+'" class="'+l.sPageButton+" "+l.sPagePrevious+'">'+k.sPrevious+'</a><span></span><a tabindex="'+e.iTabIndex+'" class="'+l.sPageButton+" "+l.sPageNext+'">'+k.sNext+'</a><a tabindex="'+e.iTabIndex+'" class="'+l.sPageButton+" "+l.sPageLast+'">'+k.sLast+"</a>");
var t=h("a",j),k=t[0],l=t[1],r=t[2],t=t[3];
e.oApi._fnBindAction(k,{action:"first"},n);
e.oApi._fnBindAction(l,{action:"previous"},n);
e.oApi._fnBindAction(r,{action:"next"},n);
e.oApi._fnBindAction(t,{action:"last"},n);
e.aanFeatures.p||(j.id=e.sTableId+"_paginate",k.id=e.sTableId+"_first",l.id=e.sTableId+"_previous",r.id=e.sTableId+"_next",t.id=e.sTableId+"_last")
},fnUpdate:function(e,o){if(e.aanFeatures.p){var m=j.ext.oPagination.iFullNumbersShowPages,k=Math.floor(m/2),l=Math.ceil(e.fnRecordsDisplay()/e._iDisplayLength),n=Math.ceil(e._iDisplayStart/e._iDisplayLength)+1,t="",r,B=e.oClasses,u,M=e.aanFeatures.p,L=function(h){e.oApi._fnBindAction(this,{page:h+r-1},function(h){e.oApi._fnPageChange(e,h.data.page);
o(e);
h.preventDefault()
})
};
-1===e._iDisplayLength?n=k=r=1:l<m?(r=1,k=l):n<=k?(r=1,k=m):n>=l-k?(r=l-m+1,k=l):(r=n-Math.ceil(m/2)+1,k=r+m-1);
for(m=r;
m<=k;
m++){t+=n!==m?'<a tabindex="'+e.iTabIndex+'" class="'+B.sPageButton+'">'+e.fnFormatNumber(m)+"</a>":'<a tabindex="'+e.iTabIndex+'" class="'+B.sPageButtonActive+'">'+e.fnFormatNumber(m)+"</a>"
}m=0;
for(k=M.length;
m<k;
m++){u=M[m],u.hasChildNodes()&&(h("span:eq(0)",u).html(t).children("a").each(L),u=u.getElementsByTagName("a"),u=[u[0],u[1],u[u.length-2],u[u.length-1]],h(u).removeClass(B.sPageButton+" "+B.sPageButtonActive+" "+B.sPageButtonStaticDisabled),h([u[0],u[1]]).addClass(1==n?B.sPageButtonStaticDisabled:B.sPageButton),h([u[2],u[3]]).addClass(0===l||n===l||-1===e._iDisplayLength?B.sPageButtonStaticDisabled:B.sPageButton))
}}}}});
h.extend(j.ext.oSort,{"string-pre":function(e){"string"!=typeof e&&(e=null!==e&&e.toString?e.toString():"");
return e.toLowerCase()
},"string-asc":function(e,h){return e<h?-1:e>h?1:0
},"string-desc":function(e,h){return e<h?1:e>h?-1:0
},"html-pre":function(e){return e.replace(/<.*?>/g,"").toLowerCase()
},"html-asc":function(e,h){return e<h?-1:e>h?1:0
},"html-desc":function(e,h){return e<h?1:e>h?-1:0
},"date-pre":function(e){e=Date.parse(e);
if(isNaN(e)||""===e){e=Date.parse("01/01/1970 00:00:00")
}return e
},"date-asc":function(e,h){return e-h
},"date-desc":function(e,h){return h-e
},"numeric-pre":function(e){return"-"==e||""===e?0:1*e
},"numeric-asc":function(e,h){return e-h
},"numeric-desc":function(e,h){return h-e
}});
h.extend(j.ext.aTypes,[function(e){if("number"===typeof e){return"numeric"
}if("string"!==typeof e){return null
}var h,j=!1;
h=e.charAt(0);
if(-1=="0123456789-".indexOf(h)){return null
}for(var k=1;
k<e.length;
k++){h=e.charAt(k);
if(-1=="0123456789.".indexOf(h)){return null
}if("."==h){if(j){return null
}j=!0
}}return"numeric"
},function(e){var h=Date.parse(e);
return null!==h&&!isNaN(h)||"string"===typeof e&&0===e.length?"date":null
},function(e){return"string"===typeof e&&-1!=e.indexOf("<")&&-1!=e.indexOf(">")?"html":null
}]);
h.fn.DataTable=j;
h.fn.dataTable=j;
h.fn.dataTableSettings=j.settings;
h.fn.dataTableExt=j.ext
};
"function"===typeof define&&define.amd?define(["jquery"],L):jQuery&&!jQuery.fn.dataTable&&L(jQuery)
})(window,document);
!function(w){var v,u,t="0.4.2",r="hasOwnProperty",q=/[\.\/]/,p="*",o=function(){},n=function(d,c){return d-c
},m={n:{}},l=function(F,E){F=String(F);
var D,C=u,B=Array.prototype.slice.call(arguments,2),A=l.listeners(F),z=0,y=[],x={},k=[],i=v;
v=F,u=0;
for(var c=0,b=A.length;
b>c;
c++){"zIndex" in A[c]&&(y.push(A[c].zIndex),A[c].zIndex<0&&(x[A[c].zIndex]=A[c]))
}for(y.sort(n);
y[z]<0;
){if(D=x[y[z++]],k.push(D.apply(E,B)),u){return u=C,k
}}for(c=0;
b>c;
c++){if(D=A[c],"zIndex" in D){if(D.zIndex==y[z]){if(k.push(D.apply(E,B)),u){break
}do{if(z++,D=x[y[z]],D&&k.push(D.apply(E,B)),u){break
}}while(D)
}else{x[D.zIndex]=D
}}else{if(k.push(D.apply(E,B)),u){break
}}}return u=C,v=i,k.length?k:null
};
l._events=m,l.listeners=function(G){var F,E,D,C,B,A,z,y,x=G.split(q),j=m,g=[j],f=[];
for(C=0,B=x.length;
B>C;
C++){for(y=[],A=0,z=g.length;
z>A;
A++){for(j=g[A].n,E=[j[x[C]],j[p]],D=2;
D--;
){F=E[D],F&&(y.push(F),f=f.concat(F.f||[]))
}}g=y
}return f
},l.on=function(h,f){if(h=String(h),"function"!=typeof f){return function(){}
}for(var x=h.split(q),k=m,j=0,i=x.length;
i>j;
j++){k=k.n,k=k.hasOwnProperty(x[j])&&k[x[j]]||(k[x[j]]={n:{}})
}for(k.f=k.f||[],j=0,i=k.f.length;
i>j;
j++){if(k.f[j]==f){return o
}}return k.f.push(f),function(b){+b==+b&&(f.zIndex=+b)
}
},l.f=function(d){var c=[].slice.call(arguments,1);
return function(){l.apply(null,[d,null].concat(c).concat([].slice.call(arguments,0)))
}
},l.stop=function(){u=1
},l.nt=function(b){return b?new RegExp("(?:\\.|\\/|^)"+b+"(?:\\.|\\/|$)").test(v):v
},l.nts=function(){return v.split(q)
},l.off=l.unbind=function(D,C){if(!D){return l._events=m={n:{}},void 0
}var B,A,z,y,x,k,j,g=D.split(q),f=[m];
for(y=0,x=g.length;
x>y;
y++){for(k=0;
k<f.length;
k+=z.length-2){if(z=[k,1],B=f[k].n,g[y]!=p){B[g[y]]&&z.push(B[g[y]])
}else{for(A in B){B[r](A)&&z.push(B[A])
}}f.splice.apply(f,z)
}}for(y=0,x=f.length;
x>y;
y++){for(B=f[y];
B.n;
){if(C){if(B.f){for(k=0,j=B.f.length;
j>k;
k++){if(B.f[k]==C){B.f.splice(k,1);
break
}}!B.f.length&&delete B.f
}for(A in B.n){if(B.n[r](A)&&B.n[A].f){var e=B.n[A].f;
for(k=0,j=e.length;
j>k;
k++){if(e[k]==C){e.splice(k,1);
break
}}!e.length&&delete B.n[A].f
}}}else{delete B.f;
for(A in B.n){B.n[r](A)&&B.n[A].f&&delete B.n[A].f
}}B=B.n
}}},l.once=function(e,d){var f=function(){return l.unbind(e,f),d.apply(this,arguments)
};
return l.on(e,f)
},l.version=t,l.toString=function(){return"You are running Eve "+t
},"undefined"!=typeof module&&module.exports?module.exports=l:"undefined"!=typeof define?define("eve",[],function(){return l
}):w.eve=l
}(this),function(d,c){"function"==typeof define&&define.amd?define(["eve"],function(a){return c(d,a)
}):c(d,d.eve)
}(this,function(a8,a7){function a6(b){if(a6.is(b,"function")){return aG?b():a7.on("raphael.DOMload",b)
}if(a6.is(b,bj)){return a6._engine.create[bK](a6,b.splice(0,3+a6.is(b[0],bl))).add(b)
}var f=Array.prototype.slice.call(arguments,0);
if(a6.is(f[f.length-1],"function")){var c=f.pop();
return aG?c.call(a6._engine.create[bK](a6,f)):a7.on("raphael.DOMload",function(){c.call(a6._engine.create[bK](a6,f))
})
}return a6._engine.create[bK](a6,arguments)
}function a5(e){if("function"==typeof e||Object(e)!==e){return e
}var d=new e.constructor;
for(var f in e){e[aA](f)&&(d[f]=a5(e[f]))
}return d
}function a2(f,e){for(var h=0,g=f.length;
g>h;
h++){if(f[h]===e){return f.push(f.splice(h,1)[0])
}}}function a1(f,e,h){function g(){var d=Array.prototype.slice.call(arguments,0),c=d.join(""),b=g.cache=g.cache||{},a=g.count=g.count||[];
return b[aA](c)?(a2(a,c),h?h(b[c]):b[c]):(a.length>=1000&&delete b[a.shift()],a.push(c),b[c]=f[bK](e,d),h?h(b[c]):b[c])
}return g
}function aZ(){return this.hex
}function aY(h,g){for(var l=[],k=0,j=h.length;
j-2*!g>k;
k+=2){var i=[{x:+h[k-2],y:+h[k-1]},{x:+h[k],y:+h[k+1]},{x:+h[k+2],y:+h[k+3]},{x:+h[k+4],y:+h[k+5]}];
g?k?j-4==k?i[3]={x:+h[0],y:+h[1]}:j-2==k&&(i[2]={x:+h[0],y:+h[1]},i[3]={x:+h[2],y:+h[3]}):i[0]={x:+h[j-2],y:+h[j-1]}:j-4==k?i[3]=i[2]:k||(i[0]={x:+h[k],y:+h[k+1]}),l.push(["C",(-i[0].x+6*i[1].x+i[2].x)/6,(-i[0].y+6*i[1].y+i[2].y)/6,(i[1].x+6*i[2].x-i[3].x)/6,(i[1].y+6*i[2].y-i[3].y)/6,i[2].x,i[2].y])
}return l
}function aX(i,h,n,m,l){var k=-3*h+9*n-9*m+3*l,j=i*k+6*h-12*n+6*m;
return i*j-3*h+3*n
}function aU(L,K,J,I,H,G,F,E,D){null==D&&(D=1),D=D>1?1:0>D?0:D;
for(var C=D/2,B=12,A=[-0.1252,0.1252,-0.3678,0.3678,-0.5873,0.5873,-0.7699,0.7699,-0.9041,0.9041,-0.9816,0.9816],z=[0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],y=0,x=0;
B>x;
x++){var w=C*A[x]+C,v=aX(w,L,J,H,F),u=aX(w,K,I,G,E),i=v*v+u*u;
y+=z[x]*bt.sqrt(i)
}return C*y
}function aT(C,B,A,z,y,x,w,v,u){if(!(0>u||aU(C,B,A,z,y,x,w,v)<u)){var t,r=1,q=r/2,p=r-q,j=0.01;
for(t=aU(C,B,A,z,y,x,w,v,p);
bp(t-u)>j;
){q/=2,p+=(u>t?1:-1)*q,t=aU(C,B,A,z,y,x,w,v,p)
}return p
}}function aR(E,D,C,B,A,z,y,x){if(!(bs(E,C)<br(A,y)||br(E,C)>bs(A,y)||bs(D,B)<br(z,x)||br(D,B)>bs(z,x))){var w=(E*B-D*C)*(A-y)-(E-C)*(A*x-z*y),v=(E*B-D*C)*(z-x)-(D-B)*(A*x-z*y),u=(E-C)*(z-x)-(D-B)*(A-y);
if(u){var t=w/u,r=v/u,q=+t.toFixed(2),p=+r.toFixed(2);
if(!(q<+br(E,C).toFixed(2)||q>+bs(E,C).toFixed(2)||q<+br(A,y).toFixed(2)||q>+bs(A,y).toFixed(2)||p<+br(D,B).toFixed(2)||p>+bs(D,B).toFixed(2)||p<+br(z,x).toFixed(2)||p>+bs(z,x).toFixed(2))){return{x:t,y:r}
}}}}function aQ(X,W,V){var U=a6.bezierBBox(X),T=a6.bezierBBox(W);
if(!a6.isBBoxIntersect(U,T)){return V?0:[]
}for(var S=aU.apply(0,X),R=aU.apply(0,W),Q=bs(~~(S/5),1),P=bs(~~(R/5),1),O=[],N=[],M={},L=V?0:[],J=0;
Q+1>J;
J++){var H=a6.findDotsAtSegment.apply(a6,X.concat(J/Q));
O.push({x:H.x,y:H.y,t:J/Q})
}for(J=0;
P+1>J;
J++){H=a6.findDotsAtSegment.apply(a6,W.concat(J/P)),N.push({x:H.x,y:H.y,t:J/P})
}for(J=0;
Q>J;
J++){for(var G=0;
P>G;
G++){var F=O[J],E=O[J+1],D=N[G],C=N[G+1],l=bp(E.x-F.x)<0.001?"y":"x",j=bp(C.x-D.x)<0.001?"y":"x",c=aR(F.x,F.y,E.x,E.y,D.x,D.y,C.x,C.y);
if(c){if(M[c.x.toFixed(4)]==c.y.toFixed(4)){continue
}M[c.x.toFixed(4)]=c.y.toFixed(4);
var K=F.t+bp((c[l]-F[l])/(E[l]-F[l]))*(E.t-F.t),I=D.t+bp((c[j]-D[j])/(C[j]-D[j]))*(C.t-D.t);
K>=0&&1.001>=K&&I>=0&&1.001>=I&&(V?L++:L.push({x:c.x,y:c.y,t1:br(K,1),t2:br(I,1)}))
}}}return L
}function aP(T,S,R){T=a6._path2curve(T),S=a6._path2curve(S);
for(var Q,P,O,N,M,L,K,J,I,H,G=R?0:[],F=0,E=T.length;
E>F;
F++){var D=T[F];
if("M"==D[0]){Q=M=D[1],P=L=D[2]
}else{"C"==D[0]?(I=[Q,P].concat(D.slice(1)),Q=I[6],P=I[7]):(I=[Q,P,Q,P,M,L,M,L],Q=M,P=L);
for(var C=0,B=S.length;
B>C;
C++){var A=S[C];
if("M"==A[0]){O=K=A[1],N=J=A[2]
}else{"C"==A[0]?(H=[O,N].concat(A.slice(1)),O=H[6],N=H[7]):(H=[O,N,O,N,K,J,K,J],O=K,N=J);
var z=aQ(I,H,R);
if(R){G+=z
}else{for(var m=0,c=z.length;
c>m;
m++){z[m].segment1=F,z[m].segment2=C,z[m].bez1=I,z[m].bez2=H
}G=G.concat(z)
}}}}}return G
}function aN(h,g,l,k,j,i){null!=h?(this.a=+h,this.b=+g,this.c=+l,this.d=+k,this.e=+j,this.f=+i):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)
}function aM(){return this.x+bC+this.y+bC+this.width+"  "+this.height
}function aK(E,D,C,B,A,z){function y(b){return((t*b+u)*b+v)*b
}function x(e,d){var f=w(e,d);
return((p*f+q)*f+r)*f
}function w(j,g){var F,o,n,m,l,k;
for(n=j,k=0;
8>k;
k++){if(m=y(n)-j,bp(m)<g){return n
}if(l=(3*t*n+2*u)*n+v,bp(l)<0.000001){break
}n-=m/l
}if(F=0,o=1,n=j,F>n){return F
}if(n>o){return o
}for(;
o>F;
){if(m=y(n),bp(m-j)<g){return n
}j>m?F=n:o=n,n=(o-F)/2+F
}return n
}var v=3*D,u=3*(B-D)-v,t=1-v-u,r=3*C,q=3*(A-C)-r,p=1-r-q;
return x(E,1/(200*z))
}function aJ(g,f){var j=[],i={};
if(this.ms=f,this.times=1,g){for(var h in g){g[aA](h)&&(i[bd(h)]=g[h],j.push(bd(h)))
}j.sort(ca)
}this.anim=i,this.top=j[j.length-1],this.percents=j
}function aI(cp,co,cn,cm,cl,ck){cn=bd(cn);
var cj,ci,ch,cg,cc,cb,bc=cp.ms,ab={},Y={},W={};
if(cm){for(T=0,J=aS.length;
J>T;
T++){var V=aS[T];
if(V.el.id==co.id&&V.anim==cp){V.percent!=cn?(aS.splice(T,1),ch=1):ci=V,co.attr(V.totalOrigin);
break
}}}else{cm=+Y
}for(var T=0,J=cp.percents.length;
J>T;
T++){if(cp.percents[T]==cn||cp.percents[T]>cm*cp.top){cn=cp.percents[T],cc=cp.percents[T-1]||0,bc=bc/cp.top*(cn-cc),cg=cp.percents[T+1],cj=cp.anim[cn];
break
}cm&&co.attr(cp.anim[cp.percents[T]])
}if(cj){if(ci){ci.initstatus=cm,ci.start=new Date-ci.ms*cm
}else{for(var I in cj){if(cj[aA](I)&&(ar[aA](I)||co.paper.customAttributes[aA](I))){switch(ab[I]=co.attr(I),null==ab[I]&&(ab[I]=aO[I]),Y[I]=cj[I],ar[I]){case bl:W[I]=(Y[I]-ab[I])/bc;
break;
case"colour":ab[I]=a6.getRGB(ab[I]);
var bb=a6.getRGB(Y[I]);
W[I]={r:(bb.r-ab[I].r)/bc,g:(bb.g-ab[I].g)/bc,b:(bb.b-ab[I].b)/bc};
break;
case"path":var ac=ax(ab[I],Y[I]),Z=ac[1];
for(ab[I]=ac[0],W[I]=[],T=0,J=ab[I].length;
J>T;
T++){W[I][T]=[0];
for(var X=1,U=ab[I][T].length;
U>X;
X++){W[I][T][X]=(Z[T][X]-ab[I][T][X])/bc
}}break;
case"transform":var S=co._,R=ba(S[I],Y[I]);
if(R){for(ab[I]=R.from,Y[I]=R.to,W[I]=[],W[I].real=!0,T=0,J=ab[I].length;
J>T;
T++){for(W[I][T]=[ab[I][T][0]],X=1,U=ab[I][T].length;
U>X;
X++){W[I][T][X]=(Y[I][T][X]-ab[I][T][X])/bc
}}}else{var E=co.matrix||new aN,z={_:{transform:S.transform},getBBox:function(){return co.getBBox(1)
}};
ab[I]=[E.a,E.b,E.c,E.d,E.e,E.f],b2(z,Y[I]),Y[I]=z._.transform,W[I]=[(z.matrix.a-E.a)/bc,(z.matrix.b-E.b)/bc,(z.matrix.c-E.c)/bc,(z.matrix.d-E.d)/bc,(z.matrix.e-E.e)/bc,(z.matrix.f-E.f)/bc]
}break;
case"csv":var w=bB(cj[I])[bA](aE),q=bB(ab[I])[bA](aE);
if("clip-rect"==I){for(ab[I]=q,W[I]=[],T=q.length;
T--;
){W[I][T]=(w[T]-ab[I][T])/bc
}}Y[I]=w;
break;
default:for(w=[][bI](cj[I]),q=[][bI](ab[I]),W[I]=[],T=co.paper.customAttributes[I].length;
T--;
){W[I][T]=((w[T]||0)-(q[T]||0))/bc
}}}}var o=cj.easing,c=a6.easing_formulas[o];
if(!c){if(c=bB(o).match(bf),c&&5==c.length){var b=c;
c=function(d){return aK(d,+b[1],+b[2],+b[3],+b[4],bc)
}
}else{c=bG
}}if(cb=cj.start||cp.start||+new Date,V={anim:cp,percent:cn,timestamp:cb,start:cb+(cp.del||0),status:0,initstatus:cm||0,stop:!1,ms:bc,easing:c,from:ab,diff:W,to:Y,el:co,callback:cj.callback,prev:cc,next:cg,repeat:ck||cp.times,origin:co.attr(),totalOrigin:cl},aS.push(V),cm&&!ci&&!ch&&(V.stop=!0,V.start=new Date-bc*cm,1==aS.length)){return ai()
}ch&&(V.start=new Date-V.ms*cm),1==aS.length&&at(ai)
}a7("raphael.anim.start."+co.id,co,cp)
}}function aH(d){for(var c=0;
c<aS.length;
c++){aS[c].el.paper==d&&aS.splice(c--,1)
}}a6.version="2.1.2",a6.eve=a7;
var aG,aF,aE=/[, ]+/,aD={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},aC=/\{(\d+)\}/g,aA="hasOwnProperty",bO={doc:document,win:a8},bM={was:Object.prototype[aA].call(bO.win,"Raphael"),is:bO.win.Raphael},bL=function(){this.ca=this.customAttributes={}
},bK="apply",bI="concat",bF="ontouchstart" in bO.win||bO.win.DocumentTouch&&bO.doc instanceof DocumentTouch,bE="",bC=" ",bB=String,bA="split",bx="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[bA](bC),bw={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},bu=bB.prototype.toLowerCase,bt=Math,bs=bt.max,br=bt.min,bp=bt.abs,bn=bt.pow,bm=bt.PI,bl="number",bk="string",bj="array",bi=Object.prototype.toString,bh=(a6._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i),bg={NaN:1,Infinity:1,"-Infinity":1},bf=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,b0=bt.round,bd=parseFloat,bT=parseInt,bq=bB.prototype.toUpperCase,aO=a6._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},ar=a6._availableAnimAttrs={blur:bl,"clip-rect":"csv",cx:bl,cy:bl,fill:"colour","fill-opacity":bl,"font-size":bl,height:bl,opacity:bl,path:"path",r:bl,rx:bl,ry:bl,stroke:"colour","stroke-opacity":bl,"stroke-width":bl,transform:"transform",width:bl,x:bl,y:bl},ah=/[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/,b7={hs:1,rg:1},bV=/,?([achlmqrstvxz]),?/gi,by=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,aV=/([rstm])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,au=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi,aj=(a6._radial_gradient=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,{}),ca=function(d,c){return bd(d)-bd(c)
},bY=function(){},bG=function(b){return b
},a3=a6._rectPath=function(g,f,j,i,h){return h?[["M",g+h,f],["l",j-2*h,0],["a",h,h,0,0,1,h,h],["l",0,i-2*h],["a",h,h,0,0,1,-h,h],["l",2*h-j,0],["a",h,h,0,0,1,-h,-h],["l",0,2*h-i],["a",h,h,0,0,1,h,-h],["z"]]:[["M",g,f],["l",j,0],["l",0,i],["l",-j,0],["z"]]
},aw=function(f,e,h,g){return null==g&&(g=h),[["M",f,e],["m",0,-g],["a",h,g,0,1,1,0,2*g],["a",h,g,0,1,1,0,-2*g],["z"]]
},al=a6._getPath={path:function(b){return b.attr("path")
},circle:function(d){var c=d.attrs;
return aw(c.cx,c.cy,c.r)
},ellipse:function(d){var c=d.attrs;
return aw(c.cx,c.cy,c.rx,c.ry)
},rect:function(d){var c=d.attrs;
return a3(c.x,c.y,c.width,c.height,c.r)
},image:function(d){var c=d.attrs;
return a3(c.x,c.y,c.width,c.height)
},text:function(d){var c=d._getBBox();
return a3(c.x,c.y,c.width,c.height)
},set:function(d){var c=d._getBBox();
return a3(c.x,c.y,c.width,c.height)
}},ce=a6.mapPath=function(r,q){if(!q){return r
}var p,o,n,m,l,k,j;
for(r=ax(r),n=0,l=r.length;
l>n;
n++){for(j=r[n],m=1,k=j.length;
k>m;
m+=2){p=q.x(j[m],j[m+1]),o=q.y(j[m],j[m+1]),j[m]=p,j[m+1]=o
}}return r
};
if(a6._g=bO,a6.type=bO.win.SVGAngle||bO.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==a6.type){var b1,bN=bO.doc.createElement("div");
if(bN.innerHTML='<v:shape adj="1"/>',b1=bN.firstChild,b1.style.behavior="url(#default#VML)",!b1||"object"!=typeof b1.adj){return a6.type=bE
}bN=null
}a6.svg=!(a6.vml="VML"==a6.type),a6._Paper=bL,a6.fn=aF=bL.prototype=a6.prototype,a6._id=0,a6._oid=0,a6.is=function(d,c){return c=bu.call(c),"finite"==c?!bg[aA](+d):"array"==c?d instanceof Array:"null"==c&&null===d||c==typeof d&&null!==d||"object"==c&&d===Object(d)||"array"==c&&Array.isArray&&Array.isArray(d)||bi.call(d).slice(8,-1).toLowerCase()==c
},a6.angle=function(j,c,p,o,n,m){if(null==n){var l=j-p,k=c-o;
return l||k?(180+180*bt.atan2(-k,-l)/bm+360)%360:0
}return a6.angle(j,c,n,m)-a6.angle(p,o,n,m)
},a6.rad=function(b){return b%360*bm/180
},a6.deg=function(b){return 180*b/bm%360
},a6.snapTo=function(g,c,j){if(j=a6.is(j,"finite")?j:10,a6.is(g,bj)){for(var i=g.length;
i--;
){if(bp(g[i]-c)<=j){return g[i]
}}}else{g=+g;
var h=c%g;
if(j>h){return c-h
}if(h>g-j){return c-h+g
}}return c
},a6.createUUID=function(d,c){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(d,c).toUpperCase()
}
}(/[xy]/g,function(e){var d=0|16*bt.random(),f="x"==e?d:8|3&d;
return f.toString(16)
}),a6.setWindow=function(b){a7("raphael.setWindow",a6,bO.win,b),bO.win=b,bO.doc=bO.win.document,a6._engine.initWin&&a6._engine.initWin(bO.win)
};
var a9=function(f){if(a6.vml){var c,n=/^\s+|\s+$/g;
try{var m=new ActiveXObject("htmlfile");
m.write("<body>"),m.close(),c=m.body
}catch(l){c=createPopup().document.body
}var k=c.createTextRange();
a9=a1(function(b){try{c.style.color=bB(b).replace(n,bE);
var g=k.queryCommandValue("ForeColor");
return g=(255&g)<<16|65280&g|(16711680&g)>>>16,"#"+("000000"+g.toString(16)).slice(-6)
}catch(d){return"none"
}})
}else{var j=bO.doc.createElement("i");
j.title="Raphal Colour Picker",j.style.display="none",bO.doc.body.appendChild(j),a9=a1(function(b){return j.style.color=b,bO.doc.defaultView.getComputedStyle(j,bE).getPropertyValue("color")
})
}return a9(f)
},ay=function(){return"hsb("+[this.h,this.s,this.b]+")"
},an=function(){return"hsl("+[this.h,this.s,this.l]+")"
},aa=function(){return this.hex
},b3=function(f,c,h){if(null==c&&a6.is(f,"object")&&"r" in f&&"g" in f&&"b" in f&&(h=f.b,c=f.g,f=f.r),null==c&&a6.is(f,bk)){var g=a6.getRGB(f);
f=g.r,c=g.g,h=g.b
}return(f>1||c>1||h>1)&&(f/=255,c/=255,h/=255),[f,c,h]
},bQ=function(g,c,j,i){g*=255,c*=255,j*=255;
var h={r:g,g:c,b:j,hex:a6.rgb(g,c,j),toString:aa};
return a6.is(i,"finite")&&(h.opacity=i),h
};
a6.color=function(d){var c;
return a6.is(d,"object")&&"h" in d&&"s" in d&&"b" in d?(c=a6.hsb2rgb(d),d.r=c.r,d.g=c.g,d.b=c.b,d.hex=c.hex):a6.is(d,"object")&&"h" in d&&"s" in d&&"l" in d?(c=a6.hsl2rgb(d),d.r=c.r,d.g=c.g,d.b=c.b,d.hex=c.hex):(a6.is(d,"string")&&(d=a6.getRGB(d)),a6.is(d,"object")&&"r" in d&&"g" in d&&"b" in d?(c=a6.rgb2hsl(d),d.h=c.h,d.s=c.s,d.l=c.l,c=a6.rgb2hsb(d),d.v=c.b):(d={hex:"none"},d.r=d.g=d.b=d.h=d.s=d.v=d.l=-1)),d.toString=aa,d
},a6.hsb2rgb=function(r,q,p,o){this.is(r,"object")&&"h" in r&&"s" in r&&"b" in r&&(p=r.b,q=r.s,r=r.h,o=r.o),r*=360;
var n,m,l,k,j;
return r=r%360/60,j=p*q,k=j*(1-bp(r%2-1)),n=m=l=p-j,r=~~r,n+=[j,k,0,0,k,j][r],m+=[k,j,j,k,0,0][r],l+=[0,0,k,j,j,k][r],bQ(n,m,l,o)
},a6.hsl2rgb=function(r,q,p,o){this.is(r,"object")&&"h" in r&&"s" in r&&"l" in r&&(p=r.l,q=r.s,r=r.h),(r>1||q>1||p>1)&&(r/=360,q/=100,p/=100),r*=360;
var n,m,l,k,j;
return r=r%360/60,j=2*q*(0.5>p?p:1-p),k=j*(1-bp(r%2-1)),n=m=l=p-j/2,r=~~r,n+=[j,k,0,0,k,j][r],m+=[k,j,j,k,0,0][r],l+=[0,0,k,j,j,k][r],bQ(n,m,l,o)
},a6.rgb2hsb=function(i,h,n){n=b3(i,h,n),i=n[0],h=n[1],n=n[2];
var m,l,k,j;
return k=bs(i,h,n),j=k-br(i,h,n),m=0==j?null:k==i?(h-n)/j:k==h?(n-i)/j+2:(i-h)/j+4,m=60*((m+360)%6)/360,l=0==j?0:j/k,{h:m,s:l,b:k,toString:ay}
},a6.rgb2hsl=function(r,q,p){p=b3(r,q,p),r=p[0],q=p[1],p=p[2];
var o,n,m,l,k,j;
return l=bs(r,q,p),k=br(r,q,p),j=l-k,o=0==j?null:l==r?(q-p)/j:l==q?(p-r)/j+2:(r-q)/j+4,o=60*((o+360)%6)/360,m=(l+k)/2,n=0==j?0:0.5>m?j/(2*m):j/(2-2*m),{h:o,s:n,l:m,toString:an}
},a6._path2string=function(){return this.join(",").replace(bV,"$1")
},a6._preload=function(e,d){var f=bO.doc.createElement("img");
f.style.cssText="position:absolute;left:-9999em;top:-9999em",f.onload=function(){d.call(this),this.onload=null,bO.doc.body.removeChild(this)
},f.onerror=function(){bO.doc.body.removeChild(this)
},bO.doc.body.appendChild(f),f.src=e
},a6.getRGB=a1(function(g){if(!g||(g=bB(g)).indexOf("-")+1){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aZ}
}if("none"==g){return{r:-1,g:-1,b:-1,hex:"none",toString:aZ}
}!(b7[aA](g.toLowerCase().substring(0,2))||"#"==g.charAt())&&(g=a9(g));
var c,p,o,n,m,l,k=g.match(bh);
return k?(k[2]&&(o=bT(k[2].substring(5),16),p=bT(k[2].substring(3,5),16),c=bT(k[2].substring(1,3),16)),k[3]&&(o=bT((m=k[3].charAt(3))+m,16),p=bT((m=k[3].charAt(2))+m,16),c=bT((m=k[3].charAt(1))+m,16)),k[4]&&(l=k[4][bA](ah),c=bd(l[0]),"%"==l[0].slice(-1)&&(c*=2.55),p=bd(l[1]),"%"==l[1].slice(-1)&&(p*=2.55),o=bd(l[2]),"%"==l[2].slice(-1)&&(o*=2.55),"rgba"==k[1].toLowerCase().slice(0,4)&&(n=bd(l[3])),l[3]&&"%"==l[3].slice(-1)&&(n/=100)),k[5]?(l=k[5][bA](ah),c=bd(l[0]),"%"==l[0].slice(-1)&&(c*=2.55),p=bd(l[1]),"%"==l[1].slice(-1)&&(p*=2.55),o=bd(l[2]),"%"==l[2].slice(-1)&&(o*=2.55),("deg"==l[0].slice(-3)||""==l[0].slice(-1))&&(c/=360),"hsba"==k[1].toLowerCase().slice(0,4)&&(n=bd(l[3])),l[3]&&"%"==l[3].slice(-1)&&(n/=100),a6.hsb2rgb(c,p,o,n)):k[6]?(l=k[6][bA](ah),c=bd(l[0]),"%"==l[0].slice(-1)&&(c*=2.55),p=bd(l[1]),"%"==l[1].slice(-1)&&(p*=2.55),o=bd(l[2]),"%"==l[2].slice(-1)&&(o*=2.55),("deg"==l[0].slice(-3)||""==l[0].slice(-1))&&(c/=360),"hsla"==k[1].toLowerCase().slice(0,4)&&(n=bd(l[3])),l[3]&&"%"==l[3].slice(-1)&&(n/=100),a6.hsl2rgb(c,p,o,n)):(k={r:c,g:p,b:o,toString:aZ},k.hex="#"+(16777216|o|p<<8|c<<16).toString(16).slice(1),a6.is(n,"finite")&&(k.opacity=n),k)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aZ}
},a6),a6.hsb=a1(function(e,c,f){return a6.hsb2rgb(e,c,f).hex
}),a6.hsl=a1(function(e,c,f){return a6.hsl2rgb(e,c,f).hex
}),a6.rgb=a1(function(e,d,f){return"#"+(16777216|f|d<<8|e<<16).toString(16).slice(1)
}),a6.getColor=function(e){var d=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||0.75},f=this.hsb2rgb(d.h,d.s,d.b);
return d.h+=0.075,d.h>1&&(d.h=0,d.s-=0.2,d.s<=0&&(this.getColor.start={h:0,s:1,b:d.b})),f.hex
},a6.getColor.reset=function(){delete this.start
},a6.parsePathString=function(f){if(!f){return null
}var c=b8(f);
if(c.arr){return bz(c.arr)
}var h={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},g=[];
return a6.is(f,bj)&&a6.is(f[0],bj)&&(g=bz(f)),g.length||bB(f).replace(by,function(e,d,k){var j=[],i=d.toLowerCase();
if(k.replace(au,function(m,l){l&&j.push(+l)
}),"m"==i&&j.length>2&&(g.push([d][bI](j.splice(0,2))),i="l",d="m"==d?"l":"L"),"r"==i){g.push([d][bI](j))
}else{for(;
j.length>=h[i]&&(g.push([d][bI](j.splice(0,h[i]))),h[i]);
){}}}),g.toString=a6._path2string,c.arr=bz(g),g
},a6.parseTransformString=a1(function(d){if(!d){return null
}var c=[];
return a6.is(d,bj)&&a6.is(d[0],bj)&&(c=bz(d)),c.length||bB(d).replace(aV,function(b,h,g){var f=[];
bu.call(h),g.replace(au,function(i,e){e&&f.push(+e)
}),c.push([h][bI](f))
}),c.toString=a6._path2string,c
});
var b8=function(d){var c=b8.ps=b8.ps||{};
return c[d]?c[d].sleep=100:c[d]={sleep:100},setTimeout(function(){for(var a in c){c[aA](a)&&a!=d&&(c[a].sleep--,!c[a].sleep&&delete c[a])
}}),c[d]
};
a6.findDotsAtSegment=function(X,W,V,U,T,S,R,Q,P){var O=1-P,N=bn(O,3),M=bn(O,2),L=P*P,K=L*P,J=N*X+3*M*P*V+3*O*P*P*T+K*R,I=N*W+3*M*P*U+3*O*P*P*S+K*Q,H=X+2*P*(V-X)+L*(T-2*V+X),G=W+2*P*(U-W)+L*(S-2*U+W),F=V+2*P*(T-V)+L*(R-2*T+V),E=U+2*P*(S-U)+L*(Q-2*S+U),D=O*X+P*V,C=O*W+P*U,B=O*T+P*R,A=O*S+P*Q,z=90-180*bt.atan2(H-F,G-E)/bm;
return(H>F||E>G)&&(z+=180),{x:J,y:I,m:{x:H,y:G},n:{x:F,y:E},start:{x:D,y:C},end:{x:B,y:A},alpha:z}
},a6.bezierBBox=function(r,q,p,o,n,m,l,k){a6.is(r,"array")||(r=[r,q,p,o,n,m,l,k]);
var c=a4.apply(null,r);
return{x:c.min.x,y:c.min.y,x2:c.max.x,y2:c.max.y,width:c.max.x-c.min.x,height:c.max.y-c.min.y}
},a6.isPointInsideBBox=function(e,d,f){return d>=e.x&&d<=e.x2&&f>=e.y&&f<=e.y2
},a6.isBBoxIntersect=function(e,c){var f=a6.isPointInsideBBox;
return f(c,e.x,e.y)||f(c,e.x2,e.y)||f(c,e.x,e.y2)||f(c,e.x2,e.y2)||f(e,c.x,c.y)||f(e,c.x2,c.y)||f(e,c.x,c.y2)||f(e,c.x2,c.y2)||(e.x<c.x2&&e.x>c.x||c.x<e.x2&&c.x>e.x)&&(e.y<c.y2&&e.y>c.y||c.y<e.y2&&c.y>e.y)
},a6.pathIntersection=function(d,c){return aP(d,c)
},a6.pathIntersectionNumber=function(d,c){return aP(d,c,1)
},a6.isPointInsidePath=function(f,c,h){var g=a6.pathBBox(f);
return a6.isPointInsideBBox(g,c,h)&&1==aP(f,[["M",c,h],["H",g.x2+10]],1)%2
},a6._removedFactory=function(b){return function(){a7("raphael.log",null,"Raphal: you are calling to method "+b+" of removed object",b)
}
};
var bW=a6.pathBBox=function(I){var H=b8(I);
if(H.bbox){return a5(H.bbox)
}if(!I){return{x:0,y:0,width:0,height:0,x2:0,y2:0}
}I=ax(I);
for(var G,F=0,E=0,D=[],C=[],B=0,A=I.length;
A>B;
B++){if(G=I[B],"M"==G[0]){F=G[1],E=G[2],D.push(F),C.push(E)
}else{var z=a4(F,E,G[1],G[2],G[3],G[4],G[5],G[6]);
D=D[bI](z.min.x,z.max.x),C=C[bI](z.min.y,z.max.y),F=G[5],E=G[6]
}}var y=br[bK](0,D),x=br[bK](0,C),w=bs[bK](0,D),v=bs[bK](0,C),u=w-y,t=v-x,d={x:y,y:x,x2:w,y2:v,width:u,height:t,cx:y+u/2,cy:x+t/2};
return H.bbox=a5(d),d
},bz=function(d){var c=a5(d);
return c.toString=a6._path2string,c
},aW=a6._pathToRelative=function(I){var H=b8(I);
if(H.rel){return bz(H.rel)
}a6.is(I,bj)&&a6.is(I&&I[0],bj)||(I=a6.parsePathString(I));
var G=[],F=0,E=0,D=0,C=0,B=0;
"M"==I[0][0]&&(F=I[0][1],E=I[0][2],D=F,C=E,B++,G.push(["M",F,E]));
for(var A=B,z=I.length;
z>A;
A++){var y=G[A]=[],x=I[A];
if(x[0]!=bu.call(x[0])){switch(y[0]=bu.call(x[0]),y[0]){case"a":y[1]=x[1],y[2]=x[2],y[3]=x[3],y[4]=x[4],y[5]=x[5],y[6]=+(x[6]-F).toFixed(3),y[7]=+(x[7]-E).toFixed(3);
break;
case"v":y[1]=+(x[1]-E).toFixed(3);
break;
case"m":D=x[1],C=x[2];
default:for(var w=1,v=x.length;
v>w;
w++){y[w]=+(x[w]-(w%2?F:E)).toFixed(3)
}}}else{y=G[A]=[],"m"==x[0]&&(D=x[1]+F,C=x[2]+E);
for(var u=0,t=x.length;
t>u;
u++){G[A][u]=x[u]
}}var c=G[A].length;
switch(G[A][0]){case"z":F=D,E=C;
break;
case"h":F+=+G[A][c-1];
break;
case"v":E+=+G[A][c-1];
break;
default:F+=+G[A][c-2],E+=+G[A][c-1]
}}return G.toString=a6._path2string,H.rel=bz(G),G
},av=a6._pathToAbsolute=function(J){var I=b8(J);
if(I.abs){return bz(I.abs)
}if(a6.is(J,bj)&&a6.is(J&&J[0],bj)||(J=a6.parsePathString(J)),!J||!J.length){return[["M",0,0]]
}var H=[],G=0,F=0,E=0,D=0,C=0;
"M"==J[0][0]&&(G=+J[0][1],F=+J[0][2],E=G,D=F,C++,H[0]=["M",G,F]);
for(var B,A,z=3==J.length&&"M"==J[0][0]&&"R"==J[1][0].toUpperCase()&&"Z"==J[2][0].toUpperCase(),y=C,x=J.length;
x>y;
y++){if(H.push(B=[]),A=J[y],A[0]!=bq.call(A[0])){switch(B[0]=bq.call(A[0]),B[0]){case"A":B[1]=A[1],B[2]=A[2],B[3]=A[3],B[4]=A[4],B[5]=A[5],B[6]=+(A[6]+G),B[7]=+(A[7]+F);
break;
case"V":B[1]=+A[1]+F;
break;
case"H":B[1]=+A[1]+G;
break;
case"R":for(var w=[G,F][bI](A.slice(1)),v=2,u=w.length;
u>v;
v++){w[v]=+w[v]+G,w[++v]=+w[v]+F
}H.pop(),H=H[bI](aY(w,z));
break;
case"M":E=+A[1]+G,D=+A[2]+F;
default:for(v=1,u=A.length;
u>v;
v++){B[v]=+A[v]+(v%2?G:F)
}}}else{if("R"==A[0]){w=[G,F][bI](A.slice(1)),H.pop(),H=H[bI](aY(w,z)),B=["R"][bI](A.slice(-2))
}else{for(var h=0,c=A.length;
c>h;
h++){B[h]=A[h]
}}}switch(B[0]){case"Z":G=E,F=D;
break;
case"H":G=B[1];
break;
case"V":F=B[1];
break;
case"M":E=B[B.length-2],D=B[B.length-1];
default:G=B[B.length-2],F=B[B.length-1]
}}return H.toString=a6._path2string,I.abs=bz(H),H
},ak=function(f,e,h,g){return[f,e,h,g,h,g]
},cd=function(j,i,p,o,n,m){var l=1/3,k=2/3;
return[l*j+k*p,l*i+k*o,l*n+k*p,l*m+k*o,n,m]
},bZ=function(cH,cG,cF,cE,cD,cC,cB,cA,cz,cy){var cx,cw=120*bm/180,cv=bm/180*(+cD||0),cu=[],ct=a1(function(h,g,k){var j=h*bt.cos(k)-g*bt.sin(k),i=h*bt.sin(k)+g*bt.cos(k);
return{x:j,y:i}
});
if(cy){ck=cy[0],cj=cy[1],cm=cy[2],cl=cy[3]
}else{cx=ct(cH,cG,-cv),cH=cx.x,cG=cx.y,cx=ct(cA,cz,-cv),cA=cx.x,cz=cx.y;
var cs=(bt.cos(bm/180*cD),bt.sin(bm/180*cD),(cH-cA)/2),cr=(cG-cz)/2,cq=cs*cs/(cF*cF)+cr*cr/(cE*cE);
cq>1&&(cq=bt.sqrt(cq),cF=cq*cF,cE=cq*cE);
var cp=cF*cF,co=cE*cE,cn=(cC==cB?-1:1)*bt.sqrt(bp((cp*co-cp*cr*cr-co*cs*cs)/(cp*cr*cr+co*cs*cs))),cm=cn*cF*cr/cE+(cH+cA)/2,cl=cn*-cE*cs/cF+(cG+cz)/2,ck=bt.asin(((cG-cl)/cE).toFixed(9)),cj=bt.asin(((cz-cl)/cE).toFixed(9));
ck=cm>cH?bm-ck:ck,cj=cm>cA?bm-cj:cj,0>ck&&(ck=2*bm+ck),0>cj&&(cj=2*bm+cj),cB&&ck>cj&&(ck-=2*bm),!cB&&cj>ck&&(cj-=2*bm)
}var ci=cj-ck;
if(bp(ci)>cw){var ch=cj,cg=cA,cc=cz;
cj=ck+cw*(cB&&cj>ck?1:-1),cA=cm+cF*bt.cos(cj),cz=cl+cE*bt.sin(cj),cu=bZ(cA,cz,cF,cE,cD,0,cB,cg,cc,[cj,ch,cm,cl])
}ci=cj-ck;
var cb=bt.cos(ck),bc=bt.sin(ck),bb=bt.cos(cj),ac=bt.sin(cj),ab=bt.tan(ci/4),Z=4/3*cF*ab,Y=4/3*cE*ab,X=[cH,cG],S=[cH+Z*bc,cG-Y*cb],Q=[cA+Z*ac,cz-Y*bb],N=[cA,cz];
if(S[0]=2*X[0]-S[0],S[1]=2*X[1]-S[1],cy){return[S,Q,N][bI](cu)
}cu=[S,Q,N][bI](cu).join()[bA](",");
for(var J=[],E=0,f=cu.length;
f>E;
E++){J[E]=E%2?ct(cu[E-1],cu[E],cv).y:ct(cu[E],cu[E+1],cv).x
}return J
},bH=function(u,t,r,q,p,o,n,m,l){var k=1-l;
return{x:bn(k,3)*u+3*bn(k,2)*l*r+3*k*l*l*p+bn(l,3)*n,y:bn(k,3)*t+3*bn(k,2)*l*q+3*k*l*l*o+bn(l,3)*m}
},a4=a1(function(G,F,E,D,C,B,A,z){var y,x=C-2*E+G-(A-2*C+E),w=2*(E-G)-2*(C-E),v=G-E,u=(-w+bt.sqrt(w*w-4*x*v))/2/x,t=(-w-bt.sqrt(w*w-4*x*v))/2/x,r=[F,z],q=[G,A];
return bp(u)>"1e12"&&(u=0.5),bp(t)>"1e12"&&(t=0.5),u>0&&1>u&&(y=bH(G,F,E,D,C,B,A,z,u),q.push(y.x),r.push(y.y)),t>0&&1>t&&(y=bH(G,F,E,D,C,B,A,z,t),q.push(y.x),r.push(y.y)),x=B-2*D+F-(z-2*B+D),w=2*(D-F)-2*(B-D),v=F-D,u=(-w+bt.sqrt(w*w-4*x*v))/2/x,t=(-w-bt.sqrt(w*w-4*x*v))/2/x,bp(u)>"1e12"&&(u=0.5),bp(t)>"1e12"&&(t=0.5),u>0&&1>u&&(y=bH(G,F,E,D,C,B,A,z,u),q.push(y.x),r.push(y.y)),t>0&&1>t&&(y=bH(G,F,E,D,C,B,A,z,t),q.push(y.x),r.push(y.y)),{min:{x:br[bK](0,q),y:br[bK](0,r)},max:{x:bs[bK](0,q),y:bs[bK](0,r)}}
}),ax=a6._path2curve=a1(function(G,F){var E=!F&&b8(G);
if(!F&&E.curve){return bz(E.curve)
}for(var D=av(G),C=F&&av(F),B={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},A={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},z=(function(g,f,j){var i,h;
if(!g){return["C",f.x,f.y,f.x,f.y,f.x,f.y]
}switch(!(g[0] in {T:1,Q:1})&&(f.qx=f.qy=null),g[0]){case"M":f.X=g[1],f.Y=g[2];
break;
case"A":g=["C"][bI](bZ[bK](0,[f.x,f.y][bI](g.slice(1))));
break;
case"S":"C"==j||"S"==j?(i=2*f.x-f.bx,h=2*f.y-f.by):(i=f.x,h=f.y),g=["C",i,h][bI](g.slice(1));
break;
case"T":"Q"==j||"T"==j?(f.qx=2*f.x-f.qx,f.qy=2*f.y-f.qy):(f.qx=f.x,f.qy=f.y),g=["C"][bI](cd(f.x,f.y,f.qx,f.qy,g[1],g[2]));
break;
case"Q":f.qx=g[1],f.qy=g[2],g=["C"][bI](cd(f.x,f.y,g[1],g[2],g[3],g[4]));
break;
case"L":g=["C"][bI](ak(f.x,f.y,g[1],g[2]));
break;
case"H":g=["C"][bI](ak(f.x,f.y,g[1],f.y));
break;
case"V":g=["C"][bI](ak(f.x,f.y,f.x,g[1]));
break;
case"Z":g=["C"][bI](ak(f.x,f.y,f.X,f.Y))
}return g
}),y=function(e,d){if(e[d].length>7){e[d].shift();
for(var f=e[d];
f.length;
){e.splice(d++,0,["C"][bI](f.splice(0,6)))
}e.splice(d,1),v=bs(D.length,C&&C.length||0)
}},x=function(e,d,j,i,h){e&&d&&"M"==e[h][0]&&"M"!=d[h][0]&&(d.splice(h,0,["M",i.x,i.y]),j.bx=0,j.by=0,j.x=e[h][1],j.y=e[h][2],v=bs(D.length,C&&C.length||0))
},w=0,v=bs(D.length,C&&C.length||0);
v>w;
w++){D[w]=z(D[w],B),y(D,w),C&&(C[w]=z(C[w],A)),C&&y(C,w),x(D,C,B,A,w),x(C,D,A,B,w);
var u=D[w],t=C&&C[w],r=u.length,q=C&&t.length;
B.x=u[r-2],B.y=u[r-1],B.bx=bd(u[r-4])||B.x,B.by=bd(u[r-3])||B.y,A.bx=C&&(bd(t[q-4])||A.x),A.by=C&&(bd(t[q-3])||A.y),A.x=C&&t[q-2],A.y=C&&t[q-1]
}return C||(E.curve=bz(D)),C?[D,C]:D
},null,bz),am=(a6._parseDots=a1(function(u){for(var t=[],r=0,q=u.length;
q>r;
r++){var p={},o=u[r].match(/^([^:]*):?([\d\.]*)/);
if(p.color=a6.getRGB(o[1]),p.color.error){return null
}p.color=p.color.hex,o[2]&&(p.offset=o[2]+"%"),t.push(p)
}for(r=1,q=t.length-1;
q>r;
r++){if(!t[r].offset){for(var n=bd(t[r-1].offset||0),m=0,l=r+1;
q>l;
l++){if(t[l].offset){m=t[l].offset;
break
}}m||(m=100,l=q),m=bd(m);
for(var c=(m-n)/(l-r+1);
l>r;
r++){n+=c,t[r].offset=n+"%"
}}}return t
}),a6._tear=function(d,c){d==c.top&&(c.top=d.prev),d==c.bottom&&(c.bottom=d.next),d.next&&(d.next.prev=d.prev),d.prev&&(d.prev.next=d.next)
}),cf=(a6._tofront=function(d,c){c.top!==d&&(am(d,c),d.next=null,d.prev=c.top,c.top.next=d,c.top=d)
},a6._toback=function(d,c){c.bottom!==d&&(am(d,c),d.next=c.bottom,d.prev=null,c.bottom.prev=d,c.bottom=d)
},a6._insertafter=function(e,d,f){am(e,f),d==f.top&&(f.top=e),d.next&&(d.next.prev=e),e.next=d.next,e.prev=d,d.next=e
},a6._insertbefore=function(e,d,f){am(e,f),d==f.bottom&&(f.bottom=e),d.prev&&(d.prev.next=e),e.prev=d.prev,d.prev=e,e.next=d
},a6.toMatrix=function(f,e){var h=bW(f),g={_:{transform:bE},getBBox:function(){return h
}};
return b2(g,e),g.matrix
}),b2=(a6.transformPath=function(d,c){return ce(d,cf(d,c))
},a6._extractTransform=function(R,Q){if(null==Q){return R._.transform
}Q=bB(Q).replace(/\.{3}|\u2026/g,R._.transform||bE);
var P=a6.parseTransformString(Q),O=0,N=0,M=0,L=1,K=1,J=R._,I=new aN;
if(J.transform=P||[],P){for(var H=0,G=P.length;
G>H;
H++){var F,E,D,C,B,A=P[H],z=A.length,y=bB(A[0]).toLowerCase(),o=A[0]!=y,c=o?I.invert():0;
"t"==y&&3==z?o?(F=c.x(0,0),E=c.y(0,0),D=c.x(A[1],A[2]),C=c.y(A[1],A[2]),I.translate(D-F,C-E)):I.translate(A[1],A[2]):"r"==y?2==z?(B=B||R.getBBox(1),I.rotate(A[1],B.x+B.width/2,B.y+B.height/2),O+=A[1]):4==z&&(o?(D=c.x(A[2],A[3]),C=c.y(A[2],A[3]),I.rotate(A[1],D,C)):I.rotate(A[1],A[2],A[3]),O+=A[1]):"s"==y?2==z||3==z?(B=B||R.getBBox(1),I.scale(A[1],A[z-1],B.x+B.width/2,B.y+B.height/2),L*=A[1],K*=A[z-1]):5==z&&(o?(D=c.x(A[3],A[4]),C=c.y(A[3],A[4]),I.scale(A[1],A[2],D,C)):I.scale(A[1],A[2],A[3],A[4]),L*=A[1],K*=A[2]):"m"==y&&7==z&&I.add(A[1],A[2],A[3],A[4],A[5],A[6]),J.dirtyT=1,R.matrix=I
}}R.matrix=I,J.sx=L,J.sy=K,J.deg=O,J.dx=N=I.e,J.dy=M=I.f,1==L&&1==K&&!O&&J.bbox?(J.bbox.x+=+N,J.bbox.y+=+M):J.dirtyT=1
}),bP=function(d){var c=d[0];
switch(c.toLowerCase()){case"t":return[c,0,0];
case"m":return[c,1,0,0,1,0,0];
case"r":return 4==d.length?[c,0,d[2],d[3]]:[c,0];
case"s":return 5==d.length?[c,1,1,d[3],d[4]]:3==d.length?[c,1,1]:[c,1]
}},ba=a6._equaliseTransform=function(u,t){t=bB(t).replace(/\.{3}|\u2026/g,u),u=a6.parseTransformString(u)||[],t=a6.parseTransformString(t)||[];
for(var r,q,p,o,n=bs(u.length,t.length),m=[],l=[],c=0;
n>c;
c++){if(p=u[c]||bP(t[c]),o=t[c]||bP(p),p[0]!=o[0]||"r"==p[0].toLowerCase()&&(p[2]!=o[2]||p[3]!=o[3])||"s"==p[0].toLowerCase()&&(p[3]!=o[3]||p[4]!=o[4])){return
}for(m[c]=[],l[c]=[],r=0,q=bs(p.length,o.length);
q>r;
r++){r in p&&(m[c][r]=p[r]),r in o&&(l[c][r]=o[r])
}}return{from:m,to:l}
};
a6._getContainer=function(g,c,j,i){var h;
return h=null!=i||a6.is(g,"object")?g:bO.doc.getElementById(g),null!=h?h.tagName?null==c?{container:h,width:h.style.pixelWidth||h.offsetWidth,height:h.style.pixelHeight||h.offsetHeight}:{container:h,width:c,height:j}:{container:1,x:g,y:c,width:j,height:i}:void 0
},a6.pathToRelative=aW,a6._engine={},a6.path2curve=ax,a6.matrix=function(h,g,l,k,j,i){return new aN(h,g,l,k,j,i)
},function(e){function c(b){return b[0]*b[0]+b[1]*b[1]
}function f(b){var d=bt.sqrt(c(b));
b[0]&&(b[0]/=d),b[1]&&(b[1]/=d)
}e.add=function(A,z,y,x,w,v){var u,t,r,q,p=[[],[],[]],o=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],n=[[A,y,w],[z,x,v],[0,0,1]];
for(A&&A instanceof aN&&(n=[[A.a,A.c,A.e],[A.b,A.d,A.f],[0,0,1]]),u=0;
3>u;
u++){for(t=0;
3>t;
t++){for(q=0,r=0;
3>r;
r++){q+=o[u][r]*n[r][t]
}p[u][t]=q
}}this.a=p[0][0],this.b=p[1][0],this.c=p[0][1],this.d=p[1][1],this.e=p[0][2],this.f=p[1][2]
},e.invert=function(){var g=this,d=g.a*g.d-g.b*g.c;
return new aN(g.d/d,-g.b/d,-g.c/d,g.a/d,(g.c*g.f-g.d*g.e)/d,(g.b*g.e-g.a*g.f)/d)
},e.clone=function(){return new aN(this.a,this.b,this.c,this.d,this.e,this.f)
},e.translate=function(g,d){this.add(1,0,0,1,g,d)
},e.scale=function(h,g,j,i){null==g&&(g=h),(j||i)&&this.add(1,0,0,1,j,i),this.add(h,0,0,g,0,0),(j||i)&&this.add(1,0,0,1,-j,-i)
},e.rotate=function(h,g,k){h=a6.rad(h),g=g||0,k=k||0;
var j=+bt.cos(h).toFixed(9),i=+bt.sin(h).toFixed(9);
this.add(j,i,-i,j,g,k),this.add(1,0,0,1,-g,-k)
},e.x=function(g,d){return g*this.a+d*this.c+this.e
},e.y=function(g,d){return g*this.b+d*this.d+this.f
},e.get=function(b){return +this[bB.fromCharCode(97+b)].toFixed(4)
},e.toString=function(){return a6.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()
},e.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"
},e.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]
},e.split=function(){var b={};
b.dx=this.e,b.dy=this.f;
var i=[[this.a,this.c],[this.b,this.d]];
b.scalex=bt.sqrt(c(i[0])),f(i[0]),b.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*b.shear,i[1][1]-i[0][1]*b.shear],b.scaley=bt.sqrt(c(i[1])),f(i[1]),b.shear/=b.scaley;
var h=-i[0][1],d=i[1][1];
return 0>d?(b.rotate=a6.deg(bt.acos(d)),0>h&&(b.rotate=360-b.rotate)):b.rotate=a6.deg(bt.asin(h)),b.isSimple=!(+b.shear.toFixed(9)||b.scalex.toFixed(9)!=b.scaley.toFixed(9)&&b.rotate),b.isSuperSimple=!+b.shear.toFixed(9)&&b.scalex.toFixed(9)==b.scaley.toFixed(9)&&!b.rotate,b.noRotation=!+b.shear.toFixed(9)&&!b.rotate,b
},e.toTransformString=function(g){var d=g||this[bA]();
return d.isSimple?(d.scalex=+d.scalex.toFixed(4),d.scaley=+d.scaley.toFixed(4),d.rotate=+d.rotate.toFixed(4),(d.dx||d.dy?"t"+[d.dx,d.dy]:bE)+(1!=d.scalex||1!=d.scaley?"s"+[d.scalex,d.scaley,0,0]:bE)+(d.rotate?"r"+[d.rotate,0,0]:bE)):"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]
}
}(aN.prototype);
var az=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);
aF.safari="Apple Computer, Inc."==navigator.vendor&&(az&&az[1]<4||"iP"==navigator.platform.slice(0,2))||"Google Inc."==navigator.vendor&&az&&az[1]<8?function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});
setTimeout(function(){b.remove()
})
}:bY;
for(var ao=function(){this.returnValue=!1
},ad=function(){return this.originalEvent.preventDefault()
},b4=function(){this.cancelBubble=!0
},bR=function(){return this.originalEvent.stopPropagation()
},be=function(e){var d=bO.doc.documentElement.scrollTop||bO.doc.body.scrollTop,f=bO.doc.documentElement.scrollLeft||bO.doc.body.scrollLeft;
return{x:e.clientX+f,y:e.clientY+d}
},aB=function(){return bO.doc.addEventListener?function(h,g,l,k){var j=function(d){var c=be(d);
return l.call(k,d,c.x,c.y)
};
if(h.addEventListener(g,j,!1),bF&&bw[g]){var i=function(a){for(var n=be(a),m=a,d=0,c=a.targetTouches&&a.targetTouches.length;
c>d;
d++){if(a.targetTouches[d].target==h){a=a.targetTouches[d],a.originalEvent=m,a.preventDefault=ad,a.stopPropagation=bR;
break
}}return l.call(k,a,n.x,n.y)
};
h.addEventListener(bw[g],i,!1)
}return function(){return h.removeEventListener(g,j,!1),bF&&bw[g]&&h.removeEventListener(bw[g],j,!1),!0
}
}:bO.doc.attachEvent?function(h,g,l,k){var j=function(d){d=d||bO.win.event;
var c=bO.doc.documentElement.scrollTop||bO.doc.body.scrollTop,o=bO.doc.documentElement.scrollLeft||bO.doc.body.scrollLeft,n=d.clientX+o,m=d.clientY+c;
return d.preventDefault=d.preventDefault||ao,d.stopPropagation=d.stopPropagation||b4,l.call(k,d,n,m)
};
h.attachEvent("on"+g,j);
var i=function(){return h.detachEvent("on"+g,j),!0
};
return i
}:void 0
}(),ap=[],ae=function(C){for(var B,A=C.clientX,z=C.clientY,y=bO.doc.documentElement.scrollTop||bO.doc.body.scrollTop,x=bO.doc.documentElement.scrollLeft||bO.doc.body.scrollLeft,w=ap.length;
w--;
){if(B=ap[w],bF&&C.touches){for(var v,u=C.touches.length;
u--;
){if(v=C.touches[u],v.identifier==B.el._drag.id){A=v.clientX,z=v.clientY,(C.originalEvent?C.originalEvent:C).preventDefault();
break
}}}else{C.preventDefault()
}var t,r=B.el.node,q=r.nextSibling,p=r.parentNode,b=r.style.display;
bO.win.opera&&p.removeChild(r),r.style.display="none",t=B.el.paper.getElementByPoint(A,z),r.style.display=b,bO.win.opera&&(q?p.insertBefore(r,q):p.appendChild(r)),t&&a7("raphael.drag.over."+B.el.id,B.el,t),A+=x,z+=y,a7("raphael.drag.move."+B.el.id,B.move_scope||B.el,A-B.el._drag.x,z-B.el._drag.y,A,z,C)
}},b5=function(b){a6.unmousemove(ae).unmouseup(b5);
for(var f,c=ap.length;
c--;
){f=ap[c],f.el._drag={},a7("raphael.drag.end."+f.el.id,f.end_scope||f.start_scope||f.move_scope||f.el,b)
}ap=[]
},bJ=a6.el={},af=bx.length;
af--;
){!function(b){a6[b]=bJ[b]=function(a,c){return a6.is(a,"function")&&(this.events=this.events||[],this.events.push({name:b,f:a,unbind:aB(this.shape||this.node||bO.doc,b,a,c||this)})),this
},a6["un"+b]=bJ["un"+b]=function(a){for(var f=this.events||[],c=f.length;
c--;
){f[c].name!=b||!a6.is(a,"undefined")&&f[c].f!=a||(f[c].unbind(),f.splice(c,1),!f.length&&delete this.events)
}return this
}
}(bx[af])
}bJ.data=function(b,h){var g=aj[this.id]=aj[this.id]||{};
if(0==arguments.length){return g
}if(1==arguments.length){if(a6.is(b,"object")){for(var c in b){b[aA](c)&&this.data(c,b[c])
}return this
}return a7("raphael.data.get."+this.id,this,g[b],b),g[b]
}return g[b]=h,a7("raphael.data.set."+this.id,this,h,b),this
},bJ.removeData=function(b){return null==b?aj[this.id]={}:aj[this.id]&&delete aj[this.id][b],this
},bJ.getData=function(){return a5(aj[this.id]||{})
},bJ.hover=function(f,e,h,g){return this.mouseover(f,h).mouseout(e,g||h)
},bJ.unhover=function(d,c){return this.unmouseover(d).unmouseout(c)
};
var bS=[];
bJ.drag=function(b,n,m,l,k,j){function c(g){(g.originalEvent||g).preventDefault();
var f=g.clientX,e=g.clientY,d=bO.doc.documentElement.scrollTop||bO.doc.body.scrollTop,a=bO.doc.documentElement.scrollLeft||bO.doc.body.scrollLeft;
if(this._drag.id=g.identifier,bF&&g.touches){for(var p,h=g.touches.length;
h--;
){if(p=g.touches[h],this._drag.id=p.identifier,p.identifier==this._drag.id){f=p.clientX,e=p.clientY;
break
}}}this._drag.x=f+a,this._drag.y=e+d,!ap.length&&a6.mousemove(ae).mouseup(b5),ap.push({el:this,move_scope:l,start_scope:k,end_scope:j}),n&&a7.on("raphael.drag.start."+this.id,n),b&&a7.on("raphael.drag.move."+this.id,b),m&&a7.on("raphael.drag.end."+this.id,m),a7("raphael.drag.start."+this.id,k||l||this,g.clientX+a,g.clientY+d,g)
}return this._drag={},bS.push({el:this,start:c}),this.mousedown(c),this
},bJ.onDragOver=function(b){b?a7.on("raphael.drag.over."+this.id,b):a7.unbind("raphael.drag.over."+this.id)
},bJ.undrag=function(){for(var b=bS.length;
b--;
){bS[b].el==this&&(this.unmousedown(bS[b].start),bS.splice(b,1),a7.unbind("raphael.drag.*."+this.id))
}!bS.length&&a6.unmousemove(ae).unmouseup(b5),ap=[]
},aF.circle=function(f,c,h){var g=a6._engine.circle(this,f||0,c||0,h||0);
return this.__set__&&this.__set__.push(g),g
},aF.rect=function(h,c,l,k,j){var i=a6._engine.rect(this,h||0,c||0,l||0,k||0,j||0);
return this.__set__&&this.__set__.push(i),i
},aF.ellipse=function(g,c,j,i){var h=a6._engine.ellipse(this,g||0,c||0,j||0,i||0);
return this.__set__&&this.__set__.push(h),h
},aF.path=function(d){d&&!a6.is(d,bk)&&!a6.is(d[0],bj)&&(d+=bE);
var c=a6._engine.path(a6.format[bK](a6,arguments),this);
return this.__set__&&this.__set__.push(c),c
},aF.image=function(h,c,l,k,j){var i=a6._engine.image(this,h||"about:blank",c||0,l||0,k||0,j||0);
return this.__set__&&this.__set__.push(i),i
},aF.text=function(f,c,h){var g=a6._engine.text(this,f||0,c||0,bB(h));
return this.__set__&&this.__set__.push(g),g
},aF.set=function(d){!a6.is(d,"array")&&(d=Array.prototype.splice.call(arguments,0,arguments.length));
var c=new bX(d);
return this.__set__&&this.__set__.push(c),c.paper=this,c.type="set",c
},aF.setStart=function(b){this.__set__=b||this.set()
},aF.setFinish=function(){var b=this.__set__;
return delete this.__set__,b
},aF.setSize=function(d,c){return a6._engine.setSize.call(this,d,c)
},aF.setViewBox=function(g,c,j,i,h){return a6._engine.setViewBox.call(this,g,c,j,i,h)
},aF.top=aF.bottom=null,aF.raphael=a6;
var bo=function(r){var q=r.getBoundingClientRect(),p=r.ownerDocument,o=p.body,n=p.documentElement,m=n.clientTop||o.clientTop||0,l=n.clientLeft||o.clientLeft||0,k=q.top+(bO.win.pageYOffset||n.scrollTop||o.scrollTop)-m,j=q.left+(bO.win.pageXOffset||n.scrollLeft||o.scrollLeft)-l;
return{y:k,x:j}
};
aF.getElementByPoint=function(j,i){var p=this,o=p.canvas,n=bO.doc.elementFromPoint(j,i);
if(bO.win.opera&&"svg"==n.tagName){var m=bo(o),l=o.createSVGRect();
l.x=j-m.x,l.y=i-m.y,l.width=l.height=1;
var k=o.getIntersectionList(l,null);
k.length&&(n=k[k.length-1])
}if(!n){return null
}for(;
n.parentNode&&n!=o.parentNode&&!n.raphael;
){n=n.parentNode
}return n==p.canvas.parentNode&&(n=o),n=n&&n.raphael?p.getById(n.raphaelid):null
},aF.getElementsByBBox=function(d){var c=this.set();
return this.forEach(function(a){a6.isBBoxIntersect(a.getBBox(),d)&&c.push(a)
}),c
},aF.getById=function(d){for(var c=this.bottom;
c;
){if(c.id==d){return c
}c=c.next
}return null
},aF.forEach=function(e,d){for(var f=this.bottom;
f;
){if(e.call(d,f)===!1){return this
}f=f.next
}return this
},aF.getElementsByPoint=function(e,d){var f=this.set();
return this.forEach(function(a){a.isPointInside(e,d)&&f.push(a)
}),f
},bJ.isPointInside=function(e,c){var f=this.realPath=al[this.type](this);
return this.attr("transform")&&this.attr("transform").length&&(f=a6.transformPath(f,this.attr("transform"))),a6.isPointInsidePath(f,e,c)
},bJ.getBBox=function(d){if(this.removed){return{}
}var c=this._;
return d?((c.dirty||!c.bboxwt)&&(this.realPath=al[this.type](this),c.bboxwt=bW(this.realPath),c.bboxwt.toString=aM,c.dirty=0),c.bboxwt):((c.dirty||c.dirtyT||!c.bbox)&&((c.dirty||!this.realPath)&&(c.bboxwt=0,this.realPath=al[this.type](this)),c.bbox=bW(ce(this.realPath,this.matrix)),c.bbox.toString=aM,c.dirty=c.dirtyT=0),c.bbox)
},bJ.clone=function(){if(this.removed){return null
}var b=this.paper[this.type]().attr(this.attr());
return this.__set__&&this.__set__.push(b),b
},bJ.glow=function(i){if("text"==this.type){return null
}i=i||{};
var h={width:(i.width||10)+(+this.attr("stroke-width")||1),fill:i.fill||!1,opacity:i.opacity||0.5,offsetx:i.offsetx||0,offsety:i.offsety||0,color:i.color||"#000"},n=h.width/2,m=this.paper,l=m.set(),k=this.realPath||al[this.type](this);
k=this.matrix?ce(k,this.matrix):k;
for(var j=1;
n+1>j;
j++){l.push(m.path(k).attr({stroke:h.color,fill:h.fill?h.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(h.width/n*j).toFixed(3),opacity:+(h.opacity/n).toFixed(3)}))
}return l.insertBefore(this).translate(h.offsetx,h.offsety)
};
var aL=function(r,q,p,o,n,m,k,j,c){return null==c?aU(r,q,p,o,n,m,k,j):a6.findDotsAtSegment(r,q,p,o,n,m,k,j,aT(r,q,p,o,n,m,k,j,c))
},aq=function(d,c){return function(B,A,z){B=ax(B);
for(var y,x,w,v,u,t="",r={},q=0,b=0,a=B.length;
a>b;
b++){if(w=B[b],"M"==w[0]){y=+w[1],x=+w[2]
}else{if(v=aL(y,x,w[1],w[2],w[3],w[4],w[5],w[6]),q+v>A){if(c&&!r.start){if(u=aL(y,x,w[1],w[2],w[3],w[4],w[5],w[6],A-q),t+=["C"+u.start.x,u.start.y,u.m.x,u.m.y,u.x,u.y],z){return t
}r.start=t,t=["M"+u.x,u.y+"C"+u.n.x,u.n.y,u.end.x,u.end.y,w[5],w[6]].join(),q+=v,y=+w[5],x=+w[6];
continue
}if(!d&&!c){return u=aL(y,x,w[1],w[2],w[3],w[4],w[5],w[6],A-q),{x:u.x,y:u.y,alpha:u.alpha}
}}q+=v,y=+w[5],x=+w[6]
}t+=w.shift()+w
}return r.end=t,u=d?q:c?r:a6.findDotsAtSegment(y,x,w[0],w[1],w[2],w[3],w[4],w[5],1),u.alpha&&(u={x:u.x,y:u.y,alpha:u.alpha}),u
}
},ag=aq(1),b6=aq(),bU=aq(0,1);
a6.getTotalLength=ag,a6.getPointAtLength=b6,a6.getSubpath=function(f,e,h){if(this.getTotalLength(f)-h<0.000001){return bU(f,e).end
}var g=bU(f,h,1);
return e?bU(g,e).end:g
},bJ.getTotalLength=function(){var b=this.getPath();
if(b){return this.node.getTotalLength?this.node.getTotalLength():ag(b)
}},bJ.getPointAtLength=function(d){var c=this.getPath();
if(c){return b6(c,d)
}},bJ.getPath=function(){var d,c=a6._getPath[this.type];
if("text"!=this.type&&"set"!=this.type){return c&&(d=c(this)),d
}},bJ.getSubpath=function(e,c){var f=this.getPath();
if(f){return a6.getSubpath(f,e,c)
}};
var bv=a6.easing_formulas={linear:function(b){return b
},"<":function(b){return bn(b,1.7)
},">":function(b){return bn(b,0.48)
},"<>":function(j){var i=0.48-j/1.04,p=bt.sqrt(0.1734+i*i),o=p-i,n=bn(bp(o),1/3)*(0>o?-1:1),m=-p-i,l=bn(bp(m),1/3)*(0>m?-1:1),k=n+l+0.5;
return 3*(1-k)*k*k+k*k*k
},backIn:function(d){var c=1.70158;
return d*d*((c+1)*d-c)
},backOut:function(d){d-=1;
var c=1.70158;
return d*d*((c+1)*d+c)+1
},elastic:function(b){return b==!!b?b:bn(2,-10*b)*bt.sin((b-0.075)*2*bm/0.3)+1
},bounce:function(f){var e,h=7.5625,g=2.75;
return 1/g>f?e=h*f*f:2/g>f?(f-=1.5/g,e=h*f*f+0.75):2.5/g>f?(f-=2.25/g,e=h*f*f+0.9375):(f-=2.625/g,e=h*f*f+0.984375),e
}};
bv.easeIn=bv["ease-in"]=bv["<"],bv.easeOut=bv["ease-out"]=bv[">"],bv.easeInOut=bv["ease-in-out"]=bv["<>"],bv["back-in"]=bv.backIn,bv["back-out"]=bv.backOut;
var aS=[],at=a8.requestAnimationFrame||a8.webkitRequestAnimationFrame||a8.mozRequestAnimationFrame||a8.oRequestAnimationFrame||a8.msRequestAnimationFrame||function(b){setTimeout(b,16)
},ai=function(){for(var S=+new Date,R=0;
R<aS.length;
R++){var Q=aS[R];
if(!Q.el.removed&&!Q.paused){var P,O,N=S-Q.start,M=Q.ms,L=Q.easing,K=Q.from,J=Q.diff,I=Q.to,H=(Q.t,Q.el),G={},F={};
if(Q.initstatus?(N=(Q.initstatus*Q.anim.top-Q.prev)/(Q.percent-Q.prev)*M,Q.status=Q.initstatus,delete Q.initstatus,Q.stop&&aS.splice(R--,1)):Q.status=(Q.prev+(Q.percent-Q.prev)*(N/M))/Q.anim.top,!(0>N)){if(M>N){var E=L(N/M);
for(var D in K){if(K[aA](D)){switch(ar[D]){case bl:P=+K[D]+E*M*J[D];
break;
case"colour":P="rgb("+[b9(b0(K[D].r+E*M*J[D].r)),b9(b0(K[D].g+E*M*J[D].g)),b9(b0(K[D].b+E*M*J[D].b))].join(",")+")";
break;
case"path":P=[];
for(var C=0,B=K[D].length;
B>C;
C++){P[C]=[K[D][C][0]];
for(var A=1,z=K[D][C].length;
z>A;
A++){P[C][A]=+K[D][C][A]+E*M*J[D][C][A]
}P[C]=P[C].join(bC)
}P=P.join(bC);
break;
case"transform":if(J[D].real){for(P=[],C=0,B=K[D].length;
B>C;
C++){for(P[C]=[K[D][C][0]],A=1,z=K[D][C].length;
z>A;
A++){P[C][A]=K[D][C][A]+E*M*J[D][C][A]
}}}else{var c=function(d){return +K[D][d]+E*M*J[D][d]
};
P=[["m",c(0),c(1),c(2),c(3),c(4),c(5)]]
}break;
case"csv":if("clip-rect"==D){for(P=[],C=4;
C--;
){P[C]=+K[D][C]+E*M*J[D][C]
}}break;
default:var b=[][bI](K[D]);
for(P=[],C=H.paper.customAttributes[D].length;
C--;
){P[C]=+b[C]+E*M*J[D][C]
}}G[D]=P
}}H.attr(G),function(e,g,f){setTimeout(function(){a7("raphael.anim.frame."+e,g,f)
})
}(H.id,H,Q.anim)
}else{if(function(f,h,g){setTimeout(function(){a7("raphael.anim.frame."+h.id,h,g),a7("raphael.anim.finish."+h.id,h,g),a6.is(f,"function")&&f.call(h)
})
}(Q.callback,H,Q.anim),H.attr(I),aS.splice(R--,1),Q.repeat>1&&!Q.next){for(O in I){I[aA](O)&&(F[O]=Q.totalOrigin[O])
}Q.el.attr(F),aI(Q.anim,Q.el,Q.anim.percents[0],null,Q.totalOrigin,Q.repeat-1)
}Q.next&&!Q.stop&&aI(Q.anim,Q.el,Q.next,null,Q.totalOrigin,Q.repeat)
}}}}a6.svg&&H&&H.paper&&H.paper.safari(),aS.length&&at(ai)
},b9=function(b){return b>255?255:0>b?0:b
};
bJ.animateWith=function(u,t,r,q,p,o){var n=this;
if(n.removed){return o&&o.call(n),n
}var m=r instanceof aJ?r:a6.animation(r,q,p,o);
aI(m,n,m.percents[0],null,n.attr());
for(var l=0,c=aS.length;
c>l;
l++){if(aS[l].anim==t&&aS[l].el==u){aS[c-1].start=aS[l].start;
break
}}return n
},bJ.onAnimation=function(b){return b?a7.on("raphael.anim.frame."+this.id,b):a7.unbind("raphael.anim.frame."+this.id),this
},aJ.prototype.delay=function(d){var c=new aJ(this.anim,this.ms);
return c.times=this.times,c.del=+d||0,c
},aJ.prototype.repeat=function(d){var c=new aJ(this.anim,this.ms);
return c.del=this.del,c.times=bt.floor(bs(d,0))||1,c
},a6.animation=function(i,c,n,m){if(i instanceof aJ){return i
}(a6.is(n,"function")||!n)&&(m=m||n||null,n=null),i=Object(i),c=+c||0;
var l,k,j={};
for(k in i){i[aA](k)&&bd(k)!=k&&bd(k)+"%"!=k&&(l=!0,j[k]=i[k])
}return l?(n&&(j.easing=n),m&&(j.callback=m),new aJ({100:j},c)):new aJ(i,c)
},bJ.animate=function(h,c,l,k){var j=this;
if(j.removed){return k&&k.call(j),j
}var i=h instanceof aJ?h:a6.animation(h,c,l,k);
return aI(i,j,i.percents[0],null,j.attr()),j
},bJ.setTime=function(d,c){return d&&null!=c&&this.status(d,br(c,d.ms)/d.ms),this
},bJ.status=function(h,g){var l,k,j=[],i=0;
if(null!=g){return aI(h,this,-1,br(g,1)),this
}for(l=aS.length;
l>i;
i++){if(k=aS[i],k.el.id==this.id&&(!h||k.anim==h)){if(h){return k.status
}j.push({anim:k.anim,status:k.status})
}}return h?0:j
},bJ.pause=function(b){for(var d=0;
d<aS.length;
d++){aS[d].el.id!=this.id||b&&aS[d].anim!=b||a7("raphael.anim.pause."+this.id,this,aS[d].anim)!==!1&&(aS[d].paused=!0)
}return this
},bJ.resume=function(b){for(var f=0;
f<aS.length;
f++){if(aS[f].el.id==this.id&&(!b||aS[f].anim==b)){var e=aS[f];
a7("raphael.anim.resume."+this.id,this,e.anim)!==!1&&(delete e.paused,this.status(e.anim,e.status))
}}return this
},bJ.stop=function(b){for(var d=0;
d<aS.length;
d++){aS[d].el.id!=this.id||b&&aS[d].anim!=b||a7("raphael.anim.stop."+this.id,this,aS[d].anim)!==!1&&aS.splice(d--,1)
}return this
},a7.on("raphael.remove",aH),a7.on("raphael.clear",aH),bJ.toString=function(){return"Raphals object"
};
var bX=function(e){if(this.items=[],this.length=0,this.type="set",e){for(var d=0,f=e.length;
f>d;
d++){!e[d]||e[d].constructor!=bJ.constructor&&e[d].constructor!=bX||(this[this.items.length]=this.items[this.items.length]=e[d],this.length++)
}}},bD=bX.prototype;
bD.push=function(){for(var f,e,h=0,g=arguments.length;
g>h;
h++){f=arguments[h],!f||f.constructor!=bJ.constructor&&f.constructor!=bX||(e=this.items.length,this[e]=this.items[e]=f,this.length++)
}return this
},bD.pop=function(){return this.length&&delete this[this.length--],this.items.pop()
},bD.forEach=function(f,e){for(var h=0,g=this.items.length;
g>h;
h++){if(f.call(e,this.items[h],h)===!1){return this
}}return this
};
for(var a0 in bJ){bJ[aA](a0)&&(bD[a0]=function(b){return function(){var a=arguments;
return this.forEach(function(d){d[b][bK](d,a)
})
}
}(a0))
}return bD.attr=function(h,c){if(h&&a6.is(h,bj)&&a6.is(h[0],"object")){for(var l=0,k=h.length;
k>l;
l++){this.items[l].attr(h[l])
}}else{for(var j=0,i=this.items.length;
i>j;
j++){this.items[j].attr(h,c)
}}return this
},bD.clear=function(){for(;
this.length;
){this.pop()
}},bD.splice=function(i,h){i=0>i?bs(this.length+i,0):i,h=bs(0,br(this.length-i,h));
var n,m=[],l=[],k=[];
for(n=2;
n<arguments.length;
n++){k.push(arguments[n])
}for(n=0;
h>n;
n++){l.push(this[i+n])
}for(;
n<this.length-i;
n++){m.push(this[i+n])
}var j=k.length;
for(n=0;
n<j+m.length;
n++){this.items[i+n]=this[i+n]=j>n?k[n]:m[n-j]
}for(n=this.items.length=this.length-=h-j;
this[n];
){delete this[n++]
}return new bX(l)
},bD.exclude=function(e){for(var d=0,f=this.length;
f>d;
d++){if(this[d]==e){return this.splice(d,1),!0
}}},bD.animate=function(u,t,r,q){(a6.is(r,"function")||!r)&&(q=r||null);
var p,o,n=this.items.length,m=n,l=this;
if(!n){return this
}q&&(o=function(){!--n&&q.call(l)
}),r=a6.is(r,bk)?r:o;
var c=a6.animation(u,t,r,o);
for(p=this.items[--m].animate(c);
m--;
){this.items[m]&&!this.items[m].removed&&this.items[m].animateWith(p,c,c),this.items[m]&&!this.items[m].removed||n--
}return this
},bD.insertAfter=function(d){for(var c=this.items.length;
c--;
){this.items[c].insertAfter(d)
}return this
},bD.getBBox=function(){for(var h=[],g=[],l=[],k=[],j=this.items.length;
j--;
){if(!this.items[j].removed){var i=this.items[j].getBBox();
h.push(i.x),g.push(i.y),l.push(i.x+i.width),k.push(i.y+i.height)
}}return h=br[bK](0,h),g=br[bK](0,g),l=bs[bK](0,l),k=bs[bK](0,k),{x:h,y:g,x2:l,y2:k,width:l-h,height:k-g}
},bD.clone=function(e){e=this.paper.set();
for(var d=0,f=this.items.length;
f>d;
d++){e.push(this.items[d].clone())
}return e
},bD.toString=function(){return"Raphals set"
},bD.glow=function(d){var c=this.paper.set();
return this.forEach(function(b){var a=b.glow(d);
null!=a&&a.forEach(function(e){c.push(e)
})
}),c
},bD.isPointInside=function(e,d){var f=!1;
return this.forEach(function(a){return a.isPointInside(e,d)?(console.log("runned"),f=!0,!1):void 0
}),f
},a6.registerFont=function(i){if(!i.face){return i
}this.fonts=this.fonts||{};
var h={w:i.w,face:{},glyphs:{}},n=i.face["font-family"];
for(var m in i.face){i.face[aA](m)&&(h.face[m]=i.face[m])
}if(this.fonts[n]?this.fonts[n].push(h):this.fonts[n]=[h],!i.svg){h.face["units-per-em"]=bT(i.face["units-per-em"],10);
for(var l in i.glyphs){if(i.glyphs[aA](l)){var k=i.glyphs[l];
if(h.glyphs[l]={w:k.w,k:{},d:k.d&&"M"+k.d.replace(/[mlcxtrv]/g,function(b){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[b]||"M"
})+"z"},k.k){for(var j in k.k){k[aA](j)&&(h.glyphs[l].k[j]=k.k[j])
}}}}}return i
},aF.getFont=function(u,t,r,q){if(q=q||"normal",r=r||"normal",t=+t||{normal:400,bold:700,lighter:300,bolder:800}[t]||400,a6.fonts){var p=a6.fonts[u];
if(!p){var o=new RegExp("(^|\\s)"+u.replace(/[^\w\d\s+!~.:_-]/g,bE)+"(\\s|$)","i");
for(var n in a6.fonts){if(a6.fonts[aA](n)&&o.test(n)){p=a6.fonts[n];
break
}}}var m;
if(p){for(var l=0,c=p.length;
c>l&&(m=p[l],m.face["font-weight"]!=t||m.face["font-style"]!=r&&m.face["font-style"]||m.face["font-stretch"]!=q);
l++){}}return m
}},aF.print=function(R,Q,P,O,N,M,L,K){M=M||"middle",L=bs(br(L||0,1),-1),K=bs(br(K||1,3),1);
var J,I=bB(P)[bA](bE),H=0,G=0,F=bE;
if(a6.is(O,"string")&&(O=this.getFont(O)),O){J=(N||16)/O.face["units-per-em"];
for(var E=O.face.bbox[bA](aE),D=+E[0],C=E[3]-E[1],B=0,A=+E[1]+("baseline"==M?C+ +O.face.descent:C/2),z=0,y=I.length;
y>z;
z++){if("\n"==I[z]){H=0,c=0,G=0,B+=C*K
}else{var w=G&&O.glyphs[I[z-1]]||{},c=O.glyphs[I[z]];
H+=G?(w.w||O.w)+(w.k&&w.k[I[z]]||0)+O.w*L:0,G=1
}c&&c.d&&(F+=a6.transformPath(c.d,["t",H*J,B*J,"s",J,J,D,A,"t",(R-D)/J,(Q-A)/J]))
}}return this.path(F).attr({fill:"#000",stroke:"none"})
},aF.add=function(g){if(a6.is(g,"array")){for(var c,j=this.set(),i=0,h=g.length;
h>i;
i++){c=g[i]||{},aD[aA](c.type)&&j.push(this[c.type]().attr(c))
}}return j
},a6.format=function(e,c){var f=a6.is(c,bj)?[0][bI](c):arguments;
return e&&a6.is(e,bk)&&f.length-1&&(e=e.replace(aC,function(g,d){return null==f[++d]?bE:f[d]
})),e||bE
},a6.fullfill=function(){var e=/\{([^\}]+)\}/g,d=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,f=function(b,i,h){var g=h;
return i.replace(d,function(k,j,n,m,l){j=j||m,g&&(j in g&&(g=g[j]),"function"==typeof g&&l&&(g=g()))
}),g=(null==g||g==h?b:g)+""
};
return function(a,c){return String(a).replace(e,function(h,g){return f(h,g,c)
})
}
}(),a6.ninja=function(){return bM.was?bO.win.Raphael=bM.is:delete Raphael,a6
},a6.st=bD,function(f,c,h){function g(){/in/.test(f.readyState)?setTimeout(g,9):a6.eve("raphael.DOMload")
}null==f.readyState&&f.addEventListener&&(f.addEventListener(c,h=function(){f.removeEventListener(c,h,!1),f.readyState="complete"
},!1),f.readyState="loading"),g()
}(document,"DOMContentLoaded"),a7.on("raphael.DOMload",function(){aG=!0
}),function(){if(a6.svg){var bc="hasOwnProperty",bb=String,ac=parseFloat,ab=parseInt,Z=Math,Y=Z.max,X=Z.abs,W=Z.pow,V=/[, ]+/,U=a6.eve,T="",S=" ",R="http://www.w3.org/1999/xlink",Q={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},P={};
a6.toString=function(){return"Your browser supports SVG.\nYou are running Raphal "+this.version
};
var N=function(g,b){if(b){"string"==typeof g&&(g=N(g));
for(var a in b){b[bc](a)&&("xlink:"==a.substring(0,6)?g.setAttributeNS(R,a.substring(6),bb(b[a])):g.setAttribute(a,bb(b[a])))
}}else{g=a6._g.doc.createElementNS("http://www.w3.org/2000/svg",g),g.style&&(g.style.webkitTapHighlightColor="rgba(0,0,0,0)")
}return g
},L=function(B,q){var l="linear",i=B.id+q,h=0.5,g=0.5,f=B.node,d=B.paper,b=f.style,ch=a6._g.doc.getElementById(i);
if(!ch){if(q=bb(q).replace(a6._radial_gradient,function(k,j,n){if(l="radial",j&&n){h=ac(j),g=ac(n);
var m=2*(g>0.5)-1;
W(h-0.5,2)+W(g-0.5,2)>0.25&&(g=Z.sqrt(0.25-W(h-0.5,2))*m+0.5)&&0.5!=g&&(g=g.toFixed(5)-0.00001*m)
}return T
}),q=q.split(/\s*\-\s*/),"linear"==l){var cg=q.shift();
if(cg=-ac(cg),isNaN(cg)){return null
}var cc=[0,0,Z.cos(a6.rad(cg)),Z.sin(a6.rad(cg))],cb=1/(Y(X(cc[2]),X(cc[3]))||1);
cc[2]*=cb,cc[3]*=cb,cc[2]<0&&(cc[0]=-cc[2],cc[2]=0),cc[3]<0&&(cc[1]=-cc[3],cc[3]=0)
}var C=a6._parseDots(q);
if(!C){return null
}if(i=i.replace(/[\(\)\s,\xb0#]/g,"_"),B.gradient&&i!=B.gradient.id&&(d.defs.removeChild(B.gradient),delete B.gradient),!B.gradient){ch=N(l+"Gradient",{id:i}),B.gradient=ch,N(ch,"radial"==l?{fx:h,fy:g}:{x1:cc[0],y1:cc[1],x2:cc[2],y2:cc[3],gradientTransform:B.matrix.invert()}),d.defs.appendChild(ch);
for(var A=0,z=C.length;
z>A;
A++){ch.appendChild(N("stop",{offset:C[A].offset?C[A].offset:A?"100%":"0%","stop-color":C[A].color||"#fff"}))
}}}return N(f,{fill:"url(#"+i+")",opacity:1,"fill-opacity":1}),b.fill=T,b.opacity=1,b.fillOpacity=1,1
},J=function(e){var d=e.getBBox(1);
N(e.pattern,{patternTransform:e.matrix.invert()+" translate("+d.x+","+d.y+")"})
},I=function(cw,cv,cu){if("path"==cw.type){for(var ct,cs,cr,cq,cp,co=bb(cv).toLowerCase().split("-"),cn=cw.paper,ck=cu?"end":"start",ci=cw.node,cg=cw.attrs,cb=cg["stroke-width"],p=co.length,o="classic",l=3,b=3,a=5;
p--;
){switch(co[p]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":o=co[p];
break;
case"wide":b=5;
break;
case"narrow":b=2;
break;
case"long":l=5;
break;
case"short":l=2
}}if("open"==o?(l+=2,b+=2,a+=2,cr=1,cq=cu?4:1,cp={fill:"none",stroke:cg.stroke}):(cq=cr=l/2,cp={fill:cg.stroke,stroke:"none"}),cw._.arrows?cu?(cw._.arrows.endPath&&P[cw._.arrows.endPath]--,cw._.arrows.endMarker&&P[cw._.arrows.endMarker]--):(cw._.arrows.startPath&&P[cw._.arrows.startPath]--,cw._.arrows.startMarker&&P[cw._.arrows.startMarker]--):cw._.arrows={},"none"!=o){var cm="raphael-marker-"+o,cl="raphael-marker-"+ck+o+l+b;
a6._g.doc.getElementById(cm)?P[cm]++:(cn.defs.appendChild(N(N("path"),{"stroke-linecap":"round",d:Q[o],id:cm})),P[cm]=1);
var cj,ch=a6._g.doc.getElementById(cl);
ch?(P[cl]++,cj=ch.getElementsByTagName("use")[0]):(ch=N(N("marker"),{id:cl,markerHeight:b,markerWidth:l,orient:"auto",refX:cq,refY:b/2}),cj=N(N("use"),{"xlink:href":"#"+cm,transform:(cu?"rotate(180 "+l/2+" "+b/2+") ":T)+"scale("+l/a+","+b/a+")","stroke-width":(1/((l/a+b/a)/2)).toFixed(4)}),ch.appendChild(cj),cn.defs.appendChild(ch),P[cl]=1),N(cj,cp);
var cc=cr*("diamond"!=o&&"oval"!=o);
cu?(ct=cw._.arrows.startdx*cb||0,cs=a6.getTotalLength(cg.path)-cc*cb):(ct=cc*cb,cs=a6.getTotalLength(cg.path)-(cw._.arrows.enddx*cb||0)),cp={},cp["marker-"+ck]="url(#"+cl+")",(cs||ct)&&(cp.d=a6.getSubpath(cg.path,ct,cs)),N(ci,cp),cw._.arrows[ck+"Path"]=cm,cw._.arrows[ck+"Marker"]=cl,cw._.arrows[ck+"dx"]=cc,cw._.arrows[ck+"Type"]=o,cw._.arrows[ck+"String"]=cv
}else{cu?(ct=cw._.arrows.startdx*cb||0,cs=a6.getTotalLength(cg.path)-ct):(ct=0,cs=a6.getTotalLength(cg.path)-(cw._.arrows.enddx*cb||0)),cw._.arrows[ck+"Path"]&&N(ci,{d:a6.getSubpath(cg.path,ct,cs)}),delete cw._.arrows[ck+"Path"],delete cw._.arrows[ck+"Marker"],delete cw._.arrows[ck+"dx"],delete cw._.arrows[ck+"Type"],delete cw._.arrows[ck+"String"]
}for(cp in P){if(P[bc](cp)&&!P[cp]){var q=a6._g.doc.getElementById(cp);
q&&q.parentNode.removeChild(q)
}}}},H={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},G=function(b,n,m){if(n=H[bb(n).toLowerCase()]){for(var l=b.attrs["stroke-width"]||"1",k={round:l,square:l,butt:0}[b.attrs["stroke-linecap"]||m["stroke-linecap"]]||0,j=[],i=n.length;
i--;
){j[i]=n[i]*l+(i%2?1:-1)*k
}N(b.node,{"stroke-dasharray":j.join(",")})
}},F=function(cl,ck){var cj=cl.node,ci=cl.attrs,ch=cj.style.visibility;
cj.style.visibility="hidden";
for(var cg in ck){if(ck[bc](cg)){if(!a6._availableAttrs[bc](cg)){continue
}var cc=ck[cg];
switch(ci[cg]=cc,cg){case"blur":cl.blur(cc);
break;
case"href":case"title":var q=N("title"),j=a6._g.doc.createTextNode(cc);
q.appendChild(j),cj.appendChild(q);
break;
case"target":var g=cj.parentNode;
if("a"!=g.tagName.toLowerCase()){var q=N("a");
g.insertBefore(q,cj),q.appendChild(cj),g=q
}"target"==cg?g.setAttributeNS(R,"show","blank"==cc?"new":cc):g.setAttributeNS(R,cg,cc);
break;
case"cursor":cj.style.cursor=cc;
break;
case"transform":cl.transform(cc);
break;
case"arrow-start":I(cl,cc);
break;
case"arrow-end":I(cl,cc,1);
break;
case"clip-rect":var a=bb(cc).split(V);
if(4==a.length){cl.clip&&cl.clip.parentNode.parentNode.removeChild(cl.clip.parentNode);
var cb=N("clipPath"),y=N("rect");
cb.id=a6.createUUID(),N(y,{x:a[0],y:a[1],width:a[2],height:a[3]}),cb.appendChild(y),cl.paper.defs.appendChild(cb),N(cj,{"clip-path":"url(#"+cb.id+")"}),cl.clip=y
}if(!cc){var v=cj.getAttribute("clip-path");
if(v){var t=a6._g.doc.getElementById(v.replace(/(^url\(#|\)$)/g,T));
t&&t.parentNode.removeChild(t),N(cj,{"clip-path":T}),delete cl.clip
}}break;
case"path":"path"==cl.type&&(N(cj,{d:cc?ci.path=a6._pathToAbsolute(cc):"M0,0"}),cl._.dirty=1,cl._.arrows&&("startString" in cl._.arrows&&I(cl,cl._.arrows.startString),"endString" in cl._.arrows&&I(cl,cl._.arrows.endString,1)));
break;
case"width":if(cj.setAttribute(cg,cc),cl._.dirty=1,!ci.fx){break
}cg="x",cc=ci.x;
case"x":ci.fx&&(cc=-ci.x-(ci.width||0));
case"rx":if("rx"==cg&&"rect"==cl.type){break
}case"cx":cj.setAttribute(cg,cc),cl.pattern&&J(cl),cl._.dirty=1;
break;
case"height":if(cj.setAttribute(cg,cc),cl._.dirty=1,!ci.fy){break
}cg="y",cc=ci.y;
case"y":ci.fy&&(cc=-ci.y-(ci.height||0));
case"ry":if("ry"==cg&&"rect"==cl.type){break
}case"cy":cj.setAttribute(cg,cc),cl.pattern&&J(cl),cl._.dirty=1;
break;
case"r":"rect"==cl.type?N(cj,{rx:cc,ry:cc}):cj.setAttribute(cg,cc),cl._.dirty=1;
break;
case"src":"image"==cl.type&&cj.setAttributeNS(R,"href",cc);
break;
case"stroke-width":(1!=cl._.sx||1!=cl._.sy)&&(cc/=Y(X(cl._.sx),X(cl._.sy))||1),cl.paper._vbSize&&(cc*=cl.paper._vbSize),cj.setAttribute(cg,cc),ci["stroke-dasharray"]&&G(cl,ci["stroke-dasharray"],ck),cl._.arrows&&("startString" in cl._.arrows&&I(cl,cl._.arrows.startString),"endString" in cl._.arrows&&I(cl,cl._.arrows.endString,1));
break;
case"stroke-dasharray":G(cl,cc,ck);
break;
case"fill":var r=bb(cc).match(a6._ISURL);
if(r){cb=N("pattern");
var n=N("image");
cb.id=a6.createUUID(),N(cb,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),N(n,{x:0,y:0,"xlink:href":r[1]}),cb.appendChild(n),function(d){a6._preload(r[1],function(){var f=this.offsetWidth,i=this.offsetHeight;
N(d,{width:f,height:i}),N(n,{width:f,height:i}),cl.paper.safari()
})
}(cb),cl.paper.defs.appendChild(cb),N(cj,{fill:"url(#"+cb.id+")"}),cl.pattern=cb,cl.pattern&&J(cl);
break
}var l=a6.getRGB(cc);
if(l.error){if(("circle"==cl.type||"ellipse"==cl.type||"r"!=bb(cc).charAt())&&L(cl,cc)){if("opacity" in ci||"fill-opacity" in ci){var h=a6._g.doc.getElementById(cj.getAttribute("fill").replace(/^url\(#|\)$/g,T));
if(h){var e=h.getElementsByTagName("stop");
N(e[e.length-1],{"stop-opacity":("opacity" in ci?ci.opacity:1)*("fill-opacity" in ci?ci["fill-opacity"]:1)})
}}ci.gradient=cc,ci.fill="none";
break
}}else{delete ck.gradient,delete ci.gradient,!a6.is(ci.opacity,"undefined")&&a6.is(ck.opacity,"undefined")&&N(cj,{opacity:ci.opacity}),!a6.is(ci["fill-opacity"],"undefined")&&a6.is(ck["fill-opacity"],"undefined")&&N(cj,{"fill-opacity":ci["fill-opacity"]})
}l[bc]("opacity")&&N(cj,{"fill-opacity":l.opacity>1?l.opacity/100:l.opacity});
case"stroke":l=a6.getRGB(cc),cj.setAttribute(cg,l.hex),"stroke"==cg&&l[bc]("opacity")&&N(cj,{"stroke-opacity":l.opacity>1?l.opacity/100:l.opacity}),"stroke"==cg&&cl._.arrows&&("startString" in cl._.arrows&&I(cl,cl._.arrows.startString),"endString" in cl._.arrows&&I(cl,cl._.arrows.endString,1));
break;
case"gradient":("circle"==cl.type||"ellipse"==cl.type||"r"!=bb(cc).charAt())&&L(cl,cc);
break;
case"opacity":ci.gradient&&!ci[bc]("stroke-opacity")&&N(cj,{"stroke-opacity":cc>1?cc/100:cc});
case"fill-opacity":if(ci.gradient){h=a6._g.doc.getElementById(cj.getAttribute("fill").replace(/^url\(#|\)$/g,T)),h&&(e=h.getElementsByTagName("stop"),N(e[e.length-1],{"stop-opacity":cc}));
break
}default:"font-size"==cg&&(cc=ab(cc,10)+"px");
var b=cg.replace(/(\-.)/g,function(d){return d.substring(1).toUpperCase()
});
cj.style[b]=cc,cl._.dirty=1,cj.setAttribute(cg,cc)
}}}D(cl,ck),cj.style.visibility=ch
},E=1.2,D=function(z,y){if("text"==z.type&&(y[bc]("text")||y[bc]("font")||y[bc]("font-size")||y[bc]("x")||y[bc]("y"))){var x=z.attrs,w=z.node,v=w.firstChild?ab(a6._g.doc.defaultView.getComputedStyle(w.firstChild,T).getPropertyValue("font-size"),10):10;
if(y[bc]("text")){for(x.text=y.text;
w.firstChild;
){w.removeChild(w.firstChild)
}for(var u,t=bb(y.text).split("\n"),q=[],l=0,e=t.length;
e>l;
l++){u=N("tspan"),l&&N(u,{dy:v*E,x:x.x}),u.appendChild(a6._g.doc.createTextNode(t[l])),w.appendChild(u),q[l]=u
}}else{for(q=w.getElementsByTagName("tspan"),l=0,e=q.length;
e>l;
l++){l?N(q[l],{dy:v*E,x:x.x}):N(q[0],{dy:0})
}}N(w,{x:x.x,y:x.y}),z._.dirty=1;
var b=z._getBBox(),a=x.y-(b.y+b.height/2);
a&&a6.is(a,"finite")&&N(q[0],{dy:a})
}},c=function(e,d){this[0]=this.node=e,e.raphael=!0,this.id=a6._oid++,e.raphaelid=this.id,this.matrix=a6.matrix(),this.realPath=null,this.paper=d,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!d.bottom&&(d.bottom=this),this.prev=d.top,d.top&&(d.top.next=this),d.top=this,this.next=null
},O=a6.el;
c.prototype=O,O.constructor=c,a6._engine.path=function(f,e){var h=N("path");
e.canvas&&e.canvas.appendChild(h);
var g=new c(h,e);
return g.type="path",F(g,{fill:"none",stroke:"#000",path:f}),g
},O.rotate=function(b,h,g){if(this.removed){return this
}if(b=bb(b).split(V),b.length-1&&(h=ac(b[1]),g=ac(b[2])),b=ac(b[0]),null==g&&(h=g),null==h||null==g){var d=this.getBBox(1);
h=d.x+d.width/2,g=d.y+d.height/2
}return this.transform(this._.transform.concat([["r",b,h,g]])),this
},O.scale=function(b,j,i,h){if(this.removed){return this
}if(b=bb(b).split(V),b.length-1&&(j=ac(b[1]),i=ac(b[2]),h=ac(b[3])),b=ac(b[0]),null==j&&(j=b),null==h&&(i=h),null==i||null==h){var d=this.getBBox(1)
}return i=null==i?d.x+d.width/2:i,h=null==h?d.y+d.height/2:h,this.transform(this._.transform.concat([["s",b,j,i,h]])),this
},O.translate=function(b,d){return this.removed?this:(b=bb(b).split(V),b.length-1&&(d=ac(b[1])),b=ac(b[0])||0,d=+d||0,this.transform(this._.transform.concat([["t",b,d]])),this)
},O.transform=function(a){var g=this._;
if(null==a){return g.transform
}if(a6._extractTransform(this,a),this.clip&&N(this.clip,{transform:this.matrix.invert()}),this.pattern&&J(this),this.node&&N(this.node,{transform:this.matrix}),1!=g.sx||1!=g.sy){var f=this.attrs[bc]("stroke-width")?this.attrs["stroke-width"]:1;
this.attr({"stroke-width":f})
}return this
},O.hide=function(){return !this.removed&&this.paper.safari(this.node.style.display="none"),this
},O.show=function(){return !this.removed&&this.paper.safari(this.node.style.display=""),this
},O.remove=function(){if(!this.removed&&this.node.parentNode){var e=this.paper;
e.__set__&&e.__set__.exclude(this),U.unbind("raphael.*.*."+this.id),this.gradient&&e.defs.removeChild(this.gradient),a6._tear(this,e),"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.removeChild(this.node.parentNode):this.node.parentNode.removeChild(this.node);
for(var d in this){this[d]="function"==typeof this[d]?a6._removedFactory(d):null
}this.removed=!0
}},O._getBBox=function(){if("none"==this.node.style.display){this.show();
var e=!0
}var d={};
try{d=this.node.getBBox()
}catch(f){}finally{d=d||{}
}return e&&this.hide(),d
},O.attr=function(z,y){if(this.removed){return this
}if(null==z){var x={};
for(var w in this.attrs){this.attrs[bc](w)&&(x[w]=this.attrs[w])
}return x.gradient&&"none"==x.fill&&(x.fill=x.gradient)&&delete x.gradient,x.transform=this._.transform,x
}if(null==y&&a6.is(z,"string")){if("fill"==z&&"none"==this.attrs.fill&&this.attrs.gradient){return this.attrs.gradient
}if("transform"==z){return this._.transform
}for(var v=z.split(V),u={},t=0,r=v.length;
r>t;
t++){z=v[t],u[z]=z in this.attrs?this.attrs[z]:a6.is(this.paper.customAttributes[z],"function")?this.paper.customAttributes[z].def:a6._availableAttrs[z]
}return r-1?u:u[v[0]]
}if(null==y&&a6.is(z,"array")){for(u={},t=0,r=z.length;
r>t;
t++){u[z[t]]=this.attr(z[t])
}return u
}if(null!=y){var q={};
q[z]=y
}else{null!=z&&a6.is(z,"object")&&(q=z)
}for(var k in q){U("raphael.attr."+k+"."+this.id,this,q[k])
}for(k in this.paper.customAttributes){if(this.paper.customAttributes[bc](k)&&q[bc](k)&&a6.is(this.paper.customAttributes[k],"function")){var j=this.paper.customAttributes[k].apply(this,[].concat(q[k]));
this.attrs[k]=q[k];
for(var a in j){j[bc](a)&&(q[a]=j[a])
}}}return F(this,q),this
},O.toFront=function(){if(this.removed){return this
}"a"==this.node.parentNode.tagName.toLowerCase()?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);
var b=this.paper;
return b.top!=this&&a6._tofront(this,b),this
},O.toBack=function(){if(this.removed){return this
}var b=this.node.parentNode;
return"a"==b.tagName.toLowerCase()?b.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):b.firstChild!=this.node&&b.insertBefore(this.node,this.node.parentNode.firstChild),a6._toback(this,this.paper),this.paper,this
},O.insertAfter=function(e){if(this.removed){return this
}var d=e.node||e[e.length-1].node;
return d.nextSibling?d.parentNode.insertBefore(this.node,d.nextSibling):d.parentNode.appendChild(this.node),a6._insertafter(this,e,this.paper),this
},O.insertBefore=function(e){if(this.removed){return this
}var d=e.node||e[0].node;
return d.parentNode.insertBefore(this.node,d),a6._insertbefore(this,e,this.paper),this
},O.blur=function(g){var f=this;
if(0!==+g){var i=N("filter"),h=N("feGaussianBlur");
f.attrs.blur=g,i.id=a6.createUUID(),N(h,{stdDeviation:+g||1.5}),i.appendChild(h),f.paper.defs.appendChild(i),f._blur=i,N(f.node,{filter:"url(#"+i.id+")"})
}else{f._blur&&(f._blur.parentNode.removeChild(f._blur),delete f._blur,delete f.attrs.blur),f.node.removeAttribute("filter")
}return f
},a6._engine.circle=function(h,g,l,k){var j=N("circle");
h.canvas&&h.canvas.appendChild(j);
var i=new c(j,h);
return i.attrs={cx:g,cy:l,r:k,fill:"none",stroke:"#000"},i.type="circle",N(j,i.attrs),i
},a6._engine.rect=function(j,i,p,o,n,m){var l=N("rect");
j.canvas&&j.canvas.appendChild(l);
var k=new c(l,j);
return k.attrs={x:i,y:p,width:o,height:n,r:m||0,rx:m||0,ry:m||0,fill:"none",stroke:"#000"},k.type="rect",N(l,k.attrs),k
},a6._engine.ellipse=function(i,h,n,m,l){var k=N("ellipse");
i.canvas&&i.canvas.appendChild(k);
var j=new c(k,i);
return j.attrs={cx:h,cy:n,rx:m,ry:l,fill:"none",stroke:"#000"},j.type="ellipse",N(k,j.attrs),j
},a6._engine.image=function(j,i,p,o,n,m){var l=N("image");
N(l,{x:p,y:o,width:n,height:m,preserveAspectRatio:"none"}),l.setAttributeNS(R,"href",i),j.canvas&&j.canvas.appendChild(l);
var k=new c(l,j);
return k.attrs={x:p,y:o,width:n,height:m,src:i},k.type="image",k
},a6._engine.text=function(i,h,m,l){var k=N("text");
i.canvas&&i.canvas.appendChild(k);
var j=new c(k,i);
return j.attrs={x:h,y:m,"text-anchor":"middle",text:l,font:a6._availableAttrs.font,stroke:"none",fill:"#000"},j.type="text",F(j,j.attrs),j
},a6._engine.setSize=function(e,d){return this.width=e||this.width,this.height=d||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox),this
},a6._engine.create=function(){var t=a6._getContainer.apply(0,arguments),r=t&&t.container,q=t.x,p=t.y,o=t.width,n=t.height;
if(!r){throw new Error("SVG container not found.")
}var m,l=N("svg"),k="overflow:hidden;";
return q=q||0,p=p||0,o=o||512,n=n||342,N(l,{height:n,version:1.1,width:o,xmlns:"http://www.w3.org/2000/svg"}),1==r?(l.style.cssText=k+"position:absolute;left:"+q+"px;top:"+p+"px",a6._g.doc.body.appendChild(l),m=1):(l.style.cssText=k+"position:relative",r.firstChild?r.insertBefore(l,r.firstChild):r.appendChild(l)),r=new a6._Paper,r.width=o,r.height=n,r.canvas=l,r.clear(),r._left=r._top=0,m&&(r.renderfix=function(){}),r.renderfix(),r
},a6._engine.setViewBox=function(u,t,r,q,p){U("raphael.setViewBox",this,this._viewBox,[u,t,r,q,p]);
var o,n,m=Y(r/this.width,q/this.height),k=this.top,g=p?"meet":"xMinYMin";
for(null==u?(this._vbSize&&(m=1),delete this._vbSize,o="0 0 "+this.width+S+this.height):(this._vbSize=m,o=u+S+t+S+r+S+q),N(this.canvas,{viewBox:o,preserveAspectRatio:g});
m&&k;
){n="stroke-width" in k.attrs?k.attrs["stroke-width"]:1,k.attr({"stroke-width":n}),k._.dirty=1,k._.dirtyT=1,k=k.prev
}return this._viewBox=[u,t,r,q,!!p],this
},a6.prototype.renderfix=function(){var h,g=this.canvas,l=g.style;
try{h=g.getScreenCTM()||g.createSVGMatrix()
}catch(k){h=g.createSVGMatrix()
}var j=-h.e%1,i=-h.f%1;
(j||i)&&(j&&(this._left=(this._left+j)%1,l.left=this._left+"px"),i&&(this._top=(this._top+i)%1,l.top=this._top+"px"))
},a6.prototype.clear=function(){a6.eve("raphael.clear",this);
for(var b=this.canvas;
b.firstChild;
){b.removeChild(b.firstChild)
}this.bottom=this.top=null,(this.desc=N("desc")).appendChild(a6._g.doc.createTextNode("Created with Raphal "+a6.version)),b.appendChild(this.desc),b.appendChild(this.defs=N("defs"))
},a6.prototype.remove=function(){U("raphael.remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);
for(var b in this){this[b]="function"==typeof this[b]?a6._removedFactory(b):null
}};
var M=a6.st;
for(var K in O){O[bc](K)&&!M[bc](K)&&(M[K]=function(b){return function(){var a=arguments;
return this.forEach(function(d){d[b].apply(d,a)
})
}
}(K))
}}}(),function(){if(a6.vml){var cn="hasOwnProperty",cm=String,cl=parseFloat,ck=Math,cj=ck.round,ci=ck.max,ch=ck.min,cg=ck.abs,cc="fill",cb=/[, ]+/,bc=a6.eve,bb=" progid:DXImageTransform.Microsoft",ac=" ",ab="",Z={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},X=/([clmz]),?([^clmz]*)/gi,V=/ progid:\S+Blur\([^\)]+\)/g,T=/-?[^,\s-]+/g,R="position:absolute;left:0;top:0;width:1px;height:1px",P=21600,N={path:1,rect:1,image:1},L={circle:1,ellipse:1},J=function(x){var w=/[ahqstv]/gi,v=a6._pathToAbsolute;
if(cm(x).match(w)&&(v=a6._path2curve),w=/[clmz]/g,v==a6._pathToAbsolute&&!cm(x).match(w)){var u=cm(x).replace(X,function(i,h,m){var l=[],k="m"==h.toLowerCase(),j=Z[h];
return m.replace(T,function(d){k&&2==l.length&&(j+=l+Z["m"==h?"l":"L"],l=[]),l.push(cj(d*P))
}),j+l
});
return u
}var t,q,p=v(x);
u=[];
for(var o=0,n=p.length;
n>o;
o++){t=p[o],q=p[o][0].toLowerCase(),"z"==q&&(q="x");
for(var f=1,b=t.length;
b>f;
f++){q+=cj(t[f]*P)+(f!=b-1?",":ab)
}u.push(q)
}return u.join(ac)
},I=function(g,f,i){var h=a6.matrix();
return h.rotate(-g,0.5,0.5),{dx:h.x(f,i),dy:h.y(f,i)}
},c=function(F,E,D,C,B,A){var z=F._,y=F.matrix,x=z.fillpos,w=F.node,v=w.style,u=1,n="",j=P/E,i=P/D;
if(v.visibility="hidden",E&&D){if(w.coordsize=cg(j)+ac+cg(i),v.rotation=A*(0>E*D?-1:1),A){var H=I(A,C,B);
C=H.dx,B=H.dy
}if(0>E&&(n+="x"),0>D&&(n+=" y")&&(u=-1),v.flip=n,w.coordorigin=C*-j+ac+B*-i,x||z.fillsize){var G=w.getElementsByTagName(cc);
G=G&&G[0],w.removeChild(G),x&&(H=I(A,y.x(x[0],x[1]),y.y(x[0],x[1])),G.position=H.dx*u+ac+H.dy*u),z.fillsize&&(G.size=z.fillsize[0]*cg(E)+ac+z.fillsize[1]*cg(D)),w.appendChild(G)
}v.visibility="visible"
}};
a6.toString=function(){return"Your browser doesnt support SVG. Falling down to VML.\nYou are running Raphal "+this.version
};
var Y=function(u,t,r){for(var q=cm(t).toLowerCase().split("-"),p=r?"end":"start",o=q.length,n="classic",m="medium",l="medium";
o--;
){switch(q[o]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":n=q[o];
break;
case"wide":case"narrow":l=q[o];
break;
case"long":case"short":m=q[o]
}}var b=u.node.getElementsByTagName("stroke")[0];
b[p+"arrow"]=n,b[p+"arrowlength"]=m,b[p+"arrowwidth"]=l
},W=function(cD,cC){cD.attrs=cD.attrs||{};
var cB=cD.node,cA=cD.attrs,cz=cB.style,cy=N[cD.type]&&(cC.x!=cA.x||cC.y!=cA.y||cC.width!=cA.width||cC.height!=cA.height||cC.cx!=cA.cx||cC.cy!=cA.cy||cC.rx!=cA.rx||cC.ry!=cA.ry||cC.r!=cA.r),cw=L[cD.type]&&(cA.cx!=cC.cx||cA.cy!=cC.cy||cA.r!=cC.r||cA.rx!=cC.rx||cA.ry!=cC.ry),cu=cD;
for(var ct in cC){cC[cn](ct)&&(cA[ct]=cC[ct])
}if(cy&&(cA.path=a6._getPath[cD.type](cD),cD._.dirty=1),cC.href&&(cB.href=cC.href),cC.title&&(cB.title=cC.title),cC.target&&(cB.target=cC.target),cC.cursor&&(cz.cursor=cC.cursor),"blur" in cC&&cD.blur(cC.blur),(cC.path&&"path"==cD.type||cy)&&(cB.path=J(~cm(cA.path).toLowerCase().indexOf("r")?a6._pathToAbsolute(cA.path):cA.path),"image"==cD.type&&(cD._.fillpos=[cA.x,cA.y],cD._.fillsize=[cA.width,cA.height],c(cD,1,1,0,0,0))),"transform" in cC&&cD.transform(cC.transform),cw){var co=+cA.cx,cx=+cA.cy,cv=+cA.rx||+cA.r||0,cs=+cA.ry||+cA.r||0;
cB.path=a6.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",cj((co-cv)*P),cj((cx-cs)*P),cj((co+cv)*P),cj((cx+cs)*P),cj(co*P)),cD._.dirty=1
}if("clip-rect" in cC){var cr=cm(cC["clip-rect"]).split(cb);
if(4==cr.length){cr[2]=+cr[2]+ +cr[0],cr[3]=+cr[3]+ +cr[1];
var cq=cB.clipRect||a6._g.doc.createElement("div"),cp=cq.style;
cp.clip=a6.format("rect({1}px {2}px {3}px {0}px)",cr),cB.clipRect||(cp.position="absolute",cp.top=0,cp.left=0,cp.width=cD.paper.width+"px",cp.height=cD.paper.height+"px",cB.parentNode.insertBefore(cq,cB),cq.appendChild(cB),cB.clipRect=cq)
}cC["clip-rect"]||cB.clipRect&&(cB.clipRect.style.clip="auto")
}if(cD.textpath){var F=cD.textpath.style;
cC.font&&(F.font=cC.font),cC["font-family"]&&(F.fontFamily='"'+cC["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,ab)+'"'),cC["font-size"]&&(F.fontSize=cC["font-size"]),cC["font-weight"]&&(F.fontWeight=cC["font-weight"]),cC["font-style"]&&(F.fontStyle=cC["font-style"])
}if("arrow-start" in cC&&Y(cu,cC["arrow-start"]),"arrow-end" in cC&&Y(cu,cC["arrow-end"],1),null!=cC.opacity||null!=cC["stroke-width"]||null!=cC.fill||null!=cC.src||null!=cC.stroke||null!=cC["stroke-width"]||null!=cC["stroke-opacity"]||null!=cC["fill-opacity"]||null!=cC["stroke-dasharray"]||null!=cC["stroke-miterlimit"]||null!=cC["stroke-linejoin"]||null!=cC["stroke-linecap"]){var C=cB.getElementsByTagName(cc),A=!1;
if(C=C&&C[0],!C&&(A=C=O(cc)),"image"==cD.type&&cC.src&&(C.src=cC.src),cC.fill&&(C.on=!0),(null==C.on||"none"==cC.fill||null===cC.fill)&&(C.on=!1),C.on&&cC.fill){var z=cm(cC.fill).match(a6._ISURL);
if(z){C.parentNode==cB&&cB.removeChild(C),C.rotate=!0,C.src=z[1],C.type="tile";
var x=cD.getBBox(1);
C.position=x.x+ac+x.y,cD._.fillpos=[x.x,x.y],a6._preload(z[1],function(){cD._.fillsize=[this.offsetWidth,this.offsetHeight]
})
}else{C.color=a6.getRGB(cC.fill).hex,C.src=ab,C.type="solid",a6.getRGB(cC.fill).error&&(cu.type in {circle:1,ellipse:1}||"r"!=cm(cC.fill).charAt())&&U(cu,cC.fill,C)&&(cA.fill="none",cA.gradient=cC.fill,C.rotate=!1)
}}if("fill-opacity" in cC||"opacity" in cC){var w=((+cA["fill-opacity"]+1||2)-1)*((+cA.opacity+1||2)-1)*((+a6.getRGB(cC.fill).o+1||2)-1);
w=ch(ci(w,0),1),C.opacity=w,C.src&&(C.color="none")
}cB.appendChild(C);
var v=cB.getElementsByTagName("stroke")&&cB.getElementsByTagName("stroke")[0],u=!1;
!v&&(u=v=O("stroke")),(cC.stroke&&"none"!=cC.stroke||cC["stroke-width"]||null!=cC["stroke-opacity"]||cC["stroke-dasharray"]||cC["stroke-miterlimit"]||cC["stroke-linejoin"]||cC["stroke-linecap"])&&(v.on=!0),("none"==cC.stroke||null===cC.stroke||null==v.on||0==cC.stroke||0==cC["stroke-width"])&&(v.on=!1);
var o=a6.getRGB(cC.stroke);
v.on&&cC.stroke&&(v.color=o.hex),w=((+cA["stroke-opacity"]+1||2)-1)*((+cA.opacity+1||2)-1)*((+o.o+1||2)-1);
var n=0.75*(cl(cC["stroke-width"])||1);
if(w=ch(ci(w,0),1),null==cC["stroke-width"]&&(n=cA["stroke-width"]),cC["stroke-width"]&&(v.weight=n),n&&1>n&&(w*=n)&&(v.weight=1),v.opacity=w,cC["stroke-linejoin"]&&(v.joinstyle=cC["stroke-linejoin"]||"miter"),v.miterlimit=cC["stroke-miterlimit"]||8,cC["stroke-linecap"]&&(v.endcap="butt"==cC["stroke-linecap"]?"flat":"square"==cC["stroke-linecap"]?"square":"round"),cC["stroke-dasharray"]){var j={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};
v.dashstyle=j[cn](cC["stroke-dasharray"])?j[cC["stroke-dasharray"]]:ab
}u&&cB.appendChild(v)
}if("text"==cu.type){cu.paper.canvas.style.display=ab;
var h=cu.paper.span,g=100,f=cA.font&&cA.font.match(/\d+(?:\.\d*)?(?=px)/);
cz=h.style,cA.font&&(cz.font=cA.font),cA["font-family"]&&(cz.fontFamily=cA["font-family"]),cA["font-weight"]&&(cz.fontWeight=cA["font-weight"]),cA["font-style"]&&(cz.fontStyle=cA["font-style"]),f=cl(cA["font-size"]||f&&f[0])||10,cz.fontSize=f*g+"px",cu.textpath.string&&(h.innerHTML=cm(cu.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));
var d=h.getBoundingClientRect();
cu.W=cA.w=(d.right-d.left)/g,cu.H=cA.h=(d.bottom-d.top)/g,cu.X=cA.x,cu.Y=cA.y+cu.H/2,("x" in cC||"y" in cC)&&(cu.path.v=a6.format("m{0},{1}l{2},{1}",cj(cA.x*P),cj(cA.y*P),cj(cA.x*P)+1));
for(var b=["x","y","text","font","font-family","font-weight","font-style","font-size"],a=0,k=b.length;
k>a;
a++){if(b[a] in cC){cu._.dirty=1;
break
}}switch(cA["text-anchor"]){case"start":cu.textpath.style["v-text-align"]="left",cu.bbx=cu.W/2;
break;
case"end":cu.textpath.style["v-text-align"]="right",cu.bbx=-cu.W/2;
break;
default:cu.textpath.style["v-text-align"]="center",cu.bbx=0
}cu.textpath.style["v-text-kern"]=!0
}},U=function(x,w,v){x.attrs=x.attrs||{};
var u=(x.attrs,Math.pow),t="linear",r=".5 .5";
if(x.attrs.gradient=w,w=cm(w).replace(a6._radial_gradient,function(g,f,h){return t="radial",f&&h&&(f=cl(f),h=cl(h),u(f-0.5,2)+u(h-0.5,2)>0.25&&(h=ck.sqrt(0.25-u(f-0.5,2))*(2*(h>0.5)-1)+0.5),r=f+ac+h),ab
}),w=w.split(/\s*\-\s*/),"linear"==t){var o=w.shift();
if(o=-cl(o),isNaN(o)){return null
}}var n=a6._parseDots(w);
if(!n){return null
}if(x=x.shape||x.node,n.length){x.removeChild(v),v.on=!0,v.method="none",v.color=n[0].color,v.color2=n[n.length-1].color;
for(var e=[],d=0,b=n.length;
b>d;
d++){n[d].offset&&e.push(n[d].offset+ac+n[d].color)
}v.colors=e.length?e.join():"0% "+v.color,"radial"==t?(v.type="gradientTitle",v.focus="100%",v.focussize="0 0",v.focusposition=r,v.angle=0):(v.type="gradient",v.angle=(270-o)%360),x.appendChild(v)
}return 1
},S=function(e,d){this[0]=this.node=e,e.raphael=!0,this.id=a6._oid++,e.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=d,this.matrix=a6.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!d.bottom&&(d.bottom=this),this.prev=d.top,d.top&&(d.top.next=this),d.top=this,this.next=null
},Q=a6.el;
S.prototype=Q,Q.constructor=S,Q.transform=function(D){if(null==D){return this._.transform
}var C,B=this.paper._viewBoxShift,A=B?"s"+[B.scale,B.scale]+"-1-1t"+[B.dx,B.dy]:ab;
B&&(C=D=cm(D).replace(/\.{3}|\u2026/g,this._.transform||ab)),a6._extractTransform(this,A+D);
var z,y=this.matrix.clone(),x=this.skew,w=this.node,v=~cm(this.attrs.fill).indexOf("-"),u=!cm(this.attrs.fill).indexOf("url(");
if(y.translate(1,1),u||v||"image"==this.type){if(x.matrix="1 0 0 1",x.offset="0 0",z=y.split(),v&&z.noRotation||!z.isSimple){w.style.filter=y.toFilter();
var t=this.getBBox(),o=this.getBBox(1),n=t.x-o.x,b=t.y-o.y;
w.coordorigin=n*-P+ac+b*-P,c(this,1,1,n,b,0)
}else{w.style.filter=ab,c(this,z.scalex,z.scaley,z.dx,z.dy,z.rotate)
}}else{w.style.filter=ab,x.matrix=cm(y),x.offset=y.offset()
}return C&&(this._.transform=C),this
},Q.rotate=function(b,h,g){if(this.removed){return this
}if(null!=b){if(b=cm(b).split(cb),b.length-1&&(h=cl(b[1]),g=cl(b[2])),b=cl(b[0]),null==g&&(h=g),null==h||null==g){var d=this.getBBox(1);
h=d.x+d.width/2,g=d.y+d.height/2
}return this._.dirtyT=1,this.transform(this._.transform.concat([["r",b,h,g]])),this
}},Q.translate=function(b,d){return this.removed?this:(b=cm(b).split(cb),b.length-1&&(d=cl(b[1])),b=cl(b[0])||0,d=+d||0,this._.bbox&&(this._.bbox.x+=b,this._.bbox.y+=d),this.transform(this._.transform.concat([["t",b,d]])),this)
},Q.scale=function(b,j,i,h){if(this.removed){return this
}if(b=cm(b).split(cb),b.length-1&&(j=cl(b[1]),i=cl(b[2]),h=cl(b[3]),isNaN(i)&&(i=null),isNaN(h)&&(h=null)),b=cl(b[0]),null==j&&(j=b),null==h&&(i=h),null==i||null==h){var d=this.getBBox(1)
}return i=null==i?d.x+d.width/2:i,h=null==h?d.y+d.height/2:h,this.transform(this._.transform.concat([["s",b,j,i,h]])),this._.dirtyT=1,this
},Q.hide=function(){return !this.removed&&(this.node.style.display="none"),this
},Q.show=function(){return !this.removed&&(this.node.style.display=ab),this
},Q._getBBox=function(){return this.removed?{}:{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}
},Q.remove=function(){if(!this.removed&&this.node.parentNode){this.paper.__set__&&this.paper.__set__.exclude(this),a6.eve.unbind("raphael.*.*."+this.id),a6._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);
for(var b in this){this[b]="function"==typeof this[b]?a6._removedFactory(b):null
}this.removed=!0
}},Q.attr=function(z,y){if(this.removed){return this
}if(null==z){var x={};
for(var w in this.attrs){this.attrs[cn](w)&&(x[w]=this.attrs[w])
}return x.gradient&&"none"==x.fill&&(x.fill=x.gradient)&&delete x.gradient,x.transform=this._.transform,x
}if(null==y&&a6.is(z,"string")){if(z==cc&&"none"==this.attrs.fill&&this.attrs.gradient){return this.attrs.gradient
}for(var v=z.split(cb),u={},t=0,r=v.length;
r>t;
t++){z=v[t],u[z]=z in this.attrs?this.attrs[z]:a6.is(this.paper.customAttributes[z],"function")?this.paper.customAttributes[z].def:a6._availableAttrs[z]
}return r-1?u:u[v[0]]
}if(this.attrs&&null==y&&a6.is(z,"array")){for(u={},t=0,r=z.length;
r>t;
t++){u[z[t]]=this.attr(z[t])
}return u
}var l;
null!=y&&(l={},l[z]=y),null==y&&a6.is(z,"object")&&(l=z);
for(var k in l){bc("raphael.attr."+k+"."+this.id,this,l[k])
}if(l){for(k in this.paper.customAttributes){if(this.paper.customAttributes[cn](k)&&l[cn](k)&&a6.is(this.paper.customAttributes[k],"function")){var j=this.paper.customAttributes[k].apply(this,[].concat(l[k]));
this.attrs[k]=l[k];
for(var a in j){j[cn](a)&&(l[a]=j[a])
}}}l.text&&"text"==this.type&&(this.textpath.string=l.text),W(this,l)
}return this
},Q.toFront=function(){return !this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&a6._tofront(this,this.paper),this
},Q.toBack=function(){return this.removed?this:(this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),a6._toback(this,this.paper)),this)
},Q.insertAfter=function(b){return this.removed?this:(b.constructor==a6.st.constructor&&(b=b[b.length-1]),b.node.nextSibling?b.node.parentNode.insertBefore(this.node,b.node.nextSibling):b.node.parentNode.appendChild(this.node),a6._insertafter(this,b,this.paper),this)
},Q.insertBefore=function(b){return this.removed?this:(b.constructor==a6.st.constructor&&(b=b[0]),b.node.parentNode.insertBefore(this.node,b.node),a6._insertbefore(this,b,this.paper),this)
},Q.blur=function(f){var e=this.node.runtimeStyle,g=e.filter;
return g=g.replace(V,ab),0!==+f?(this.attrs.blur=f,e.filter=g+ac+bb+".Blur(pixelradius="+(+f||1.5)+")",e.margin=a6.format("-{0}px 0 0 -{0}px",cj(+f||1.5))):(e.filter=g,e.margin=0,delete this.attrs.blur),this
},a6._engine.path=function(h,g){var l=O("shape");
l.style.cssText=R,l.coordsize=P+ac+P,l.coordorigin=g.coordorigin;
var k=new S(l,g),j={fill:"none",stroke:"#000"};
h&&(j.path=h),k.type="path",k.path=[],k.Path=ab,W(k,j),g.canvas.appendChild(l);
var i=O("skew");
return i.on=!0,l.appendChild(i),k.skew=i,k.transform(ab),k
},a6._engine.rect=function(t,r,q,p,o,n){var m=a6._rectPath(r,q,p,o,n),l=t.path(m),k=l.attrs;
return l.X=k.x=r,l.Y=k.y=q,l.W=k.width=p,l.H=k.height=o,k.r=n,k.path=m,l.type="rect",l
},a6._engine.ellipse=function(h,g,l,k,j){var i=h.path();
return i.attrs,i.X=g-k,i.Y=l-j,i.W=2*k,i.H=2*j,i.type="ellipse",W(i,{cx:g,cy:l,rx:k,ry:j}),i
},a6._engine.circle=function(g,f,j,i){var h=g.path();
return h.attrs,h.X=f-i,h.Y=j-i,h.W=h.H=2*i,h.type="circle",W(h,{cx:f,cy:j,r:i}),h
},a6._engine.image=function(x,w,v,u,t,r){var q=a6._rectPath(v,u,t,r),p=x.path(q).attr({stroke:"none"}),o=p.attrs,n=p.node,j=n.getElementsByTagName(cc)[0];
return o.src=w,p.X=o.x=v,p.Y=o.y=u,p.W=o.width=t,p.H=o.height=r,o.path=q,p.type="image",j.parentNode==n&&n.removeChild(j),j.rotate=!0,j.src=w,j.type="tile",p._.fillpos=[v,u],p._.fillsize=[t,r],n.appendChild(j),c(p,1,1,0,0,0),p
},a6._engine.text=function(v,u,t,r){var q=O("shape"),p=O("path"),o=O("textpath");
u=u||0,t=t||0,r=r||"",p.v=a6.format("m{0},{1}l{2},{1}",cj(u*P),cj(t*P),cj(u*P)+1),p.textpathok=!0,o.string=cm(r),o.on=!0,q.style.cssText=R,q.coordsize=P+ac+P,q.coordorigin="0 0";
var n=new S(q,v),f={fill:"#000",stroke:"none",font:a6._availableAttrs.font,text:r};
n.shape=q,n.path=p,n.textpath=o,n.type="text",n.attrs.text=cm(r),n.attrs.x=u,n.attrs.y=t,n.attrs.w=1,n.attrs.h=1,W(n,f),q.appendChild(o),q.appendChild(p),v.canvas.appendChild(q);
var b=O("skew");
return b.on=!0,q.appendChild(b),n.skew=b,n.transform(ab),n
},a6._engine.setSize=function(f,e){var g=this.canvas.style;
return this.width=f,this.height=e,f==+f&&(f+="px"),e==+e&&(e+="px"),g.width=f,g.height=e,g.clip="rect(0 "+f+" "+e+" 0)",this._viewBox&&a6._engine.setViewBox.apply(this,this._viewBox),this
},a6._engine.setViewBox=function(v,u,t,r,q){a6.eve("raphael.setViewBox",this,this._viewBox,[v,u,t,r,q]);
var p,o,n=this.width,m=this.height,g=1/ci(t/n,r/m);
return q&&(p=m/r,o=n/t,n>t*p&&(v-=(n-t*p)/2/p),m>r*o&&(u-=(m-r*o)/2/o)),this._viewBox=[v,u,t,r,!!q],this._viewBoxShift={dx:-v,dy:-u,scale:g},this.forEach(function(b){b.transform("...")
}),this
};
var O;
a6._engine.initWin=function(e){var d=e.document;
d.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");
try{!d.namespaces.rvml&&d.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),O=function(b){return d.createElement("<rvml:"+b+' class="rvml">')
}
}catch(f){O=function(b){return d.createElement("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')
}
}},a6._engine.initWin(a6._g.win),a6._engine.create=function(){var t=a6._getContainer.apply(0,arguments),r=t.container,q=t.height,p=t.width,o=t.x,n=t.y;
if(!r){throw new Error("VML container not found.")
}var m=new a6._Paper,l=m.canvas=a6._g.doc.createElement("div"),k=l.style;
return o=o||0,n=n||0,p=p||512,q=q||342,m.width=p,m.height=q,p==+p&&(p+="px"),q==+q&&(q+="px"),m.coordsize=1000*P+ac+1000*P,m.coordorigin="0 0",m.span=a6._g.doc.createElement("span"),m.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(m.span),k.cssText=a6.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",p,q),1==r?(a6._g.doc.body.appendChild(l),k.left=o+"px",k.top=n+"px",k.position="absolute"):r.firstChild?r.insertBefore(l,r.firstChild):r.appendChild(l),m.renderfix=function(){},m
},a6.prototype.clear=function(){a6.eve("raphael.clear",this),this.canvas.innerHTML=ab,this.span=a6._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null
},a6.prototype.remove=function(){a6.eve("raphael.remove",this),this.canvas.parentNode.removeChild(this.canvas);
for(var b in this){this[b]="function"==typeof this[b]?a6._removedFactory(b):null
}return !0
};
var M=a6.st;
for(var K in Q){Q[cn](K)&&!M[cn](K)&&(M[K]=function(b){return function(){var a=arguments;
return this.forEach(function(d){d[b].apply(d,a)
})
}
}(K))
}}}(),bM.was?bO.win.Raphael=a6:Raphael=a6,a6
});
(function(d){function b(){var f=document.createElement("p");
var e=false;
if(f.addEventListener){f.addEventListener("DOMAttrModified",function(){e=true
},false)
}else{if(f.attachEvent){f.attachEvent("onDOMAttrModified",function(){e=true
})
}else{return false
}}f.setAttribute("id","target");
return e
}function a(g,i){if(g){var f=this.data("attr-old-value");
if(i.attributeName.indexOf("style")>=0){if(!f.style){f.style={}
}var h=i.attributeName.split(".");
i.attributeName=h[0];
i.oldValue=f.style[h[1]];
i.newValue=h[1]+":"+this.prop("style")[d.camelCase(h[1])];
f.style[h[1]]=i.newValue
}else{i.oldValue=f[i.attributeName];
i.newValue=this.attr(i.attributeName);
f[i.attributeName]=i.newValue
}this.data("attr-old-value",f)
}}var c=window.MutationObserver||window.WebKitMutationObserver;
d.fn.attrchange=function(h){var e={trackValues:false,callback:d.noop,context:this};
if(typeof h==="function"){e.callback=h
}else{d.extend(e,h)
}if(e.trackValues){d(this).each(function(o,p){var m={};
for(var j,o=0,n=p.attributes,k=n.length;
o<k;
o++){j=n.item(o);
m[j.nodeName]=j.value
}d(this).data("attr-old-value",m)
})
}if(c){var g={subtree:false,attributes:true,attributeOldValue:e.trackValues};
var f=new c(function(i){i.forEach(function(j){var k=j.target;
if(e.trackValues){j.newValue=d(k).attr(j.attributeName)
}e.callback.call(k,j,e.context)
})
});
return this.each(function(){f.observe(this,g)
})
}else{if(b()){return this.on("DOMAttrModified",function(i){if(i.originalEvent){i=i.originalEvent
}i.attributeName=i.attrName;
i.oldValue=i.prevValue;
e.callback.call(this,i,e.context)
})
}else{if("onpropertychange" in document.body){return this.on("propertychange",function(i){i.attributeName=window.event.propertyName;
a.call(d(this),e.trackValues,i,e.context);
e.callback.call(this,i,e.context)
})
}}}return this
}
})(jQuery);
(function(h,l,m,d){var k="Stack",g={debug:false,raphaelUrl:"http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js",events:true,version:"0.7",step:1.5,stripeAt:5,hasContainer:false,animationDelay:10,animation:false,baseHeightRatio:0.58},j,f,o,n,c,e="#ebebeb",a,b="#bbb";
f="M62.918000000000006 9.681999999999988c-0.003 -0.628 -0.233 -1.26 -0.683 -1.858c-1.303 -1.751 -4.273 -2.813 -7.358 -2.811c-0.769 -0.003 -1.551 0.061 -2.312 0.188c-1.833 -1.263 -4.046 -2.162 -6.343 -2.742c-3.002 -0.759 -6.119 -1.007 -8.988 -1.015c-4.874 0 -9.136 0.67 -11.311 1.085c-3.387 -1.212 -7.064 -1.81 -10.723 -2.065c-0.292 -0.021 -0.588 -0.033 -0.886 -0.033c-1.319 -0.008 -2.742 0.221 -3.838 0.799c-1.105 0.569 -1.652 1.438 -1.626 2.21c0.006 0.586 0.265 1.144 0.683 1.666c0.646 0.801 1.303 1.546 1.858 2.261c0.027 0.033 0.053 0.065 0.08 0.094c-1.763 1.268 -2.914 2.669 -3.833 4.023c-1.063 0.123 -2.075 0.194 -3.039 0.192c-0.165 0 -0.333 -0.003 -0.505 -0.008c-0.076 -0.002 -0.151 -0.002 -0.226 -0.002c-0.298 0 -0.661 0.009 -1.136 0.08c-0.697 0.084 -1.733 0.47 -2.173 0.972c-0.455 0.489 -0.469 0.869 -0.479 1.133c0 0.012 0 0.053 0.005 0.121c0.051 0.928 0.048 1.884 0.068 2.872c-0.009 0.742 0.003 1.447 -0.038 2.112c0 0.022 -0.003 0.067 -0.003 0.119c0.003 0.182 0.028 0.4 0.146 0.659c0.162 0.39 0.667 0.874 1.294 1.148c0.623 0.288 1.2 0.399 1.649 0.473c1.719 0.267 3.458 0.571 5.241 0.881c1.15 1.204 2.637 2.248 4.359 3.136c-0.629 0.906 -1.476 2.24 -2.274 3.88c-0.153 0.313 -0.251 0.64 -0.248 0.989c0 0.142 0.016 0.288 0.059 0.438c0.234 0.887 1.554 1.544 3.106 1.548c2.168 0.003 4.398 0.008 6.27 0.011c1.873 0.003 3.392 0.006 4.138 0.008c0.848 0.003 1.646 -0.189 2.236 -0.537c0.728 -0.439 1.544 -1.052 2.926 -2.218c0.286 0.021 0.605 0.048 0.948 0.07c1.339 0.092 3.138 0.175 5.473 0.181c1.299 0.004 2.763 -0.021 4.41 -0.074c0.068 0.415 0.168 0.84 0.378 1.288c0.379 0.785 1.612 1.325 3.021 1.327c0.243 0.004 1.633 0.008 3.388 0.009c1.755 0.005 3.875 0.008 5.574 0.01c0.852 0 1.598 0.002 2.146 0c0.275 0 0.497 0 0.666 0c0.086 0 0.159 -0.002 0.219 -0.002c0.034 -0.001 0.065 -0.001 0.105 -0.001c0.057 -0.004 0.057 0 0.273 -0.012c0.587 -0.03 1.285 -0.203 1.747 -0.441c0.708 -0.368 0.912 -0.738 1.02 -0.969c0.102 -0.243 0.109 -0.405 0.109 -0.543c-0.011 -0.38 -0.106 -0.601 -0.205 -0.861c-0.361 -0.854 -1.05 -1.927 -1.678 -2.88c-0.2 -0.306 -0.392 -0.585 -0.562 -0.831c0.362 -0.317 0.781 -0.687 1.226 -1.143c0.79 -0.804 1.56 -1.851 2.125 -3.268c0.983 -1.364 1.485 -2.826 1.549 -4.328c0.014 -0.225 0.022 -0.445 0.021 -0.659c-0.003 -0.593 -0.066 -1.163 -0.152 -1.716c-0.119 -0.641 -0.327 -1.168 -0.505 -1.6C61.971999999999994 12.193000000000012 62.94199999999999 10.963999999999999 62.918000000000006 9.681999999999988zM55.620999999999995 10.525000000000006c-1.204 0.302 -1.948 1.007 -1.862 1.762c0.183 1.272 0.785 2.118 0.823 2.655c0.077 0.491 0.127 0.955 0.129 1.408c0 0.174 -0.005 0.351 -0.018 0.522l-0.003 0.035c-0.048 1.146 -0.429 2.183 -1.157 3.149c-0.09 0.122 -0.159 0.25 -0.203 0.38c-0.461 1.166 -0.977 1.836 -1.519 2.4c-0.547 0.57 -1.225 1.067 -1.986 1.827c-0.48 0.485 -0.543 1.068 -0.168 1.588c0 0 0.167 0.233 0.426 0.604c0.327 0.471 0.797 1.162 1.22 1.83c-1.515 -0.001 -3.234 -0.006 -4.689 -0.009c-0.21 0 -0.413 0 -0.61 0c-0.017 -0.25 -0.022 -0.485 -0.025 -0.676c0 -0.097 0.003 -0.181 0.003 -0.246c0.013 -0.517 -0.359 -1.009 -1.015 -1.359c-0.659 -0.352 -1.542 -0.524 -2.429 -0.476c-2.879 0.157 -5.228 0.208 -7.124 0.205c-2.386 -0.005 -4.047 -0.097 -5.185 -0.186c-0.572 -0.045 -1.007 -0.088 -1.379 -0.122c-0.397 -0.035 -0.607 -0.078 -1.281 -0.088c-0.165 0 -0.359 0.003 -0.643 0.032c-0.833 0.087 -1.574 0.363 -2.04 0.771c-1.136 0.996 -1.968 1.673 -2.521 2.094c-0.742 -0.002 -1.657 -0.002 -2.675 -0.005c-0.712 0 -1.474 -0.003 -2.269 -0.003c0.4 -0.694 0.783 -1.285 1.103 -1.754c0.275 -0.401 0.508 -0.713 0.667 -0.92c0.078 -0.103 0.142 -0.181 0.178 -0.23c0.041 -0.047 0.052 -0.06 0.052 -0.06c0.542 -0.646 0.367 -1.421 -0.448 -1.969c-0.318 -0.213 -0.605 -0.343 -0.837 -0.448c-1.929 -0.832 -3.406 -1.803 -4.443 -2.977c-0.354 -0.426 -1.015 -0.836 -1.665 -1.062c-0.646 -0.231 -1.171 -0.311 -1.473 -0.365c-1.354 -0.233 -2.735 -0.478 -4.151 -0.713c0.005 -0.428 0.001 -0.842 0.008 -1.242v-0.035c-0.013 -0.527 -0.014 -1.062 -0.023 -1.602c1.074 -0.057 2.104 -0.165 3.098 -0.289c0.747 -0.094 1.612 -0.292 2.341 -0.655c0.732 -0.361 1.215 -0.833 1.5 -1.27c1.034 -1.573 2.208 -2.895 3.957 -3.893c0.542 -0.308 0.866 -0.721 0.915 -1.159c0.006 -0.046 0.01 -0.114 0.01 -0.206c-0.002 -0.668 -0.426 -1.175 -0.696 -1.459c-0.143 -0.149 -0.259 -0.254 -0.327 -0.322c-0.035 -0.035 -0.064 -0.061 -0.077 -0.073c-0.013 -0.014 -0.013 -0.018 -0.013 -0.014c-0.479 -0.618 -0.979 -1.2 -1.44 -1.756c2.724 0.259 5.187 0.751 7.388 1.592c0.467 0.181 0.837 0.284 1.029 0.348c0.829 0.273 1.838 0.31 2.72 0.104c0 0 0 0 0.025 -0.007c0.418 -0.102 5.323 -1.148 10.435 -1.127c2.254 0.003 4.52 0.209 6.483 0.71c1.967 0.503 3.663 1.268 5.067 2.565c0.496 0.464 1.314 0.771 2.243 0.852c0.178 0.013 0.362 0.021 0.567 0.021c1.146 0.003 1.968 -0.271 2.326 -0.403c0.132 -0.047 0.224 -0.083 0.281 -0.104c0.238 -0.053 0.459 -0.073 0.677 -0.073c0.697 0.01 1.284 0.21 1.595 0.615c0.118 0.157 0.164 0.302 0.164 0.427C56.637 10.026999999999987 56.367000000000004 10.325999999999993 55.620999999999995 10.525000000000006z";
o="M22.994999999999997 13.376000000000005c0.006 1.196 -0.983 2.164 -2.211 2.161c-1.229 -0.002 -2.233 -0.973 -2.241 -2.17c-0.005 -1.195 0.983 -2.162 2.216 -2.159C21.985999999999997 11.211000000000013 22.988999999999997 12.181000000000012 22.994999999999997 13.376000000000005z";
n="M92.189,41.444c2.433-2.177,3.867-5.299,3.844-8.555c0.002-1.587-0.328-3.194-0.981-4.709c-1.893-4.431-6.233-7.118-10.756-7.096c-1.126,0-2.269,0.162-3.384,0.492c-2.676-3.194-5.907-5.469-9.27-6.923c-4.39-1.911-8.951-2.525-13.154-2.527c-7.137,0.022-13.386,1.75-16.571,2.808c-4.95-3.058-10.334-4.555-15.69-5.186c-0.426-0.05-0.859-0.079-1.295-0.079c-1.931-0.009-4.019,0.575-5.63,2.045c-1.626,1.452-2.433,3.653-2.402,5.61c0.002,1.493,0.378,2.902,0.986,4.224c0.938,2.034,1.895,3.92,2.701,5.73c0.038,0.083,0.076,0.162,0.113,0.238c-2.59,3.223-4.289,6.781-5.645,10.226c-1.557,0.318-3.042,0.504-4.455,0.503c-0.242,0-0.487-0.005-0.734-0.017c-0.118-0.005-0.225-0.007-0.335-0.007c-0.438,0.003-0.969,0.026-1.666,0.213c-1.021,0.215-2.539,1.201-3.191,2.474c-0.671,1.244-0.695,2.207-0.708,2.881c0,0.023-0.003,0.13,0.005,0.301c0.064,2.354,0.053,4.785,0.072,7.286c-0.019,1.883-0.008,3.671-0.071,5.36c-0.003,0.059-0.006,0.166-0.006,0.3c0.001,0.462,0.035,1.017,0.21,1.678c0.23,0.985,0.966,2.209,1.883,2.909c0.909,0.721,1.752,1,2.412,1.182c2.512,0.666,5.059,1.435,7.664,2.213c1.677,3.049,3.847,5.689,6.358,7.934c-0.93,2.299-2.181,5.688-3.366,9.849c-0.226,0.793-0.37,1.626-0.372,2.515c0,0.354,0.023,0.727,0.082,1.111c0.335,2.244,2.264,3.906,4.534,3.906c3.178,0,6.442-0.001,9.185-0.001c2.743,0,4.966,0,6.06,0.001c1.243,0,2.412-0.492,3.281-1.379c1.07-1.115,2.273-2.676,4.305-5.645c0.42,0.06,0.886,0.121,1.388,0.18c1.961,0.229,4.596,0.427,8.014,0.427c1.901,0,4.047-0.062,6.461-0.209c0.095,1.058,0.235,2.133,0.541,3.267c0.552,1.988,2.351,3.357,4.414,3.357c0.358,0.002,2.393,0.002,4.963,0.002c2.569,0,5.674-0.002,8.166-0.005c1.246-0.003,2.34-0.005,3.143-0.011c0.4-0.002,0.729-0.004,0.975-0.006c0.125-0.002,0.229-0.004,0.321-0.006c0.05,0,0.095-0.003,0.154-0.004c0.081-0.007,0.084,0.004,0.401-0.031c0.858-0.078,1.879-0.517,2.559-1.129c1.042-0.937,1.345-1.875,1.506-2.465c0.152-0.613,0.162-1.023,0.165-1.371c-0.013-0.959-0.151-1.523-0.295-2.185c-0.521-2.169-1.521-4.888-2.429-7.298c-0.293-0.768-0.572-1.485-0.818-2.109c0.535-0.805,1.152-1.74,1.809-2.896c1.161-2.051,2.299-4.707,3.141-8.303c1.451-3.47,2.201-7.176,2.305-10.988c0.025-0.567,0.037-1.126,0.037-1.674c0-1.502-0.087-2.949-0.206-4.351C92.744,43.876,92.443,42.536,92.189,41.444zM85.34,35.069c-1.765,0.768-2.861,2.561-2.744,4.481c0.26,3.221,1.131,5.367,1.184,6.729c0.106,1.241,0.175,2.426,0.175,3.57c0,0.449-0.011,0.889-0.03,1.323l-0.003,0.089c-0.083,2.911-0.649,5.542-1.72,7.996c-0.139,0.316-0.238,0.638-0.301,0.968c-0.688,2.959-1.453,4.664-2.252,6.096c-0.801,1.449-1.799,2.714-2.922,4.646c-0.709,1.236-0.803,2.714-0.259,4.03c0,0.002,0.242,0.588,0.616,1.527c0.477,1.193,1.158,2.942,1.771,4.636c-2.217,0.003-4.737,0.003-6.869,0.003h-0.893c-0.021-0.629-0.029-1.229-0.029-1.707c0-0.246,0.002-0.458,0.004-0.629c0.022-1.309-0.512-2.559-1.476-3.444c-0.963-0.888-2.251-1.319-3.554-1.192c-4.217,0.412-7.656,0.557-10.434,0.557c-3.494-0.001-5.929-0.227-7.591-0.444c-0.836-0.11-1.476-0.217-2.018-0.308c-0.586-0.083-0.887-0.188-1.877-0.213c-0.238,0.001-0.527,0.009-0.94,0.082c-1.222,0.224-2.309,0.939-2.996,1.975c-1.673,2.533-2.898,4.253-3.709,5.324h-3.916c-1.044,0-2.164,0-3.325,0c0.591-1.758,1.156-3.262,1.631-4.452c0.407-1.022,0.748-1.812,0.982-2.337c0.117-0.262,0.208-0.458,0.266-0.583c0.058-0.125,0.075-0.156,0.075-0.157c0.799-1.641,0.548-3.604-0.639-4.988c-0.465-0.539-0.88-0.867-1.223-1.131c-2.818-2.104-4.973-4.557-6.481-7.531c-0.515-1.078-1.481-2.117-2.428-2.684c-0.947-0.581-1.713-0.781-2.154-0.917c-1.979-0.59-4.003-1.202-6.074-1.789c0.012-1.086,0.012-2.136,0.024-3.153v-0.09c-0.012-1.333-0.013-2.689-0.023-4.063c1.573-0.149,3.088-0.419,4.543-0.745c1.091-0.24,2.362-0.75,3.431-1.678c1.075-0.918,1.791-2.116,2.211-3.226c1.525-3.991,3.258-7.354,5.831-9.893c0.793-0.786,1.271-1.832,1.349-2.946c0.008-0.118,0.019-0.292,0.019-0.527c0-1.685-0.618-2.974-1.012-3.695c-0.207-0.373-0.373-0.64-0.476-0.814c-0.051-0.087-0.087-0.15-0.108-0.188c-0.02-0.035-0.017-0.036-0.018-0.035c-0.698-1.563-1.422-3.035-2.095-4.446c3.99,0.648,7.593,1.886,10.806,4.004c0.683,0.456,1.226,0.714,1.506,0.878c1.214,0.682,2.692,0.772,3.981,0.247c0,0,0,0,0.037-0.015c0.614-0.263,7.809-2.94,15.295-2.914c3.304-0.003,6.616,0.504,9.487,1.762c2.875,1.273,5.356,3.199,7.399,6.491c0.722,1.171,1.917,1.952,3.28,2.138c0.258,0.037,0.527,0.057,0.826,0.058c1.68-0.002,2.886-0.706,3.412-1.035c0.193-0.122,0.33-0.215,0.414-0.27c0.35-0.131,0.672-0.185,0.988-0.186c1.021,0.023,1.879,0.526,2.333,1.55c0.171,0.401,0.236,0.761,0.237,1.087C86.835,33.804,86.434,34.559,85.34,35.069z";
c="M37.53,42.465c0,3.038-1.459,5.495-3.259,5.495c-1.802,0-3.261-2.458-3.261-5.495c0-3.029,1.46-5.489,3.261-5.489C36.071,36.977,37.53,39.436,37.53,42.465z";
function i(q,p){this.element=q;
this.$element=h(q);
this.options={};
this.options=h.extend({},g,p);
this._defaults=g;
this._name=k;
if(!p.step){this.options.stepover=true;
this.options.step=j.getStep(this.$element)
}this.init()
}j=i.prototype;
j.getStep=function(q){var p=(q.height()/q.width());
var r=13.2173-(4.1956*p);
return r
};
j.loadRaphael=function(){var p,q=h.Deferred();
if(!l.Raphael){p=h.getScript(this.options.raphaelUrl)
}else{return q.resolve()
}return p
};
j.checkVisibilityAndInit=function(q,p){if(q.attributeName==="style"){if(q.newValue==="display: inline-block;"||q.newValue==="display: block;"){p.init()
}else{if(q.newValue==="display: none;"){if(p.paper){p.paper.forEach(function(r){r.hide()
})
}}else{return false
}}}};
j.initPaper=function(){var p=this.$element.offset(),t=this.$element.outerWidth(),r=this.$element.outerHeight(),q=this.$element.attr("id");
this.posLeft=p.left;
this.posTop=p.top;
this.posWidth=t;
this.posHeight=r;
if(this.posHeight===0||this.posWidth===0){this.debugMessage("Element width or height are not set","warn")
}if(!this.paper){this.paper=l.Raphael(q,"100%","100%")
}};
j.listenToEvents=function(){var p=this;
if(!this.eventsAreSet&&this.options.events){this.$element.on("stack:clear",function(q){q.stopPropagation();
q.preventDefault();
if(p.animationTimeout){clearTimeout(p.animationTimeout)
}p.paper.clear();
p.debugMessage("canvas is clear")
});
this.$element.on("stack:percentage",function(t,r,q,u){t.stopPropagation();
t.preventDefault();
p.totalPercentage=r;
p.options.stacks[q].percentage=u;
p.debugMessage("new percentage set: "+u)
});
this.$element.on("stack:resetStacks",function(q){q.stopPropagation();
q.preventDefault();
p.options.stacks=[];
p.debugMessage("all stacks are removed from config")
});
this.$element.on("stack:addStack",function(r,q){r.stopPropagation();
r.preventDefault();
p.options.stacks.push(q);
p.debugMessage("added a stack")
});
this.$element.on("stack:render",function(q,r){q.stopPropagation();
q.preventDefault();
if(r){b=r
}p.initPaper();
p.render();
p.debugMessage("chart is rendered")
});
this.$element.on("stack:rerender",function(q){q.stopPropagation();
q.preventDefault();
p.initPaper();
p.render(false);
p.debugMessage("chart is rendered")
});
this.eventsAreSet=true
}};
j.renderPigIfEmpty=function(){var v=_.reduce(this.options.stacks,function(D,B){var C=B.percentage||0;
return D+C
},0);
if(v<=0){if(this.flatPigElement||this.flatPigsEyeElement){this.flatPigElement.remove();
this.flatPigsEyeElement.remove()
}this.flatPigElement=this.paper.path(n);
this.flatPigsEyeElement=this.paper.path(c);
var A=this.paper.set();
A.push(this.flatPigElement,this.flatPigsEyeElement);
A.attr({fill:b,opacity:1,"stroke-width":0,x:0,y:0});
var q=this.flatPigElement.getBBox();
var x=-1*q.cx;
var w=-1*q.cy;
var z=(this.posWidth/100)*0.8;
var t=q.width*z;
var u=q.height*z;
var r=this.posWidth/2;
var p=this.posHeight-a;
var y=a+(p/2);
A.transform("T"+x+","+w+"S"+z+"T"+r+","+y)
}};
j.getEllipseDimensions=function(p){var q={baseWidth:this.posWidth/2-2,baseHeight:this.posWidth*this.options.baseHeightRatio/2,baseX:this.posWidth/2,baseY:this.posHeight-this.posWidth*this.options.baseHeightRatio/2-p*this.options.step-2};
a=a||this.posHeight;
if(q.baseY<a){a=q.baseY-(q.baseHeight/2)
}return q
};
j.getEllipseColors=function(p,q){var r={fillColor:p.primaryColor,strokeColor:p.strokeColor||p.primaryColor};
if(q===(this.totalPercentage+p.percentage)*this.options.step){r.fillColor=p.secondaryColor||p.primaryColor;
r.strokeColor=p.strokeColor||p.secondaryColor||p.primaryColor
}if(!p.isContainer){r.strokeColor=((Math.round(q/this.options.step))%(this.options.stripeAt)===0)?"#FFFFFF":r.strokeColor
}else{r.strokeColor=(Math.round(q/this.options.step)+1===100)?"#FFFFFF":r.strokeColor
}return r
};
j.getEllipseOpacity=function(p){return p.opacity||(this.options.animation)?0:1
};
j.drawEllipse=function(p,t,u){var w=this.getEllipseDimensions(u),q=this.getEllipseColors(t,u),v=this.paper.ellipse(w.baseX,w.baseY,w.baseWidth,w.baseHeight),r=this.getEllipseOpacity(t);
if(t.isContainer){r=1
}v.attr({stroke:q.strokeColor,"stroke-opacity":r});
v.attr({fill:q.fillColor,"fill-opacity":r});
p.push(v)
};
j.drawStack=function(q){var r,p,t=this.totalPercentage*this.options.step;
p=this.stacks[this.stacks.length]=[];
for(r=t;
r<=t+q.percentage*this.options.step;
r+=1*this.options.step){if(q.percentage!==0){this.drawEllipse(p,q,r)
}}this.stack=p;
this.totalPercentage+=q.percentage
};
j.drawContainer=function(){var q,p={primaryColor:e,secondaryColor:e,percentage:100,isContainer:true};
a=this.posHeight;
for(q=0;
q<=100*this.options.step-1;
q+=1*this.options.step){this.drawEllipse([],p,q)
}};
j.animateEllipses=function(p){if(p.length>0){var r=this,t=function(v){var u=r.options.animationDelay||0;
q(p[v]);
v+=1;
if(v===p.length){r.addPig(p);
return
}else{r.animationTimeout=setTimeout(function(){t(v)
},u)
}},q=function(u){if(u.animate){u.animate({"stroke-opacity":1},10);
u.animate({"fill-opacity":1},10)
}else{u.attr({"stroke-opacity":1,"fill-opacity":1})
}};
t(0)
}};
j.addPig=function(z){if(this.pigElement||this.pigsEyeElement){this.pigElement.remove();
this.pigsEyeElement.remove()
}var w=_.filter(z,function(D){return(D.attr&&D.attr.fill!==e)
});
var C=_.last(w);
if(C){this.pigElement=this.paper.path(f);
this.pigsEyeElement=this.paper.path(o);
var B=this.paper.set();
B.push(this.pigElement,this.pigsEyeElement);
B.attr({fill:"#fff",opacity:0.35,"stroke-width":0,x:0,y:0});
var p=this.pigElement.getBBox();
var x=-1*p.cx;
var v=-1*p.cy;
var q=C.getBBox().width+1;
var A=q/109;
var t=p.width*A;
var u=p.height*A;
var r=(t/2)+((q-t)/2);
var y=C.attrs.cy;
B.transform("T"+x+","+v+"S"+A+"T"+r+","+y)
}};
j.render=function(t){var r=this.options.stacks,q=[],p;
if(this.options.hasContainer){this.drawContainer()
}this.totalPercentage=0;
this.stacks=[];
if(this.options.container){this.drawContainer()
}if(this.options.stepover){this.options.step=j.getStep(this.$element)
}if(t===false){this.options.animation=false
}for(p in r){if(r.hasOwnProperty(p)){this.drawStack(r[p])
}}for(p in this.stacks){q=q.concat(this.stacks[p])
}if(this.options.animation){this.animateEllipses(q)
}else{this.addPig(q)
}this.renderPigIfEmpty()
};
j.init=function(){var q=this.loadRaphael();
var p=this;
q.done(function(){p.$element.trigger("stack:clear");
if(p.$element.is(":visible")===false){p.$element.attrchange({trackValues:true,callback:p.checkVisibilityAndInit,context:p});
return false
}p.initPaper();
p.listenToEvents();
p.render()
});
q.fail(function(){throw new Error(p._name+": Raphael is not loaded, cannot proceed")
})
};
j.debugMessage=function(r,q){var p=q||"log";
if(this.options.debug){l.console[p](r,this.element)
}};
h.fn[k]=function(p){return this.each(function(){h.data(this,"plugin_"+k,new i(this,p))
})
}
})(jQuery,window,document);
(function(d){function b(){var f=document.createElement("p");
var e=false;
if(f.addEventListener){f.addEventListener("DOMAttrModified",function(){e=true
},false)
}else{if(f.attachEvent){f.attachEvent("onDOMAttrModified",function(){e=true
})
}else{return false
}}f.setAttribute("id","target");
return e
}function a(g,i){if(g){var f=this.data("attr-old-value");
if(i.attributeName.indexOf("style")>=0){if(!f.style){f.style={}
}var h=i.attributeName.split(".");
i.attributeName=h[0];
i.oldValue=f.style[h[1]];
i.newValue=h[1]+":"+this.prop("style")[d.camelCase(h[1])];
f.style[h[1]]=i.newValue
}else{i.oldValue=f[i.attributeName];
i.newValue=this.attr(i.attributeName);
f[i.attributeName]=i.newValue
}this.data("attr-old-value",f)
}}var c=window.MutationObserver||window.WebKitMutationObserver;
d.fn.attrchange=function(h){var e={trackValues:false,callback:d.noop,context:this};
if(typeof h==="function"){e.callback=h
}else{d.extend(e,h)
}if(e.trackValues){d(this).each(function(o,q){var m={};
for(var j,p=0,n=q.attributes,k=n.length;
p<k;
p++){j=n.item(p);
m[j.nodeName]=j.value
}d(this).data("attr-old-value",m)
})
}if(c){var g={subtree:false,attributes:true,attributeOldValue:e.trackValues};
var f=new c(function(i){i.forEach(function(j){var k=j.target;
if(e.trackValues){j.newValue=d(k).attr(j.attributeName)
}e.callback.call(k,j,e.context)
})
});
return this.each(function(){f.observe(this,g)
})
}else{if(b()){return this.on("DOMAttrModified",function(i){if(i.originalEvent){i=i.originalEvent
}i.attributeName=i.attrName;
i.oldValue=i.prevValue;
e.callback.call(this,i,e.context)
})
}else{if("onpropertychange" in document.body){return this.on("propertychange",function(i){i.attributeName=window.event.propertyName;
a.call(d(this),e.trackValues,i,e.context);
e.callback.call(this,i,e.context)
})
}}}return this
}
})(jQuery);
function Swipe(m,e){var f=function(){};
var v=function(D){setTimeout(D||f,0)
};
var C={addEventListener:!!window.addEventListener,touch:("ontouchstart" in window)||window.DocumentTouch&&document instanceof DocumentTouch,transitions:(function(D){var F=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];
for(var E in F){if(D.style[F[E]]!==undefined){return true
}}return false
})(document.createElement("swipe"))};
if(!m){return
}var c=m.children[0];
var t,d,r,g;
e=e||{};
var k=parseInt(e.startSlide,10)||0;
var w=e.speed||300;
e.continuous=e.continuous!==undefined?e.continuous:true;
function n(){t=c.children;
g=t.length;
if(t.length<2){e.continuous=false
}if(C.transitions&&e.continuous&&t.length<3){c.appendChild(t[0].cloneNode(true));
c.appendChild(c.children[1].cloneNode(true));
t=c.children
}d=new Array(t.length);
r=m.getBoundingClientRect().width||m.offsetWidth;
c.style.width=(t.length*r)+"px";
var E=t.length;
while(E--){var D=t[E];
D.style.width=r+"px";
D.setAttribute("data-index",E);
if(C.transitions){D.style.left=(E*-r)+"px";
q(E,k>E?-r:(k<E?r:0),0)
}}if(e.continuous&&C.transitions){q(i(k-1),-r,0);
q(i(k+1),r,0)
}if(!C.transitions){c.style.left=(k*-r)+"px"
}m.style.visibility="visible"
}function o(){if(e.continuous){a(k-1)
}else{if(k){a(k-1)
}}}function p(){if(e.continuous){a(k+1)
}else{if(k<t.length-1){a(k+1)
}}}function i(D){return(t.length+(D%t.length))%t.length
}function a(H,E){if(k==H){return
}if(C.transitions){var G=Math.abs(k-H)/(k-H);
if(e.continuous){var D=G;
G=-d[i(H)]/r;
if(G!==D){H=-G*t.length+H
}}var F=Math.abs(k-H)-1;
while(F--){q(i((H>k?H:k)-F-1),r*G,0)
}H=i(H);
q(k,r*G,E||w);
q(H,0,E||w);
if(e.continuous){q(i(H-G),-(r*G),0)
}}else{H=i(H);
j(k*-r,H*-r,E||w)
}k=H;
v(e.callback&&e.callback(k,t[k]))
}function q(D,F,E){l(D,F,E);
d[D]=F
}function l(E,H,G){var D=t[E];
var F=D&&D.style;
if(!F){return
}F.webkitTransitionDuration=F.MozTransitionDuration=F.msTransitionDuration=F.OTransitionDuration=F.transitionDuration=G+"ms";
F.webkitTransform="translate("+H+"px,0)translateZ(0)";
F.msTransform=F.MozTransform=F.OTransform="translateX("+H+"px)"
}function j(H,G,D){if(!D){c.style.left=G+"px";
return
}var F=+new Date;
var E=setInterval(function(){var I=+new Date-F;
if(I>D){c.style.left=G+"px";
if(B){y()
}e.transitionEnd&&e.transitionEnd.call(event,k,t[k]);
clearInterval(E);
return
}c.style.left=(((G-H)*(Math.floor((I/D)*100)/100))+H)+"px"
},4)
}var B=e.auto||0;
var x;
function y(){x=setTimeout(p,B)
}function u(){B=0;
clearTimeout(x)
}var h={};
var z={};
var A;
var b={handleEvent:function(D){switch(D.type){case"touchstart":this.start(D);
break;
case"touchmove":this.move(D);
break;
case"touchend":v(this.end(D));
break;
case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":v(this.transitionEnd(D));
break;
case"resize":v(n.call());
break
}if(e.stopPropagation){D.stopPropagation()
}},start:function(D){var E=D.touches[0];
h={x:E.pageX,y:E.pageY,time:+new Date};
A=undefined;
z={};
c.addEventListener("touchmove",this,false);
c.addEventListener("touchend",this,false)
},move:function(D){if(D.touches.length>1||D.scale&&D.scale!==1){return
}if(e.disableScroll){D.preventDefault()
}var E=D.touches[0];
z={x:E.pageX-h.x,y:E.pageY-h.y};
if(typeof A=="undefined"){A=!!(A||Math.abs(z.x)<Math.abs(z.y))
}if(!A){D.preventDefault();
u();
if(e.continuous){l(i(k-1),z.x+d[i(k-1)],0);
l(k,z.x+d[k],0);
l(i(k+1),z.x+d[i(k+1)],0)
}else{z.x=z.x/((!k&&z.x>0||k==t.length-1&&z.x<0)?(Math.abs(z.x)/r+1):1);
l(k-1,z.x+d[k-1],0);
l(k,z.x+d[k],0);
l(k+1,z.x+d[k+1],0)
}}},end:function(F){var H=+new Date-h.time;
var E=Number(H)<250&&Math.abs(z.x)>20||Math.abs(z.x)>r/2;
var D=!k&&z.x>0||k==t.length-1&&z.x<0;
if(e.continuous){D=false
}var G=z.x<0;
if(!A){if(E&&!D){if(G){if(e.continuous){q(i(k-1),-r,0);
q(i(k+2),r,0)
}else{q(k-1,-r,0)
}q(k,d[k]-r,w);
q(i(k+1),d[i(k+1)]-r,w);
k=i(k+1)
}else{if(e.continuous){q(i(k+1),r,0);
q(i(k-2),-r,0)
}else{q(k+1,r,0)
}q(k,d[k]+r,w);
q(i(k-1),d[i(k-1)]+r,w);
k=i(k-1)
}e.callback&&e.callback(k,t[k])
}else{if(e.continuous){q(i(k-1),-r,w);
q(k,0,w);
q(i(k+1),r,w)
}else{q(k-1,-r,w);
q(k,0,w);
q(k+1,r,w)
}}}c.removeEventListener("touchmove",b,false);
c.removeEventListener("touchend",b,false)
},transitionEnd:function(D){if(parseInt(D.target.getAttribute("data-index"),10)==k){if(B){y()
}e.transitionEnd&&e.transitionEnd.call(D,k,t[k])
}}};
n();
if(B){y()
}if(C.addEventListener){if(C.touch){c.addEventListener("touchstart",b,false)
}if(C.transitions){c.addEventListener("webkitTransitionEnd",b,false);
c.addEventListener("msTransitionEnd",b,false);
c.addEventListener("oTransitionEnd",b,false);
c.addEventListener("otransitionend",b,false);
c.addEventListener("transitionend",b,false)
}window.addEventListener("resize",b,false)
}else{window.onresize=function(){n()
}
}return{setup:function(){n()
},slide:function(E,D){u();
a(E,D)
},prev:function(){u();
o()
},next:function(){u();
p()
},getPos:function(){return k
},getNumSlides:function(){return g
},kill:function(){u();
c.style.width="auto";
c.style.left=0;
var E=t.length;
while(E--){var D=t[E];
D.style.width="100%";
D.style.left=0;
if(C.transitions){l(E,0,0)
}}if(C.addEventListener){c.removeEventListener("touchstart",b,false);
c.removeEventListener("webkitTransitionEnd",b,false);
c.removeEventListener("msTransitionEnd",b,false);
c.removeEventListener("oTransitionEnd",b,false);
c.removeEventListener("otransitionend",b,false);
c.removeEventListener("transitionend",b,false);
window.removeEventListener("resize",b,false)
}else{window.onresize=null
}}}
}if(window.jQuery||window.Zepto){(function(a){a.fn.Swipe=function(b){return this.each(function(){a(this).data("Swipe",new Swipe(a(this)[0],b))
})
}
})(window.jQuery||window.Zepto)
}function scrollToElement(a,e,b){e=typeof(e)!=="undefined"?e:1000;
b=typeof(b)!=="undefined"?b:0;
var c=$(a);
if(c.length===0){return
}var f=c.offset();
if(f!==undefined&&f.top!==undefined){var d=f.top+b;
$("html, body").animate({scrollTop:d},e)
}}var Cursor={x:0,y:0,init:function(){this.setEvent("mouse");
this.setEvent("touch")
},setEvent:function(a){var b=document["on"+a+"move"]||function(){};
document["on"+a+"move"]=function(c){b(c);
Cursor.refresh(c)
}
},refresh:function(a){if(!a){a=window.event
}if(a.type=="mousemove"){this.set(a)
}else{if(a.touches){this.set(a.touches[0])
}}},set:function(a){if(a.pageX||a.pageY){this.x=a.pageX;
this.y=a.pageY
}else{if(a.clientX||a.clientY){this.x=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;
this.y=a.clientY+document.body.scrollTop+document.documentElement.scrollTop
}}}};
Cursor.init();
var Position={get:function(a){var b=curtop=0;
if(a.offsetParent){do{b+=a.offsetLeft;
curtop+=a.offsetTop
}while((a=a.offsetParent))
}return[b,curtop]
}};
var Dragdealer=function(c,a){if(typeof(c)=="string"){c=document.getElementById(c)
}if(!c){return
}var b=c.getElementsByTagName("button")[0];
if(!b||b.className.search(/(^|\s)handle(\s|$)/)==-1){return
}this.init(c,b,a||{});
this.setup()
};
Dragdealer.prototype={init:function(c,b,a){this.wrapper=c;
this.handle=b;
this.options=a;
this.disabled=this.getOption("disabled",false);
this.horizontal=this.getOption("horizontal",true);
this.vertical=this.getOption("vertical",false);
this.slide=this.getOption("slide",true);
this.steps=this.getOption("steps",0);
this.snap=this.getOption("snap",false);
this.loose=this.getOption("loose",false);
this.speed=this.getOption("speed",10)/100;
this.xPrecision=this.getOption("xPrecision",0);
this.yPrecision=this.getOption("yPrecision",0);
this.callback=a.callback||null;
this.animationCallback=a.animationCallback||null;
this.bounds={left:a.left||0,right:-(a.right||0),top:a.top||0,bottom:-(a.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0};
this.value={prev:[-1,-1],current:[a.x||0,a.y||0],target:[a.x||0,a.y||0]};
this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]};
this.change=[0,0];
this.activity=false;
this.dragging=false;
this.tapping=false
},getOption:function(b,a){return this.options[b]!==undefined?this.options[b]:a
},setup:function(){this.setWrapperOffset();
this.setBoundsPadding();
this.setBounds();
this.setSteps();
this.addListeners()
},setWrapperOffset:function(){this.offset.wrapper=Position.get(this.wrapper)
},setBoundsPadding:function(a,b){if(a!=undefined){this.bounds.left=a
}if(!this.bounds.left&&!this.bounds.right){this.bounds.left=Position.get(this.handle)[0]-this.offset.wrapper[0];
this.bounds.right=-this.bounds.left
}if(!this.bounds.top&&!this.bounds.bottom){this.bounds.top=Position.get(this.handle)[1]-this.offset.wrapper[1];
this.bounds.bottom=-this.bounds.top
}},setBounds:function(){this.bounds.x0=this.bounds.left*this.wrapper.offsetWidth;
this.bounds.x1=this.wrapper.offsetWidth+(this.bounds.right*this.wrapper.offsetWidth);
this.bounds.xRange=(this.bounds.x1-this.bounds.x0)-this.handle.offsetWidth;
this.bounds.y0=this.bounds.top;
this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom;
this.bounds.yRange=(this.bounds.y1-this.bounds.y0)-this.handle.offsetHeight;
this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth));
this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))
},setSteps:function(){if(this.steps>1){this.stepRatios=[];
for(var a=0;
a<=this.steps-1;
a++){this.stepRatios[a]=a/(this.steps-1)
}}},addListeners:function(){var a=this;
this.wrapper.onselectstart=function(){return false
};
this.handle.onmousedown=this.handle.ontouchstart=function(f){a.handleDownHandler(f)
};
this.wrapper.onmousedown=this.wrapper.ontouchstart=function(f){a.wrapperDownHandler(f)
};
var d=document.onmouseup||function(){};
document.onmouseup=function(f){d(f);
a.documentUpHandler(f)
};
var c=document.ontouchend||function(){};
document.ontouchend=function(f){c(f);
a.documentUpHandler(f)
};
var b=window.onresize||function(){};
window.onresize=function(f){b(f);
a.documentResizeHandler(f)
};
this.wrapper.onmousemove=function(f){a.activity=true
};
this.wrapper.onclick=function(f){return !a.activity
};
this.interval=setInterval(function(){a.animate()
},25);
a.animate(false,true)
},handleDownHandler:function(a){this.activity=false;
Cursor.refresh(a);
this.preventDefaults(a,true);
this.startDrag();
this.cancelEvent(a)
},wrapperDownHandler:function(a){Cursor.refresh(a);
this.preventDefaults(a,true);
this.startTap()
},documentUpHandler:function(a){this.stopDrag();
this.stopTap()
},documentResizeHandler:function(a){this.setWrapperOffset();
this.setBounds();
this.update()
},enable:function(){this.disabled=false;
this.handle.className=this.handle.className.replace(/\s?disabled/g,"")
},disable:function(){this.disabled=true;
this.handle.className+=" disabled"
},setStep:function(b,c,a){this.setValue(this.steps&&b>1?(b-1)/(this.steps-1):0,this.steps&&c>1?(c-1)/(this.steps-1):0,a)
},setValue:function(b,c,a){this.setTargetValue([b,c||0]);
if(a){this.groupCopy(this.value.current,this.value.target)
}},startTap:function(a){if(this.disabled){return
}this.tapping=true;
if(a===undefined){a=[Cursor.x-this.offset.wrapper[0]-(this.handle.offsetWidth/2),Cursor.y-this.offset.wrapper[1]-(this.handle.offsetHeight/2)]
}this.setTargetOffset(a)
},stopTap:function(){if(this.disabled||!this.tapping){return
}this.tapping=false;
this.setTargetValue(this.value.current);
this.result()
},startDrag:function(){if(this.disabled){return
}this.offset.mouse=[Cursor.x-Position.get(this.handle)[0],Cursor.y-Position.get(this.handle)[1]];
this.dragging=true
},stopDrag:function(){if(this.disabled||!this.dragging){return
}this.dragging=false;
var b=this.groupClone(this.value.current);
if(this.slide){var a=this.change;
b[0]+=a[0]*4;
b[1]+=a[1]*4
}this.setTargetValue(b);
this.result()
},feedback:function(){var a=this.value.current;
if(this.snap&&this.steps>1){a=this.getClosestSteps(a)
}if(!this.groupCompare(a,this.value.prev)){if(typeof(this.animationCallback)=="function"){this.animationCallback(a[0],a[1])
}this.groupCopy(this.value.prev,a)
}},result:function(){if(typeof(this.callback)=="function"){this.callback(this.value.target[0],this.value.target[1])
}},animate:function(d,c){if(d&&!this.dragging){return
}if(this.dragging){var a=this.groupClone(this.value.target);
var b=[Cursor.x-this.offset.wrapper[0]-this.offset.mouse[0],Cursor.y-this.offset.wrapper[1]-this.offset.mouse[1]];
this.setTargetOffset(b,this.loose);
this.change=[this.value.target[0]-a[0],this.value.target[1]-a[1]]
}if(this.dragging||c){this.groupCopy(this.value.current,this.value.target)
}if(this.dragging||this.glide()||c){this.update();
this.feedback()
}},glide:function(){var a=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];
if(!a[0]&&!a[1]){return false
}if(Math.abs(a[0])>this.bounds.xStep||Math.abs(a[1])>this.bounds.yStep){this.value.current[0]+=a[0]*this.speed;
this.value.current[1]+=a[1]*this.speed
}else{this.groupCopy(this.value.current,this.value.target)
}return true
},update:function(){if(!this.snap){this.offset.current=this.getOffsetsByRatios(this.value.current)
}else{this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current))
}this.show()
},show:function(){if(!this.groupCompare(this.offset.current,this.offset.prev)){if(this.horizontal){this.handle.style.left=String(this.offset.current[0])+"px"
}if(this.vertical){this.handle.style.top=String(this.offset.current[1])+"px"
}this.groupCopy(this.offset.prev,this.offset.current)
}},setTargetValue:function(a,c){var b=c?this.getLooseValue(a):this.getProperValue(a);
this.groupCopy(this.value.target,b);
this.offset.target=this.getOffsetsByRatios(b)
},setTargetOffset:function(c,d){var a=this.getRatiosByOffsets(c);
var b=d?this.getLooseValue(a):this.getProperValue(a);
this.groupCopy(this.value.target,b);
this.offset.target=this.getOffsetsByRatios(b)
},getLooseValue:function(b){var a=this.getProperValue(b);
return[a[0]+((b[0]-a[0])/4),a[1]+((b[1]-a[1])/4)]
},getProperValue:function(b){var a=this.groupClone(b);
a[0]=Math.max(a[0],0);
a[1]=Math.max(a[1],0);
a[0]=Math.min(a[0],1);
a[1]=Math.min(a[1],1);
if((!this.dragging&&!this.tapping)||this.snap){if(this.steps>1){a=this.getClosestSteps(a)
}}return a
},getRatiosByOffsets:function(a){return[this.getRatioByOffset(a[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(a[1],this.bounds.yRange,this.bounds.y0)]
},getRatioByOffset:function(c,a,b){return a?(c-b)/a:0
},getOffsetsByRatios:function(a){return[this.getOffsetByRatio(a[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(a[1],this.bounds.yRange,this.bounds.y0)]
},getOffsetByRatio:function(b,a,c){return Math.round(b*a)+c
},getClosestSteps:function(a){return[this.getClosestStep(a[0]),this.getClosestStep(a[1])]
},getClosestStep:function(d){var a=0;
var c=1;
for(var b=0;
b<=this.steps-1;
b++){if(Math.abs(this.stepRatios[b]-d)<c){c=Math.abs(this.stepRatios[b]-d);
a=b
}}return this.stepRatios[a]
},groupCompare:function(d,c){return d[0]==c[0]&&d[1]==c[1]
},groupCopy:function(d,c){d[0]=c[0];
d[1]=c[1]
},groupClone:function(b){return[b[0],b[1]]
},preventDefaults:function(b,a){if(!b){b=window.event
}if(b.preventDefault){b.preventDefault()
}b.returnValue=false;
if(a&&document.selection){document.selection.empty()
}},cancelEvent:function(a){if(!a){a=window.event
}if(a.stopPropagation){a.stopPropagation()
}a.cancelBubble=true
}};
/*! Fixedfixed: a CSS position:fixed qualifier. (c)2012 @scottjehl, Filament Group, Inc. Dual license: MIT and/or GPLv2 */
(function(a,f){var e="fixed-supported",d=a.document.createElement("div"),c=a.navigator.userAgent;
d.style.position="fixed";
d.style.top=0;
function b(){var g="scrollTop" in a.document.body?a.document.body.scrollTop:a.document.documentElement.scrollTop;
if(g!==f&&g>0&&a.document.body){a.document.body.insertBefore(d,a.document.body.firstChild);
if(!d.getBoundingClientRect||d.getBoundingClientRect().top!==0){a.document.documentElement.className=a.document.documentElement.className.replace(e,"")
}a.document.body.removeChild(d);
if(a.removeEventListener){a.removeEventListener("scroll",b,false)
}else{a.detachEvent("onscroll",b)
}}}if(!(c.match(/Android 2\.[1256]/)&&c.indexOf("AppleWebKit")>-1)||!(c.match(/Opera Mobi\/([0-9]+)/)&&RegExp.$1<7458)||!(a.operamini&&({}).toString.call(a.operamini)==="[object OperaMini]")||!(c.match(/Fennec\/([0-9]+)/)&&RegExp.$1<6)){a.document.documentElement.className+=" "+e;
if(a.addEventListener){a.addEventListener("scroll",b,false)
}else{a.attachEvent("onscroll",b)
}}}(this));
(function(b){b.rateit={aria:{resetLabel:"reset rating",ratingLabel:"rating"}};
b.fn.rateit=function(i,g){var d=1;
var c={};
var h="init";
var f=function(j){return j.charAt(0).toUpperCase()+j.substr(1)
};
if(this.length==0){return this
}var e=b.type(i);
if(e=="object"||i===undefined||i==null){c=b.extend({},b.fn.rateit.defaults,i)
}else{if(e=="string"&&g===undefined){return this.data("rateit"+f(i))
}else{if(e=="string"){h="setvalue"
}}}return this.each(function(){var v=b(this);
var w=function(y,z){if(z!=null){var A="aria-value"+((y=="value")?"now":y);
var x=v.find(".rateit-range");
if(x.attr(A)!=undefined){x.attr(A,z)
}}arguments[0]="rateit"+f(y);
return v.data.apply(v,arguments)
};
if(!v.hasClass("rateit")){v.addClass("rateit")
}var k=v.css("direction")!="rtl";
if(h=="setvalue"){if(!w("init")){throw"Can't set value before init"
}if(i=="readonly"&&g==true&&!w("readonly")){v.find(".rateit-range").unbind();
w("wired",false)
}if(i=="value"){g=(g==null)?w("min"):Math.max(w("min"),Math.min(w("max"),g))
}if(w("backingfld")){var m=b(w("backingfld"));
if(i=="value"){m.val(g)
}if(i=="min"&&m[0].min){m[0].min=g
}if(i=="max"&&m[0].max){m[0].max=g
}if(i=="step"&&m[0].step){m[0].step=g
}}w(i,g)
}if(!w("init")){w("min",w("min")||c.min);
w("max",w("max")||c.max);
w("step",w("step")||c.step);
w("readonly",w("readonly")!==undefined?w("readonly"):c.readonly);
w("resetable",w("resetable")!==undefined?w("resetable"):c.resetable);
w("backingfld",w("backingfld")||c.backingfld);
w("starwidth",w("starwidth")||c.starwidth);
w("starheight",w("starheight")||c.starheight);
w("value",Math.max(w("min"),Math.min(w("max"),(w("value")||c.value||c.min))));
w("ispreset",w("ispreset")!==undefined?w("ispreset"):c.ispreset);
if(w("backingfld")){var m=b(w("backingfld"));
w("value",m.hide().val());
if(m.attr("disabled")||m.attr("readonly")){w("readonly",true)
}if(m[0].nodeName=="INPUT"){if(m[0].type=="range"||m[0].type=="text"){w("min",parseInt(m.attr("min"))||w("min"));
w("max",parseInt(m.attr("max"))||w("max"));
w("step",parseInt(m.attr("step"))||w("step"))
}}if(m[0].nodeName=="SELECT"&&m[0].options.length>1){w("min",Number(m[0].options[0].value));
w("max",Number(m[0].options[m[0].length-1].value));
w("step",Number(m[0].options[1].value)-Number(m[0].options[0].value))
}}var o=v[0].nodeName=="DIV"?"div":"span";
d++;
var p='<{{element}} id="rateit-range-{{index}}" class="rateit-range" tabindex="0" role="slider" aria-label="'+b.rateit.aria.ratingLabel+'" aria-owns="rateit-reset-{{index}}" aria-valuemin="'+w("min")+'" aria-valuemax="'+w("max")+'" aria-valuenow="'+w("value")+'"><{{element}} class="rateit-selected" style="height:'+w("starheight")+'px"></{{element}}><{{element}} class="rateit-hover" style="height:'+w("starheight")+'px"></{{element}}></{{element}}>';
v.append(p.replace(/{{index}}/gi,d).replace(/{{element}}/gi,o));
if(!k){v.find(".rateit-reset").css("float","right");
v.find(".rateit-selected").addClass("rateit-selected-rtl");
v.find(".rateit-hover").addClass("rateit-hover-rtl")
}w("init",true)
}var q=v.find(".rateit-range");
q.width(w("starwidth")*(w("max")-w("min"))).height(w("starheight"));
var n="rateit-preset"+((k)?"":"-rtl");
if(w("ispreset")){v.find(".rateit-selected").addClass(n)
}else{v.find(".rateit-selected").removeClass(n)
}if(w("value")!=null){var l=(w("value")-w("min"))*w("starwidth");
v.find(".rateit-selected").width(l)
}var r=v.find(".rateit-reset");
if(r.data("wired")!==true){r.bind("click",function(x){x.preventDefault();
r.blur();
w("value",w("min"));
q.find(".rateit-hover").hide().width(0);
q.find(".rateit-selected").width(0).show();
if(w("backingfld")){b(w("backingfld")).val(w("min"))
}v.trigger("reset")
}).data("wired",true)
}var u=function(y,A){var z=(A.changedTouches)?A.changedTouches[0].pageX:A.pageX;
var x=z-b(y).offset().left;
if(!k){x=q.width()-x
}if(x>q.width()){x=q.width()
}if(x<0){x=0
}return l=Math.ceil(x/w("starwidth")*(1/w("step")))
};
var j=function(A){var x=A*w("starwidth")*w("step");
var y=q.find(".rateit-hover");
if(y.data("width")!=x){q.find(".rateit-selected").hide();
y.width(x).show().data("width",x);
var z=[(A*w("step"))+w("min")];
v.trigger("hover",z).trigger("over",z)
}};
var t=function(x){w("value",x);
if(w("backingfld")){b(w("backingfld")).val(x)
}if(w("ispreset")){q.find(".rateit-selected").removeClass(n);
w("ispreset",false)
}q.find(".rateit-hover").hide();
q.find(".rateit-selected").width(x*w("starwidth")-(w("min")*w("starwidth"))).show();
v.trigger("hover",[null]).trigger("over",[null]).trigger("rated",[x])
};
if(!w("readonly")){if(!w("resetable")){r.hide()
}if(!w("wired")){q.bind("touchmove touchend",a);
q.mousemove(function(x){var y=u(this,x);
j(y)
});
q.mouseleave(function(x){q.find(".rateit-hover").hide().width(0).data("width","");
v.trigger("hover",[null]).trigger("over",[null]);
q.find(".rateit-selected").show()
});
q.mouseup(function(y){var z=u(this,y);
var x=(z*w("step"))+w("min");
t(x)
});
q.keyup(function(x){if(x.which==38||x.which==(k?39:37)){t(Math.min(w("value")+w("step"),w("max")))
}if(x.which==40||x.which==(k?37:39)){t(Math.max(w("value")-w("step"),w("min")))
}});
w("wired",true)
}if(w("resetable")){r.show()
}}else{r.hide()
}q.attr("aria-readonly",w("readonly"))
})
};
function a(e){var f=e.originalEvent.changedTouches,g=f[0],c="";
switch(e.type){case"touchmove":c="mousemove";
break;
case"touchend":c="mouseup";
break;
default:return
}var d=document.createEvent("MouseEvent");
d.initMouseEvent(c,true,true,window,1,g.screenX,g.screenY,g.clientX,g.clientY,false,false,false,false,0,null);
g.target.dispatchEvent(d);
e.preventDefault()
}b.fn.rateit.defaults={min:0,max:5,step:1,starwidth:25,starheight:25,readonly:false,resetable:true,ispreset:false}
})(jQuery);
/*!
 * jQuery Cookie Plugin v1.4.0
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2013 Klaus Hartl
 * Released under the MIT license
 */
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)
}else{a(jQuery)
}}(function(f){var a=/\+/g;
function d(i){return b.raw?i:encodeURIComponent(i)
}function g(i){return b.raw?i:decodeURIComponent(i)
}function h(i){return d(b.json?JSON.stringify(i):String(i))
}function c(i){if(i.indexOf('"')===0){i=i.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")
}try{i=decodeURIComponent(i.replace(a," "));
return b.json?JSON.parse(i):i
}catch(j){}}function e(j,i){var k=b.raw?j:c(j);
return f.isFunction(i)?i(k):k
}var b=f.cookie=function(q,p,w){if(p!==undefined&&!f.isFunction(p)){w=f.extend({},b.defaults,w);
if(typeof w.expires==="number"){var r=w.expires,v=w.expires=new Date();
v.setTime(+v+r*86400000)
}return(document.cookie=[d(q),"=",h(p),w.expires?"; expires="+w.expires.toUTCString():"",w.path?"; path="+w.path:"",w.domain?"; domain="+w.domain:"",w.secure?"; secure":""].join(""))
}var x=q?undefined:{};
var u=document.cookie?document.cookie.split("; "):[];
for(var o=0,m=u.length;
o<m;
o++){var n=u[o].split("=");
var j=g(n.shift());
var k=n.join("=");
if(q&&q===j){x=e(k,p);
break
}if(!q&&(k=e(k))!==undefined){x[j]=k
}}return x
};
b.defaults={};
f.removeCookie=function(j,i){if(f.cookie(j)===undefined){return false
}f.cookie(j,"",f.extend({},i,{expires:-1}));
return !f.cookie(j)
}
}));
(function(a){a.fn.alterClass=function(c,e){var b=this;
if(c.indexOf("*")===-1){b.removeClass(c);
return !e?b:b.addClass(e)
}var d=new RegExp("\\s"+c.replace(/\*/g,"[A-Za-z0-9-_]+").split(" ").join("\\s|\\s")+"\\s","g");
b.each(function(f,g){var h=" "+g.className+" ";
while(d.test(h)){h=h.replace(d," ")
}g.className=a.trim(h)
});
return !e?b:b.addClass(e)
}
})(jQuery);
jQuery.fn.prevWrap=function(a){prev=$(this).prev(a);
if(prev.length<=0){prev=$(this).parent().children(a).last()
}return prev
};
jQuery.fn.nextWrap=function(a){next=$(this).next(a);
if(next.length<=0){next=$(this).parent().children(a).first()
}return next
}
/*!
 * Platform.js v1.0.0 <http://mths.be/platform>
 * Copyright 2010-2014 John-David Dalton <http://allyoucanleet.com/>
 * Available under MIT license <http://mths.be/mit>
 */
;
(function(){var f={"function":true,object:true};
var q=(f[typeof window]&&window)||this;
var p=q;
var c=f[typeof exports]&&exports;
var E=f[typeof module]&&module&&!module.nodeType&&module;
var n=c&&E&&typeof global=="object"&&global;
if(n&&(n.global===n||n.window===n||n.self===n)){q=n
}var k=/Opera/;
var r=Object.prototype.toString;
var l=/Java/.test(y(q.java))&&q.java;
var D=l&&y(q.environment)=="Environment";
var b=l?"a":"\u03b1";
var z=l?"b":"\u03b2";
var C=q.document||{};
var h={}.hasOwnProperty;
var e=q.navigator||{};
var w=q.operamini||q.opera;
var j=k.test(j=y(w))?j:(w=null);
var d=this;
var A=e.userAgent||"";
function g(F){F=String(F);
return F.charAt(0).toUpperCase()+F.slice(1)
}function a(G,I){var F=-1,H=G.length;
if(H==H>>>0){while(++F<H){I(G[F],F,G)
}}else{x(G,I)
}}function v(F){F=u(F);
return/^(?:webOS|i(?:OS|P))/.test(F)?F:g(F)
}function x(F,H){for(var G in F){B(F,G)&&H(F[G],G,F)
}}function y(F){return F==null?g(F):r.call(F).slice(8,-1)
}function B(){B=function(F,G){var H=F!=null&&(F.constructor||Object).prototype;
return !!H&&G in Object(F)&&!(G in H&&F[G]===H[G])
};
if(y(h)=="Function"){B=function(F,G){return F!=null&&h.call(F,G)
}
}else{if({}.__proto__==Object.prototype){B=function(G,H){var F=false;
if(G!=null){G=Object(G);
G.__proto__=[G.__proto__,G.__proto__=null,F=H in G][0]
}return F
}
}}return B.apply(this,arguments)
}function o(F,H){var G=F!=null?typeof F[H]:"number";
return !/^(?:boolean|number|string|undefined)$/.test(G)&&(G=="object"?!!F[H]:true)
}function t(F){return String(F).replace(/([ -])(?!$)/g,"$1?")
}function i(H,G){var F=null;
a(H,function(J,I){F=G(F,J,I,H)
});
return F
}function u(F){return String(F).replace(/^ +| +$/g,"")
}function m(N){N||(N=A);
var W;
var X=N;
var M=[];
var I=null;
var O=N==A;
var G=O&&w&&typeof w.version=="function"&&w.version();
var S=P([{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","Trident","KHTML","Gecko"]);
var Y=L(["Adobe AIR","Arora","Avant Browser","Camino","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","Iron","K-Meleon","Konqueror","Lunascape","Maxthon","Midori","Nook Browser","PhantomJS","Raven","Rekonq","RockMelt","SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser","Sunrise","Swiftfox","WebPositive","Opera Mini","Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"IE",pattern:"MSIE"},"Safari"]);
var F=Q(["BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},"Google TV","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nook","PlayBook","PlayStation 4","PlayStation 3","PlayStation Vita","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One","Xbox","Xoom"]);
var V=K({Apple:{iPad:1,iPhone:1,iPod:1},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{"PlayStation 4":1,"PlayStation 3":1,"PlayStation Vita":1}});
var H=T(["Android","CentOS","Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);
function P(Z){return i(Z,function(aa,ab){return aa||RegExp("\\b"+(ab.pattern||t(ab))+"\\b","i").exec(N)&&(ab.label||ab)
})
}function K(Z){return i(Z,function(aa,ac,ab){return aa||(ac[F]||ac[0,/^[a-z]+(?: +[a-z]+\b)*/i.exec(F)]||RegExp("\\b"+t(ab)+"(?:\\b|\\w*\\d)","i").exec(N))&&ab
})
}function L(Z){return i(Z,function(aa,ab){return aa||RegExp("\\b"+(ab.pattern||t(ab))+"\\b","i").exec(N)&&(ab.label||ab)
})
}function T(Z){return i(Z,function(aa,ac){var ab=ac.pattern||t(ac);
if(!aa&&(aa=RegExp("\\b"+ab+"(?:/[\\d.]+|[ \\w.]*)","i").exec(N))){W={"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};
if(/^Win/i.test(aa)&&(W=W[0,/[\d.]+$/.exec(aa)])){aa="Windows "+W
}aa=v(String(aa).replace(RegExp(ab,"i"),ac.label||ac).replace(/ ce$/i," CE").replace(/hpw/i,"web").replace(/Macintosh/,"Mac OS").replace(/_PowerPC/i," OS").replace(/(OS X) [^ \d]+/i,"$1").replace(/Mac (OS X)/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/x86\.64/gi,"x86_64").split(" on ")[0])
}return aa
})
}function Q(Z){return i(Z,function(aa,ac){var ab=ac.pattern||t(ac);
if(!aa&&(aa=RegExp("\\b"+ab+" *\\d+[.\\w_]*","i").exec(N)||RegExp("\\b"+ab+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(N))){if((aa=String(ac.label||aa).split("/"))[1]&&!/[\d.]+/.test(aa[0])){aa[0]+=" "+aa[1]
}ac=ac.label||ac;
aa=v(aa[0].replace(RegExp(ab,"i"),ac).replace(RegExp("; *(?:"+ac+"[_-])?","i")," ").replace(RegExp("("+ac+")(\\w)","i"),"$1 $2"))
}return aa
})
}function J(Z){return i(Z,function(aa,ab){return aa||(RegExp(ab+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(N)||0)[1]||null
})
}function U(){return this.description||""
}S&&(S=[S]);
if(V&&!F){F=Q([V])
}if((W=/Google TV/.exec(F))){F=W[0]
}if(/\bSimulator\b/i.test(N)){F=(F?F+" ":"")+"Simulator"
}if((/\((?:Mobile|Tablet).*?Firefox/i).test(N)){H="Firefox OS"
}if(/^iP/.test(F)){Y||(Y="Safari");
H="iOS"+((W=/ OS ([\d_]+)/i.exec(N))?" "+W[1].replace(/_/g,"."):"")
}else{if(Y=="Konqueror"&&!/buntu/i.test(H)){H="Kubuntu"
}else{if(V&&V!="Google"&&((/Chrome/.test(Y)&&!/Mobile Safari/.test(N))||/Vita/.test(F))){Y="Android Browser";
H=/Android/.test(H)?H:"Android"
}else{if(!Y||(W=!/\bMinefield\b|\(Android;/i.test(N)&&/Firefox|Safari/.exec(Y))){if(Y&&!F&&/[\/,]|^[^(]+?\)/.test(N.slice(N.indexOf(W+"/")+8))){Y=null
}if((W=F||V||H)&&(F||V||/Android|Symbian OS|Tablet OS|webOS/.test(H))){Y=/[a-z]+(?: Hat)?/i.exec(/Android/.test(H)?H:W)+" Browser"
}}}}}if(!G){G=J(["(?:Cloud9|CriOS|CrMo|Opera ?Mini|OPR|Raven|Silk(?!/[\\d.]+$))","Version",t(Y),"(?:Firefox|Minefield|NetFront)"])
}if(S=="iCab"&&parseFloat(G)>3){S=["WebKit"]
}else{if((W=/Opera/.test(Y)&&(/OPR/.test(N)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(N)&&"WebKit"||!S&&/\bMSIE\b/i.test(N)&&(H=="Mac OS"?"Tasman":"Trident"))){S=[W]
}else{if(/PlayStation(?! Vita)/i.test(Y)&&S=="WebKit"){S=["NetFront"]
}}}if(!Y&&S=="Trident"){Y="IE";
G=(/\brv:([\d.]+)/.exec(N)||0)[1]
}if(O){if(o(q,"global")){if(l){W=l.lang.System;
X=W.getProperty("os.arch");
H=H||W.getProperty("os.name")+" "+W.getProperty("os.version")
}if(c){if(d==p&&typeof system=="object"&&(W=[system])[0]){H||(H=W[0].os||null);
try{W[1]=(W[1]=require)&&W[1]("ringo/engine").version;
G=W[1].join(".");
Y="RingoJS"
}catch(R){if(W[0].global==n){Y="Narwhal"
}}}else{if(typeof process=="object"&&(W=process)){Y="Node.js";
X=W.arch;
H=W.platform;
G=/[\d.]+/.exec(W.version)[0]
}else{if(D){Y="Rhino"
}}}}else{if(D){Y="Rhino"
}}}else{if(y((W=q.runtime))=="ScriptBridgingProxyObject"){Y="Adobe AIR";
H=W.flash.system.Capabilities.os
}else{if(y((W=q.phantom))=="RuntimeObject"){Y="PhantomJS";
G=(W=W.version||null)&&(W.major+"."+W.minor+"."+W.patch)
}else{if(typeof C.documentMode=="number"&&(W=/\bTrident\/(\d+)/i.exec(N))){G=[G,C.documentMode];
if((W=+W[1]+4)!=G[1]){M.push("IE "+G[1]+" mode");
S&&(S[1]="");
G[1]=W
}G=Y=="IE"?String(G[1].toFixed(1)):G[0]
}}}}H=H&&v(H)
}if(G&&(W=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(G)||/(?:alpha|beta)(?: ?\d)?/i.exec(N+";"+(O&&e.appMinorVersion))||/\bMinefield\b/i.test(N)&&"a")){I=/b/i.test(W)?"beta":"alpha";
G=G.replace(RegExp(W+"\\+?$"),"")+(I=="beta"?z:b)+(/\d+\+?/.exec(W)||"")
}if(Y=="Fennec"||Y=="Firefox"&&/Android|Firefox OS/.test(H)){Y="Firefox Mobile"
}else{if(Y=="Maxthon"&&G){G=G.replace(/\.[\d.]+/,".x")
}else{if(Y=="Silk"){if(!/Mobi/i.test(N)){H="Android";
M.unshift("desktop mode")
}if(/Accelerated *= *true/i.test(N)){M.unshift("accelerated")
}}else{if(Y=="IE"&&(W=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(N)||0)[1])){Y+=" Mobile";
H="Windows Phone OS "+W+".x";
M.unshift("desktop mode")
}else{if(/Xbox/i.test(F)){H=null;
if(F=="Xbox"){F="Xbox 360";
if(/IEMobile/.test(N)){M.unshift("mobile mode")
}}}else{if((Y=="Chrome"||Y=="IE"||Y&&!F&&!/Browser|Mobi/.test(Y))&&(H=="Windows CE"||/Mobi/i.test(N))){Y+=" Mobile"
}else{if(Y=="IE"&&O&&typeof external=="object"&&!external){M.unshift("platform preview")
}else{if(/BlackBerry/.test(F)&&(W=(RegExp(F.replace(/ +/g," *")+"/([.\\d]+)","i").exec(N)||0)[1]||G)){H="Device Software "+W;
G=null
}else{if(this!=x&&(F!="Wii"&&((O&&w)||(/Opera/.test(Y)&&/\b(?:MSIE|Firefox)\b/i.test(N))||(Y=="Firefox"&&/OS X (?:\d+\.){2,}/.test(H))||(Y=="IE"&&((H&&!/^Win/.test(H)&&G>5.5)||/Windows XP/.test(H)&&G>8||G==8&&!/Trident/.test(N)))))&&!k.test((W=m.call(x,N.replace(k,"")+";")))&&W.name){W="ing as "+W.name+((W=W.version)?" "+W:"");
if(k.test(Y)){if(/IE/.test(W)&&H=="Mac OS"){H=null
}W="identify"+W
}else{W="mask"+W;
if(j){Y=v(j.replace(/([a-z])([A-Z])/g,"$1 $2"))
}else{Y="Opera"
}if(/IE/.test(W)){H=null
}if(!O){G=null
}}S=["Presto"];
M.push(W)
}}}}}}}}}if((W=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(N)||0)[1])){W=[parseFloat(W.replace(/\.(\d)$/,".0$1")),W];
if(Y=="Safari"&&W[1].slice(-1)=="+"){Y="WebKit Nightly";
I="alpha";
G=W[1].slice(0,-1)
}else{if(G==W[1]||G==(/\bSafari\/([\d.]+\+?)/i.exec(N)||0)[1]){G=null
}}W=[W[0],(/\bChrome\/([\d.]+)/i.exec(N)||0)[1]];
if(!O||(/internal|\n/i.test(r.toString())&&!W[1])){S&&(S[1]="like Safari");
W=(W=W[0],W<400?1:W<500?2:W<526?3:W<533?4:W<534?"4+":W<535?5:"5")
}else{S&&(S[1]="like Chrome");
W=W[1]||(W=W[0],W<530?1:W<532?2:W<532.05?3:W<533?4:W<534.03?5:W<534.07?6:W<534.1?7:W<534.13?8:W<534.16?9:W<534.24?10:W<534.3?11:W<535.01?12:W<535.02?"13+":W<535.07?15:W<535.11?16:W<535.19?17:W<536.05?18:W<536.1?19:W<537.01?20:"21")
}S&&(S[1]+=" "+(W+=typeof W=="number"?".x":/[.+]/.test(W)?"":"+"));
if(Y=="Safari"&&(!G||parseInt(G)>45)){G=W
}}if(Y=="Opera"&&(W=/(?:zbov|zvav)$/.exec(H))){Y+=" ";
M.unshift("desktop mode");
if(W=="zvav"){Y+="Mini";
G=null
}else{Y+="Mobile"
}}else{if(Y=="Safari"&&/Chrome/.exec(S&&S[1])){M.unshift("desktop mode");
Y="Chrome Mobile";
G=null;
if(/OS X/.test(H)){V="Apple";
H="iOS 4.3+"
}else{H=null
}}}if(G&&G.indexOf((W=/[\d.]+$/.exec(H)))==0&&N.indexOf("/"+W+"-")>-1){H=u(H.replace(W,""))
}if(S&&!/Avant|Nook/.test(Y)&&(/Browser|Lunascape|Maxthon/.test(Y)||/^(?:Adobe|Arora|Midori|Phantom|Rekonq|Rock|Sleipnir|Web)/.test(Y)&&S[1])){(W=S[S.length-1])&&M.push(W)
}if(M.length){M=["("+M.join("; ")+")"]
}if(V&&F&&F.indexOf(V)<0){M.push("on "+V)
}if(F){M.push((/^on /.test(M[M.length-1])?"":"on ")+F)
}if(H){W=/ ([\d.+]+)$/.exec(H);
H={architecture:32,family:W?H.replace(W[0],""):H,version:W?W[1]:null,toString:function(){var Z=this.version;
return this.family+(Z?" "+Z:"")+(this.architecture==64?" 64-bit":"")
}}
}if((W=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(X))&&!/\bi686\b/i.test(X)){if(H){H.architecture=64;
H.family=H.family.replace(RegExp(" *"+W),"")
}if(Y&&(/WOW64/i.test(N)||(O&&/\w(?:86|32)$/.test(e.cpuClass||e.platform)))){M.unshift("32-bit")
}}N||(N=null);
return{version:Y&&G&&(M.unshift(G),G),name:Y&&(M.unshift(Y),Y),os:H?(Y&&!(H==String(H).split(" ")[0]&&(H==Y.split(" ")[0]||F))&&M.push(F?"("+H+")":"on "+H),H):{architecture:null,family:null,version:null,toString:function(){return"null"
}},description:M.length?M.join(" "):N,layout:S&&S[0],manufacturer:V,prerelease:I,product:F,ua:N,parse:m,toString:U}
}if(typeof define=="function"&&typeof define.amd=="object"&&define.amd){define(function(){return m()
})
}else{if(c&&E){x(m(),function(G,F){c[F]=G
})
}else{q.platform=m()
}}}.call(this));
function SwipeResponsive(o,f){var g=function(){};
var x=function(F){setTimeout(F||g,0)
};
var m=false;
var E={addEventListener:!!window.addEventListener,touch:("ontouchstart" in window)||window.DocumentTouch&&document instanceof DocumentTouch,transitions:(function(F){var H=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];
for(var G in H){if(F.style[H[G]]!==undefined){return true
}}return false
})(document.createElement("swipe"))};
if(!o){return
}var c=o.querySelector(".slider-content");
var v,d,u,h;
f=f||{};
var l=parseInt(f.startSlide,10)||0;
var y=f.speed||300;
f.continuous=f.continuous!==undefined?f.continuous:true;
var e=f.responsiveRule||function(){if(window.innerWidth<600){return true
}else{return false
}};
function p(){if(e()){m=true;
v=c.querySelectorAll(".feature-box");
h=v.length;
if(v.length<2){f.continuous=false
}if(E.transitions&&f.continuous&&v.length<3){var H=v[0].cloneNode(true);
var G=v[1].cloneNode(true);
H.classList.add("cloned");
G.classList.add("cloned");
c.appendChild(H);
c.appendChild(G);
v=c.querySelectorAll(".feature-box")
}d=new Array(v.length);
u=o.getBoundingClientRect().width||o.offsetWidth;
c.style.width=(v.length*u)+"px";
var I=v.length;
while(I--){var F=v[I];
F.style.width=u+"px";
F.setAttribute("data-index",I);
if(E.transitions){F.style.left=(I*-u)+"px";
t(I,l>I?-u:(l<I?u:0),0)
}}if(f.continuous&&E.transitions){t(j(l-1),-u,0);
t(j(l+1),u,0)
}if(!E.transitions){c.style.left=(l*-u)+"px"
}o.style.visibility="visible"
}else{if(m){$(".slider").find(".slider-content").find(".feature-box").removeAttr("style");
$(".cloned").remove()
}}}function q(){if(f.continuous){a(l-1)
}else{if(l){a(l-1)
}}}function r(){if(f.continuous){a(l+1)
}else{if(l<v.length-1){a(l+1)
}}}function j(F){return(v.length+(F%v.length))%v.length
}function a(J,G){if(l==J){return
}if(E.transitions){var I=Math.abs(l-J)/(l-J);
if(f.continuous){var F=I;
I=-d[j(J)]/u;
if(I!==F){J=-I*v.length+J
}}var H=Math.abs(l-J)-1;
while(H--){t(j((J>l?J:l)-H-1),u*I,0)
}J=j(J);
t(l,u*I,G||y);
t(J,0,G||y);
if(f.continuous){t(j(J-I),-(u*I),0)
}}else{J=j(J);
k(l*-u,J*-u,G||y)
}l=J;
x(f.callback&&f.callback(l,v[l]))
}function t(F,H,G){n(F,H,G);
d[F]=H
}function n(G,J,I){var F=v[G];
var H=F&&F.style;
if(!H){return
}H.webkitTransitionDuration=H.MozTransitionDuration=H.msTransitionDuration=H.OTransitionDuration=H.transitionDuration=I+"ms";
H.webkitTransform="translate("+J+"px,0)translateZ(0)";
H.msTransform=H.MozTransform=H.OTransform="translateX("+J+"px)"
}function k(J,I,F){if(!F){c.style.left=I+"px";
return
}var H=+new Date;
var G=setInterval(function(){var K=+new Date-H;
if(K>F){c.style.left=I+"px";
if(D){A()
}f.transitionEnd&&f.transitionEnd.call(event,l,v[l]);
clearInterval(G);
return
}c.style.left=(((I-J)*(Math.floor((K/F)*100)/100))+J)+"px"
},4)
}var D=f.auto||0;
var z;
function A(){z=setTimeout(r,D)
}function w(){D=0;
clearTimeout(z)
}var i={};
var B={};
var C;
var b={handleEvent:function(F){switch(F.type){case"touchstart":this.start(F);
break;
case"touchmove":this.move(F);
break;
case"touchend":x(this.end(F));
break;
case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":x(this.transitionEnd(F));
break;
case"resize":x(p.call());
break
}if(f.stopPropagation){F.stopPropagation()
}},start:function(F){var G=F.touches[0];
i={x:G.pageX,y:G.pageY,time:+new Date};
C=undefined;
B={};
c.addEventListener("touchmove",this,false);
c.addEventListener("touchend",this,false)
},move:function(F){if(F.touches.length>1||F.scale&&F.scale!==1){return
}if(f.disableScroll){F.preventDefault()
}var G=F.touches[0];
B={x:G.pageX-i.x,y:G.pageY-i.y};
if(typeof C=="undefined"){C=!!(C||Math.abs(B.x)<Math.abs(B.y))
}if(!C){F.preventDefault();
w();
if(f.continuous){n(j(l-1),B.x+d[j(l-1)],0);
n(l,B.x+d[l],0);
n(j(l+1),B.x+d[j(l+1)],0)
}else{B.x=B.x/((!l&&B.x>0||l==v.length-1&&B.x<0)?(Math.abs(B.x)/u+1):1);
n(l-1,B.x+d[l-1],0);
n(l,B.x+d[l],0);
n(l+1,B.x+d[l+1],0)
}}},end:function(H){var J=+new Date-i.time;
var G=Number(J)<250&&Math.abs(B.x)>20||Math.abs(B.x)>u/2;
var F=!l&&B.x>0||l==v.length-1&&B.x<0;
if(f.continuous){F=false
}var I=B.x<0;
if(!C){if(G&&!F){if(I){if(f.continuous){t(j(l-1),-u,0);
t(j(l+2),u,0)
}else{t(l-1,-u,0)
}t(l,d[l]-u,y);
t(j(l+1),d[j(l+1)]-u,y);
l=j(l+1)
}else{if(f.continuous){t(j(l+1),u,0);
t(j(l-2),-u,0)
}else{t(l+1,u,0)
}t(l,d[l]+u,y);
t(j(l-1),d[j(l-1)]+u,y);
l=j(l-1)
}f.callback&&f.callback(l,v[l])
}else{if(f.continuous){t(j(l-1),-u,y);
t(l,0,y);
t(j(l+1),u,y)
}else{t(l-1,-u,y);
t(l,0,y);
t(l+1,u,y)
}}}c.removeEventListener("touchmove",b,false);
c.removeEventListener("touchend",b,false)
},transitionEnd:function(F){if(parseInt(F.target.getAttribute("data-index"),10)==l){if(D){A()
}f.transitionEnd&&f.transitionEnd.call(F,l,v[l])
}}};
p();
if(D){A()
}if(E.addEventListener&&c){if(E.touch){c.addEventListener("touchstart",b,false)
}if(E.transitions){c.addEventListener("webkitTransitionEnd",b,false);
c.addEventListener("msTransitionEnd",b,false);
c.addEventListener("oTransitionEnd",b,false);
c.addEventListener("otransitionend",b,false);
c.addEventListener("transitionend",b,false)
}window.addEventListener("resize",b,false)
}else{window.onresize=function(){p()
}
}return{setup:function(){p()
},slide:function(G,F){w();
a(G,F)
},prev:function(){w();
q()
},next:function(){w();
r()
},getPos:function(){return l
},getNumSlides:function(){return h
},kill:function(){w();
c.style.width="auto";
c.style.left=0;
var G=v.length;
while(G--){var F=v[G];
F.style.width="100%";
F.style.left=0;
if(E.transitions){n(G,0,0)
}}if(E.addEventListener){c.removeEventListener("touchstart",b,false);
c.removeEventListener("webkitTransitionEnd",b,false);
c.removeEventListener("msTransitionEnd",b,false);
c.removeEventListener("oTransitionEnd",b,false);
c.removeEventListener("otransitionend",b,false);
c.removeEventListener("transitionend",b,false);
window.removeEventListener("resize",b,false)
}else{window.onresize=null
}}}
}if(window.jQuery||window.Zepto){(function(a){a.fn.Swipe=function(b){return this.each(function(){a(this).data("Swipe",new Swipe(a(this)[0],b))
})
}
})(window.jQuery||window.Zepto)
}!function(a){a(function(){a.support.transition=(function(){var b=(function(){var e=document.createElement("bootstrap"),d={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},c;
for(c in d){if(e.style[c]!==undefined){return d[c]
}}}());
return b&&{end:b}
})()
})
}(window.jQuery);
!function(d){var c='[data-dismiss="alert"]',b=function(e){d(e).on("click",c,this.close)
};
b.prototype.close=function(j){var i=d(this),g=i.attr("data-target"),h;
if(!g){g=i.attr("href");
g=g&&g.replace(/.*(?=#[^\s]*$)/,"")
}h=d(g);
j&&j.preventDefault();
h.length||(h=i.hasClass("alert")?i:i.parent());
h.trigger(j=d.Event("close"));
if(j.isDefaultPrevented()){return
}h.removeClass("in");
function f(){h.trigger("closed").remove()
}d.support.transition&&h.hasClass("fade")?h.on(d.support.transition.end,f):f()
};
var a=d.fn.alert;
d.fn.alert=function(e){return this.each(function(){var g=d(this),f=g.data("alert");
if(!f){g.data("alert",(f=new b(this)))
}if(typeof e=="string"){f[e].call(g)
}})
};
d.fn.alert.Constructor=b;
d.fn.alert.noConflict=function(){d.fn.alert=a;
return this
};
d(document).on("click.alert.data-api",c,b.prototype.close)
}(window.jQuery);
!function(c){var b=function(e,d){this.$element=c(e);
this.options=c.extend({},c.fn.button.defaults,d)
};
b.prototype.setState=function(g){var i="disabled",e=this.$element,f=e.data(),h=e.is("input")?"val":"html";
g=g+"Text";
f.resetText||e.data("resetText",e[h]());
e[h](f[g]||this.options[g]);
setTimeout(function(){g=="loadingText"?e.addClass(i).attr(i,i):e.removeClass(i).removeAttr(i)
},0)
};
b.prototype.toggle=function(){var d=this.$element.closest('[data-toggle="buttons-radio"]');
d&&d.find(".active").removeClass("active");
this.$element.toggleClass("active")
};
var a=c.fn.button;
c.fn.button=function(d){return this.each(function(){var g=c(this),f=g.data("button"),e=typeof d=="object"&&d;
if(!f){g.data("button",(f=new b(this,e)))
}if(d=="toggle"){f.toggle()
}else{if(d){f.setState(d)
}}})
};
c.fn.button.defaults={loadingText:"loading..."};
c.fn.button.Constructor=b;
c.fn.button.noConflict=function(){c.fn.button=a;
return this
};
c(document).on("click.button.data-api","[data-toggle^=button]",function(f){var d=c(f.target);
if(!d.hasClass("btn")){d=d.closest(".btn")
}d.button("toggle")
})
}(window.jQuery);
!function(b){var c=function(e,d){this.$element=b(e);
this.$indicators=this.$element.find(".carousel-indicators");
this.options=d;
this.options.pause=="hover"&&this.$element.on("mouseenter",b.proxy(this.pause,this)).on("mouseleave",b.proxy(this.cycle,this))
};
c.prototype={cycle:function(d){if(!d){this.paused=false
}if(this.interval){clearInterval(this.interval)
}this.options.interval&&!this.paused&&(this.interval=setInterval(b.proxy(this.next,this),this.options.interval));
return this
},getActiveIndex:function(){this.$active=this.$element.find(".item.active");
this.$items=this.$active.parent().children();
return this.$items.index(this.$active)
},to:function(f){var d=this.getActiveIndex(),e=this;
if(f>(this.$items.length-1)||f<0){return
}if(this.sliding){return this.$element.one("slid",function(){e.to(f)
})
}if(d==f){return this.pause().cycle()
}return this.slide(f>d?"next":"prev",b(this.$items[f]))
},pause:function(d){if(!d){this.paused=true
}if(this.$element.find(".next, .prev").length&&b.support.transition.end){this.$element.trigger(b.support.transition.end);
this.cycle(true)
}clearInterval(this.interval);
this.interval=null;
return this
},next:function(){if(this.sliding){return
}return this.slide("next")
},prev:function(){if(this.sliding){return
}return this.slide("prev")
},slide:function(k,f){var m=this.$element.find(".item.active"),d=f||m[k](),j=this.interval,l=k=="next"?"left":"right",g=k=="next"?"first":"last",h=this,i;
this.sliding=true;
j&&this.pause();
d=d.length?d:this.$element.find(".item")[g]();
i=b.Event("slide",{relatedTarget:d[0],direction:l});
if(d.hasClass("active")){return
}if(this.$indicators.length){this.$indicators.find(".active").removeClass("active");
this.$element.one("slid",function(){var e=b(h.$indicators.children()[h.getActiveIndex()]);
e&&e.addClass("active")
})
}if(b.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(i);
if(i.isDefaultPrevented()){return
}d.addClass(k);
d[0].offsetWidth;
m.addClass(l);
d.addClass(l);
this.$element.one(b.support.transition.end,function(){d.removeClass([k,l].join(" ")).addClass("active");
m.removeClass(["active",l].join(" "));
h.sliding=false;
setTimeout(function(){h.$element.trigger("slid")
},0)
})
}else{this.$element.trigger(i);
if(i.isDefaultPrevented()){return
}m.removeClass("active");
d.addClass("active");
this.sliding=false;
this.$element.trigger("slid")
}j&&this.cycle();
return this
}};
var a=b.fn.carousel;
b.fn.carousel=function(d){return this.each(function(){var h=b(this),g=h.data("carousel"),e=b.extend({},b.fn.carousel.defaults,typeof d=="object"&&d),f=typeof d=="string"?d:e.slide;
if(!g){h.data("carousel",(g=new c(this,e)))
}if(typeof d=="number"){g.to(d)
}else{if(f){g[f]()
}else{if(e.interval){g.pause().cycle()
}}}})
};
b.fn.carousel.defaults={interval:5000,pause:"hover"};
b.fn.carousel.Constructor=c;
b.fn.carousel.noConflict=function(){b.fn.carousel=a;
return this
};
b(document).on("click.carousel.data-api","[data-slide], [data-slide-to]",function(j){var i=b(this),f,d=b(i.attr("data-target")||(f=i.attr("href"))&&f.replace(/.*(?=#[^\s]+$)/,"")),g=b.extend({},d.data(),i.data()),h;
d.carousel(g);
if(h=i.attr("data-slide-to")){d.data("carousel").pause().to(h).cycle()
}j.preventDefault()
})
}(window.jQuery);
!function(b){var c=function(e,d){this.$element=b(e);
this.options=b.extend({},b.fn.collapse.defaults,d);
if(this.options.parent){this.$parent=b(this.options.parent)
}this.options.toggle&&this.toggle()
};
c.prototype={constructor:c,dimension:function(){var d=this.$element.hasClass("width");
return d?"width":"height"
},show:function(){var g,d,f,e;
if(this.transitioning||this.$element.hasClass("in")){return
}g=this.dimension();
d=b.camelCase(["scroll",g].join("-"));
f=this.$parent&&this.$parent.find("> .accordion-group > .in");
if(f&&f.length){e=f.data("collapse");
if(e&&e.transitioning){return
}f.collapse("hide");
e||f.data("collapse",null)
}this.$element[g](0);
this.transition("addClass",b.Event("show"),"shown");
b.support.transition&&this.$element[g](this.$element[0][d])
},hide:function(){var d;
if(this.transitioning||!this.$element.hasClass("in")){return
}d=this.dimension();
this.reset(this.$element[d]());
this.transition("removeClass",b.Event("hide"),"hidden");
this.$element[d](0)
},reset:function(d){var e=this.dimension();
this.$element.removeClass("collapse")[e](d||"auto")[0].offsetWidth;
this.$element[d!==null?"addClass":"removeClass"]("collapse");
return this
},transition:function(h,e,f){var g=this,d=function(){if(e.type=="show"){g.reset()
}g.transitioning=0;
g.$element.trigger(f)
};
this.$element.trigger(e);
if(e.isDefaultPrevented()){return
}this.transitioning=1;
this.$element[h]("in");
b.support.transition&&this.$element.hasClass("collapse")?this.$element.one(b.support.transition.end,d):d()
},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()
}};
var a=b.fn.collapse;
b.fn.collapse=function(d){return this.each(function(){var g=b(this),f=g.data("collapse"),e=b.extend({},b.fn.collapse.defaults,g.data(),typeof d=="object"&&d);
if(!f){g.data("collapse",(f=new c(this,e)))
}if(typeof d=="string"){f[d]()
}})
};
b.fn.collapse.defaults={toggle:true};
b.fn.collapse.Constructor=c;
b.fn.collapse.noConflict=function(){b.fn.collapse=a;
return this
};
b(document).on("click.collapse.data-api","[data-toggle=collapse]",function(i){var h=b(this),d,g=h.attr("data-target")||i.preventDefault()||(d=h.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,""),f=b(g).data("collapse")?"toggle":h.data();
h[b(g).hasClass("in")?"addClass":"removeClass"]("collapsed");
h[b(g).hasClass("in")?"removeClass":"addClass"]("opened");
b(g).collapse(f)
})
}(window.jQuery);
!function(f){var b="[data-toggle=dropdown]",a=function(h){var g=f(h).on("click.dropdown.data-api",this.toggle);
f("html").on("click.dropdown.data-api",function(){g.parent().removeClass("open")
})
};
a.prototype={constructor:a,toggle:function(j){var i=f(this),h,g;
if(i.is(".disabled, :disabled")){return
}h=e(i);
g=h.hasClass("open");
d();
if(!g){if("ontouchstart" in document.documentElement){f('<div class="dropdown-backdrop"/>').insertBefore(f(this)).on("click",d)
}h.toggleClass("open")
}i.focus();
return false
},keydown:function(l){var k,m,g,j,i,h;
if(!/(38|40|27)/.test(l.keyCode)){return
}k=f(this);
l.preventDefault();
l.stopPropagation();
if(k.is(".disabled, :disabled")){return
}j=e(k);
i=j.hasClass("open");
if(!i||(i&&l.keyCode==27)){if(l.which==27){j.find(b).focus()
}return k.click()
}m=f("[role=menu] li:not(.divider):visible a",j);
if(!m.length){return
}h=m.index(m.filter(":focus"));
if(l.keyCode==38&&h>0){h--
}if(l.keyCode==40&&h<m.length-1){h++
}if(!~h){h=0
}m.eq(h).focus()
}};
function d(){f(".dropdown-backdrop").remove();
f(b).each(function(){e(f(this)).removeClass("open")
})
}function e(i){var g=i.attr("data-target"),h;
if(!g){g=i.attr("href");
g=g&&/#/.test(g)&&g.replace(/.*(?=#[^\s]*$)/,"")
}h=g&&f(g);
if(!h||!h.length){h=i.parent()
}return h
}var c=f.fn.dropdown;
f.fn.dropdown=function(g){return this.each(function(){var i=f(this),h=i.data("dropdown");
if(!h){i.data("dropdown",(h=new a(this)))
}if(typeof g=="string"){h[g].call(i)
}})
};
f.fn.dropdown.Constructor=a;
f.fn.dropdown.noConflict=function(){f.fn.dropdown=c;
return this
};
f(document).on("click.dropdown.data-api",d).on("click.dropdown.data-api",".dropdown form",function(g){g.stopPropagation()
}).on("click.dropdown.data-api",b,a.prototype.toggle).on("keydown.dropdown.data-api",b+", [role=menu]",a.prototype.keydown)
}(window.jQuery);
!function(c){var a=function(f,e){this.init(f,e)
};
a.prototype={constructor:a,init:function(f,e){this.$element=c(f);
this.options=c.extend({},c.fn.modalmanager.defaults,this.$element.data(),typeof e=="object"&&e);
this.stack=[];
this.backdropCount=0;
if(this.options.resize){var h,g=this;
c(window).on("resize.modal",function(){h&&clearTimeout(h);
h=setTimeout(function(){for(var j=0;
j<g.stack.length;
j++){g.stack[j].isShown&&g.stack[j].layout()
}},10)
})
}},createModal:function(f,e){c(f).modal(c.extend({manager:this},e))
},appendModal:function(f){this.stack.push(f);
var e=this;
f.$element.on("show.modalmanager",b(function(h){var g=function(){f.isShown=true;
var i=c.support.transition&&f.$element.hasClass("fade");
e.$element.toggleClass("modal-open",e.hasOpenModal()).toggleClass("page-overflow",c(window).height()<e.$element.height());
f.$parent=f.$element.parent();
f.$container=e.createContainer(f);
f.$element.appendTo(f.$container);
e.backdrop(f,function(){f.$element.show();
if(i){f.$element[0].offsetWidth
}f.layout();
f.$element.addClass("in").attr("aria-hidden",false);
var j=function(){e.setFocus();
f.$element.trigger("shown")
};
i?f.$element.one(c.support.transition.end,j):j()
})
};
f.options.replace?e.replace(g):g()
}));
f.$element.on("hidden.modalmanager",b(function(g){e.backdrop(f);
if(f.$backdrop){var h=c.support.transition&&f.$element.hasClass("fade");
if(h){f.$element[0].offsetWidth
}c.support.transition&&f.$element.hasClass("fade")?f.$backdrop.one(c.support.transition.end,function(){e.destroyModal(f)
}):e.destroyModal(f)
}else{e.destroyModal(f)
}}));
f.$element.on("destroy.modalmanager",b(function(g){e.removeModal(f)
}))
},destroyModal:function(f){f.destroy();
var e=this.hasOpenModal();
this.$element.toggleClass("modal-open",e);
if(!e){this.$element.removeClass("page-overflow")
}this.removeContainer(f);
this.setFocus()
},getOpenModals:function(){var f=[];
for(var e=0;
e<this.stack.length;
e++){if(this.stack[e].isShown){f.push(this.stack[e])
}}return f
},hasOpenModal:function(){return this.getOpenModals().length>0
},setFocus:function(){var f;
for(var e=0;
e<this.stack.length;
e++){if(this.stack[e].isShown){f=this.stack[e]
}}if(!f){return
}f.focus()
},removeModal:function(e){e.$element.off(".modalmanager");
if(e.$backdrop){this.removeBackdrop(e)
}this.stack.splice(this.getIndexOfModal(e),1)
},getModalAt:function(e){return this.stack[e]
},getIndexOfModal:function(f){for(var e=0;
e<this.stack.length;
e++){if(f===this.stack[e]){return e
}}},replace:function(g){var f;
for(var e=0;
e<this.stack.length;
e++){if(this.stack[e].isShown){f=this.stack[e]
}}if(f){this.$backdropHandle=f.$backdrop;
f.$backdrop=null;
g&&f.$element.one("hidden",b(c.proxy(g,this)));
f.hide()
}else{if(g){g()
}}},removeBackdrop:function(e){e.$backdrop.remove();
e.$backdrop=null
},createBackdrop:function(g,f){var e;
if(!this.$backdropHandle){e=c(f).addClass(g).appendTo(this.$element)
}else{e=this.$backdropHandle;
e.off(".modalmanager");
this.$backdropHandle=null;
this.isLoading&&this.removeSpinner()
}return e
},removeContainer:function(e){e.$container.remove();
e.$container=null
},createContainer:function(e){var f;
f=c('<div class="modal-scrollable">').css("z-index",d("modal",this.getOpenModals().length)).appendTo(this.$element);
if(e&&e.options.backdrop!="static"){f.on("click.modal",b(function(g){e.hide()
}))
}else{if(e){f.on("click.modal",b(function(g){e.attention()
}))
}}return f
},backdrop:function(h,j){var f=h.$element.hasClass("fade")?"fade":"",i=h.options.backdrop&&this.backdropCount<this.options.backdropLimit;
if(h.isShown&&i){var e=c.support.transition&&f&&!this.$backdropHandle;
h.$backdrop=this.createBackdrop(f,h.options.backdropTemplate);
if(e){h.$backdrop[0].offsetWidth
}h.$backdrop.addClass("in");
this.backdropCount+=1;
e?h.$backdrop.one(c.support.transition.end,j):j()
}else{if(!h.isShown&&h.$backdrop){h.$backdrop.removeClass("in");
this.backdropCount-=1;
var g=this;
c.support.transition&&h.$element.hasClass("fade")?h.$backdrop.one(c.support.transition.end,function(){g.removeBackdrop(h)
}):g.removeBackdrop(h)
}else{if(j){j()
}}}},removeSpinner:function(){this.$spinner&&this.$spinner.remove();
this.$spinner=null;
this.isLoading=false
},removeLoading:function(){this.$backdropHandle&&this.$backdropHandle.remove();
this.$backdropHandle=null;
this.removeSpinner()
},loading:function(h){h=h||function(){};
this.$element.toggleClass("modal-open",!this.isLoading||this.hasOpenModal()).toggleClass("page-overflow",c(window).height()<this.$element.height());
if(!this.isLoading){this.$backdropHandle=this.createBackdrop("fade",this.options.backdropTemplate);
this.$backdropHandle[0].offsetWidth;
var e=this.getOpenModals();
this.$backdropHandle.css("z-index",d("backdrop",e.length+1)).addClass("in");
var g=c(this.options.spinner).css("z-index",d("modal",e.length+1)).appendTo(this.$element).addClass("in");
this.$spinner=c(this.createContainer()).append(g).on("click.modalmanager",c.proxy(this.loading,this));
this.isLoading=true;
c.support.transition?this.$backdropHandle.one(c.support.transition.end,h):h()
}else{if(this.isLoading&&this.$backdropHandle){this.$backdropHandle.removeClass("in");
var f=this;
c.support.transition?this.$backdropHandle.one(c.support.transition.end,function(){f.removeLoading()
}):f.removeLoading()
}else{if(h){h(this.isLoading)
}}}}};
var d=(function(){var f,e={};
return function(g,j){if(typeof f==="undefined"){var i=c('<div class="modal hide" />').appendTo("body"),h=c('<div class="modal-backdrop hide" />').appendTo("body");
e.modal=+i.css("z-index");
e.backdrop=+h.css("z-index");
f=e.modal-e.backdrop;
i.remove();
h.remove();
h=i=null
}return e[g]+(f*j)
}
}());
function b(e){return function(f){if(this===f.target){return e.apply(this,arguments)
}}
}c.fn.modalmanager=function(f,e){return this.each(function(){var h=c(this),g=h.data("modalmanager");
if(!g){h.data("modalmanager",(g=new a(this,f)))
}if(typeof f==="string"){g[f].apply(g,[].concat(e))
}})
};
c.fn.modalmanager.defaults={backdropLimit:999,resize:true,spinner:'<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',backdropTemplate:'<div class="modal-backdrop" />'};
c.fn.modalmanager.Constructor=a
}(jQuery);
!function(b){var a=function(d,c){this.init(d,c)
};
a.prototype={constructor:a,init:function(e,c){var f=this;
this.options=c;
this.$element=b(e).delegate('[data-dismiss="modal"]',"click.dismiss.modal",b.proxy(this.hide,this));
this.options.remote&&this.$element.find(".modal-body").load(this.options.remote,function(){var g=b.Event("loaded");
f.$element.trigger(g)
});
var d=typeof this.options.manager==="function"?this.options.manager.call(this):this.options.manager;
d=d.appendModal?d:b(d).modalmanager().data("modalmanager");
d.appendModal(this)
},toggle:function(){return this[!this.isShown?"show":"hide"]()
},show:function(){var c=b.Event("show");
if(this.isShown){return
}this.$element.trigger(c);
if(c.isDefaultPrevented()){return
}this.escape();
this.tab();
this.options.loading&&this.loading()
},hide:function(c){c&&c.preventDefault();
c=b.Event("hide");
this.$element.trigger(c);
if(!this.isShown||c.isDefaultPrevented()){return(this.isShown=false)
}this.isShown=false;
this.escape();
this.tab();
this.isLoading&&this.loading();
b(document).off("focusin.modal");
this.$element.removeClass("in").removeClass("animated").removeClass(this.options.attentionAnimation).removeClass("modal-overflow").attr("aria-hidden",true);
b.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()
},layout:function(){var f=this.options.height?"height":"max-height",d=this.options.height||this.options.maxHeight;
if(this.options.width){this.$element.css("width",this.options.width);
var c=this;
this.$element.css("margin-left",function(){if(/%/ig.test(c.options.width)){return -(parseInt(c.options.width)/2)+"%"
}else{return -(b(this).width()/2)+"px"
}})
}else{this.$element.css("width","");
this.$element.css("margin-left","")
}this.$element.find(".modal-body").css("overflow","").css(f,"");
if(d){this.$element.find(".modal-body").css("overflow","auto").css(f,d)
}var e=b(window).height()-10<this.$element.height();
if(e||this.options.modalOverflow){this.$element.addClass("modal-overflow")
}else{this.$element.removeClass("modal-overflow")
}b(".input-prepend, .input-append").each(function(h,i){var g=b("input",i).css("width","");
b(".add-on",i).each(function(){g.css("width","-="+b(this).outerWidth())
})
})
},tab:function(){var c=this;
if(this.isShown&&this.options.consumeTab){this.$element.on("keydown.tabindex.modal","[data-tabindex]",function(g){if(g.keyCode&&g.keyCode==9){var d=b(this),f=b(this);
c.$element.find("[data-tabindex]:enabled:not([readonly])").each(function(h){if(!h.shiftKey){d=d.data("tabindex")<b(this).data("tabindex")?d=b(this):f=b(this)
}else{d=d.data("tabindex")>b(this).data("tabindex")?d=b(this):f=b(this)
}});
d[0]!==b(this)[0]?d.focus():f.focus();
g.preventDefault()
}})
}else{if(!this.isShown){this.$element.off("keydown.tabindex.modal")
}}},escape:function(){var c=this;
if(this.isShown&&this.options.keyboard){if(!this.$element.attr("tabindex")){this.$element.attr("tabindex",-1)
}this.$element.on("keyup.dismiss.modal",function(d){d.which==27&&c.hide()
})
}else{if(!this.isShown){this.$element.off("keyup.dismiss.modal")
}}},hideWithTransition:function(){var c=this,d=setTimeout(function(){c.$element.off(b.support.transition.end);
c.hideModal()
},500);
this.$element.one(b.support.transition.end,function(){clearTimeout(d);
c.hideModal()
})
},hideModal:function(){var d=this.options.height?"height":"max-height";
var c=this.options.height||this.options.maxHeight;
if(c){this.$element.find(".modal-body").css("overflow","").css(d,"")
}this.$element.hide().trigger("hidden")
},removeLoading:function(){this.$loading.remove();
this.$loading=null;
this.isLoading=false
},loading:function(f){f=f||function(){};
var d=this.$element.hasClass("fade")?"fade":"";
if(!this.isLoading){var c=b.support.transition&&d;
this.$loading=b('<div class="loading-mask '+d+'">').append(this.options.spinner).appendTo(this.$element);
if(c){this.$loading[0].offsetWidth
}this.$loading.addClass("in");
this.isLoading=true;
c?this.$loading.one(b.support.transition.end,f):f()
}else{if(this.isLoading&&this.$loading){this.$loading.removeClass("in");
var e=this;
b.support.transition&&this.$element.hasClass("fade")?this.$loading.one(b.support.transition.end,function(){e.removeLoading()
}):e.removeLoading()
}else{if(f){f(this.isLoading)
}}}},focus:function(){var c=this.$element.find(this.options.focusOn);
c=c.length?c:this.$element;
c.focus()
},attention:function(){if(this.options.attentionAnimation){this.$element.removeClass("animated").removeClass(this.options.attentionAnimation);
var c=this;
setTimeout(function(){c.$element.addClass("animated").addClass(c.options.attentionAnimation)
},0)
}this.focus()
},destroy:function(){var c=b.Event("destroy");
this.$element.trigger(c);
if(c.isDefaultPrevented()){return
}this.teardown()
},teardown:function(){if(!this.$parent.length){this.$element.remove();
this.$element=null;
return
}if(this.$parent!==this.$element.parent()){this.$element.appendTo(this.$parent)
}this.$element.off(".modal");
this.$element.removeData("modal");
this.$element.removeClass("in").attr("aria-hidden",true)
}};
b.fn.modal=function(d,c){return this.each(function(){var g=b(this),f=g.data("modal"),e=b.extend({},b.fn.modal.defaults,g.data(),typeof d=="object"&&d);
if(!f){g.data("modal",(f=new a(this,e)))
}if(typeof d=="string"){f[d].apply(f,[].concat(c))
}else{if(e.show){f.show()
}}})
};
b.fn.modal.defaults={keyboard:true,backdrop:true,loading:false,show:true,width:null,height:null,maxHeight:null,modalOverflow:false,consumeTab:true,focusOn:null,replace:false,resize:false,attentionAnimation:"shake",manager:"body",spinner:'<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',backdropTemplate:'<div class="modal-backdrop" />'};
b.fn.modal.Constructor=a;
b(function(){b(document).off("click.modal").on("click.modal.data-api",'[data-toggle="modal"]',function(h){var g=b(this),d=g.attr("href"),c=b(g.attr("data-target")||(d&&d.replace(/.*(?=#[^\s]+$)/,""))),f=c.data("modal")?"toggle":b.extend({remote:!/#/.test(d)&&d},c.data(),g.data());
h.preventDefault();
c.modal(f).one("hide",function(){g.focus()
})
})
})
}(window.jQuery);
!function(c){var b=function(e,d){this.init("tooltip",e,d)
};
b.prototype={constructor:b,init:function(k,h,f){var l,d,j,e,g;
this.type=k;
this.$element=c(h);
this.options=this.getOptions(f);
this.enabled=true;
j=this.options.trigger.split(" ");
for(g=j.length;
g--;
){e=j[g];
if(e=="click"){this.$element.on("click."+this.type,this.options.selector,c.proxy(this.toggle,this))
}else{if(e!="manual"){l=e=="hover"?"mouseenter":"focus";
d=e=="hover"?"mouseleave":"blur";
this.$element.on(l+"."+this.type,this.options.selector,c.proxy(this.enter,this));
this.$element.on(d+"."+this.type,this.options.selector,c.proxy(this.leave,this))
}}}this.options.selector?(this._options=c.extend({},this.options,{trigger:"manual",selector:""})):this.fixTitle()
},getOptions:function(d){d=c.extend({},c.fn[this.type].defaults,this.$element.data(),d);
if(d.delay&&typeof d.delay=="number"){d.delay={show:d.delay,hide:d.delay}
}return d
},enter:function(h){var g=c.fn[this.type].defaults,f={},d;
this._options&&c.each(this._options,function(e,i){if(g[e]!=i){f[e]=i
}},this);
d=c(h.currentTarget)[this.type](f).data(this.type);
if(!d.options.delay||!d.options.delay.show){return d.show()
}clearTimeout(this.timeout);
d.hoverState="in";
this.timeout=setTimeout(function(){if(d.hoverState=="in"){d.show()
}},d.options.delay.show)
},leave:function(f){var d=c(f.currentTarget)[this.type](this._options).data(this.type);
if(this.timeout){clearTimeout(this.timeout)
}if(!d.options.delay||!d.options.delay.hide){return d.hide()
}d.hoverState="out";
this.timeout=setTimeout(function(){if(d.hoverState=="out"){d.hide()
}},d.options.delay.hide)
},show:function(){var i,k,g,j,d,h,f=c.Event("show");
if(this.hasContent()&&this.enabled){this.$element.trigger(f);
if(f.isDefaultPrevented()){return
}i=this.tip();
this.setContent();
if(this.options.animation){i.addClass("fade")
}d=typeof this.options.placement=="function"?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement;
i.detach().css({top:0,left:0,display:"block"});
this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);
k=this.getPosition();
g=i[0].offsetWidth;
j=i[0].offsetHeight;
switch(d){case"bottom":h={top:k.top+k.height,left:k.left+k.width/2-g/2};
break;
case"top":h={top:k.top-j,left:k.left+k.width/2-g/2};
break;
case"left":h={top:k.top+k.height/2-j/2,left:k.left-g};
break;
case"right":h={top:k.top+k.height/2-j/2,left:k.left+k.width};
break
}this.applyPlacement(h,d);
this.$element.trigger("shown")
}},applyPlacement:function(g,h){var i=this.tip(),e=i[0].offsetWidth,l=i[0].offsetHeight,d,j,k,f;
i.offset(g).addClass(h).addClass("in");
d=i[0].offsetWidth;
j=i[0].offsetHeight;
if(h=="top"&&j!=l){g.top=g.top+l-j;
f=true
}if(h=="bottom"||h=="top"){k=0;
if(g.left<0){k=g.left*-2;
g.left=0;
i.offset(g);
d=i[0].offsetWidth;
j=i[0].offsetHeight
}this.replaceArrow(k-e+d,d,"left")
}else{this.replaceArrow(j-l,j,"top")
}if(f){i.offset(g)
}},replaceArrow:function(f,e,d){this.arrow().css(d,f?(50*(1-f/e)+"%"):"")
},setContent:function(){var e=this.tip(),d=this.getTitle();
e.find(".tooltip-inner")[this.options.html?"html":"text"](d);
e.removeClass("fade in top bottom left right")
},hide:function(){var d=this,g=this.tip(),f=c.Event("hide");
this.$element.trigger(f);
if(f.isDefaultPrevented()){return
}g.removeClass("in");
function h(){var e=setTimeout(function(){g.off(c.support.transition.end).detach()
},500);
g.one(c.support.transition.end,function(){clearTimeout(e);
g.detach()
})
}c.support.transition&&this.$tip.hasClass("fade")?h():g.detach();
this.$element.trigger("hidden");
return this
},fixTitle:function(){var d=this.$element;
if(d.attr("title")||typeof(d.attr("data-original-title"))!="string"){d.attr("data-original-title",d.attr("title")||"").attr("title","")
}},hasContent:function(){return this.getTitle()
},getPosition:function(){var d=this.$element[0];
return c.extend({},(typeof d.getBoundingClientRect=="function")?d.getBoundingClientRect():{width:d.offsetWidth,height:d.offsetHeight},this.$element.offset())
},getTitle:function(){var f,d=this.$element,e=this.options;
f=d.attr("data-original-title")||(typeof e.title=="function"?e.title.call(d[0]):e.title);
return f
},tip:function(){return this.$tip=this.$tip||c(this.options.template)
},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")
},validate:function(){if(!this.$element[0].parentNode){this.hide();
this.$element=null;
this.options=null
}},enable:function(){this.enabled=true
},disable:function(){this.enabled=false
},toggleEnabled:function(){this.enabled=!this.enabled
},toggle:function(f){var d=f?c(f.currentTarget)[this.type](this._options).data(this.type):this;
d.tip().hasClass("in")?d.hide():d.show()
},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)
}};
var a=c.fn.tooltip;
c.fn.tooltip=function(d){return this.each(function(){var g=c(this),f=g.data("tooltip"),e=typeof d=="object"&&d;
if(!f){g.data("tooltip",(f=new b(this,e)))
}if(typeof d=="string"){f[d]()
}})
};
c.fn.tooltip.Constructor=b;
c.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:false,container:false};
c.fn.tooltip.noConflict=function(){c.fn.tooltip=a;
return this
}
}(window.jQuery);
!function(c){var b=function(e,d){this.init("popover",e,d)
};
b.prototype=c.extend({},c.fn.tooltip.Constructor.prototype,{constructor:b,setContent:function(){var f=this.tip(),e=this.getTitle(),d=this.getContent();
f.find(".popover-title")[this.options.html?"html":"text"](e);
f.find(".popover-content")[this.options.html?"html":"text"](d);
f.removeClass("fade top bottom left right in")
},hasContent:function(){return this.getTitle()||this.getContent()
},getContent:function(){var e,d=this.$element,f=this.options;
e=(typeof f.content=="function"?f.content.call(d[0]):f.content)||d.attr("data-content");
return e
},tip:function(){if(!this.$tip){this.$tip=c(this.options.template)
}return this.$tip
},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type)
}});
var a=c.fn.popover;
c.fn.popover=function(d){return this.each(function(){var g=c(this),f=g.data("popover"),e=typeof d=="object"&&d;
if(!f){g.data("popover",(f=new b(this,e)))
}if(typeof d=="string"){f[d]()
}})
};
c.fn.popover.Constructor=b;
c.fn.popover.defaults=c.extend({},c.fn.tooltip.defaults,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'});
c.fn.popover.noConflict=function(){c.fn.popover=a;
return this
}
}(window.jQuery);
!function(c){function b(g,f){var h=c.proxy(this.process,this),d=c(g).is("body")?c(window):c(g),e;
this.options=c.extend({},c.fn.scrollspy.defaults,f);
this.$scrollElement=d.on("scroll.scroll-spy.data-api",h);
this.selector=(this.options.target||((e=c(g).attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,""))||"")+" .nav li > a";
this.$body=c("body");
this.refresh();
this.process()
}b.prototype={constructor:b,refresh:function(){var d=this,e;
this.offsets=c([]);
this.targets=c([]);
e=this.$body.find(this.selector).map(function(){var g=c(this),f=g.data("target")||g.attr("href"),h=/^#\w/.test(f)&&c(f);
return(h&&h.length&&[[h.position().top+(!c.isWindow(d.$scrollElement.get(0))&&d.$scrollElement.scrollTop()),f]])||null
}).sort(function(g,f){return g[0]-f[0]
}).each(function(){d.offsets.push(this[0]);
d.targets.push(this[1])
})
},process:function(){var j=this.$scrollElement.scrollTop()+this.options.offset,f=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,h=f-this.$scrollElement.height(),g=this.offsets,d=this.targets,k=this.activeTarget,e;
if(j>=h){return k!=(e=d.last()[0])&&this.activate(e)
}for(e=g.length;
e--;
){k!=d[e]&&j>=g[e]&&(!g[e+1]||j<=g[e+1])&&this.activate(d[e])
}},activate:function(f){var e,d;
this.activeTarget=f;
c(this.selector).parent(".active").removeClass("active");
d=this.selector+'[data-target="'+f+'"],'+this.selector+'[href="'+f+'"]';
e=c(d).parent("li").addClass("active");
if(e.parent(".dropdown-menu").length){e=e.closest("li.dropdown").addClass("active")
}e.trigger("activate")
}};
var a=c.fn.scrollspy;
c.fn.scrollspy=function(d){return this.each(function(){var g=c(this),f=g.data("scrollspy"),e=typeof d=="object"&&d;
if(!f){g.data("scrollspy",(f=new b(this,e)))
}if(typeof d=="string"){f[d]()
}})
};
c.fn.scrollspy.Constructor=b;
c.fn.scrollspy.defaults={offset:10};
c.fn.scrollspy.noConflict=function(){c.fn.scrollspy=a;
return this
};
c(window).on("load",function(){c('[data-spy="scroll"]').each(function(){var d=c(this);
d.scrollspy(d.data())
})
})
}(window.jQuery);
!function(c){var b=function(d){this.element=c(d)
};
b.prototype={constructor:b,show:function(){var j=this.element,g=j.closest("ul:not(.dropdown-menu)"),f=j.attr("data-target"),h,d,i;
if(!f){f=j.attr("href");
f=f&&f.replace(/.*(?=#[^\s]*$)/,"")
}if(j.parent("li").hasClass("active")){return
}h=g.find(".active:last a")[0];
i=c.Event("show",{relatedTarget:h});
j.trigger(i);
if(i.isDefaultPrevented()){return
}d=c(f);
this.activate(j.parent("li"),g);
this.activate(d,d.parent(),function(){j.trigger({type:"shown",relatedTarget:h})
})
},activate:function(f,e,i){var d=e.find("> .active"),h=i&&c.support.transition&&d.hasClass("fade");
function g(){d.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");
f.addClass("active");
if(h){f[0].offsetWidth;
f.addClass("in")
}else{f.removeClass("fade")
}if(f.parent(".dropdown-menu")){f.closest("li.dropdown").addClass("active")
}i&&i()
}h?d.one(c.support.transition.end,g):g();
d.removeClass("in")
}};
var a=c.fn.tab;
c.fn.tab=function(d){return this.each(function(){var f=c(this),e=f.data("tab");
if(!e){f.data("tab",(e=new b(this)))
}if(typeof d=="string"){e[d]()
}})
};
c.fn.tab.Constructor=b;
c.fn.tab.noConflict=function(){c.fn.tab=a;
return this
};
c(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(d){d.preventDefault();
c(this).tab("show")
})
}(window.jQuery);
!function(c){var b=function(e,d){this.options=c.extend({},c.fn.affix.defaults,d);
this.$window=c(window).on("scroll.affix.data-api",c.proxy(this.checkPosition,this)).on("click.affix.data-api",c.proxy(function(){setTimeout(c.proxy(this.checkPosition,this),1)
},this));
this.$element=c(e);
this.checkPosition()
};
b.prototype.checkPosition=function(){if(!this.$element.is(":visible")){return
}var h=c(document).height(),j=this.$window.scrollTop(),d=this.$element.offset(),k=this.options.offset,f=k.bottom,g=k.top,i="affix affix-top affix-bottom",e;
if(typeof k!="object"){f=g=k
}if(typeof g=="function"){g=k.top()
}if(typeof f=="function"){f=k.bottom()
}e=this.unpin!=null&&(j+this.unpin<=d.top)?false:f!=null&&(d.top+this.$element.height()>=h-f)?"bottom":g!=null&&j<=g?"top":false;
if(this.affixed===e){return
}this.affixed=e;
this.unpin=e=="bottom"?d.top-j:null;
this.$element.removeClass(i).addClass("affix"+(e?"-"+e:""))
};
var a=c.fn.affix;
c.fn.affix=function(d){return this.each(function(){var g=c(this),f=g.data("affix"),e=typeof d=="object"&&d;
if(!f){g.data("affix",(f=new b(this,e)))
}if(typeof d=="string"){f[d]()
}})
};
c.fn.affix.Constructor=b;
c.fn.affix.defaults={offset:0};
c.fn.affix.noConflict=function(){c.fn.affix=a;
return this
};
c(window).on("load",function(){c('[data-spy="affix"]').each(function(){var e=c(this),d=e.data();
d.offset=d.offset||{};
d.offsetBottom&&(d.offset.bottom=d.offsetBottom);
d.offsetTop&&(d.offset.top=d.offsetTop);
e.affix(d)
})
})
}(window.jQuery);
window.console=window.console||{error:function(a){},info:function(a){},log:function(a){},time:function(a){},timeEnd:function(a){},trace:function(a){},warn:function(a){}};
if(!Array.prototype.indexOf){Array.prototype.indexOf=function(a,b){if(this===undefined||this===null){throw new TypeError('"this" is null or not defined')
}var c=this.length>>>0;
b=+b||0;
if(Math.abs(b)===Infinity){b=0
}if(b<0){b+=c;
if(b<0){b=0
}}for(;
b<c;
b++){if(this[b]===a){return b
}}return -1
}
}var RR=(function(c,b,a){c.getVersion=(function(){var d="0.5.26";
return d
})();
c.pages={};
c.components={};
c.plugins={};
c.init=function(){};
c.options={debug:false,templates:true,API_PATH:"/api"};
if(window.sfdcVariables&&window.sfdcVariables.deploymentId&&window.sfdcVariables.deploymentId==="572g0000000CaS0"){c.options.debug=true
}c.post=function(g,d,f){var e;
e=f?f:{};
e.type="POST";
e.data=JSON.stringify(f.data);
e.contentType="application/json; charset=utf-8";
e.dataType="json";
return c.ajax(g,d,f)
};
c.get=function(f,e){var d;
d={};
d.type="GET";
return c.ajax(f,e,d)
};
c.ajax=function(i,e,h){var g;
var f;
var j;
var d;
d=new b.Deferred();
f={cache:false};
j=[];
if(h===undefined||h.dontSpin===undefined||!(h.dontSpin)){c.setupLoadingSpinnerTriggers(d)
}g=b.ajax(c.options.API_PATH+i,a.defaults(h,f));
g.done(function(l,m,k){d.resolve(k.status,l)
});
g.fail(function(k,m,l){if(a.indexOf(a.defaults(e,j),k.status)>=0){d.resolve(k.status,{})
}else{d.reject(k,m,l)
}});
return d.promise()
};
c.setupLoadingSpinnerTriggers=function(d){if(d===undefined){return
}b(RR).trigger("apiCallStarted");
d.always(function(f,g,e){b(RR).trigger("apiCallFinished")
})
};
if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")
}
}return c
}(RR||{},jQuery,_));
var RR=(function(d,c,a){var b={};
b.API_PATH="/api";
d.apiCache=[];
d.debugCalls=[];
b.callsInProgress={};
b.addDirtyFieldsArrayTo=function(g,i,f){var h=[];
function e(k,l,j){a.each(l,function(m,n){var o=k.hasOwnProperty(n)?k[n]:undefined;
var p=(j||j===0)?j+(isNaN(Number(n))?"."+n:"["+n+"]"):n;
if(f&&a.isObject(m)&&o===undefined){if(a.isArray(m)){o=[]
}else{o={}
}}if(a.isObject(m)&&o!==undefined&&p!=="personalDetails.dateOfBirth"){e(o,m,p)
}else{if(m!==o){h.push(p)
}}})
}e(i||{},g);
g.dirtyFields=h;
return h
};
b.mock=function(e,h){var g;
var f;
f=h?h:{};
g=new c.Deferred();
g.resolve(e,f);
return g.promise()
};
b.cacheAvailable=function(h,g){var f,e=d.apiCache.length,j=false;
for(f;
f<e;
f+=1){if((d.apiCache[f].path===h)&&(d.apiCache[f].settings===g)){j=true;
break
}}if(j){return d.apiCache[f].data
}else{return false
}};
b.call=function(f,q,g,l,o,h){var r;
var p;
var k;
var j;
var i=h;
var n=false;
p=new c.Deferred();
if(!(i)){d.setupLoadingSpinnerTriggers(p)
}try{f=f.toUpperCase();
l=l?l:{};
a.each(l,function(t,e){if(!a.isObject(t)){if(q.match(":"+e)){l=a.omit(l,e);
q=q.replace(":"+e,t)
}}});
k={data:l,type:f,cache:false};
if(f==="POST"){k.data=RR.utils.replaceHTMLCharacters(JSON.stringify(k.data));
k.contentType="application/json; charset=utf-8";
k.dataType="json"
}if(f==="GET"){j=b.cacheAvailable(b.API_PATH+q,k);
if(RR.api.callsInProgress[q]&&RR.api.callsInProgress[q].type===k.type){n=true;
c(RR).on("apiCallDone:"+q,function(v,u,w,t){b.onApiCallDone(u,t,p)
});
c(RR).on("apiCallFail:"+q,function(v,t,w,u){b.onApiCallFail(t,w,u,p,g)
})
}else{RR.api.callsInProgress[q]=k
}}if(!j&&!n){r=c.ajax(b.API_PATH+q,k);
r.done(function(t,u,e){b.onApiCallDone(t,e,p);
c(RR).trigger("apiCallDone:"+q,[t,u,e]);
b.stopTrackingCall(q);
RR.apiCache.push({path:b.API_PATH+q,settings:k,data:t})
});
r.fail(function(e,u,t){b.onApiCallFail(e,u,t,p,g);
c(RR).trigger("apiCallFail:"+q,[e,u,t]);
b.stopTrackingCall(q)
})
}}catch(m){if(!RR.utils.isAuthor()){d.url.redirect("GLOBAL_SERVER_ERROR")
}p.reject()
}return p.promise()
};
b.onApiCallDone=function(g,f,e){e.resolve(f.status,g,f)
};
b.onApiCallFail=function(i,l,k,g,f){var h;
if(a.indexOf(f,i.status)>=0){if(i.responseText){try{h=JSON.parse(i.responseText)
}catch(j){h={}
}g.resolve(i.status,h,i)
}else{g.resolve(i.status,{},i)
}}else{if(i.status===403&&d.currentPageId()!=="GLOBAL_ACCESS_FORBIDDEN"){d.url.redirect("GLOBAL_ACCESS_FORBIDDEN");
g.reject(i,l,k)
}else{if(i.status&&typeof window.callPhantom!=="function"&&typeof jasmine==="undefined"){if(!RR.utils.isAuthor()){d.url.redirect("GLOBAL_SERVER_ERROR")
}g.reject(i,l,k)
}}}};
b.stopTrackingCall=function(e){delete RR.api.callsInProgress[e];
c(RR).off("apiCallDone:"+e).off("apiCallFail:"+e)
};
d.api=b;
return d
}(RR||{},jQuery,_));
var RR=(function(f,d,b){var c;
var a;
var e;
c="";
e=".html";
a={ROOT:"",HOME:"/secure/home",HOME_SIGNED_OUT:"/retiready",SIGNED_IN_HOME:"/secure/home",SETUP_IN_PROGRESS:"/public/setup-in-progress",SIGN_IN:"/public/sign-in",RESET_YOUR_PASSWORD:"/public/sign-in/reset-your-password",FORGOTTEN_PASSWORD:"/public/sign-in/forgotten-password",ACCOUNT_LOCKED:"/public/sign-in/account-locked",CHANGE_YOUR_USERNAME:"/public/sign-in/change-your-username",CONTACT_US:"/public/contact-us",CONTACT_US_THANKS:"/public/contact-us/thank-you",FAQ_HOME:"/public/support/faq",FAQ_SEARCH:"/public/support/faq/search",FAQS:"/public/support/faq/*",INSIGHTS_HOME:"/public/coach/insights",INSIGHTS:"/public/coach/insights/*",INSIGHTS_SEARCH:"/public/coach/insights/search",SAVINGS:"/secure/savings",YOUR_PROFILE:"/secure/your-profile",ORPHAN_HOME:"/public/upgrade",ORPHAN_AUTH_ALREADY_REGISTERED:"/public/upgrade/already-registered",ORPHAN_AUTH_ID:"/public/upgrade/primary-authentication",ORPHAN_SINGLE_AUTH:"/public/upgrade/single-authentication",ORPHAN_AUTH_REQUEST_ID:"/public/upgrade/expired",ORPHAN_AUTH_SECURITY:"/session/upgrade/secondary-authentication",ORPHAN_COMPARISON_HOME:"/session/upgrade/authenticated/before-you-apply",ORPHAN_CONFIRM_DETAILS:"/session/upgrade/authenticated/confirm-your-details",ORPHAN_FUND_PROJECTIONS:"/session/upgrade/authenticated/fund-selection",ORPHAN_FUNDS_EDUCATION:"/session/upgrade/authenticated/fund-information",ORPHAN_RESEND_VERIFICATION:"/session/upgrade/authenticated/resend-verification",ORPHAN_SECURITY_DETAILS:"/session/upgrade/authenticated/create-profile",ORPHAN_TERMS_AND_CONDITIONS:"/session/upgrade/authenticated/terms-and-conditions",ORPHAN_UPDATE_EMAIL:"/session/upgrade/authenticated/update-email",ORPHAN_VERIFY_EMAIL:"/public/upgrade/authenticated/verify-email",RISK_PROFILE_START:"/session/risk-profile",RISK_PROFILE_QUESTIONNAIRE:"/session/risk-profile/risk-profile-questionnaire",RISK_PROFILE_RESULTS:"/session/risk-profile/risk-profile-results",AUTO_PROFILE:"/session/activate/authenticated/profile",AUTO_SECURITY:"/session/activate/authenticated/security",AUTO_WELCOME:"/public/activate/welcome",AUTO_EMAIL:"/public/activate/verify-email",WORKPLACE_PROFILE:"/session/getstarted/authenticated/profile",WORKPLACE_SECURITY:"/session/getstarted/authenticated/security",WORKPLACE_WELCOME:"/public/getstarted/welcome",WORKPLACE_EMAIL:"/public/getstarted/verify-email",NEW_CUSTOMER_PURCHASE_ISA:"/public/shop/retiready-isa/payments",NEW_CUSTOMER_PURCHASE_PENSION:"/public/shop/retiready-pension/payments",NEW_CUSTOMER_CONFIRM_DETAILS:"/session/shop/retiready/confirm-your-details",FUND_SELECTION_ISA:"/session/shop/retiready-isa/fund-selection",FUND_SELECTION_PENSION:"/session/shop/retiready-pension/fund-selection",NEW_CUSTOMER_SECURITY_DETAILS:"/session/shop/retiready/create-profile",NEW_CUSTOMER_ISA_TERMS:"/session/shop/retiready-isa/terms-and-conditions",NEW_CUSTOMER_PENSION_TERMS:"/session/shop/retiready-pension/terms-and-conditions",NEW_CUSTOMER_UPDATE_EMAIL:"/public/shop/retiready/update-email",NEW_CUSTOMER_VERIFY_EMAIL:"/public/shop/retiready/verify-email",NEW_CUSTOMER_PENSION:"/public/shop/retiready-pension",NEW_CUSTOMER_ISA:"/public/shop/retiready-isa",NEW_COMPARISON_ISA:"/public/shop/arc-isa",ISA_WRAPPER:"/secure/savings/isa/transfer-in",ISA_WRAPPER_CONFIRM_TERMS:"/secure/savings/isa/transfer-in/confirm-terms",PENSION_WRAPPER:"/secure/savings/pension/transfer-in",PENSION_WRAPPER_CONFIRM_TERMS:"/secure/savings/pension/transfer-in/confirm-terms",CHANGE_FUND_ISA:"/secure/savings/isa/switch-investment-fund",CHANGE_FUND_PENSION:"/secure/savings/pension/switch-investment-fund",CHANGE_FUND_CONFIRMATION:"/secure/savings/change-fund/confirm",CHANGE_FUND_EDUCATION:"/secure/savings/change-fund/fund-education",CHANGE_FUND_NON_RR:"/secure/savings/pension/switch-investment-fund-non-rr",CHANGE_OTHER_FUND_CONFIRMATION:"/secure/savings/change-fund/confirm-others",SAVINGS_BENEFICIARIES:"/secure/savings/pension/beneficiaries",BASIC_PROFILE:"/secure/your-profile",RESET_MEMORABLE_WORD:"/public/sign-in/reset-memorable-word",MANAGE_PENSION_SINGLE:"/secure/savings/pension/single-payment",MANAGE_ISA_SINGLE:"/secure/savings/isa/single-payment",MANAGE_ISA_REGULAR:"/secure/savings/isa/regular-payments",MANAGE_ISA_AMOUNT_REGULAR:"/secure/savings/isa/regular-withdrawals",MANAGE_ISA_AMOUNT_ONE_OFF:"/secure/savings/isa/single-withdrawal",MANAGE_ISA_FUNDS_CONFIRM:"/secure/savings/manage-isa-funds/confirm",GLOBAL_SESSION_EXPIRY:"/public/error/session-expired",SIGNED_OUT_GLOBAL_SERVER_ERROR:"/public/error/500",SIGNED_IN_GLOBAL_SERVER_ERROR:"/secure/error/500",SIGNED_OUT_GLOBAL_ACCESS_FORBIDDEN:"/public/error/403",SIGNED_IN_GLOBAL_ACCESS_FORBIDDEN:"/secure/error/403",PROSPECT_CUSTOMER_ACCOUNT_CREATION_FAILED:"/public/error/502",WELCOME:"/public/purchase-confirmed",GOALS_DASHBOARD:"/session/goals",GOAL_PLANNER:"/session/goals/goal-planner",GET_SCORE:"/session/goals/get-score",GOALS_LANDING:"/public/goals",LIFESTYLE_PLANNER:"/session/goals/life-planner",SUPPORT:"/secure/support",SUPPORT_SIGN_OUT:"/public/support",MAILBOX:"/secure/support/messages",LANDING_SHOP_HOME:"/secure/shop",SHOP_PAGES_OUR_INVESTMENT_FUNDS:"/public/shop/about-investment-funds",SHOP_PENSION_BEFORE_YOU_APPLY:"/public/shop/retiready-pension/before-you-apply",SHOP_PENSION_TRANSFER_INFO:"/public/shop/retiready-pension/pension-transfer",SHOP_ISA_BEFORE_YOU_APPLY:"/public/shop/retiready-isa/before-you-apply",SHOP_ISA_TRANSFER_INFO:"/public/shop/retiready-isa/isa-transfer",SHOP_CONSOLIDATION:"/public/shop/transfer",REGISTERED_CUSTOMER_PURCHASE_PENSION:"/session/registered-shop/retiready-pension/payments",REGISTERED_CUSTOMER_PURCHASE_ISA:"/session/registered-shop/retiready-isa/payments",REGISTERED_FUND_SELECTION_PENSION:"/session/registered-shop/retiready-pension/fund-selection",REGISTERED_FUND_SELECTION_ISA:"/session/registered-shop/retiready-isa/fund-selection",REGISTERED_CUSTOMER_PENSION_CONFIRM_DETAILS:"/session/registered-shop/retiready-pension/confirm-your-details",REGISTERED_CUSTOMER_ISA_CONFIRM_DETAILS:"/session/registered-shop/retiready-isa/confirm-your-details",REGISTERED_CUSTOMER_PENSION_TERMS:"/session/registered-shop/retiready-pension/terms-and-conditions",REGISTERED_CUSTOMER_ISA_TERMS:"/session/registered-shop/retiready-isa/terms-and-conditions",REGISTER_PROSPECT:"/public/register",REGISTER_PROSPECT_VERIFY_EMAIL:"/public/register/verify-email",REGISTER_PROSPECT_UPDATE_EMAIL:"/public/register/update-email",REGISTERED_PROSPECT_PURCHASE_ISA:"/secure/shop/pre-registered/retiready-isa/payments",REGISTERED_PROSPECT_PURCHASE_PENSION:"/secure/shop/pre-registered/retiready-pension/payments",REGISTERED_PROSPECT_CONFIRM_DETAILS:"/secure/shop/pre-registered/confirm-your-details",REGISTERED_PROSPECT_FUND_SELECTION_ISA:"/secure/shop/pre-registered/retiready-isa/fund-selection",REGISTERED_PROSPECT_FUND_SELECTION_PENSION:"/secure/shop/pre-registered/retiready-pension/fund-selection",REGISTERED_PROSPECT_SECURITY_DETAILS:"/secure/shop/pre-registered/create-profile",REGISTERED_PROSPECT_ISA_TERMS:"/secure/shop/pre-registered/retiready-isa/terms-and-conditions",REGISTERED_PROSPECT_PENSION_TERMS:"/secure/shop/pre-registered/retiready-pension/terms-and-conditions"};
f.navigation={HOME:"/home.",GOALS:"/session/goals",SHOP:"/secure/shop",SAVINGS:"/secure/savings",COACH:"/secure/coach",SUPPORT:"/secure/support"};
f.route=function(h,g){if(h){if(h.indexOf("GLOBAL_ACCESS_FORBIDDEN")>=0){h=RR.utils.isUserLoggedIn()?"SIGNED_IN_GLOBAL_ACCESS_FORBIDDEN":"SIGNED_OUT_GLOBAL_ACCESS_FORBIDDEN"
}else{if(h.indexOf("GLOBAL_SERVER_ERROR")>=0){h=RR.utils.isUserLoggedIn()?"SIGNED_IN_GLOBAL_SERVER_ERROR":"SIGNED_OUT_GLOBAL_SERVER_ERROR"
}}var i=g?"?"+decodeURIComponent(d.param(g)):"";
if(a.hasOwnProperty(h)){return c+a[h]+e+i
}else{return false
}}else{return false
}};
f.currentPageId=function(m){var l;
var k;
var h;
var g;
if(!m){m=window
}k=m.location.pathname.replace(c,"").replace(e,"");
g=b.invert(a)[k];
if(!g){h=k.split("/");
for(var j=0;
j<h.length;
j++){h[j]=j>0?h[j-1]+"/"+h[j]:h[j];
g=b.invert(a)[h[j]+"/*"];
if(g){break
}}}return g
};
f.url={};
f.url.pathRoot="/content/retiready";
f.url.parameter=function(g){return decodeURIComponent((new RegExp("[?|&]"+g+"=([^&;]+?)(&|#|;|$)").exec(location.search)||["",""])[1].replace(/\+/g,"%20"))||null
};
f.url.getParametersAsObject=function(h){h=h||window.location.search.length>0?window.location.search.substr(1):"";
var g={};
if(h.length===0){return
}h.replace(/\b([^&=]*)=([^&=]*)\b/g,function(j,i,k){if(g[i]===undefined){g[i]=k
}else{if(!d.isArray(g[i])){g[i]=[g[i]]
}g[i].push(k)
}});
return g
};
f.url.redirect=function(h,g){d(window).off("beforeunload");
var j=g?"?"+decodeURIComponent(d.param(g)):"";
var i=RR.route(h);
if(document.URL.indexOf(i)===-1){d(RR).trigger("headway:showSpinner",[true])
}window.location=i+j
};
f.url.goToUrl=function(g){location.replace(g)
};
f.url.goBack=function(){window.history.go(-1)
};
f.findRoute=function(g){var h=document.URL;
return h.indexOf(g)!==-1
};
f.prevRoute=function(g){var h=document.referrer;
return h.indexOf(g)!==-1
};
f.setActiveNavigation=function(h){var g=document.URL;
return g.indexOf(h)!==-1
};
return f
}(RR||{},jQuery,_));
var RR=(function(d,c,b){var a={};
a.getNumberAbbreviations=function(){return["","k","m","b"]
};
a.getNumberSuffixValue=function(g){var f=a.getNumberAbbreviations(),e=f.indexOf(g);
if(e>=0){return Math.pow(10,e*3)
}else{return 1
}};
a.isonscreen=function(g){var h=c(window);
var e={top:h.scrollTop(),left:h.scrollLeft()};
e.right=e.left+h.width();
e.bottom=e.top+h.height();
var f=g.offset();
f.right=f.left+g.outerWidth();
f.bottom=f.top+g.outerHeight();
return(!(e.right<f.left||e.left>f.right||e.bottom<f.top||e.top>f.bottom))
};
a.formatAmount=function(l,p,h,e){p=p||"";
e=e===undefined?"":e;
var g=a.getNumberAbbreviations(),u=g.length,w,r="",t=true,q=q,v=3,m=(p==="G"&&l<10000)?1:0;
h=(h===undefined)?false:h;
l=parseFloat(l,10);
if(isNaN(l)){return false
}if(p==="B"){l=(h===true)?l.toFixed(2):parseInt(l,10);
return o(l,"",e)
}if(p==="G"&&l<100){l=0
}var n=[100,1000,10000],j=n.length;
while(j--){if(l<n[j]){v=j+1
}}if(p!=="G"&&l<1000){v=3
}function k(i,y){if(i===0||isNaN(i)){return false
}if(!y){return i
}function B(D){return Math.log(D)/Math.LN10
}var C=Math.ceil(B(i<0?-i:i)),x=y-C,A=Math.pow(10,x),z=Math.floor(i*A);
return z/A
}if(t){while(u--){w=a.getNumberSuffixValue(g[u]);
if(l===0){r=g[1]
}if(w<=l){r=g[u];
if(w===1&&p==="G"){w=1000;
r=g[1]
}l=k(l/w,v-m);
break
}}}else{l=k(l,v)
}if(!l.toString().split(".")[1]){if(l!==0){var f=v-l.toString().length-m;
if(f>0){l=l.toFixed(f)
}}else{l=l.toFixed(v-m+1)
}}function o(i,y,x){x=x===undefined?"":x;
y=y||"";
return x+i.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+y
}return o(l,r,e)
};
a.getNumberFromString=function(h){if(b.isNumber(h)){return h
}else{if(!b.isString(h)){return null
}}var e=["0","1","2","3","4","5","6","7","8","9","."],f="",g=h.charAt(h.length-1);
b.each(h,function(i){if(b.indexOf(e,i)>=0){f+=i
}});
return parseFloat(f)*a.getNumberSuffixValue(g)
};
a.isAuthor=function(){if(typeof CQ!=="undefined"){return(typeof CQ.WCM!=="undefined")
}return false
};
a.isUserLoggedIn=function(){return !!(RR.session("loggedIn"))
};
a.isRegisteredCustomer=function(){return(RR.session("customerType")&&RR.session("customerType")==="REGISTERED_CUSTOMER")
};
a.isRegisteredProspect=function(){return(RR.session("customerType")&&RR.session("customerType")==="REGISTERED_PROSPECT")
};
a.formatNumber=function(h,k,e,i){if(isNaN(h)||h===null){return""
}h=h.toFixed(~~k);
i=(typeof i==="string")?i:",";
var j=h.split("."),g=j[0],f=j[1]?(e||".")+j[1]:"";
return g.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+i)+f
};
a.debugMessage=function(g,f){var e=f||"log";
if(RR.options.debug){if(window.console){window.console[e](g,this.element)
}}};
a.logEvents=function(){c.fn.trigger=function(e,f){a.debugMessage(['Event: "'+e+'"',f,this]);
return this.each(function(){c.event.trigger(e,f,this)
})
}
};
a.detectDevice=function(){var g=["phone","tablet","desktop"],f=c("<div>"),e,h;
f.appendTo(c("body"));
for(e=g.length-1;
e>=0;
e--){h=g[e];
f.addClass("hidden-"+h);
if(f.is(":hidden")){f.remove();
return h
}}};
a.removeObjectProperties=function(f,e){b.each(e,function(g){delete f[g]
});
return f
};
a.rrHide=function(){c("[data-rr-show]").each(function(){var f=c(this),e=f.attr("data-rr-show");
if(!e||e==="false"){f.hide()
}else{f.show()
}})
};
a.isValidDate=function(g){var h=/^(\d{2})[-\/](\d{2})[-\/](\d{4})$/.exec(g);
if(h===null){return false
}var i=parseInt(h[2],10);
var f=parseInt(h[1]-1,10);
var j=parseInt(h[3],10);
var e=new Date(j,f,i);
return e.getDate()===i&&e.getMonth()===f&&e.getFullYear()===j
};
a.chunk=function(f,h){var e=[];
for(var g=0;
g<f.length;
g+=h){e.push(f.substr(g,h))
}return e.join(" ")
};
a.formatSortCode=function(g,f,e){if(!g){return""
}else{return g+"-"+f+"-"+e
}};
a.formatStringAsCurrency=function(h,f){f=(f!==undefined)?f:"";
if(h||h===0){h=Math.abs(h);
var j=Number("1.2").toLocaleString().substr(1,1);
var e=String(h).split(j);
var g=e[0];
var i=(e.length>1?e[1]:"");
i=(i+"00").substr(0,2);
h=g+j+i;
return f+h.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")
}else{return""
}};
a.replaceClass=function(e,g,f){c(e).removeClass(g).addClass(f)
};
a.fundToInt=function(f){var e;
switch(f){case"A":e=1;
break;
case"B":e=2;
break;
case"C":e=3;
break;
case"D":e=4;
break;
case"E":e=5;
break;
default:e=0
}return e
};
a.reloadPage=function(){location.reload()
};
a.stringToDate=function(e){return window.moment(e)
};
a.stringToDateFormatted=function(e,f){f=f||"D MMMM YYYY";
return window.moment(e).format(f)
};
a.arrayToDateFormatted=function(f,g){g=g||"D MMMM YYYY";
var e=[];
e[0]=f[0];
e[1]=f[1]-1;
e[2]=f[2];
return window.moment(e).format(g)
};
a.convertCharToPaymentPeriod=function(e){switch(e){case"W":return"per week";
case"M":return"per month";
case"A":return"anual"
}};
a.accordionArrowBehaviour=function(f,g,e){c.each(f,function(j,h){var m=c(h);
var k;
var l;
if(g){l="&#xf709;";
k="&#xf70a;"
}else{k="&#xf709;";
l="&#xf70a;"
}m.on("hidden",function(i){var n=c(i.target).attr("id");
m.find('a[href="#'+n.replace("-inner","")+'"] .ico').html(k)
});
m.on("shown",function(i){var n=c(i.target).attr("id");
m.find('a[href="#'+n.replace("-inner","")+'"] .ico').html(l)
});
if(!e){c(window).resize(function(i){if(m.find("a.accordion-toggle").is(":visible")){m.find(".accordion-body").collapse("show")
}})
}})
};
a.calculateEffectivePaymentYear=function(f){var e=new Date();
var g=e.getMonth()+1;
if(g>=f){return e.getFullYear()+1
}else{return e.getFullYear()
}};
a.calculatePaymentMonth=function(){var f=new Date();
var e=new Date();
var g;
e.setDate(f.getDate()+10);
if(f.getMonth()!==e.getMonth()){return e.getMonth()
}else{return f.getMonth()
}};
a.calculatePaymentMonthForMoneyOut=function(){var f=new Date();
var h=new Date(f.getFullYear(),f.getMonth()+1,6);
var g=24*60*60*1000;
var e=((h-f)/g);
if(e>=14){return new Date(f.getFullYear(),f.getMonth()+1).getMonth()
}else{return new Date(f.getFullYear(),f.getMonth()+2).getMonth()
}};
a.addLeadingZeroes=function(h,f){var e="";
for(var g=0;
g<f;
g++){e+="0"
}return(e+h).slice(-f)
};
a.roundToNearest=function(f,e){return f*(Math.round(e/f))
};
a.removeHash=function(e){return e.split("#")[0]
};
a.toLetters=function(e){return(e-1).toString(26).replace(/./g,function(f){return String.fromCharCode(f.charCodeAt(0)+(isNaN(+f)?10:49))
}).toUpperCase()
};
a.toNumbers=function(e){if(e!==undefined&&e!==null&&e.length!==0){e=e.toUpperCase();
var h="ABCDEFGHIJKLMNOPQRSTUVWXYZ",g=0,f;
for(f=0;
f<e.length;
f++){g+=Math.pow(h.length,f)*(h.indexOf(e.substr(((f+1)*-1),1))+1)
}return g
}else{return e
}};
a.replaceTemplateString=function(g,f,e){if(g.length){g.html(g.html().replace(f,e))
}};
a.renderWidgetCounter=function(m,j){function h(n){return"<div><span>"+n+"</span></div>"
}function k(n){return'<div class="non-flipboard">'+n+"</div>"
}var g=j.toString();
var f=[".",",","","k","m"];
var e=m.find(".widget-counter");
e.children().remove();
e.removeClass(".widget-counter");
e.addClass(".widget-counter-"+g.length);
var i=m.find(".screenreader-visible");
i.text(g);
var l="";
c.each(g.split(""),function(n,o){o=(o===" ")?"&nbsp;":o;
if(f.indexOf(o)!==-1){l+=k(o)
}else{l+=h(o)
}});
e.append(l)
};
a.contains=function(e,f){if((e.indexOf(e))>-1){return true
}else{return false
}};
a.getDeepValueFromObject=function(f,e){e=e.split(".");
while(f&&e[0]){f=f[e.shift()]
}return f
};
if(!String.prototype.startsWith){String.prototype.startsWith=function(f,e){e=e||0;
return this.indexOf(f,e)===e
}
}a.replaceHTMLCharacters=function(e){if(!b.isString(e)){return e
}return e.replace(/;/g,"&#50;").replace(/</g," ").replace(/>/g," ").replace(/=/g,"&#61").replace(/\(/g,"&#40;").replace(/\)/g,"&#41;")
};
a.redirectIfNoScore=function(e){if(RR.utils.isAuthor()){return
}if(RR.session.exists()){var f=new RR.api.Score();
var g=f.retrieveScore();
g.done(function(h,j,i){if(h===200){}else{c(RR).trigger("navigateAwayModal:deactivate");
RR.url.redirect(e)
}})
}else{c(RR).trigger("navigateAwayModal:deactivate");
RR.url.redirect(e)
}};
a.calcAge=function(g){var i;
if(b.isArray(g)){i=g
}else{if(b.isString(g)){i=g.split("-")
}else{return NaN
}}if(!i[0]||!i[1]||!i[2]){return NaN
}var h=moment([i[0],i[1]-1,i[2]]).startOf("day"),f=moment().startOf("day"),j=h.clone().year(f.year()),e;
if(!h.isValid()){return NaN
}if(j.isSame(f)||j.isBefore(f)){e=f.year()-h.year()
}else{e=f.year()-h.year()-1
}return e
};
a.getIEVersion=function(){if(platform.name==="IE"){return parseInt(platform.version.split(".")[0],10)
}else{return -1
}};
a.convertDateFieldToNumericArray=function(f){var g,h;
if(!b.isString(f)){return
}if(f.indexOf("/")>=0){h="/"
}else{if(f.indexOf("-")>=0){h="-"
}else{return
}}g=b.map(f.split(h),function(i){return parseInt(i,10)
});
if(g.length!==3){return
}else{var e=b.find(g,function(i){return b.isNaN(i)
});
if(b.isNaN(e)){return
}}return g
};
a.scrollInPageLinksInElement=function(e){e.on("click","a",function(j){var i=c(j.target),h=i.attr("href");
if(h!==undefined&&h.length>1&&h.charAt(0)==="#"){var f=c(h);
if(f.length){var g=c("#full-width-header").height()+60;
scrollToElement(f,undefined,-1*g);
j.preventDefault()
}}})
};
a.checkIfMarkupExists=function(g,e){var f={};
if(b.isObject(g)){f=g
}if(b.isBoolean(g)){f={length:g}
}if(b.isString(g)){f=c(g)
}if(f.length&&e){e();
return true
}else{return false
}};
a.frequencyToString=function(e){if(!b.isString(e)){return undefined
}return{A:"per year",H:"per half year",Q:"per quarter",M:"per month",W:"per week",F:"per four weeks",S:"one time only"}[e]
};
d.utils=a;
return d
}(RR||{},jQuery,_));
var RR=(function(e,h,k,l){var b=l;
var f="_charset_";
b[f]="UTF-8";
var c="/bin/session";
var i="/bin/sessionExtend";
function a(m){try{m=JSON.parse(m)
}catch(n){}return m
}function g(m){if(k.isObject(m)){m=JSON.stringify(m)
}if(typeof m==="string"||m instanceof String){m=RR.utils.replaceHTMLCharacters(m)
}return m
}var j=function(n,p){var m=h.Deferred();
var o={};
if(n){if(k.isObject(n)){k.each(n,function(r,q){n[q]=g(r)
});
h.post(c,n,function(){k.each(n,function(r,q){b[q]=r
});
m.resolve()
});
return m
}else{if(p||p===false||p===0){p=g(p);
o[n]=p;
h.ajax({type:"POST",url:c,data:o,success:function(){b[n]=p;
m.resolve()
},async:false});
return m
}else{return a(b[n])
}}}else{m.reject();
return m
}};
var d={refresh:function(){return h.post(i,{})
},exists:function(){return(b!==undefined&&b.loggedIn!==undefined)
},getType:function(){if(b!==undefined){var m=k.clone(b);
delete (m._charset_);
if(h.isEmptyObject(m)){return"none"
}else{if(!b.loggedIn){return"interim"
}else{return"loggedin"
}}}else{return"none"
}}};
e.session=k.extend(j,d);
return e
}(RR||{},jQuery,_,s));
RR.defineComponent=(function(d){function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)
}function b(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()
}function c(g){var f=this;
var h=[];
d(g).each(function(l,k){var j=new f();
j.guid=b();
j.params=d(k).data("component-params");
j.$el=d(k);
j.node=k;
j.init(j.$node,j.params);
h.push(j)
});
if(h.length===1){return h[0]
}else{return h
}}function e(g){var f=function(){this.on=function(i,j,h){if(h){d(i).on(j,d.proxy(h,this))
}else{this.$el.on(i,d.proxy(j,this))
}};
this.off=function(h,i){if(i){d(h).off(i)
}else{this.$el.off(i)
}};
this.trigger=function(h,i,j){if(j){d(h).trigger(i,j)
}else{this.$el.trigger(h,i)
}};
this.$node=function(h){if(h){return d(this.node).find(h)
}else{return d(this.node)
}}
};
g.attachTo=c;
g.prototype=new f();
g.prototype.constructor=g;
return g
}return e
}(jQuery));
var RR=(function(c,b,a){b(function(){var d;
a.each(c.plugins,function(f,g){try{f.init()
}catch(h){}});
b("[data-component]").each(function(){var f=b(this);
var e=f.data("component");
if(RR.components.hasOwnProperty(e)){if(RR.components[e].hasOwnProperty("attachTo")){RR.components[e].attachTo(f)
}}});
d=RR.currentPageId();
if(d&&RR.pages.hasOwnProperty(d)){RR.pages[d].init()
}if(c.hasOwnProperty("init")){c.init()
}});
return c
}(RR||{},jQuery,_));
RR.callTracker=function(){var a={timeout:200,excludedCallRegexes:[],trackingApiCalls:false,ajaxCallsSent:[],ajaxCallsReceived:[],extraIntervalsToWait:0,intervalsSinceFinished:0};
a.startTracking=function(b){if(!_.isNumber(b)){b=0
}if(a.trackingApiCalls){return false
}else{a.ajaxCallsSent=[];
a.ajaxCallsReceived=[];
a.extraIntervalsToWait=b;
a.intervalsSinceFinished=0;
$(document).ajaxSend(function(f,d,c){a.onApiCallStarted(c)
});
$(document).ajaxComplete(function(f,d,c){c.status=d.status;
a.onApiCallFinished(c)
});
a.trackingApiCalls=true;
$(document).ready(function(){window.setTimeout(a.pageReadyCheck,a.timeout)
});
return true
}};
a.stopTrackingApiCalls=function(){$(document).off("ajaxSend").off("ajaxComplete");
a.trackingApiCalls=false
};
a.onApiCallStarted=function(b){if(a.isUrlExcluded(b.url)){return
}a.ajaxCallsSent.push(b)
};
a.onApiCallFinished=function(b){if(a.isUrlExcluded(b.url)){return
}a.ajaxCallsReceived.push(b)
};
a.isUrlExcluded=function(b){if(a.excludedCallRegexes.length===0){a.excludedCallRegexes.push(new RegExp("/mailbox/[a-zA-Z@_.0-9]+/conversation","gi"))
}return _.some(a.excludedCallRegexes,function(c){return(b.search(c)!==-1)
})
};
a.pageReadyCheck=function(){var b=(a.ajaxCallsSent.length===a.ajaxCallsReceived.length);
if(b){if(!a.extraIntervalsToWait||(a.extraIntervalsToWait===a.intervalsSinceFinished)){$(a).trigger("callTracker:allCallsComplete",[a.allCallsSuccessful()]);
a.stopTrackingApiCalls()
}else{a.intervalsSinceFinished++;
window.setTimeout(a.pageReadyCheck,a.timeout)
}}else{a.intervalsSinceFinished=0;
window.setTimeout(a.pageReadyCheck,a.timeout)
}};
a.allCallsSuccessful=function(){return(a.ajaxCallsReceived.length>0)&&_.every(a.ajaxCallsReceived,function(b){return(b.status.toString().charAt(0)==="2")
})
};
return a
};
RR.api.Account=function(d,a){var b={};
var c={emailAddress:d,consentType:a};
b.products=function(e){var f={};
f=_.extend(e,c);
return RR.api.call("GET","/account/:emailAddress/products",[200,404],f)
};
b.productsmap=function(e){var f={};
f=_.extend(e,c);
return RR.api.call("GET","/account/:emailAddress/products/map",[200,404],f)
};
b.gettermscondition=function(){return RR.api.call("GET","/account/:emailAddress/termsAndConditions?consentType="+a,[200,404],c)
};
b.posttermscondition=function(e){var f={};
f=_.extend(e,c);
return RR.api.call("POST","/account/:emailAddress/termsAndConditions",[200,404],f)
};
return b
};
RR.api.Customer=function(c){var d={};
var a={};
var b={emailAddress:c};
d.search=function(e){var f={};
f=_.extend(e,f);
return RR.api.call("GET","/customer/search/:policyNumberOrEmail",[200,404,406],f)
};
d.legacySearch=function(e){return RR.api.call("GET","/customer/legacy/search/"+encodeURIComponent(e.upgradeNumber),[200,404],{})
};
d.legacyAuth=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/legacy/authenticate",[200,403],f)
};
d.initialiseUpgrade=function(f,e){if(f==="wps"){return RR.api.call("POST","/customer/wps/initialise",[200,403,404,406],e)
}else{return RR.api.call("POST","/customer/upgrade/initialise",[200,403,404,406],e)
}};
d.resetPasswordNotify=function(){return RR.api.call("GET","/customer/:emailAddress/security/resetPassword/notify",[200,404,403],b)
};
d.linkLegacyMemo=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/link",[200],f)
};
d.personalDetails=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/search/personalDetails",[200,404,406],f)
};
d.resetPasswordInitiate=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("GET","/customer/:accessToken/security/resetPassword/initiate",[200,404],f)
};
d.resetPasswordQuestion=function(){return RR.api.call("GET","/customer/:emailAddress/security/question",[200,404,403],b)
};
d.resetPasswordAnswer=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/:emailAddress/security/answer",[200,404,403],f)
};
d.resetMemorableWordQuestion=function(){return RR.api.call("GET","/customer/:emailAddress/security/question",[200,404],b)
};
d.resetMemorableWordAnswer=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/:emailAddress/security/answer",[200,404],f)
};
d.resetPassword=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/:emailAddress/security/resetPassword",[200,404],f)
};
d.resetMemorableWordInitiate=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("GET","/customer/:accessToken/security/resetMemorableWord/initiate",[200],f)
};
d.securityCheck=function(e){var f={};
if(e){f=_.extend(e,b);
return RR.api.call("POST","/customer/:emailAddress/securityCheck",[200,403,406],f)
}else{f=b;
return RR.api.call("GET","/customer/:emailAddress/securityCheck",[200,406],f)
}};
d.details=function(g,i,e){var f;
var h;
h={};
if(g){if(i!==undefined){RR.api.addDirtyFieldsArrayTo(g,i,e)
}else{RR.api.addDirtyFieldsArrayTo(g,a,e)
}h=g?_.extend(g,b):b;
f=RR.api.call("POST","/customer/:emailAddress/details",[200,404],h)
}else{h=b;
f=RR.api.call("GET","/customer/:emailAddress/details",[200,404],h);
f.done(function(j,k){a=k
})
}return f
};
d.securityQuestions=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/:emailAddress/security/questions",[200],f)
};
d.securityResetMemorableWordNotify=function(){return RR.api.call("GET","/customer/:emailAddress/security/resetMemorableWord/notify",[200],b)
};
d.securityResetMemorableWord=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/:emailAddress/security/resetMemorableWord",[200,404],f)
};
d.securityPassword=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/:emailAddress/security/password",[200,406],f)
};
d.logout=function(){return RR.api.call("GET","/customer/:emailAddress/logout",[200],b)
};
d.securityChangeUsernameNotify=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/:emailAddress/security/changeUsername/notify",[200],f)
};
d.securityChangeUsernameInitiate=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("GET","/customer/:accessToken/security/changeUsername/initiate",[200,404],f)
};
d.securityChangeMemorableWord=function(e){var f={};
f=_.extend(e,b);
return RR.api.call("POST","/customer/:emailAddress/security/memorableWord",[200],f)
};
return d
};
RR.api.Policy=function(a,b){var d={};
var e;
var c={policyType:a,policyNumber:b||""};
d.create=function(){var g="GET";
var f=[201,200];
if(a==="rrp"){g="POST";
f=[201]
}return RR.api.call(g,"/policy/:policyType/create",f,c)
};
d.getRegisterURL=function(){return RR.api.API_PATH+"/policy/"+c.policyType+"/"+c.policyNumber+"/register"
};
d.migrate=function(){return RR.api.call("POST","/policy/:policyType/migrate",[200,201],c)
};
d.valuation=function(){return RR.api.call("GET","/policy/legacy/:policyNumber/valuation",[200],c)
};
d.legacyProjection=function(f){var g={};
g=_.extend(f,c);
return RR.api.call("GET","/policy/legacy/:policyNumber/projection/:productReference",[200],g)
};
d.customer=function(h,f){var g;
var i;
i={};
if(h){h=_.pick(h,"policyType","policyNumber","dirtyFields","fundDetails","personalDetails","addressDetails","contactDetails","confirmedEmailAddress","bankDetails","payments","securityDetails","confirmationDetails","transferDetails","promoCode");
RR.api.addDirtyFieldsArrayTo(h,e,f);
i=h?_.extend(h,c):c;
if(i.dirtyFields.indexOf("confirmedEmailAddress")>-1){i.dirtyFields.splice(i.dirtyFields.indexOf("confirmedEmailAddress"),1)
}g=RR.api.call("POST","/policy/:policyType/:policyNumber/customer",[200,404],i)
}else{i=c;
g=RR.api.call("GET","/policy/:policyType/:policyNumber/customer",[200,404],i);
g.done(function(j){e=j
})
}return g
};
d.legacyCustomer=function(f){var g={};
g=_.extend(f,c);
return RR.api.call("POST","/policy/:policyType/:policyNumber/customer",[200],g)
};
d.purchase=function(f){var g={};
g=_.extend(f,c);
return RR.api.call("POST","/policy/:policyType/:policyNumber/purchase",[200,500],g)
};
d.notify=function(f){var g={};
g=_.extend(f,c);
return RR.api.call("GET","/policy/:policyType/:policyNumber/notify/:notificationType",[200,404],g)
};
d.resendVerificationCode=function(f){var g={};
g=_.extend(f,c);
return RR.api.call("POST","/policy/:policyType/:policyNumber/resendVerificationCode",[200,406],c)
};
d.resendUpgradeVerificationCode=function(){return RR.api.call("POST","/policy/upgrade/:policyNumber/resendVerificationCode",[200,406],c)
};
d.changeUsername=function(f){var g={};
g=_.extend(f,c);
return RR.api.call("POST","/policy/:policyType/:policyNumber/changeUsername",[200,406],g)
};
d.projection=function(f){var g={};
g=_.extend(f,c);
delete g.policyNumber;
return RR.api.call("POST","/policy/:policyType/projection",[200],g)
};
d.illustration=function(f){var g={};
g=_.extend(f,c);
delete g.policyNumber;
return RR.api.call("POST","/policy/:policyType/illustration",[200],g)
};
d.comparison=function(f){var g={};
g=_.extend(f,c);
return RR.api.call("GET","/policy/legacy/:currentPolicyNumber/comparison",[200],g)
};
return d
};
RR.api.Risk=function(){var b={};
var a={};
b.getScore=function(c){var d={};
d=_.extend(c,a);
return RR.api.call("POST","/risk/:policyType/score",[200,406,500],d)
};
return b
};
RR.api.Address=function(a,d){var f={};
var c={postcode:a?a.trim():undefined,houseNameOrNumber:d?d.trim():undefined};
f.lookup=function(){if(!c.houseNameOrNumber){return b()
}else{return e()
}};
f.setPostcode=function(g){c.postcode=g?g.trim():undefined
};
f.setHouseNameOrNumber=function(g){c.houseNameOrNumber=g?g.trim():undefined
};
function b(){return RR.api.call("GET","/address/:postcode",[200,404,500],c)
}function e(){return RR.api.call("GET","/address/:postcode/:houseNameOrNumber",[200,404,500],c)
}return f
};
RR.api.BankDetails=function(){var a={};
a.validate=function(b){return RR.api.call("POST","/bankdetails/validate",[200,406],{bankDetails:b})
};
return a
};
RR.api.Product=function(b){var a={},c={};
if(b!==""){c={productId:b}
}a.getTransactions=function(d){d=_.extend({},c,d);
return RR.api.call("GET","/product/:productId/transactions",[200],d)
};
a.getFundDetails=function(d){d=_.extend({},c,d);
return RR.api.call("GET","/fund/:productId",[200],d)
};
a.getProduct=function(d){d=_.extend({},c,d);
return RR.api.call("GET","/product/:productId",[200],d)
};
a.getDownloadTransactionsCSVPath=function(e){var d="/product/:productId/transactions/download";
e=_.extend({},c,e);
_.each(e,function(g,f){if(!_.isObject(g)){if(d.match(":"+f)){e=_.omit(e,f);
d=d.replace(":"+f,g)
}}});
if(!_.isEmpty(e)){d+="?"+$.param(e,true)
}d=RR.api.API_PATH+d;
return d
};
a.getDocuments=function(d){d=_.extend({},c,d);
return RR.api.call("GET","/product/:productId/documents",[200],d)
};
a.updateDocument=function(d){d=_.extend({},c,d);
return RR.api.call("POST","/product/:productId/documents/:documentId/properties",[200,404,500],d)
};
a.getPerformance=function(d){d=_.extend({},c,d);
return RR.api.call("GET","/product/:productId/performance",[200],d)
};
a.getBreakdown=function(d){d=_.extend({},c,d);
return RR.api.call("GET","/product/:productId/breakdown",[200,404],d)
};
a.getBeneficiaries=function(d){d=_.extend({},d,c);
return RR.api.call("GET","/product/:productId/beneficiaries",[200],d)
};
a.datatable={};
a.transactionSummary=function(h){var i,n,o=[],l=$.Deferred(),j=["productId","contributions"];
if(!RR.utils.isAuthor()){$(".savings-summary-panel, .js-regularContribution, .js-employeeContribution, .js-employerContribution, .js-salarySacrifice, .js-latestContribution").hide()
}var k=$(".js-regularContribution");
var m=$(".js-employeeContribution");
var f=$(".js-employerContribution");
var g=$(".js-salarySacrifice");
var e=$(".js-latestContribution");
h=_.pick(h,j);
i=this.getTransactions(h);
n=this.getProduct(h);
i.done(function(p,q){var d=q.transactions;
_.each(d,function(y){var r,u=y.description,v='<span aria-hidden="true" class="ico green" aria-valuetext="Up by">&#xf714;</span>{{amount}}',x='<span aria-hidden="true" class="ico red" aria-valuetext="Down by">&#xf715;</span>{{amount}}',t,z;
y.date[1]-=1;
r=window.moment(y.date).format("DD-MMM-YYYY");
function w(A){return(A<0)?x:v
}if(y.displayInSummary){z=RR.utils.formatStringAsCurrency(y.amount,"&pound;");
t=_.template(w(y.amount),{amount:z});
o.push([r,u,t,y.category])
}});
return l.resolve(o)
});
n.done(function(d,r){var u=0,q=0,v=0,p=0,t=0;
if(!RR.utils.isAuthor()){$(".savings-summary-panel, .js-reularContribution, .js-employeeContribution, .js-employerContribution, .js-salarySacrifice, .js-latestContribution").hide()
}if(r.regularPayment){k.show();
p=r.regularPayment.amount;
k.find(".big-txt").html("&pound;"+r.regularPayment.amount);
k.find(".date").text(RR.utils.convertCharToPaymentPeriod(r.regularPayment.frequency))
}else{if(r.latestPayment){if(!_.isNull(r.latestPayment.employerContribution)||!_.isNull(r.latestPayment.employeeContribution)||!_.isNull(r.latestPayment.salarySacrificeContribution)){if(!_.isNull(r.latestPayment.employeeContribution)){u=r.latestPayment.employeeContribution;
m.show();
m.find(".big-txt").html("&pound;"+u);
m.find(".date").text("on "+RR.utils.arrayToDateFormatted(r.latestPayment.date))
}if(!_.isNull(r.latestPayment.employerContribution)){q=r.latestPayment.employerContribution;
f.show();
f.find(".big-txt").html("&pound;"+q);
f.find(".date").text("on "+RR.utils.arrayToDateFormatted(r.latestPayment.date))
}if(!_.isNull(r.latestPayment.salarySacrificeContribution)){v=r.latestPayment.salarySacrificeContribution;
g.show();
g.find(".big-txt").html("&pound;"+v);
g.find(".date").text("on "+RR.utils.arrayToDateFormatted(r.latestPayment.date))
}}else{e.show();
t=r.latestPayment.amount;
e.find(".big-txt").html("&pound;"+r.latestPayment.amount);
e.find(".date").text("on "+RR.utils.arrayToDateFormatted(r.latestPayment.date))
}}else{}}if(u>0||q>0||v>0){e.hide();
k.hide()
}if(u>0&&q>0&&v>0){k.remove()
}if(u>0||q>0||v>0||t>0||p>0){$(".savings-summary-panel").show()
}a.switchFund(r)
});
i.fail(function(){RR.utils.debugMessage("failed to get an API call response [transactions]");
return l.reject()
});
return l.promise()
};
a.fundTransactions=function(j){var h,g,e=[],i=$.Deferred();
var f=["productId","contributions"];
j=_.pick(j,f);
h=this.getTransactions(j);
g=this.getProduct(j);
h.done(function(k,l){var d=l.transactions;
_.each(d,function(o){var n=o.description,m;
o.date[1]-=1;
m=window.moment(o.date).format("DD-MMM-YYYY");
if(o.displayInDetail){_.each(o.portfolioSplit,function(r){var t='<span aria-hidden="true" class="ico green" aria-valuetext="Up by">&#xf714;</span>{{amount}}',v='<span aria-hidden="true" class="ico red" aria-valuetext="Down by">&#xf715;</span>{{amount}}',q,w,p=r.units||"";
if(p&&typeof p==="number"){p=p.toFixed(2)
}function u(x){return(x<0)?v:t
}w=RR.utils.formatStringAsCurrency(r.amount,"&pound;");
q=_.template(u(r.amount),{amount:w});
e.push([m,n,r.name,p,q])
})
}});
g.done(function(m,n){$("#loadingSpinner").hide();
if(m===200){a.switchFund(n)
}});
return i.resolve(e)
});
h.fail(function(){RR.utils.debugMessage("failed to get an API call response [transactions]");
return i.reject()
});
return i.promise()
};
a.switchFund=function(e){if(e.source!=="WORKPLACE"){if((e.fund.type==="OTHER")&&(e.type==="PENSION")){RR.session("rrFundSelected","N");
var d=(RR.route("CHANGE_FUND_NON_RR")+"?productId="+e.id);
$("#pensionLink3").attr("href",d);
$(".js-fmodal-switch-fund").attr("href",d)
}else{if(e.type==="ISA"){$(".js-fmodal-switch-fund").attr("href",RR.route("CHANGE_FUND_ISA")+"?productId="+e.id)
}else{RR.session("rrFundSelected","Y");
var f=(RR.route("CHANGE_FUND_PENSION")+"?productId="+e.id);
$("#pensionLink3").attr("href",f);
$(".js-fmodal-switch-fund").attr("href",f)
}}RR.session("fundDetails",{fundName:e.fund.displayName,riskLevel:e.fund.riskRating,fundId:e.fund.investmentId})
}else{$(".js-fmodal-switch-fund").attr("href",RR.route("SUPPORT"))
}};
a.fundActivityBreakdown=function(i){var f,e=[],h=$.Deferred(),g=["category","search","selectedFilterOption","singleDate","start","target","isa","locked","memoasset","pension","title","total","type","value","source","effectiveDate","item"];
RR.utils.removeObjectProperties(i,g);
f=this.getBreakdown(i);
f.done(function(d,l){if(l.funds){var k=l.funds,j=RR.utils.formatAmount(l.total,"B");
e.push(["","","Total",j]);
_.each(k,function(r){var p='<a href="#" class="{{modal}}" role="button" data-investmentId="{{fundid}}" data-target="#{{modal}}" data-toggle="modal" title="{{name}}"><span>{{name}}</span> <span class="screenreader-visible">(Opens in a new layer)</span> <span aria-hidden="true" class="ico">&#xf721;</span></a>',m=RR.utils.formatStringAsCurrency(r.units,""),q=RR.utils.formatAmount(r.unitPrice,"B",true),n=RR.utils.formatAmount(r.amount,"B",true);
function o(t){if(t!=="Cash"&&t!=="Pending trades"){return("fund-help")
}else{return $.trim(t).toLowerCase().replace(/\ /g,"-")
}}p=_.template(p,{name:r.name,modal:o(r.name),fundid:r.id});
e.push([p,m,q,n])
})
}return h.resolve(e)
});
f.fail(function(){RR.utils.debugMessage("failed to get an API call response [breakdown]");
return h.reject()
});
return h.promise()
};
a.fundTransfer=function(d){d=_.extend(c,d);
return RR.api.call("POST","/product/:productId/fund/transfer",[200],d)
};
a.get=function(d){var e=_.extend({},c,d);
return RR.api.call("GET","/product/:productId",[200,404],e)
};
a.getMemoAsset=function(d){var e={};
e=_.extend(d,c);
return RR.api.call("GET","/product/:emailAddress/memoAsset",[200,404],e)
};
a.postMemoAsset=function(d){var e={};
e=_.extend(d,c);
return RR.api.call("POST","/product/:emailAddress/memoAsset",[200,201,404,406],e)
};
a.deleteMemoAsset=function(d){var e={};
e=_.extend(d,c);
return RR.api.call("DELETE","/product/:emailAddress/memoAsset/:memoAssetId",[200,404,406],e)
};
a.transferOut=function(d){var e=_.extend({},c,d);
e=_.pick(e,["productId","operation","id","percentage","amount","frequency","startMonth"]);
return RR.api.call("POST","/product/:productId/:operation/transfer/out",[200,409],e)
};
a.transferIn=function(d){var e=_.extend({},c,d);
e=_.pick(e,["productId","operation","id","amount","bankDetails","boostPensionInlineWithRPI","ukResident","sourceOfWealth","termsAndConditionsAccepted"]);
if(_.isNumber(e.bankDetails.bankAccountId)){e.bankDetails=_.pick(e.bankDetails,["bankAccountId","additionalSignatureRequest"])
}return RR.api.call("POST","/product/:productId/:operation/transfer/in",[200,409],e)
};
a.isaAllowance=function(d){var e=_.extend({},d,c);
return RR.api.call("GET","/product/:productId/isaAllowance",[200],e)
};
a.consolidate=function(d){var e=_.extend({},d,c);
return RR.api.call("POST","/product/:productId/consolidate",[200],e)
};
a.consolidateNotify=function(d){var e=_.extend({},d,c);
return RR.api.call("GET","/product/:productId/consolidate/notify/:consolidationId",[200,404,406,500],e)
};
return a
};
RR.api.Mailbox=function(d,e){var c={};
var a=e;
var b={emailAddress:d};
c.getConversations=function(f){var g=_.extend(f,b);
return RR.api.call("GET","/mailbox/:emailAddress/conversation",[200,404],g,null,a)
};
c.getConversation=function(f){var g=_.extend(b,{conversationId:f});
return RR.api.call("GET","/mailbox/:emailAddress/conversation/:conversationId",[200,404],g)
};
c.newMessage=function(f){var g=_.extend(f,b);
return RR.api.call("POST","/mailbox/:emailAddress/conversation/:conversationId/message",[200,404],g)
};
c.updateMessage=function(f){var g=_.extend(f,b);
return RR.api.call("POST","/mailbox/:emailAddress/conversation/:conversationId/message/:messageId",[200,404],g)
};
return c
};
RR.api.SCORE_CONSTANTS={LOGIN:"LOGIN",UPDATE_MEMO_ASSET:"UPDATE_MEMO_ASSET",UPDATE_PROFILE:"UPDATE_PROFILE"};
RR.api.Score=function(a){var c={};
var b={policyType:a||((RR.utils.isUserLoggedIn())?"rr":"interim")};
c.postGoalsDetails=function(d){var e={};
e=_.extend(d,b);
return RR.api.call("POST","/retirement/score/:policyType/details",[200,500,404,406],e)
};
c.calculateScore=function(d){var e={};
e=_.extend(d,b);
return RR.api.call("POST","/retirement/score/:policyType/calculate",[200,406],e)
};
c.retrieveScore=function(){return RR.api.call("GET","/retirement/score/:policyType/retrieve",[200,204],b)
};
c.getPopulateDetails=function(){return RR.api.call("GET","/retirement/score/:policyType/populateDetails",[200],b)
};
c.triggerUpdate=function(d){return RR.api.call("POST","/retirement/score/:policyType/trigger?triggerType="+d,[200],b)
};
return c
};
RR.api.Lifestyle=function(){var a={};
var b={};
b.customerType=(RR.utils.isUserLoggedIn())?"rr":"interim";
a.calculate=function(c){var d={};
d=_.extend(c,b);
return RR.api.call("POST","/lifestyle/:customerType/calculate",[200],d)
};
a.saveLifestyle=function(c){var d={};
d=_.extend(c,b);
return RR.api.call("POST","/lifestyle/:customerType",[200],d)
};
a.getLifestyle=function(){return RR.api.call("GET","/lifestyle/:customerType",[200,204],b)
};
return a
};
RR.api.Coach=function(c){var a={};
var b={emailAddress:c};
a.nextBestAction=function(d){var e={};
e=_.extend(d,b);
return RR.api.call("POST","/coach/:emailAddress/action",[200,204,404,406,500],e)
};
a.performAction=function(d){var e={};
e=_.extend(d,b);
return RR.api.call("POST","/coach/:emailAddress/action/:activityType/:actionId",[200,204,404,406,500],e)
};
a.getNotifications=function(d){var e={};
e=_.extend(d,b);
return RR.api.call("GET","/coach/:emailAddress/action/:activityType",[200,204,404,406,500],e)
};
if(RR.utils.isRegisteredProspect()){a.nextBestAction=a.performAction=a.getNotifications=function(){var d=new $.Deferred();
d.reject();
return d
}
}return a
};
RR.api.Goals=function(a){var c={};
var b={policyType:a||((RR.utils.isUserLoggedIn())?"rr":"interim")};
c.makeProjection=function(d){var e={};
e=_.extend(d,b);
var f=_.pick(e,"personalDetails","targetAnnualIncome","guaranteedAnnualIncome","taxFreeLumpSum","tfcPercentage","pension","memoPension","isa","memoIsa");
f.personalDetails=_.pick(e.personalDetails,"dateOfBirth","gender","retirementAge","retirementYear","numberOfPayDays");
_.each(["pension","memoPension","isa","memoIsa"],function(g){f[g]=_.pick(e[g],"impl","value","regularPayment","employerMonthlyContribution","oneOffPayment","selectedFund");
_.each(["regularPayment","employerMonthlyContribution"],function(h){if(f[g][h]){f[g][h]=_.pick(e[g][h],"amount","boostPensionInlineWithRPI")
}})
});
return RR.api.call("POST","/retirement/goalPlanner/project",[200,403,406],f)
};
c.getPopulateDetails=function(){return RR.api.call("GET","/retirement/goal/:policyType/populateDetails",[200,403],b)
};
c.postTaskList=function(d){var e={};
e=_.extend(d,b);
return RR.api.call("POST","/retirement/goal/:policyType/taskList",[200],e)
};
c.getTaskList=function(){return RR.api.call("GET","/retirement/goal/:policyType/taskList",[200,403],b)
};
c.deleteTaskList=function(){return RR.api.call("DELETE","/retirement/goal/:policyType/taskList",[200],b)
};
return c
};
RR.api.Interim=function(){var a={};
a.logout=function(){return RR.api.call("GET","/customer/interim/logout",[200])
};
return a
};
RR.api.Promo=function(c){var a={};
var b={code:c};
a.validateCode=function(){return RR.api.call("GET","/promo/purchase/:code/",[200,404,406],b)
};
a.validateCampaignCode=function(){return RR.api.call("GET","/promo/campaign/:code/",[200,404,406],b)
};
return a
};
RR.api.Fund=function(b){var a={},c={};
if(b!==""){c={fundId:b}
}a.getFundDetails=function(d){d=_.extend({},c,d);
return RR.api.call("GET","/fund/:fundId",[200],d)
};
a.getRRFundDetails=function(d){d=_.extend({},c,d);
return RR.api.call("GET","/fund/PENSION/type/RR",[200],d)
};
return a
};
RR.Component=function(){this.attachTo=function(e){var b=this;
var d=$(e);
var a=$.extend(true,function(){},b);
var c=function(f){if(!f){return d
}else{return d.find(f)
}};
return a.init(c,c().data("component-params"))
};
this.init=$.noop;
this.on=$(RR).on;
this.off=$(RR).off;
this.trigger=$(RR).trigger
};
RR.components.navigation=RR.defineComponent(function(){var f=$("#openBtn"),b=$("#closeBtn"),j=$("#overlay"),i=$("#navSelect"),d=$(".static"),a=$("#menu-scroll-links"),k=$(".element"),h=$("#navigation"),m=$("#sideNotificationMessages"),g=[f,b,j],e=false,c=300000,l=this;
this.removeOverlay=function(){j.removeAttr("style")
};
this.onGoalsLinkClicked=function(o){o.preventDefault();
if(RR.session.exists()){var n=l.scoreApi.retrieveScore();
n.done(function(p,r,q){if(p===200){RR.url.redirect("GOALS_DASHBOARD")
}else{RR.url.redirect("GOALS_LANDING")
}})
}else{RR.url.redirect("GOALS_LANDING")
}};
this.menuOpen=function(){var o=$(document).height(),t=$(window).height(),q=navigator.userAgent.toLowerCase(),n=q.indexOf("iPhone"),r=q.indexOf("android 3.1")>-1,p;
if(RR.utils.getIEVersion()===8&&$("html").get(0).scrollHeight>$("html").height()){}else{$("html").css("overflow","hidden")
}j.show().css("height",o);
k.removeClass("hideMenu").addClass("showMenu");
if($(window).width()<=1024){k.height(t)
}else{k.height("")
}h.appendTo($("#menu-scroll-links"));
a.scrollTop(0);
k.addClass("menu-open");
p=k.height()-$("#fixed-header-tools").height()-$(".static").height();
if(n){a.height(p+60)
}else{a.height(p)
}if(r){$("html").css("overflow","visible")
}a.focus()
};
this.menuClose=function(){$("html").css("overflow","visible");
k.removeClass("menu-open");
h.delay(500).queue(function(){h.appendTo($(".menuContent"));
k.removeClass("showMenu").addClass("hideMenu");
h.dequeue()
});
j.removeAttr("style")
};
this.menuChange=function(){e=!e;
if(e){l.menuOpen()
}else{l.menuClose()
}};
this.windowResize=function(){var n=$(window).height();
if($(window).width()<=1024){k.height(n)
}else{k.height("")
}j.removeAttr("style");
k.removeClass("menu-open showMenu").addClass("hideMenu");
j.hide()
};
this.initEvents=function(){var n=this;
h.find("ul li").last().find("a").blur(function(){n.menuClose()
});
_.each(g,function(p){p.on("click",function(q){q.preventDefault();
n.menuChange()
})
});
i.on("click",function(p){p.preventDefault();
n.menuChange();
d.focus()
});
$("#signOutBtn").on("click",function(p){p.preventDefault();
$(RR).trigger("uiLogoutAction");
return false
});
j.on("click",function(p){p.preventDefault();
$(this).hide();
n.menuClose()
});
var o=k.hammer();
o.on("swiperight",function(){n.menuChange()
});
$(RR).on("uiCloseFlyoutMenu",n.menuClose);
$(RR).on("uiLogoutAction",n.removeNumberOfNotifications);
if(RR.utils.isUserLoggedIn()){$(RR).on("uiMailboxConversationRead",n.decrementNumberOfNotifications)
}$(window).on("debouncedresize",n.windowResize);
$("#conSelect").click(function(){$("#content").attr("tabindex",-1);
setTimeout(function(){$(window).scrollTop(0)
},0)
})
};
this.computeUserName=function(){var o=RR.session("forename")+" "+RR.session("surname"),n;
return(o.length>11)?RR.session("forename"):o
};
this.displayNumberOfNotifications=function(o){var n=this,p;
n.removeNumberOfNotifications();
if(o>0){p=(o<1000)?o:"...";
n.$el.find("#nav .support a .ico").prepend('<span aria-hidden="true" class="notification" id="supportHeaderNumUnreadMessages">'+o+'</span><span aria-hidden="true" class="screenreader-visible"> unread notifications</span>');
n.$el.find("#navigation .support ul li:eq(0) a").append('<span class="notification">'+o+'</span><span aria-hidden="true" class="screenreader-visible"> unread notifications</span>');
m.html(o)
}else{m.html(0)
}};
this.removeNumberOfNotifications=function(n){l.$el.find("#nav .support a span:not(.ico)").remove();
l.$el.find("#navigation .support ul li:eq(0) a span").remove()
};
this.decrementNumberOfNotifications=function(o){var n=RR.session("numNotifications");
if(RR.utils.isUserLoggedIn()&&n){l.setNumberOfNotifications(--n)
}};
this.refreshNumberOfNotifications=function(){var n=RR.session("email");
if(!RR.utils.isUserLoggedIn()||!n){return
}var o=new RR.api.Mailbox(n,true),p=o.getConversations({});
p.done(function(q,r){if(q===404){r.totalUnread=0;
r.totalConversations=0
}l.setNumberOfNotifications(r.totalUnread)
})
};
this.setNumberOfNotifications=function(n){l.displayNumberOfNotifications(n);
RR.session("numNotifications",n);
RR.session("notificationsLastUpdated",new Date())
};
this.initialiseNumberOfNotifications=function(){var o=this,r=RR.session("notificationsLastUpdated"),n=true,q;
if(r){q=new Date().getTime()-new Date(r).getTime();
if(q<c){n=false
}}if(n){o.refreshNumberOfNotifications()
}else{var p=RR.session("numNotifications")||0;
o.displayNumberOfNotifications(p)
}};
this.initMenu=function(){var o=this,n;
if(RR.utils.isUserLoggedIn()){n=this.computeUserName();
$("#flyoutUsername").html(n);
$("#topLink").attr("href",RR.route("BASIC_PROFILE"));
this.$el.find(".goals ul li").remove();
k.find("#lastVisit").append(moment(RR.session("lastLogin")).format("HH:mm, D MMMM YYYY"))
}else{$("#topLink").attr("href",RR.route("SIGN_IN"))
}setTimeout(function(){window.scrollTo(0,1)
},0);
this.$el.find("li.goals > a").on("click",this.onGoalsLinkClicked)
};
this.menuWalker=function(){var n=window.location.pathname;
$("#nav ul li").each(function(){var p=$(this),o=p.find("a").attr("href");
if(o===n){p.addClass("active")
}});
$.each(RR.navigation,function(p,o){if(RR.setActiveNavigation(o)){$(".module-nav li."+p.toLowerCase()).addClass("active");
return false
}})
};
this.isNavigationHidden=function(){var o=RR.currentPageId(),n=false;
if(o&&o.startsWith("ORPHAN_")){n=true
}return n
};
this.hideNavigation=function(){$("#nav, .dropdown").css("visibility","hidden").addClass("hiddenNavigation")
};
this.init=function(){this.menuWalker();
this.scoreApi=new RR.api.Score();
this.email=RR.session("email");
if(this.isNavigationHidden()){this.hideNavigation()
}if(RR.utils.isUserLoggedIn()){this.initialiseNumberOfNotifications()
}else{this.removeNumberOfNotifications()
}this.initMenu();
this.initEvents();
this.windowResize()
}
});
RR.components.accordionForm=(function(e){var a={};
var f="N";
var g="";
var d="input[name='";
var b="']";
var c="";
a.init=function(q,o){var m=q.find(".accordion-body");
var i=q.find("a.accordion-toggle");
var n=i.find("span.ico");
var h=i.find("span[aria-hidden]");
var k=m.find("button").last();
var j=q.prevAll(".accordion-group").length?true:false;
var p=q.find(".accordion-heading");
if(window.location.hash){if("#"+p.attr("id")===window.location.hash){j=false
}else{j=true
}}m.collapse({toggle:j});
if(!j){m.css("overflow","visible")
}var l=function(t){t.preventDefault();
if(j){m.collapse("show");
j=false;
try{e(RR).trigger("analyticsevent",{event:("Accordion-"+e(this)[0].hash)})
}catch(r){}}};
i.click(l);
m.find(".control-group:first input,.control-group:first select").focus(l);
k.click(function(u){u.preventDefault();
var w=0;
var t="";
f="N";
g="";
c="";
q.find(".parsley-validated").each(function(){if(e(this).parsley("validate")===false){w++;
if(f==="N"){g=e(this).attr("name");
f="Y"
}}});
if(!q.find(".sort-code").find("input").first().is(":disabled")){q.find(".sort-code").children().focusout()
}c=d+g+b;
if(q.find(".control-group.error").length){w++;
if(g==="personalDetails.title"||g==="personalDetails.forename"||g==="personalDetails.surname"||g==="contactDetails.mobilePhoneNumber"){scrollToElement((m))
}else{scrollToElement((c))
}}if(_.isFunction(o)){if(o(w===0,m)===false){return false
}}if(!j&&!w){var v=q.nextAll(".accordion-group");
if(v.length){v.first().find(".accordion-body").collapse("show");
var r=q.offset().top-e("#full-width-header").height()-parseInt(q.css("marginBottom"),10);
window.scrollTo(0,r)
}m.collapse("hide");
j=true
}});
m.on("show",function(){n.hide();
h.prop("aria-hidden",true);
j=false
});
m.on("shown",function(){m.css("overflow","visible")
});
m.on("hide",function(){m.css("overflow","hidden")
});
m.on("hide",function(){n.show();
h.prop("aria-hidden",false);
j=true
});
if(!j){n.hide();
h.prop("aria-hidden",true)
}};
return a
}(jQuery));
RR.components.alert=RR.defineComponent(function(){this.init=function(){this.params=this.params?this.params:{};
if(this.params.parentName&&this.params.parentValue&&!RR.utils.isAuthor()){this.$closestForm=this.$el.closest("form");
this.$parent=this.$closestForm.find("[name='"+this.params.parentName+"']");
if(this.$parent.length){this.on(this.$parent,"change focusout",this.reveal);
this.on(this.$closestForm,"uiCancelAction",this.reveal);
this.reveal()
}}};
this.reveal=function(){var b=this.$parent.val().toLowerCase().trim();
var a=this.params.parentValue.toLowerCase().trim();
if(this.$parent.first().attr("type")==="radio"){b=this.$parent.filter(":checked").val()
}if(b&&b===a){this.$el.show();
this.hidden=false
}else{if(!this.hidden){this.$el.hide();
this.hidden=true
}}}
});
RR.components.saveCancel=RR.defineComponent(function(){this.init=function(){this.$saveButton=this.$el.find("button[data-id=submit]");
this.$cancelButton=this.$el.find("button[data-id=cancel]");
this.$closestForm=this.$el.closest("form");
this.on(this.$saveButton,"click",this.clickSaveButton);
this.on(this.$cancelButton,"click",this.clickCancelButton);
this.params=this.params?this.params:{}
};
this.clickSaveButton=function(){this.$el.trigger("uiSaveAction");
if(!this.params.preventDefault){$(RR).trigger("headway:showSpinner");
this.$closestForm.submit()
}};
this.clickCancelButton=function(){this.$el.trigger("uiCancelAction")
}
});
RR.components.form2object=(function(c,a){var d=function(h){var g=/\.?([^.\[\]]+)|\[(\d+)\]/g;
var f={};
var j;
var k;
var e;
if(Object(h)!==h||a.isArray(h)){return h
}for(var i in h){j=f;
k="";
while((e=g.exec(i))!==null){j=j[k]||(j[k]=(e[2]?[]:{}));
k=e[2]||e[1]
}j[k]=h[i]
}return f[""]
};
var b=function(e,k,i,j){var g;
var f;
var h;
g={};
f=c(e);
h=f.find("[name]");
h.each(function(){var o=c(this);
var l=o.prop("tagName");
var m;
var n;
switch(l){case"INPUT":m=o.attr("type");
switch(m){case"checkbox":if(o.is(":checked")){n=o.val()
}break;
case"radio":if(o.is(":checked")){n=o.val()
}break;
default:n=o.val();
break
}break;
case"SELECT":n=o.find("option:selected").val();
break;
case"TEXTAREA":n=o.text();
break
}if(n||j){g[o.attr("name")]=n
}});
g=d(g);
if(i&&a.isFunction(i)){i(g)
}if(k){g=a.omit(g,k)
}return g
};
return b
}(jQuery,_));
RR.components.object2form=(function(b,a){var d=function(g){var e={};
function f(n,o){if(Object(n)!==n){e[o]=n
}else{if(a.isArray(n)){for(var j=0,h=n.length;
j<h;
j++){f(n[j],o+"["+j+"]")
}if(h===0){e[o]=[]
}}else{var m=true;
for(var k in n){if(n.hasOwnProperty(k)){m=false;
f(n[k],o?o+"."+k:k)
}}if(m){e[o]={}
}}}}f(g,"");
return e
};
var c=function(e,h){var g=b(e);
var f=d(h);
a.each(f,function(p,q){var n;
var i;
var o=g.find("[name='"+q+"']").eq(0);
if(o.length){n=o.attr("type");
if(n==="checkbox"){g.find("[name='"+q+"']").prop("checked",false);
g.find("[name='"+q+"'][value='"+p+"']").click()
}else{if(o.prop("tagName")==="SELECT"&&o.data("isRangeDropdown")&&a.isNumber(p)){var m=o.children("option"),j,l,r,k;
m.each(function(t){l=b(this).val();
l=(l.length>0)?parseInt(l,10):null;
if(a.isNumber(l)){j=Math.abs(l-p);
if(!a.isNumber(k)||j<k){r=l;
k=j
}}});
if(a.isNumber(r)){o.val(r)
}}else{o.val(p)
}}if(o.prop("tagName")==="SELECT"&&!o.val()){if(p&&o.attr("data-child")){o.val(o.find("option").last().val());
g.find("[name='"+o.attr("data-child")+"']").val(p);
o.trigger("change")
}else{o.val(o.find("option").first().val())
}}}})
};
return c
}(jQuery,_));
RR.components.feedback=(function(b){var a={};
a.getPageUrl=function(){var c=window.location.pathname;
function d(e){return e.substr(0,e.lastIndexOf("."))||e
}return d(c)
};
a.initPageRating=function(){var f=b(".feedbackComponent"),d=b("#starRating"),c=0,e=a.getPageUrl();
d.rateit({min:0,max:5,step:1,backingfld:"#starRatingValue"});
d.on("rated",function(g,h){c=h;
f.find("textarea").parsley("removeConstraint","required")
});
f.on("submit",function(i){var j=f.find("textarea").val(),h={rating:RR.utils.replaceHTMLCharacters(c),comment:RR.utils.replaceHTMLCharacters(j),pageURI:encodeURI(e)},g;
i.preventDefault();
if(f.parsley("isValid")===true){g=b.ajax({type:"POST",url:"/bin/pagefeedback",data:h})
}g.done(function(){b(".feedback-entry").hide();
b(".feedback-thankyou").show()
});
return false
})
};
a.init=function(){a.initPageRating()
};
return a
}(jQuery));
RR.components.marketingPreferencesList=RR.defineComponent(function(){this.populate=function(b,a){this.$el.find("[data-object]").each(function(){var c=$(this);
var d=c.data("object");
if(a.hasOwnProperty(d)){a[d]=a[d]?a[d]:{email:false,phone:false,sms:false,post:false};
c.find("[data-id]").each(function(){var e=$(this);
if(a[d][e.data("id")]){e.removeClass("not-used")
}else{e.addClass("not-used")
}})
}else{c.hide()
}})
};
this.hide=function(){if(!this.$node("button").data("href")){this.$node().siblings("form").show();
this.$node().hide()
}};
this.show=function(){this.$node().siblings("form").hide();
this.$node().show()
};
this.showAndRefresh=function(b,a){if(a){this.populate(b,a);
this.show()
}};
this.init=function(){var a="CustomerDetails";
this.rendered=false;
this.$node("button").on("click",$.proxy(this.hide,this));
this.$node().siblings("form").on("uiFormSubmitted",$.proxy(this.showAndRefresh,this));
this.$node().siblings("form").on("uiCancelAction",$.proxy(this.show,this));
this.on(RR,"data"+a,this.populate);
$(RR).trigger("uiNeeds"+a);
this.show()
}
});
RR.components.marketingPreferencesForm=RR.defineComponent(function(){this.channels=["email","post","sms","phone"];
var b=false;
var a=false;
var d=false;
var c=false;
this.init=function(){var e=this;
this.fieldNames=[];
this.$el.find("[data-id=marketingPreferencesField]").each(function(){var f=$(this).data("name");
e.fieldNames.push(f);
e.on(e.channelElement(f,"email").closest("label").first(),"click",function(){e.toggleCheckBoxes(f)
})
});
$(RR).on("dataCustomerDetails",$.proxy(function(g,f){this.data=f;
this.populate(f)
},this));
this.$el.parsley("addListener",{onFormSubmit:$.proxy(this.submit,this)});
$("#marketing-preferences-list-amend-button").click(function(){b=$("#-email").is(":checked");
a=$("#-post").is(":checked");
d=$("#-sms").is(":checked");
c=$("#-phone").is(":checked")
});
this.on("uiCancelAction",this.reset)
};
this.reset=function(){this.populate(this.data)
};
this.populate=function(e){RR.components.object2form(this.$el,e);
_.each(this.fieldNames,function(f){this.toggleCheckBoxes(f)
},this)
};
this.toggleCheckBoxes=function(f){var e=_.without(this.channels,"email");
_.each(this.fieldNames,function(g){if(this.channelElement(g,"email").prop("checked")){_.each(e,function(h){this.channelElement(g,h).prop("disabled",false).parent().removeClass("disabled")
},this)
}else{_.each(e,function(h){this.channelElement(g,h).prop("disabled",false).prop("checked",false).prop("disabled",true).parent().addClass("disabled")
},this)
}},this)
};
this.extractFormData=function(){var e=RR.components.form2object(this.$el);
e=e?e:{};
_.each(this.fieldNames,function(g){var f=e[g]?e[g]:{};
_.each(this.channels,function(h){if(f.hasOwnProperty(h)){f[h]=true
}else{f[h]=false
}},this);
e[g]=f
},this);
return e
};
this.channelElement=function(f,e){return this.$el.find("[name='"+f+"."+e+"']")
};
this.submit=function(k,j){var f=this;
var h=RR.session("email");
var i=new RR.api.Customer(h);
var g=this.extractFormData();
if($("#-email").is(":checked")!==b||$("#-post").is(":checked")!==a||$("#-sms").is(":checked")!==d||$("#-phone").is(":checked")!==c){if(h){i.details(g).done(function(e){if(e===200){f.$el.trigger("uiFormSubmitted",g);
f.data=g;
f.reset()
}})
}}return false
}
});
RR.components.datatable=RR.defineComponent(function(){var a=this;
this.filterParams={};
this.filterApplied=false;
this.defaultCategories=["CHARGE","WITHDRAW","PAYMENT"];
this.gotProductData=false;
this.productSelectionArgs=null;
this.setDisplayLength=function(c){var b=this.tableSettings.fnRecordsTotal();
c=c||this.params.numRowsPerPage;
c=parseInt(c,10);
if(c>b){c=b;
this.paginationEnabled(false)
}this.tableSettings._iDisplayLength=c;
this.draw();
return this.tableSettings._iDisplayLength
};
this.getTableData=function(e){var b,c=$.Deferred();
if(this.params.dataUrl){return $.getScript(this.params.dataUrl)
}else{if(a.params.api){b=new a.params.api(e);
return b[this.params.apiMethod](e)
}else{RR.utils.debugMessage("No datasource set up for datatable component. Consider adding API or dataUrl parameter.");
return c.reject()
}}};
this.setDataSource=function(c){var b=this.table;
b.fnClearTable();
b.fnAddData(c);
this.setDisplayLength(this.params.numRowsPerPage);
this.draw();
this.initPagination()
};
this.draw=function(){this.table.fnDraw();
this.copyClasses()
};
this.copyClasses=function(){var c=this.$el.find(".datatable"),d=c.find("thead th"),b=c.find("tbody tr");
$.each(d,function(e,g){var f=$(g).attr("class");
b.find(":nth-child("+(e+1)+")").addClass(f)
})
};
this.initPagination=function(){var b=this.tableSettings.fnRecordsDisplay();
var c=this.params.numRowsPerPage;
if(c>b){c=b;
this.paginationEnabled(false)
}else{this.paginationEnabled(true)
}this.shwUsrFrndlyMsgFrEmptyTbl()
};
this.shwUsrFrndlyMsgFrEmptyTbl=function(){var c=this.$el.find(".datatable"),b=c.find("tbody tr");
var d=b.find("td").text();
if(d===("No data available in table")){b.find("td").replaceWith('<td valign="top" colspan="3" class="dataTables_empty text-left table-date sorting-desc sorting_desc">No entries to display</td>')
}};
this.paginationEnabled=function(b){var c=this.$el.find("button.pagination");
if(b){c.show()
}else{c.hide()
}};
this.fundActivityBreakdownFilter=function(d){var c=d.singleDate,b=a.getTableData(_.extend(d,{productId:a.currentProductId,asOfDate:c}));
b.done(function(e){a.setDataSource(e)
})
};
this.transactionSummaryFilter=function(h){var c,b,f,g,e=[];
this.setDisplayLength(h.numRows);
if(h.selectedFilterOption==="RecentTransactions"){if(h.category.length>0){c=h.category.join("|");
this.filterColumn(c,3,true,false)
}this.paginationEnabled(false)
}if(h.selectedFilterOption==="DateRange"||h.selectedFilterOption==="TaxYear"){b=window.moment(h.startDate);
f=window.moment(h.endDate).add("days",1);
for(g=b;
g.isBefore(f);
g.add("days",1)){e.push(g.format("DD-MMM-YYYY"))
}c=e.join("|");
this.filterColumn(c,0,true,false);
if(h.category.length>0){c=h.category.join("|");
this.filterColumn(c,3,true,false)
}}};
this.filterColumn=function(e,d,c,b){d=d||null;
c=c||false;
b=b||true;
this.table.fnFilter(e,d,c,b)
};
this.filterData=function(b){b=b||{};
if(b.target&&b.target!==this.instanceName){return false
}this.resetAllFilters();
if(a.currentProductId&&b.target==="fundActivityBreakdown"){this.fundActivityBreakdownFilter(b)
}if(b.target==="transactionSummary"){this.transactionSummaryFilter(b)
}if(b.target==="fundTransactions"){this.transactionSummaryFilter(b)
}if(b.search){this.filterColumn(b.search)
}this.saveFilterParams(b);
this.initPagination()
};
this.saveFilterParams=function(b){if(b===undefined){return
}a.filterApplied=true;
a.filterParams={};
if(b.startDate!==undefined){a.filterParams.startDate=b.startDate
}if(b.endDate!==undefined){a.filterParams.endDate=b.endDate
}if(b.numRows!==undefined){a.filterParams.maxTransactions=b.numRows
}if($.isArray(b.category)&&b.category.length>0){a.filterParams.category=b.category
}};
this.resetAllFilters=function(c){var b=0;
c=c||{};
a.filterParams={};
a.filterApplied=false;
if(c.target&&c.target!==this.instanceName){return false
}this.table.fnFilter("",null);
for(b;
b<this.tableSettings.aoPreSearchCols.length;
b++){this.tableSettings.aoPreSearchCols[b].sSearch=""
}this.tableSettings.oPreviousSearch.sSearch="";
this.draw()
};
this.exportTableToCSV=function(f){var d;
if(_.isEmpty(a.currentProductId)){return
}if(!a.filterApplied){var c=this.$el.find(".datatable"),b=c.find("tbody tr"),e=b.length;
a.filterParams={maxTransactions:e};
if(f!==undefined&&f.indexOf("transactionSummary")>=0){a.filterParams.category=a.defaultCategories
}}a.filterParams.time=new Date().getTime();
this.productAPI=RR.api.Product(a.currentProductId);
d=this.productAPI.getDownloadTransactionsCSVPath(a.filterParams);
a.promptCSVDownload(d)
};
this.promptCSVDownload=function(b){if(_.isString(b)&&!_.isEmpty(b)){window.location=b
}};
this.getProductIdFromHash=function(){return(window.location.hash&&window.location.hash.length>2)?window.location.hash.substr(2):""
};
this.needToGetTransactions=function(b){if(b===undefined||b.source===undefined){return false
}if(b.source==="RR"||b.source==="WORKPLACE"){return true
}return false
};
this.displayNextPayment=function(e){var c=$("#nextPaymentInfo"),d,b;
this.nextPaymentTemplate=this.nextPaymentTemplate||c.html();
if(e.contributions){if(e.contributions[0]){b=e.contributions[0].nextPaymentDate;
b[1]=b[1]-1;
d={amount:RR.utils.formatStringAsCurrency(e.contributions[0].amount,"&pound;"),date:window.moment(b).format("Do MMMM YYYY")};
c.html(_.template(this.nextPaymentTemplate,d))
}}else{c.html("")
}};
this.initDataTable=function(g){var c,e=this.$el.find(".datatable"),b=[],d=[],f=25;
g=g||{};
this.params.numRowsPerPage=f;
c={sDom:"tr",iDisplayLength:g.rowsPerPage};
e.find("th").each(function(){var j={bSearchable:true,bVisible:true},k=$(this),h=0;
if(k.hasClass("sorting-asc")===true){d.push([h,"asc"])
}if(k.hasClass("sorting-desc")===true){d.push([h,"desc"])
}if(k.hasClass("hidden-col")===true){j.bVisible=false
}if(k.hasClass("table-num")===true){j.sType="numeric"
}if(k.hasClass("table-date")===true){j.sType="date-uk";
j.bSortable=true
}if(k.hasClass("table-nosort")===true){j.bSortable=false
}b.push(j);
h+=1
});
c.aaSorting=d;
c.aoColumns=b;
if(this.params.dataUrl){c.sAjaxSource=g.dataSource
}$.extend($.fn.dataTableExt.oSort,{"date-uk-pre":function(h){var i=h.split("-");
if(i.length===3){return(i[2]*10000)+($.inArray(i[1].toUpperCase(),["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"])*100)+i[0]
}else{return 0
}},"date-uk-asc":function(i,h){return((i<h)?-1:((i>h)?1:0))
},"date-uk-desc":function(i,h){return((i<h)?1:((i>h)?-1:0))
}});
this.table=e.dataTable(c);
this.tableSettings=this.table.fnSettings()
};
this.getProductData=function(c){var b;
if(c!==undefined&&c.productId!==undefined){a.currentProductId=c.productId
}if(a.instanceName==="transactionSummary"||a.instanceName==="fundTransactions"){if(c.productId&&a.needToGetTransactions(c)){b=a.getTableData(c);
b.done(function(d){a.gotProductData=true;
a.setDataSource(d)
})
}}if(a.instanceName==="transactionSummary"){a.displayNextPayment(c)
}if(a.instanceName==="fundActivityBreakdown"){if(c.type==="pension"||c.type==="isa"){b=a.getTableData(c);
b.done(function(d){a.gotProductData=true;
a.setDataSource(d)
})
}else{a.setDataSource([])
}}};
this.initEvents=function(){var c=this.$el,e=c.find("button.pagination"),f=this.params;
e.on("click",function(){var i=a.tableSettings._iDisplayLength,g=f.numRowsPerPage,h=i+g;
a.setDisplayLength(h)
});
$(RR).trigger("uiNeedsProductDetails");
var b=a.$el.closest(".tab-pane").attr("id");
$(RR).on("productSelectionRender",function(i,j){a.gotProductData=false;
a.productSelectionArgs=_.clone(j);
var h=$("#tabButtons li.active a"),g="";
if(h.length>0){g=h.attr("href").substr(1)
}if(g===b){a.getProductData(a.productSelectionArgs)
}});
$(document).on("shown.bs.tab",'a[href="#'+b+'"]',function(g){if(!a.gotProductData){a.getProductData(a.productSelectionArgs)
}});
$(RR).on("uiDatatableFilterApplied",function(g,h){a.filterData(h)
});
$(RR).on("uiDatatableFilterReset",function(g,h){a.resetAllFilters(h)
});
var d=[{elementSelector:'[name="transactionSummaryCSV"]',tableSelector:"#transactionSummary-table",analyticsTriggerEvent:"MoneyInOutTransactionsCSV"},{elementSelector:'[name="fundTransactionsCSV"]',tableSelector:"#fundTransactions-table",analyticsTriggerEvent:"FundActivityDownloadCSV"}];
_.each(d,function(h){var g=c.parent().find(h.elementSelector);
g.off("click").on("click",function(){var i=$(h.tableSelector);
try{$(RR).trigger("analyticsevent",{event:(h.analyticsTriggerEvent)})
}catch(j){}a.exportTableToCSV(h.tableSelector)
})
})
};
this.initApi=function(){this.params.api=RR.api.Product;
if(this.instanceName==="transactionSummary"){this.params.apiMethod="transactionSummary"
}if(this.instanceName==="fundTransactions"){this.params.apiMethod="fundTransactions"
}if(this.instanceName==="fundActivityBreakdown"){this.params.apiMethod="fundActivityBreakdown"
}};
this.init=function(){this.$el=this.$node();
this.instanceName=this.params.instanceName||"";
this.initApi();
this.initDataTable();
this.initPagination();
this.initEvents()
}
});
RR.components.datatableFilter=RR.defineComponent(function(){var a=this;
this.convertSearchValues=function(f){var e={},b={},c="";
e.category=[];
_.each(f,function(h){if(h.name==="category[]"){e.category.push(h.value)
}if(h.name==="rangeType"){c=h.value
}e[h.name]=(h.value==="na")?"":h.value
});
function g(h){if(h===undefined){return h
}else{return h<10?"0"+h:""+h
}}b.selectedFilterOption=c;
b.category=e.category;
b.search=e.search||"";
b.start="";
switch(b.selectedFilterOption){case"RecentTransactions":b.numRows=parseInt(e.numRows,10)||"";
break;
case"DateRange":b.startDate=e.startDate;
b.endDate=e.endDate;
break;
case"TaxYear":var d=e.taxYear.split("-");
b.startDate=d[0]+"-04-06";
b.endDate=d[1]+"-04-05";
break;
case"StartOfPolicy":b.start=true;
break;
default:e.singleDate=[e.year||"",g(e.month)||"",g(e.day)||""].join("-");
b.singleDate=(e.singleDate!=="--")?e.singleDate:"";
break
}b.target=this.params.target||"";
return b
};
this.enableVisibleDisableInvisibleElements=function(b){if(!_.isArray(b)){return
}_.each(b,function(c){if(c.is(":visible")){c.find("select").removeAttr("disabled");
c.find("input[type=date]").attr("data-force-validation","true")
}else{c.find("select").attr("disabled","disabled");
c.find("input[type=date]").removeAttr("data-force-validation")
}})
};
this.initEvents=function(){var c=this.$el.find("form"),h,g=a.$el.find("select[name=rangeType]"),e=a.$el.find("div[id$=recentTransactionsDiv]"),d=a.$el.find("div[id$=startDateDiv]"),b=a.$el.find("div[id$=endDateDiv]"),f=a.$el.find("div[id$=taxYearDiv]"),i=[d,b,f];
c.on("shown",function(){a.enableVisibleDisableInvisibleElements(i)
});
if(g.length>0){g.change(function(k){var j=$(k.target).find(":selected").val();
e.toggleClass("hidden",j!=="RecentTransactions");
d.toggleClass("hidden",j!=="DateRange");
b.toggleClass("hidden",j!=="DateRange");
f.toggleClass("hidden",j!=="TaxYear");
a.enableVisibleDisableInvisibleElements(i)
})
}c.on("submit",function(j){var l=$(this),k=l.serializeArray();
k=k.concat(l.find("input[checked=checked]").map(function(){return{name:this.name,value:this.value}
}).get());
j.preventDefault();
if(l.parsley("isValid")===true){h=a.convertSearchValues(k);
$(RR).trigger("uiDatatableFilterApplied",h);
a.$el.find(".accordion-body").collapse("hide")
}return false
})
};
this.init=function(){this.$el=this.$node();
this.instanceName=this.params.instanceName||"";
this.initEvents()
}
});
RR.components.addressForm=RR.defineComponent(function(){var a;
this.init=function(){this.panel=null;
this.addresses=[];
this.$findAddressButton=this.$el.find("[data-id=findAddressButton]");
this.$postcodeInput=this.$el.find("[data-id=postcodeInput]");
this.$addressSelectionDropdown=this.$el.find("[data-id=addressSelectionDropdown]");
this.$selectThisAddressButton=this.$el.find("[data-id=selectThisAddressButton]");
this.$postcodeFinderHouseNameOrNumberInput=this.$el.find("[data-id=postcodeFinderHouseNameOrNumberInput]");
this.$addressTypeToggle=this.$el.find(".toggle-group");
this.$addressTypeToggleInput=this.$addressTypeToggle.find("[name=toggleSame]");
this.$enterAddressManuallyButton=this.$el.find("[data-id=enterAddressManuallyButton]");
this.$findAddressThroughPostcodeButton=this.$el.find("[data-id=findAddressThroughPostcodeButton]");
this.$enterBfpoAddressButton=this.$el.find("[data-id=enterBfpoAddress]");
this.$enterRegularAddressButton=this.$el.find("[data-id=enterRegularAddress]");
this.$submitButton=this.$el.find("[data-id=submit]");
this.$bfpoAddressFields=this.$el.find("[data-id=bfpoAddressInput]");
this.$houseNameOrNumberInput=this.$el.find("[data-id=houseNameOrNumberInput]");
this.$manualAddressFields=this.$el.find("[data-id=manualAddressInput]");
this.$countryDropdown=this.$el.find("[data-id=countryDropdown]");
this.$notUkResidentAlert=this.$el.find("[data-id=notUkResidentAlert]");
this.isHomeAddress=true;
this.isSameAsHomeAddress=true;
if(this.$addressTypeToggleInput.length){this.isHomeAddress=false
}this.on(RR,"dataCustomerDetails",this.storeCustomerDetails);
this.on(RR,"dataCustomerDetailsAddresses",this.storeAddresses);
this.showPanelPostcodeFinder();
this.on(this.$addressTypeToggleInput,"click",this.toggleSameAsHomeAddress);
this.on(this.$findAddressButton,"click",this.findAddress);
this.on(this.$selectThisAddressButton,"click",this.selectAddress);
this.on(this.$enterBfpoAddressButton,"click",this.showPanelEnterBFPOAddress);
this.on(this.$enterAddressManuallyButton,"click",this.showPanelEnterManualAddress);
this.on(this.$enterRegularAddressButton,"click",this.showPanelEnterRegularAddress);
this.on(this.$findAddressThroughPostcodeButton,"click",this.showPanelPostcodeFinder);
this.on(this.$addressSelectionDropdown,"change",this.selectAddressFromDropdown);
this.on(this.$countryDropdown,"change",this.selectCountryFromDropdown);
this.$el.parsley("addListener",{onFormSubmit:$.proxy(this.submit,this)})
};
this.extractAddress=function(){var b={};
if(this.panel==="enterBFPOAddress"){b={addressId:null,houseNameNumber:this.$el.find("[data-name=company]").val().trim(),addressLine1:this.$el.find("[data-name=bfpoService]").val().trim(),addressLine2:null,townCity:this.$el.find("[data-name=bfpoRegiment]").val().trim(),county:null,postcode:this.$el.find("[data-name=bfpoNumber]").val().trim(),country:this.$el.find("[data-name=country]").val().trim(),type:this.isHomeAddress?"A":"P","delete":false}
}else{b={addressId:null,houseNameNumber:this.$el.find("[data-name=houseNameNumber]").val().trim(),addressLine1:this.$el.find("[data-name=addressLine1]").val().trim(),addressLine2:this.$el.find("[data-name=addressLine2]").val().trim(),townCity:this.$el.find("[data-name=townCity]").val().trim(),county:null,postcode:this.$el.find("[data-name=postcode]").val().trim(),country:this.$el.find("[data-name=country]").val().trim(),type:this.isHomeAddress?"A":"P","delete":false}
}if(this.addresses[0]&&this.isHomeAddress){b.addressId=this.addresses[0].addressId
}if(this.addresses[1]&&!this.isHomeAddress){b.addressId=this.addresses[1].addressId;
if(this.isSameAsHomeAddress){b["delete"]=true
}}if(!this.addresses[1]&&!this.isHomeAddress&&this.isSameAsHomeAddress){b=null
}return b
};
this.getAddresses=function(){var e=$.Deferred();
var b=RR.session("email");
var c=new RR.api.Customer(b);
c.details().done(function(f,d){if(f===200){e.resolve(d.addresses)
}});
return e
};
this.selectCountryFromDropdown=function(){if(this.$countryDropdown.find("option:selected").text()==="United Kingdom"||this.$countryDropdown.find("option:selected").text()===this.$countryDropdown.find("option").first().text()){this.$notUkResidentAlert.hide()
}else{this.$notUkResidentAlert.show()
}};
this.saveAddresses=function(g){var b=this;
var f=$.Deferred();
var c=RR.session("email");
var e=new RR.api.Customer(c);
e.details({addresses:g}).done(function(d){if(d===200){b.getAddresses().done(function(h){b.trigger(RR,"dataCustomerDetails",{addresses:h});
b.trigger("uiFormSubmitted",{addresses:h});
f.resolve(h);
if(typeof $("#address-updated").modal==="function"){$("#address-updated").modal("show")
}$(RR).trigger("hideProcessingButton")
})
}});
return f
};
this.submit=function(d,c){if(d){var f=_.clone(this.addresses?this.addresses:[]);
var b=this.extractAddress();
if(!b){this.trigger("uiCancelAction");
return false
}if(this.isHomeAddress){f[0]=b
}else{f[1]=b
}this.saveAddresses(f)
}return false
};
this.populateAddressFromDropdown=function(){var b=JSON.parse(this.$addressSelectionDropdown.find("option:selected").val());
_.each(b,function(c,d){$("[data-name="+d+"]").val(c)
});
this.$el.find("[data-name=country] option:contains('United Kingdom')").prop("selected",true)
};
this.selectAddress=function(){this.populateAddressFromDropdown();
this.showPanelEnterRegularAddress()
};
this.selectAddressFromDropdown=function(){if(this.$addressSelectionDropdown.val()){this.showControlGroup(this.$selectThisAddressButton)
}else{this.hideControlGroup(this.$selectThisAddressButton)
}};
this.toggleSameAsHomeAddress=function(){if(this.$addressTypeToggleInput.filter(":checked").val()==="yes"){this.isSameAsHomeAddress=true
}else{this.isSameAsHomeAddress=false
}this.showPanelPostcodeFinder()
};
this.getAddressSelectionDropdownOption=function(c){var d=JSON.stringify(c);
var b="";
if(c.houseNameNumber){b+=c.houseNameNumber+", "
}if(c.addressLine1){b+=c.addressLine1+", "
}if(c.townCity){b+=c.townCity
}if(b.slice(-2)===", "){b=b.substring(0,b.length-2)
}return $("<option value='"+d+"'>"+b+"</option>")
};
this.resetAddressDetailsDropdown=function(){this.$addressSelectionDropdown.html(this.$addressSelectionDropdown.find("option").eq(0))
};
this.populateAddressSelectionDropdown=function(b){this.resetAddressDetailsDropdown();
_.each(b,function(c){this.$addressSelectionDropdown.append(this.getAddressSelectionDropdownOption(c))
},this)
};
this.showPanelEnterManualAddress=function(b){this.clearAddressFields();
this.showPanelEnterRegularAddress(b)
};
this.showPanelEnterRegularAddress=function(b){if(b===true){RR.plugins.form.setError(this.$manualAddressFields,"notfound","Sorry, we can't find that postcode. Please check the format and try again or enter your address manually")
}this.hideControlGroup(this.$findAddressButton);
this.hideControlGroup(this.$enterAddressManuallyButton);
this.hideControlGroup(this.$addressSelectionDropdown);
this.hideControlGroup(this.$selectThisAddressButton);
this.hideControlGroup(this.$bfpoAddressFields);
this.hideControlGroup(this.$enterRegularAddressButton);
this.hideControlGroup(this.$postcodeInput);
this.hideControlGroup(this.$postcodeFinderHouseNameOrNumberInput);
this.showControlGroup(this.$findAddressThroughPostcodeButton);
this.showControlGroup(this.$enterBfpoAddressButton);
this.showControlGroup(this.$houseNameOrNumberInput);
this.showControlGroup(this.$manualAddressFields);
this.showControlGroup(this.$countryDropdown);
this.$countryDropdown.prop("disabled",false);
this.$submitButton.show();
this.$notUkResidentAlert.hide();
this.panel="enterRegularAddress"
};
this.showPanelEnterBFPOAddress=function(){this.hideControlGroup(this.$findAddressButton);
this.hideControlGroup(this.$enterAddressManuallyButton);
this.hideControlGroup(this.$addressSelectionDropdown);
this.hideControlGroup(this.$selectThisAddressButton);
this.hideControlGroup(this.$findAddressThroughPostcodeButton);
this.hideControlGroup(this.$enterBfpoAddressButton);
this.hideControlGroup(this.$manualAddressFields);
this.hideControlGroup(this.$houseNameOrNumberInput);
this.hideControlGroup(this.$postcodeInput);
this.hideControlGroup(this.$postcodeFinderHouseNameOrNumberInput);
this.showControlGroup(this.$enterRegularAddressButton);
this.showControlGroup(this.$findAddressThroughPostcodeButton);
this.showControlGroup(this.$bfpoAddressFields);
this.showControlGroup(this.$countryDropdown);
this.$countryDropdown.prop("disabled",true);
this.clearAddressFields();
this.$submitButton.show();
this.$notUkResidentAlert.hide();
this.panel="enterBFPOAddress"
};
this.showPanelPostcodeFinder=function(){this.hideControlGroup(this.$addressSelectionDropdown);
this.hideControlGroup(this.$selectThisAddressButton);
this.hideControlGroup(this.$findAddressThroughPostcodeButton);
this.hideControlGroup(this.$bfpoAddressFields);
this.hideControlGroup(this.$manualAddressFields);
this.hideControlGroup(this.$countryDropdown);
this.hideControlGroup(this.$enterRegularAddressButton);
this.hideControlGroup(this.$enterBfpoAddressButton);
this.hideControlGroup(this.$houseNameOrNumberInput);
this.showControlGroup(this.$postcodeInput);
this.showControlGroup(this.$findAddressButton);
this.showControlGroup(this.$enterAddressManuallyButton);
this.showControlGroup(this.$postcodeFinderHouseNameOrNumberInput);
this.$submitButton.hide();
if(!this.isHomeAddress&&this.isSameAsHomeAddress){this.hideControlGroup(this.$postcodeInput);
this.hideControlGroup(this.$findAddressButton);
this.hideControlGroup(this.$postcodeFinderHouseNameOrNumberInput);
this.hideControlGroup(this.$enterAddressManuallyButton);
this.$submitButton.show()
}this.clearAddressFields();
this.$postcodeInput.val("");
this.$postcodeFinderHouseNameOrNumberInput.val("");
this.$notUkResidentAlert.hide();
this.panel="postcodeFinder"
};
this.clearAddressFields=function(){var b=$("[data-name]");
b.each(function(){$(this).val("")
});
this.$el.find("[data-name=country] option:contains('United Kingdom')").prop("selected",true)
};
this.showControlGroup=function(b){b.each(function(){$(this).closest(".control-group").show()
})
};
this.hideControlGroup=function(b){b.each(function(){$(this).closest(".control-group").hide();
try{$(this).parsley("validate")
}catch(c){}})
};
this.storeCustomerDetails=function(c,b){this.storeAddresses(null,b)
};
this.storeAddresses=function(c,b){this.addresses=_.clone(b.addresses?b.addresses:[])
};
this.findAddress=function(){var b=this;
var e;
var d;
var c=new RR.api.Address();
d=this.$postcodeInput.parsley("validate");
if(!this.$postcodeInput.val()||!d){return false
}this.hideControlGroup(this.$addressSelectionDropdown);
this.hideControlGroup(this.$selectThisAddressButton);
c.setPostcode(this.$postcodeInput.val().trim());
c.setHouseNameOrNumber(this.$postcodeFinderHouseNameOrNumberInput.val().trim());
c.lookup().done(function(f,g){if(f===200){b.populateAddressSelectionDropdown(g);
b.$addressSelectionDropdown.closest(".control-group").show();
b.$postcodeInput.parsley("updateConstraint",{required:false})
}else{if(f===404||f===500){b.showPanelEnterManualAddress(true)
}}})
}
});
RR.components.detailList=RR.defineComponent(function(){this.init=function(){var c=this;
this.params=this.params?this.params:{};
var e=this.params.detailsType||"CustomerDetails";
var b=this.params.sessionVariable||"";
this.rendered=false;
this.$node(".detail-list > p").each(function(){$(this).attr("data-template",JSON.stringify($(this).html()))
});
$("#goalsSetting").hide();
this.$node("button").on("click",$.proxy(c.hide,c));
this.$node().siblings("form").on("uiCancelAction",$.proxy(this.show,this));
if(e==="CustomerDetails"){$(RR).on("data"+e,$.proxy(this.populate,this));
$(RR).trigger("uiNeeds"+e);
this.$node().siblings("form").on("uiFormSubmitted",$.proxy(this.refreshAndShow,this))
}if(e==="CustomerDetailsWithProducts"){var d=RR.session("email");
var g=new RR.api.Customer(d);
g.details().done(function(h,i){c.populate(h,i)
});
this.getProducts().done(function(h,i){c.populateProducts(i)
});
this.$node().siblings("form").on("uiFormSubmitted",$.proxy(this.show,this))
}if(e==="GoalsDetails"){this.goalsApi=RR.api.Goals();
this.scoreApi=RR.api.Score();
var f=this.goalsApi.getPopulateDetails();
var a=this.scoreApi.retrieveScore();
a.done(function(h,j,i){if(h===200){f.done(function(k,m,l){c.populate(k,m)
})
}else{c.removeGoalsForm()
}});
this.$node().siblings("form").on("uiFormSubmitted",$.proxy(this.refreshAndShow,this))
}else{if(e==="CustomerDetailsWithProducts"){this.$node().siblings("form").on("uiFormSubmitted",$.proxy(this.refreshAndShowBankDetails,this))
}}if(e==="Session"){this.populate(null,RR.session(this.params.detailsObject))
}this.on(RR,"uiSecurityCheckCompleted",this.hideSecure);
this.on("uiPopulateDetailList",this.populate);
this.show()
};
this.getProducts=function(){var a=RR.session("email");
var b=new RR.api.Account(a);
var c=$.Deferred();
return b.products({})
};
this.populateProducts=function(d){var e=d.products;
if(e){var b=this.calculateNextPayment(d.products);
if(b){var c=$("#nextPayment");
var a=c.html();
c.html(_.template(a,{nextPaymentDate:RR.utils.arrayToDateFormatted(b)}));
c.show()
}}};
this.calculateNextPayment=function(g){var c;
var e;
for(var d=0;
d<g.length;
d++){var f=g[d];
if(f.regularPayment){var a=f.regularPayment.nextPaymentDate;
if(!c){c=new Date(a);
e=a
}else{var b=new Date(a);
if(b>c){e=a
}}}}return e
};
this.populate=function(g,c){if(!this.rendered&&c){_.extend(c,this.helpers);
var f=false;
this.$node(".detail-list > p").each(function(){var i=false;
var e;
var j=JSON.parse($(this).attr("data-template"));
try{e=_.template(j,c);
$(this).html(e)
}catch(k){$(this).hide()
}if(!$(this).text().replace(":","").trim()){i=true
}if(j===$(this).html()&&j.indexOf("{{")>-1){i=true
}if(!e){e=""
}if(e.indexOf("[object HTMLParagraphElement]")>-1){i=true
}if(i){$(this).hide()
}else{$(this).show();
f=true
}});
this.rendered=true;
var d=this.$el.find('[data-id="text-if-empty"]');
if(d.length===1){if(f){d.hide()
}else{d.show()
}}if(this.params.detailsType==="CustomerDetailsWithProducts"){if(!c.bankDetails||!c.bankDetails[0]){$(".jsNoBankDetails").show();
$(".jsNoBankDetails").siblings().find(".exclude-from-nav-warning").hide()
}else{$(".jsNoBankDetails").hide();
$(".jsAddBankDetails").hide()
}if(!RR.utils.isAuthor()){$("#multiple_bank_details_id, #legacy_support_id").hide()
}var b=false;
var h=false;
var a=0;
$.each(c.bankDetails,function(e,j){a++;
if(j.source==="PACKAGED"){b=true
}if(j.source==="COMPOSER"){h=true
}});
if(b===true&&h===false){$("#bank-details-amend-button").hide();
$("#legacy_support_id").show()
}if(b===true&&h===true){$("#multiple_bank_details_id").show()
}if(a>1){$("#multiple_bank_details_id").show()
}}if(this.params==="CustomerDetailsWithProducts"){if(!c.bankDetails||!c.bankDetails[0]){this.hideBankForm()
}}}};
this.removeGoalsForm=function(){var a=$("#goalsDetailsPanel");
if(a){a.remove();
$("#yourGoals").remove();
$("#goalsSetting").remove()
}};
this.hideBankForm=function(){var a=$("#bank-details-amend-button");
if(a){a.addClass("hidden");
$("#nextPayment").addClass("hidden")
}};
this.hide=function(){if(this.params.detailsType==="GoalsDetails"){$("#yourGoals").hide();
$("#goalsSetting").show()
}if(!this.params.secure){if(!this.$node("button").data("href")){this.$node().siblings("form").show();
this.$node().hide()
}}else{this.trigger(RR,"uiStartSecurityCheck",{guid:this.guid})
}};
this.hideSecure=function(b,a){if(a.guid===this.guid){if(!this.$node("button").data("href")){this.$node().siblings("form").show();
this.$node().hide()
}}};
this.show=function(){this.$node().siblings("form").hide();
this.$node().siblings("form").parsley("reset");
this.$node().show()
};
this.refreshAndShow=function(b,a){if(a){if(this.params.detailsType==="GoalsDetails"){a.personalDetails={retirementAge:a.retirementAge}
}this.rendered=false;
this.populate(null,a);
this.show()
}};
this.refreshAndShowBankDetails=function(b,a){if(a){this.rendered=false;
this.show()
}};
this.helpers={parseTaxFreeLumpSum:function(b){var a;
switch(b){case true:a="With lump sum";
break;
case false:a="No lump sum";
break;
default:break
}return a
},parseEmploymentStatus:function(a){var b;
switch(a){case"Employed":b="Employed";
break;
case"Pensioner":b="Pensioner";
break;
case"Self-employed":b="Self-employed";
break;
case"Child under 16":b="Child";
break;
case"Other - under 16 carer":b="Caring for one or more children aged under 16";
break;
case"Other - over 16 carer":b="Caring for a person aged 16 or over";
break;
case"Other - full time education":b="In full time education";
break;
case"Other - unemployed":b="Unemployed";
break;
case"Other":b="Other";
break;
default:break
}return b
},parseIndustry:function(b){var a;
switch(b){case"agricult":a="Agriculture";
break;
case"energyMin":a="Mineral, Energy";
break;
case"Self-employed":a="Self-employed";
break;
case"manuNonDur":a="Manufacturing- Non durable";
break;
case"manDur":a="Manufacturing- Durable";
break;
case"public":a="Public";
break;
case"construc":a="Construction";
break;
case"retail":a="Retail";
break;
case"wholesale":a="Wholesale";
break;
case"transPostTele":a="Transport, Post and Telecoms";
break;
case"fsi":a="Finance and Insurance";
break;
case"property":a="Property";
break;
case"bizServs":a="Business Services";
break;
case"perServs":a="Personal Services";
break;
case"other":a="Other";
break;
default:break
}return a
}}
});
RR.components.faqsAndInsightsReport=RR.defineComponent(function(){moment.lang("en-gb");
this.data={};
this.feedbackNodesQueryPath="/bin/querybuilder.json?orderby=%40dateAdded&orderby.sort=desc&p.hits=full&path=%2fcontent%2fretiready&property=nodeType&property.value=feedbackNode";
this.feedbackNodePagesQueryPath="/bin/querybuilder.json?p.hits=selective&p.properties=jcr%3apath%20jcr%3acontent%2fjcr%3atitle&path=%2fcontent%2fretiready&property=jcr%3acontent%2ffeedbackNodes%2f*%2fnodeType&property.value=feedbackNode&type=cq%3aPage";
this.feedbackListErrorMessage="There was an error getting the list of feedback from the AEM server.";
this.feedbackPagesErrorMessage="There was an error getting the list of feedback pages from the AEM server.";
this.feedbackResultsErrorMessage="The feedback results could not be compiled. This may happen if there is no FAQ page feedback in the requested path.";
var a=this;
this.generateCSV=function(){a.hideError();
var b=$.get(a.feedbackNodesQueryPath);
b.done(function(c){a.data.feedbackNodes=c;
a.finaliseCalls(a)
});
b.fail(function(){a.setErrorMessage(a.feedbackListErrorMessage);
a.showError()
})
};
this.finaliseCalls=function(){var b=$.get(a.feedbackNodePagesQueryPath);
b.done(function(c){a.data.feedbackPages=c;
a.redirect(a.compileResult())
});
b.fail(function(){a.setErrorMessage(a.feedbackPagesErrorMessage);
a.showError()
})
};
this.redirect=function(b){if(b!==undefined&&b!==false){window.location.href=b
}};
this.compileResult=function(){var e='","',c='"\r\n"',b="",d=a.compileRows();
if(!d){a.setErrorMessage(a.feedbackResultsErrorMessage);
a.showError();
return false
}_.each(d,function(g){var f=g.join(e);
b+=f+c
});
b="data:text/csv;charset=utf-8,"+encodeURIComponent(b);
return b
};
this.compileRows=function(){var b=[];
if(a.data===undefined||a.data.feedbackNodes===undefined||a.data.feedbackPages===undefined||a.data.feedbackNodes.hits===undefined||a.data.feedbackPages.hits===undefined||a.data.feedbackNodes.hits.length===0||a.data.feedbackPages.hits.length===0){return false
}var c={};
_.each(a.data.feedbackPages.hits,function(d){c[d["jcr:path"]]=d["jcr:title"]
});
b=[['"Page Title',"URL","Comment","Rating","Date Added","Time Added"]];
_.each(a.data.feedbackNodes.hits,function(h){var d=h["jcr:path"].split("/jcr:content")[0],f=c[d],e=h.rating,g=a.getDateTime(h.dateAdded);
d+=".html";
b=b.concat([[f,d,h.comment,e,g.date,g.time]])
});
return b
};
this.getDateTime=function(i){var g=i.split(" "),f=g.slice(1,4),h=g[4]===undefined?"":g[4],c=g[5]===undefined?"":g[5].replace("GMT",""),e=h+" "+c,d=f.concat(e).join(" "),b=moment(d,"MMM D YYYY HH:mm:ss Z",true),j={};
j.date="";
j.time="";
if(b.isValid()){j.date=b.format("D MMM YYYY");
j.time=b.format("h:mm:ss a")
}else{j.date=f;
j.time=e
}return j
};
this.setErrorMessage=function(b){a.$generatedCSVErrorMessage.html(b)
};
this.hideError=function(){a.$generateCSVErrorDiv.addClass("hidden")
};
this.showError=function(){a.$generateCSVErrorDiv.removeClass("hidden")
};
this.initEvents=function(){this.$generateCSVLink.on("click",function(){a.generateCSV()
})
};
this.init=function(){this.$el=this.$node();
this.$generateCSVLink=this.$el.find("#generateCSVLink");
this.$generateCSVErrorDiv=this.$el.find("#generateCSVErrorDiv");
this.$generatedCSVErrorMessage=this.$el.find("#generateCSVErrorMessage");
this.initEvents()
}
});
RR.components.accordion=(function(b){var a=new RR.Component();
a.init=function(c){var d=c();
d.on("hide",function(){d.css("overflow","hidden");
d.find(".accordion-body").css("overflow","hidden")
});
d.on("hidden",function(f){var g=b(f.target).attr("id");
d.find('a[href="#'+g.replace("-inner","")+'"] .ico').html("&#xf70a;")
});
d.on("shown",function(f){var g=b(f.target).attr("id");
d.css("overflow","visible");
d.find(".accordion-body").css("overflow","visible");
d.find('a[href="#'+g.replace("-inner","")+'"] .ico').html("&#xf709;")
});
b(window).resize(function(f){if(d.find("a.accordion-toggle").is(":visible")){d.find(".accordion-body").collapse("show")
}});
if(!d.find("a.accordion-toggle").is(":visible")){d.css("overflow","visible");
d.find(".accordion-body").css("overflow","visible")
}};
return a
}(jQuery));
RR.components.savingsDocuments=RR.defineComponent(function(){var a=this;
this.maxDisplayLength=20;
this.documentsBrokerURL="/rrdoc/document/retrieve";
this.productId=null;
this.documentsList=[];
this.gotDocuments=false;
this.productArgs=null;
this.documents={POLICY_SETUP:{button:$("#setupDocsNext"),list:$("#setupDocs"),count:0,index:0},STATEMENT:{button:$("#statementDocsNext"),list:$("#statementDocs"),count:0,index:0},INVESTMENT:{button:$("#investmentDocsNext"),list:$("#investmentDocs"),count:0,index:0}};
this.init=function(b,c){a.initEvents();
a.initNextButtons();
a.tabAnalytics()
};
this.tabAnalytics=function(){$("#documentsTabNavigationToggle li").click(function(){try{$(RR).trigger("analyticsevent",{event:("Tab-"+$(this).find("a").html())})
}catch(b){}})
};
this.enableVisibleDisableInvisibleElements=function(b){if(!_.isArray(b)){return
}_.each(b,function(c){if(c.is(":visible")){c.find("select").removeAttr("disabled");
c.find("input[type=date]").attr("data-force-validation","true")
}else{c.find("select").attr("disabled","disabled");
c.find("input[type=date]").removeAttr("data-force-validation")
}})
};
this.initEvents=function(){var d=a.$el.closest(".tab-pane").attr("id"),c=a.$el.find("form"),g=a.$el.find("select[name=rangeType]"),f=a.$el.find("#documentsStatementsStartDateDiv"),b=a.$el.find("#documentsStatementsEndDateDiv"),e=[f,b];
$(RR).on("productSelectionRender",function(k,i){a.gotDocuments=false;
a.productArgs=i;
var j=$("#tabButtons li.active a"),h="";
if(j.length>0){h=j.attr("href").substr(1)
}if(h===d){a.getDocuments(a.productArgs)
}});
$(document).on("shown.bs.tab",'a[href="#'+d+'"]',function(h){if(!a.gotDocuments){a.getDocuments(a.productArgs)
}});
$(RR).on("uiDatatableFilterApplied",function(h,i){if(i.target&&i.target==="documentsStatement"){a.filterDocuments(h,i);
$("#statementDocsNext").hide()
}});
c.on("shown",function(){a.enableVisibleDisableInvisibleElements(e)
});
if(g.length>0){g.change(function(i){var h=$(i.target).find(":selected").val();
f.toggleClass("hidden",h!=="DateRange");
b.toggleClass("hidden",h!=="DateRange");
a.enableVisibleDisableInvisibleElements(e)
})
}};
this.initNextButtons=function(){$.each(a.documents,function(c,b){b.button.attr("category",c);
b.button.click(function(){a.displayNextDocuments($(this).attr("category"))
})
})
};
this.getDocuments=function(b){if(b&&b.productId){if(b.type==="pension"||b.type==="isa"){var e=new RR.api.Product(b.productId);
var c;
var d;
$(RR).trigger("headway:showSpinner");
c=e.getDocuments();
c.done(function(f,g){if(g){a.gotDocuments=true;
a.productId=b.productId;
a.showDocuments(g)
}})
}}};
this.showDocuments=function(d){var c="li.a";
var b="li.hidden";
$.each(a.documents,function(f,e){e.count=0;
e.index=a.maxDisplayLength
});
this.$el.find(c).remove();
this.$el.find(b).show();
$.each(d,function(i,e){a.documents[e.category].count++;
var h=a.documents[e.category].list;
var g=h.find(b);
var j=g.after(g.clone());
j.removeClass("hidden").addClass("a doc"+i);
j.attr("data-doc-"+e.category,a.documents[e.category].count);
var f=a.documents[e.category].count;
a.documentsList[e.category]=[f,e.id];
if(a.documents[e.category].count>a.maxDisplayLength){j.hide()
}if(e.category==="STATEMENT"){j.attr("data-generated-date",e.generatedDate)
}a.displayDocument(".doc"+i,e.title,e.format,e.size,e.generatedDate,e.id,e.url,e.newFlag)
});
a.viewDocuments();
a.enableNextDocuments();
this.$el.find(b).hide()
};
this.displayDocument=function(i,g,h,j,e,c,b,f){var d=a.documentsBrokerURL+"/"+a.productId+"/"+c;
e=e||[];
$(i+" a").attr("href",d);
$(i+" h4").html(g);
$(i+" span.file-descriptor").html(h+" "+j);
$(i+" span.file-date").html(RR.utils.arrayToDateFormatted(e));
if(f){$(i+" span.file-new").removeClass("hidden")
}};
this.filterDocuments=function(g,d){var c=$("[data-generated-date]");
if(d.start===true){c.show()
}if(d.startDate&&d.endDate){var b=RR.utils.stringToDate(d.startDate);
var f=RR.utils.stringToDate(d.endDate);
c.hide();
$.each(c,function(j,e){var k=$(e).attr("data-generated-date");
var h=RR.utils.stringToDate(k);
if(h.isAfter(b)&&h.isBefore(f)){$(e).show()
}})
}};
this.displayNextDocuments=function(c){var b=0;
while(a.documents[c].index<=a.documents[c].count){a.documents[c].index++;
b++;
var d=$("li[data-doc-"+c+"="+a.documents[c].index+"]");
if(d.length){d.show()
}if(b>=a.maxDisplayLength){break
}}a.enableNextDocuments()
};
this.enableNextDocuments=function(){$.each(a.documents,function(c,b){b.button.hide();
if(b.count-b.index>0){b.button.show()
}})
};
this.viewDocuments=function(){$.each(a.documents,function(c,b){b.list.attr("data-category",c);
b.list.find("li").click(function(h){var j=$(this);
var f=!j.find(".file-new.hidden").length;
var g=j.parent().attr("data-category");
var i=j.attr("data-doc-"+g);
var d=a.documentsList[g][i];
if(f){a.updateDocumentFlag(d,j)
}})
})
};
this.updateDocumentFlag=function(d,g){var f=new RR.api.Product(a.productId);
var c;
var b={documentId:d,dirtyFields:["newFlag"],newFlag:false};
var e;
c=f.updateDocument(b);
c.done(function(h,i){if(h===200){g.find(".file-new").remove()
}})
}
});
RR.components.savingsPerformance=RR.defineComponent(function(){var a=this;
var b={total:0};
var c;
this.init=function(d,f){a.initEvents();
var e=$(".key-links.with-changes li:first-child");
c=e.clone().removeClass("hidden");
e.remove()
};
this.initEvents=function(){$(RR).on("productPerformance",a.getPerformanceData);
$(RR).on("productSelectionRender",a.getPerformanceData)
};
this.getPerformanceData=function(k,f){var h=$(".key-links.with-changes").hide(),d=$(".changes").hide();
if(f.type==="memoasset"||f.source==="NA"||!$(".block-list-menu-advanced").hasClass("hasProducts")){a.showPerformanceValueAndChangeIndicator("#performanceSumOfTotalChange",0)
}else{if(f.productId){var j=new RR.api.Product(f.productId),g,i;
d.show();
if(b[f.productId]){a.showPerformanceValues(b[f.productId])
}else{g=j.getPerformance();
g.done(function(e,m){if(m){b[f.productId]=m;
b.total+=m.totalChange;
a.showPerformanceValues(b[f.productId]);
a.showPerformanceValueAndChangeIndicator("#performanceSumOfTotalChange",b.total);
a.showTotalsPerformanceBarForProduct(f.productId,f.title,f.source,f.type)
}})
}}else{if($(".block-list-menu-advanced").hasClass("hasPension")||$(".block-list-menu-advanced").hasClass("hasISA")){h.show()
}a.showPerformanceValueAndChangeIndicator("#performanceSumOfTotalChange",b.total);
var l=true;
$.each(b,function(m,e){if(!e.isStartDateWithinPerfPeriod){l=false
}});
a.showRelevantDateText(l)
}}};
this.showPerformanceValues=function(g){var f=g.startValue;
var e=g.endValue;
var d=g.startDate;
var h=g.isStartDateWithinPerfPeriod;
a.showPerformanceValueAndChangeIndicator("#performancePaidIn",g.moneyIn);
a.showPerformanceValueAndChangeIndicator("#performanceInvestmentReturn",g.investmentReturn);
a.showPerformanceValueAndChangeIndicator("#performanceWithdrawals",g.withdrawals);
a.showPerformanceValueAndChangeIndicator("#performanceCharges",g.charges);
a.showPerformanceValueAndChangeIndicator("#performanceTotalChange",g.totalChange);
a.showPerformanceValueAndChangeIndicator("#performanceSumOfTotalChange",g.totalChange);
a.showStartAndEndValues(f,e,d,g.endDate);
a.showRelevantDateText(h)
};
this.showPerformanceValueAndChangeIndicator=function(f,g){var h;
var e;
var d;
if(g<0){h="&#xf715;";
e="red";
d="Down by"
}else{h="&#xf714;";
e="green";
d="Up by"
}$(f+"Value").html(RR.utils.formatStringAsCurrency(g,"&pound;"));
$(f+" span.ico").attr("aria-valuetext",d);
$(f+" span.ico").removeClass("red").removeClass("green").addClass(e).html(h)
};
this.showStartAndEndValues=function(f,e,d,g){$("#performanceStartValue p.total").html(RR.utils.formatStringAsCurrency(f,"&pound;"));
$("#performanceStartValue p.start-date").html(RR.utils.arrayToDateFormatted(d));
$("#performanceEndValue p.total").html(RR.utils.formatStringAsCurrency(e,"&pound;"));
$("#performanceEndValue p.end-date").html(RR.utils.arrayToDateFormatted(g))
};
this.showRelevantDateText=function(d){if(d){$(".changes .under-6-months").removeClass("hidden");
$(".changes .in-last-6-months").addClass("hidden");
$(".value-change .less-than-perf-period").show();
$(".value-change .perf-period").hide()
}else{$(".changes .under-6-months").addClass("hidden");
$(".changes .in-last-6-months").removeClass("hidden");
$(".value-change .less-than-perf-period").hide();
$(".value-change .perf-period").show()
}};
this.showTotalsPerformanceBarForProduct=function(h,n,e,l){_.each([h,n,e,l],function(q){if(!q||q.length===0){return
}});
var j=b[h],o=$(".key-links.with-changes"),i=o.find("ul"),k=c.clone();
k.addClass("ico-"+l.toLowerCase());
k.find(".btn-action > span:first-child").text(n);
var g=k.find(".change"),f=g.find("span"),d=(j.totalChange>=0)?"increase":"decrease",m=(j.totalChange>=0)?"&#xf70b;":"&#xf71c;",p=j.totalChange===0?RR.utils.formatAmount(Math.abs(j.totalChange),"B"):RR.utils.formatAmount(Math.abs(j.totalChange));
f.addClass(d).html(m);
g.empty().append(f).append(" "+p);
k.on("click","a",function(q){q.preventDefault();
$(RR).trigger("productSelection",{productId:h.toString(),productType:l.toLowerCase()})
});
i.append(k);
if(j.isStartDateWithinPerfPeriod){o.children("p:not(.under-6-months)").remove();
o.children("p.under-6-months").removeClass("hidden")
}}
});
RR.components.savingsSelector=RR.defineComponent(function(){var d,a,c=$(".block-list-menu-advanced"),f="",b=true,e=0;
this.init=function(g,h){a=this;
this.$el=this.$node();
this.getSavingProductsMap();
this.responsiveVisuals();
this.confirmConsolidateTransfer();
this.initEvents()
};
this.initEvents=function(){$(RR).on("productSelection",a.productSelectionAction);
if(!RR.utils.isAuthor()){$(RR).on("productSelectionRender",a.modifySidebar)
}$(RR).on("uiNeedsProductDetail",a.provideProductDetails);
$(RR).on("uiNeedsUserProducts",a.getUserProducts);
$(RR).on("headway:spinnerHidden",function(){window.setTimeout(a.loadProductFromHash,50)
});
if(RR.utils.isAuthor()){a.processData({totalValue:0,products:[]})
}};
this.provideProductDetails=function(h,g){$(RR).trigger("provideProductDetails",{asset:a.products[g.assetId]})
};
this.getUserProducts=function(h,g){$(RR).trigger("provideUserProducts",{userProducts:a.products})
};
this.productSelection=function(){$("#savingsMenu ul li").click(function(j){j.preventDefault();
var i=$(this),h=i.attr("data-account-number"),k=i.attr("data-item"),g={productId:h,item:k};
if(i.hasClass("addmemoasset")){a.openAddMemoAssetDialog();
return
}$(RR).trigger("productSelection",g)
})
};
this.openAddMemoAssetDialog=function(){if(RR.utils.isRegisteredProspect()){$(RR).trigger("renderLegacyMemoView",{})
}else{$(RR).trigger("renderMemoAssetModal",{type:"add"})
}};
this.productSelectionAction=function(h,k){var m;
if(k.item){m=c.find("[data-item='"+k.item+"']")
}else{if(k.productType){m=c.find("[data-type='"+k.productType+"']")
}else{m=c.find("[data-account-number='"+k.productId+"']")
}}var j=new Date();
var p=j.getDay();
var i=j.getMonth()+1;
var n=j.getFullYear();
var o=[n,i,p];
var l=m.attr("data-account-number");
var g;
if(a.products[l]){g=a.products[l].contributions
}if(!k.noHashChange){a.setActiveProductId(k.productId)
}$(RR).trigger("productSelectionRender",{productId:l,value:m.data("value"),locked:m.data("locked"),title:m.find("h3").text(),total:parseInt($(".savings-total").attr("data-value"),10),type:m.attr("data-type"),source:m.attr("data-source"),effectiveDate:m.attr("data-effective-date"),item:m.attr("data-item"),pension:d.totalpension,isa:d.totalisa,memoasset:d.totalmemoasset,asOfDate:o,contributions:g})
};
this.modifySidebar=function(h,g){if(g.type==="total"){$('div[data-component="tabbedArea"]').hide()
}$("#savingsMenu ul li").removeClass("active");
c.find("[data-item='"+g.item+"']").addClass("active")
};
this.confirmConsolidateTransfer=function(){var h=RR.session("transferReceived");
if(h&&h.consolidateId&&h.productId){var g={emailAddress:RR.session("email")||"{{activeUser.emailAddress}}"};
RR.plugins.templates.setTemplateVar("activeUser",g).render();
$("#transferRequestReceived .cancelButton").click(function(){var k=new RR.api.Product(h.productId);
var j={};
var i=k.consolidateNotify({consolidationId:h.consolidateId});
i.done(function(l,m){if(l===200){RR.session("transferReceived",{})
}})
});
$("#transferRequestReceived").modal().on("hide",function(){RR.session("transferReceived",{})
})
}};
this.getMaxValueLength=function(h){var g=Math.round(h.totalValue).toString().replace(/[^0-9]+/g,"").length;
if(g<6){g=6
}$.each(h.products,function(k,j){var l=Math.round(j.currentValue).toString().replace(/[^0-9]+/g,"").length;
if(l>g){g=l
}});
return g
};
this.getSavingProductsMap=function(){var h=RR.session("email");
var l=new RR.api.Account(h);
var i;
var k;
var g=[];
var j;
i=l.productsmap({});
i.done(function(m,o){if(RR.utils.isAuthor()){a.processData({totalValue:0,products:[]})
}else{$.each(o.products.PENSION,function(p,q){q.originaltype=q.type;
q.type="PENSION";
g.push(q)
});
$.each(o.products.ISA,function(p,q){q.originaltype=q.type;
q.type="ISA";
g.push(q);
if(q.hasIsaPaymentThisTaxYear===true){e++
}});
$.each(o.products.OTHER,function(p,q){q.originaltype=q.type;
q.type="OTHER";
g.push(q)
});
var n={products:g,totalValue:o.totalValue,pendingProducts:o.pendingProducts};
a.processData(n)
}})
};
this.processData=function(h){var g=a.getMaxValueLength(h);
$("#widgetCounter").removeClass().addClass("widget-counter-"+g);
$("#widgetCounter").attr("data-maxlength",g);
a.showSavingProducts(h);
$(".overview").removeClass("hidden")
};
this.showProduct=function(r,h,o,i,j,l,m,g,q,p,k){var n=$(r);
n.removeClass("hidden");
n.attr("data-value",o);
n.attr("data-account-number",i);
n.attr("data-locked",j);
n.attr("data-type",l);
n.attr("data-source",g);
n.attr("data-effective-date",m);
n.attr("data-item",i+"-"+l+"-"+g);
n.find("h3").html(h);
n.attr("data-originalType",q);
n.find("span.total").html(RR.utils.formatStringAsCurrency(o,"&pound;"));
n.find("span.screenreader-visible").html(" - "+h);
n.attr("data-nooftaxpayment",k);
n.attr("data-hasPayment",p);
if(l===""){$(RR).trigger("dataRenderSelectors",{productId:i,name:h,type:l,item:i+"-"+l+"-"+g})
}};
this.renderSelectors=function(){_.each(a.$el.find(".block-list-menu-advanced li[data-source]"),function(i,g){var h=$(i);
if(!h.hasClass("hidden")){$(RR).trigger("dataRenderSelectors",{productId:h.data("account-number"),name:h.data("name"),type:h.data("type"),item:h.data("account-number")+"-"+h.data("type")+"-"+h.data("source")})
}})
};
this.responsiveVisuals=function(){$(window).resize(function(){if($(window).width()>767){$("#savingsMenu").addClass("in");
$("#savingsMenu").height("auto")
}})
};
this.showSavingProducts=function(k){var i=0;
var l=0;
var h=0;
var m=0;
var g=false;
i=k.totalValue||0;
if(!RR.utils.isAuthor()){$(".savings-arcisa").addClass("hidden")
}$(".block-list-menu-advanced .savings-total h3").text($("#productDetailHeader").text());
if(k.products&&k.products.length>0){a.$el.find(".block-list-menu-advanced").addClass("hasProducts")
}a.showProduct(".block-list-menu-advanced .savings-total",$(".block-list-menu-advanced .savings-total h3").text(),i,"","false","","");
a.products={};
var j=false;
$("li.savings-pension").addClass("source");
$("li.savings-isa").addClass("source");
$.each(k.products,function(o,r){if(r.source==="RR"||r.source==="WORKPLACE"){$(RR).trigger("productPerformance",{productId:r.id,source:r.source,title:r.name,type:r.type})
}a.products[r.id]={};
_.each(r,function(v,u){a.products[r.id][u]=v
});
if(r.type==="PENSION"){var p=$("li.savings-pension.source").after($("li.savings-pension.source").clone());
p.removeClass("source").addClass("pension"+o);
if(r.source!=="LEGACY"){g=true;
a.$el.find(".block-list-menu-advanced").addClass("hasPension");
a.showProduct(".pension"+o,r.name,r.value,r.id,r.locked,"pension",r.effectiveDate,r.source,r.originaltype)
}else{a.showProduct(".pension"+o,r.name,r.value,r.id,r.locked,"memoasset",r.effectiveDate,r.source,r.originaltype)
}if(r.source==="RR"||r.source==="WORKPLACE"){b=false
}if(r.source==="WORKPLACE"){a.$el.find(".block-list-menu-advanced").addClass("hasWpsproduct")
}l=r.value;
$("li.savings-pension.source").addClass("hidden")
}if(r.type==="ISA"){var q=false;
var n=$("li.savings-isa.source").after($("li.savings-isa.source").clone());
n.removeClass("source").addClass("isa"+o);
if(r.hasIsaPaymentThisTaxYear===true){q=true
}a.showProduct(".isa"+o,r.name,r.value,r.id,r.locked,"isa",r.effectiveDate,r.source,r.originaltype,q,e);
h=r.value;
a.$el.find(".block-list-menu-advanced").addClass("hasISA");
$("li.savings-isa.source").addClass("hidden")
}if(r.source==="USER"){var t=$("li.savings-memo.hidden").after($("li.savings-memo.hidden").clone());
t.removeClass("hidden").addClass("asset"+o);
a.showProduct(".asset"+o,r.name,r.value,r.id,r.locked,"memoasset",r.effectiveDate,r.source,r.originaltype);
m+=r.value;
a.$el.find(".block-list-menu-advanced").addClass("hasMemoAsset")
}});
if(b===true){$(".savings-pension").removeClass("hidden")
}$(".savings-total").attr("data-type","total");
d={totalpension:l,totalisa:h,totalmemoasset:m};
a.renderSelectors();
$(RR).trigger("productSelection",{productType:"total",noHashChange:true});
$(".savings-memo.hidden").hide();
this.productSelection();
if($(".block-list-menu-advanced").hasClass("hasWpsproduct")&&(!$(".block-list-menu-advanced").hasClass("hasISA"))){$(".savings-arcisa").removeClass("hidden");
$(".savings-isa").addClass("hidden")
}if(g===true){$(".savings-pension.source").remove()
}if($(".block-list-menu-advanced").hasClass("hasISA")){$(".savings-isa.source").remove()
}};
this.setActiveProductId=function(g){if(g){window.location.hash="!"+g;
a.activeProductId=g
}else{window.location.hash="";
a.activeProductId=""
}RR.plugins.cancelButton.saveCancelUrl()
};
this.loadProductFromHash=function(){var g=a.getProductIdFromHash();
if(g&&g==="memo"){a.$el.find("#add-asset").click()
}if(g&&g!==a.activeProductId){a.$el.find('li[data-account-number="'+g+'"]').click()
}};
this.getProductIdFromHash=function(){return(window.location.hash&&window.location.hash.length>2)?window.location.hash.substr(2):""
}
});
RR.components.savingsDetail=RR.defineComponent(function(){var g=5,b=this,e,a,f=false,d=false,h=false,c=false;
this.currentProductId=null;
this.getSavingProductsMap=function(){var j=RR.session("email");
var n=new RR.api.Account(j);
var k;
var m;
var i=[];
var l;
k=n.productsmap({});
k.done(function(o,p){if(RR.utils.isAuthor()){b.processData({totalValue:0,products:[]})
}else{$.each(p.products.PENSION,function(q,r){r.type="PENSION"
});
$.each(p.products.ISA,function(q,r){r.type="ISA"
});
$.each(p.products.OTHER,function(q,r){r.type="OTHER"
});
b.processData(p)
}})
};
this.processData=function(i){b.showCorrectLinks(i)
};
this.showCorrectLinks=function(k){if(k.products){var j=0;
var l=0;
var i=0;
$.each(k.products.PENSION,function(m,n){j++;
if(k.products.PENSION[m].source==="WORKPLACE"){f=true
}});
$.each(k.products.ISA,function(m,n){l++
});
$.each(k.products.OTHER,function(m,n){i++
});
if(j===0){$("#no-pension-savings-key").removeClass("hidden");
$("#expandable-pension").hide();
$("#pension-savings-key").hide();
$("#no-pension-savings-key > a").attr("href",RR.route("SAVINGS")+"#!pension")
}else{if(j===1){$("#expandable-pension").hide();
b.showKey(k.products.PENSION,j,"pension")
}else{$("#pension-savings-key").hide();
b.showKey(k.products.PENSION,j,"pension")
}}if(l===0){$("#no-isa-savings-key").removeClass("hidden");
$("#expandable-isa").hide();
$("#isa-savings-key").hide();
if(f===true){$("#no-isa-savings-key > a").attr("href",RR.route("SAVINGS")+"#!arcisa")
}else{$("#no-isa-savings-key > a").attr("href",RR.route("SAVINGS")+"#!isa")
}}else{if(l===1){$("#expandable-isa").hide();
b.showKey(k.products.ISA,l,"isa")
}else{$("#isa-savings-key").hide();
b.showKey(k.products.ISA,l,"isa")
}}if(i===0){$("#no-memo-savings-key").removeClass("hidden");
$("#expandable-memo").hide();
$("#memo-savings-key").hide();
$("#no-memo-savings-key > a").attr("href",RR.route("SAVINGS")+"#!memo")
}else{if(i===1){$("#expandable-memo").hide();
b.showKey(k.products.OTHER,i,"memo")
}else{$("#memo-savings-key").hide();
b.showKey(k.products.OTHER,i,"memo")
}}}};
this.init=function(i,j){this.initEvents();
if(b.params&&b.params.instanceName==="home"){this.getSavingProductsMap()
}this.responsiveVisuals();
this.navigatorButtons();
this.infoPanelActions();
this.noSavingLinks();
if(!RR.utils.isAuthor()){$(RR).on("headway:spinnerHidden",this.hideOrShowTabbedArea)
}if(window.platform.name==="IE"){$("header .btn-back").remove()
}};
this.initEvents=function(){$(RR).on("productSelectionRender",b.productSelection);
$(RR).on("dataRenderSelectors",b.renderSelectors);
$(RR).on("provideUserProducts",b.productConsolidation);
this.on(this.$el.find('[href="'+RR.route("CHANGE_FUND_ISA")+'"]'),"click",this.openSwitchFundISAPage);
this.on(this.$el.find('[href="'+RR.route("CHANGE_FUND_PENSION")+'"]'),"click",this.openSwitchFundPensionPage);
this.on(this.$el.find('[href*="'+RR.route("MANAGE_ISA_AMOUNT_REGULAR")+'"]'),"click",this.openManageIsaRegularAmountPage);
this.on(this.$el.find('[href*="'+RR.route("MANAGE_ISA_AMOUNT_ONE_OFF")+'"]'),"click",this.openManageIsaOneOffAmountPage);
$("#isaWPLink3").on("click",this.preventContribution);
$("#isaWPLink1").on("click",this.preventContribution);
$("#isaLink3").on("click",this.preventContribution);
$("#isaLink1").on("click",this.preventContribution);
this.on(this.$el.find('[href*="'+RR.route("SAVINGS_BENEFICIARIES")+'"]'),"click",this.openSavingBeneficiaries);
$(".no-savings .addmemoasset").click(b.openAddMemoAssetDialog);
this.arcIsaPanel()
};
this.preventContribution=function(k){k.preventDefault();
var j=$(this).attr("href");
var i=b.getSelectedProduct();
if(parseInt(i.nooftaxpayment,10)===1&&i.hasPayment==="true"){window.location=j
}else{if(parseInt(i.nooftaxpayment,10)===1&&i.hasPayment==="false"){$("#stop-contribution").modal("show")
}else{if(parseInt(i.nooftaxpayment,10)>1){$("#stop-contribution").modal("show")
}else{window.location=j
}}}};
this.arcIsaPanel=function(){$(".arcisa-details").find("tfoot .btn").on("click",function(){var i=$(this).attr("href");
$("a[href="+i+"]:first").parent().siblings().removeClass("active");
$("a[href="+i+"]:first").parent().addClass("active");
var j=$("a[href="+i+"]:first").text();
$("a[href='#tabButtons-arc']:first").find("h3").text(j)
});
$("#tabButtons-arc").find("a[data-toggle='tab']").on("click",function(){var i=$(this).text();
$("a[href='#tabButtons-arc']:first").find("h3").text(i)
})
};
this.openSavingBeneficiaries=function(i){i.preventDefault();
RR.url.redirect("SAVINGS_BENEFICIARIES",{productId:this.currentProductId})
};
this.openAddMemoAssetDialog=function(){if(RR.utils.isRegisteredProspect()){$(RR).trigger("renderLegacyMemoView",{})
}else{$(RR).trigger("renderMemoAssetModal",{type:"add"})
}};
this.openSwitchFundISAPage=function(i){if(i){i.preventDefault()
}RR.url.redirect("CHANGE_FUND_ISA",{productId:this.currentProductId})
};
this.openSwitchFundPensionPage=function(i){if(i){i.preventDefault()
}RR.url.redirect("CHANGE_FUND_PENSION",{productId:this.currentProductId})
};
this.openManageIsaRegularAmountPage=function(i){if(i){i.preventDefault()
}RR.url.redirect("MANAGE_ISA_AMOUNT_REGULAR",{productId:this.currentProductId})
};
this.openManageIsaOneOffAmountPage=function(i){if(i){i.preventDefault()
}RR.url.redirect("MANAGE_ISA_AMOUNT_ONE_OFF",{productId:this.currentProductId})
};
this.responsiveVisuals=function(){$(window).on("debouncedresize",function(){$("#stack-container-inner").trigger("stack:clear").trigger("stack:rerender")
});
var i=["#summaryLinks","#pensionLinks","#isaLinks","#memoAssetLinks"];
RR.utils.accordionArrowBehaviour(i,false);
RR.utils.accordionArrowBehaviour([".accordion-group"],true,true)
};
this.productConsolidation=function(l,k){if(k.userProducts){var j=b.getSelectedProduct();
j.type=k.userProducts[j.productId].type;
var m=false;
var i={};
$.each(k.userProducts,function(n,o){if(o.source==="WORKPLACE"&&o.type==="PENSION"){d=true
}if(o.source==="WORKPLACE"&&o.type==="ISA"){c=true
}if(d&&o.source==="RR"){h=true
}if(o.type===j.originalType&&o.source==="RR"){m=true;
i.productId=o.id;
i.assetId=j.productId;
i.assetSource=j.source
}});
if(d||h){if((j.source==="LEGACY"||j.source==="USER")&&j.originalType==="PENSION"){RR.url.redirect("SUPPORT")
}if(j.source==="USER"&&j.originalType==="ISA"){RR.url.redirect("NEW_COMPARISON_ISA")
}}else{if(c&&j.originalType==="ISA"){if(j.source==="USER"){RR.url.redirect("NEW_COMPARISON_ISA")
}}else{if(m&&!c){if(j.type==="ISA"){RR.url.redirect("ISA_WRAPPER",i)
}else{if(j.type==="PENSION"){RR.url.redirect("PENSION_WRAPPER",i)
}else{if(j.type==="OTHER"&&j.originalType==="PENSION"){RR.url.redirect("PENSION_WRAPPER",i)
}else{if(j.type==="OTHER"&&j.originalType==="ISA"){RR.url.redirect("ISA_WRAPPER",i)
}}}}}else{if(j.originalType==="ISA"){RR.url.redirect("NEW_CUSTOMER_ISA")
}else{if(j.originalType==="PENSION"){RR.url.redirect("NEW_CUSTOMER_PENSION")
}}}}}}};
this.getSelectedProduct=function(){var i=$("#savingsMenu li.active");
var j={name:i.find("a h3").html(),productId:i.attr("data-account-number"),value:i.attr("data-value"),type:i.attr("data-type"),source:i.attr("data-source"),element:i,originalType:i.attr("data-originalType"),nooftaxpayment:i.attr("data-nooftaxpayment"),hasPayment:i.attr("data-hasPayment")};
return j
};
this.infoPanelActions=function(){$("#memoAssetLinksAction li a").click(function(l){var m=$(this).attr("id");
if(m==="memoAssetLink3"){$(RR).trigger("uiNeedsUserProducts",{});
return
}var k=$(this).attr("data-target");
var j=$(k);
if(j.length){var i="";
if(k.indexOf("Update")>-1){i="update"
}else{if(k.indexOf("remove")>-1){i="remove"
}}$(RR).trigger("renderMemoAssetModal",{type:i})
}});
$("#legacyMemoDetails").click(function(i){$(RR).trigger("renderMemoAssetModal",{type:"update"})
})
};
this.noSavingLinks=function(){b.$el.find(".no-savings li").click(function(i){if(!$(this).hasClass("addmemoasset")){i.preventDefault();
$(RR).trigger("productSelection",{productId:$(this).data("account-number"),item:$(this).data("item")})
}})
};
this.navigatorButtons=function(){$("#navigatorForward").click(function(){$(RR).trigger("productSelection",{productId:$("#productSelctor .active").nextWrap().attr("data-account-number"),item:$("#productSelctor .active").nextWrap().attr("data-item")})
});
$("#navigatorBack").click(function(){$(RR).trigger("productSelection",{productId:$("#productSelctor .active").prevWrap().attr("data-account-number"),item:$("#productSelctor .active").prevWrap().attr("data-item")})
})
};
this.renderSelectors=function(j,i){$("#productSelctor").append('<li data-account-number="'+i.productId+'" data-item="'+i.item+'" id="selector-'+i.item+'"><span>'+i.name+"</span></li>");
$("#productSelctor li").click(function(){$(RR).trigger("productSelection",{productId:$(this).attr("data-account-number"),item:$(this).attr("data-item")})
})
};
this.hideOrShowTabbedArea=function(i){if(b.source==="RR"||b.source==="WORKPLACE"){$('div[data-component="tabbedArea"]').show()
}else{$('div[data-component="tabbedArea"]').hide()
}$(".key-links.with-changes li:last-child").removeClass("hidden")
};
this.productSelection=function(m,k){b.source=k.source;
$("#legacyMemoAssetMessage").addClass("hidden");
if(!RR.utils.isAuthor()){if(k.type==="total"||k.source==="RR"||b.source==="WORKPLACE"){$("#asOfDate-RR").show();
$("#asOfDate-Assets").hide();
if(k.type==="total"){$('div[data-component="tabbedArea"]').hide()
}else{$('div[data-component="tabbedArea"]').show()
}}else{$('div[data-component="tabbedArea"]').hide();
$("#asOfDate-RR").hide();
if(k.source!=="NA"){var l=k.effectiveDate&&k.effectiveDate.split(",")||"";
$("#asOfDate-Assets").show().find(".todaysDate").html(RR.utils.arrayToDateFormatted(l))
}}}b.$el.find(".information.isa-features").addClass("hidden");
b.$el.find(".information.pension-features").addClass("hidden");
b.$el.find(".information.arcisa-features").addClass("hidden");
b.$el.find(".information.product").removeClass("hidden");
b.$el.find(".no-savings").addClass("hidden");
b.$el.find(".in-last-6-months").show();
b.$el.removeClass("hideStackMobile");
$(".isa-details, .pension-details, .arcisa-details").addClass("hidden");
if(k.source==="NA"){var j=".information."+k.type+"-features";
var i="."+k.type+"-details";
b.$el.addClass("hideStackMobile");
b.$el.find(".information.product").addClass("hidden");
b.$el.find(j).removeClass("hidden");
$(i).removeClass("hidden")
}if(k.type==="total"){$("div.score-panel").show()
}else{$("div.score-panel").hide()
}$(".overview .product h2").html(k.title);
b.flipNumbers(k.value);
$("#productSelctor li").removeClass("active");
$("#selector-"+k.item).addClass("active");
if(k.type!=="total"&&k.source!=="USER"&&k.source!=="NA"){$("#account-number-wrapper").removeClass("hidden");
$("#account-number").html(k.productId)
}else{$("#account-number-wrapper").addClass("hidden")
}if(k.type==="total"){var n=$(".block-list-menu-advanced");
if(!n.hasClass("hasProducts")){b.$el.find(".no-savings").removeClass("hidden");
b.$el.addClass("hideStackMobile")
}else{if(n.hasClass("hasMemoAsset")&&!n.hasClass("hasPension")&&!n.hasClass("hasISA")){b.$el.find(".no-savings").removeClass("hidden");
b.$el.find(".in-last-6-months").hide()
}}}if(k.type==="pension"&&k.source!=="NA"&&k.source!=="WORKPLACE"){$(".info-panel").addClass("hidden");
$("#pensionLinks").removeClass("hidden")
}else{if(k.type==="pension"&&k.source==="WORKPLACE"){$(".info-panel").addClass("hidden");
$("#wppensionLinks").removeClass("hidden")
}else{if(k.type==="isa"&&k.source!=="NA"&&k.source!=="WORKPLACE"){$(".info-panel").addClass("hidden");
$("#isaLinks").removeClass("hidden")
}else{if(k.type==="isa"&&k.source==="WORKPLACE"){$(".info-panel").addClass("hidden");
$("#wpisaLinks").removeClass("hidden")
}else{if(k.type==="memoasset"&&k.source!=="NA"){$(".info-panel").addClass("hidden");
$("#memoAssetLinks").removeClass("hidden");
if(k.source==="USER"){$("#memoAssetLink1, #memoAssetLink2").parent().show();
$("#legacyMemoAssetMessage").addClass("hidden")
}else{$("#memoAssetLink1, #memoAssetLink2").parent().hide();
$("#legacyMemoAssetMessage").removeClass("hidden")
}}else{$(".info-panel").addClass("hidden");
$("#summaryLinks").removeClass("hidden")
}}}}}if(k.locked){$(".locked-icon").css("visibility","visible");
$(".locked-icon").attr("aria-hidden","false")
}else{$(".locked-icon").css("visibility","hidden");
$(".locked-icon").attr("aria-hidden","true")
}b.renderStack(m,k)
};
this.flipNumbers=function(j){var i=parseInt($("#widgetCounter").attr("data-maxlength"),10);
j=RR.utils.formatAmount(j,"B",false,"")||"0";
j=b.padString(" ",i,j.replace(/\B(?=(\d{3})+(?!\d))/g,","));
$(".flipboard-render").remove();
$.each(j.split("").reverse(),function(l,k){if(k===","){$("#widgetCounter").prepend('<div class="flipboard-render non-flipboard">&#44;</div>')
}else{if(k===" "){$("#widgetCounter").prepend('<div class="flipboard-render">&nbsp;</div>')
}else{$("#widgetCounter").prepend('<div class="flipboard-render"><span>'+k+"</span></div>")
}}});
$("#widgetCounter").prepend('<div class="flipboard-render non-flipboard">&#163;</div>');
$("#srNumericValue").html("&pound;"+j.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",").replace(" ",""))
};
this.padString=function(l,o,m){var k=m.split(",").length-1||0,p=o-m.length+k,j=[],n=0;
for(n;
n<p;
n++){j.push(l)
}j.push(m);
return j.join("")
};
this.roundToNearest=function(j,i){return j*(Math.round(i/j))
};
this.getStackPercentages=function(p,o){var q=0;
var j=[];
$.each(o,function(t,r){o[t]=b.roundToNearest(g,(r/p*100));
j[t]=o[t]-(r/p*100);
q=q+o[t]
});
var m=q-100;
if(m===-g){var n=0;
var l=0;
$.each(j,function(t,r){if(r<n){l=t;
n=r
}});
o[l]=o[l]+g
}if(m===g){var i=100;
var k=0;
$.each(j,function(t,r){if(r<i){k=t;
i=r
}});
o[k]=o[k]-g
}return o
};
this.renderStack=function(p,l){var n=b.getStackPercentages(l.total,[l.pension,l.isa,l.memoasset]);
var o=n[0],k=n[1],j=n[2],m=b.roundToNearest(g,l.value/l.total*100);
var i=$("#stack-container-inner");
if(m===0&&l.value>0){m=1
}this.currentProductId=l.productId;
if($.trim($("#stack-container-inner").html()).length===0){$("#stack-container-inner").Stack({hasContainer:true,animation:true,stripeAt:g,stacks:[{percentage:j,primaryColor:"#36578c",secondaryColor:"#36578c",label:"Assets"},{percentage:k,primaryColor:"#199b88",secondaryColor:"#199b88",label:"Retireready ISA"},{percentage:o,primaryColor:"#6ed69f",secondaryColor:"#6ed69f",label:"Retireready Pension"}]})
}if(l.type==="total"){i.trigger("stack:clear");
i.trigger("stack:percentage",[100,0,j]);
i.trigger("stack:percentage",[100,1,k]);
i.trigger("stack:percentage",[100,2,o]);
i.trigger("stack:render","#bbb")
}else{if(l.type==="pension"){i.trigger("stack:clear");
i.trigger("stack:percentage",[100,0,0]);
i.trigger("stack:percentage",[100,1,0]);
i.trigger("stack:percentage",[100,2,m]);
i.trigger("stack:render","#6ed69f")
}else{if(l.type==="isa"){i.trigger("stack:clear");
i.trigger("stack:percentage",[100,0,0]);
i.trigger("stack:percentage",[100,1,m]);
i.trigger("stack:percentage",[100,2,0]);
i.trigger("stack:render","#199b88")
}else{if(l.type==="memoasset"&&l.source==="USER"){i.trigger("stack:clear");
i.trigger("stack:percentage",[100,0,m]);
i.trigger("stack:percentage",[100,1,0]);
i.trigger("stack:percentage",[100,2,0]);
i.trigger("stack:render","#36578c")
}else{if(l.type==="memoasset"&&l.source==="LEGACY"){i.trigger("stack:clear");
i.trigger("stack:percentage",[100,0,0]);
i.trigger("stack:percentage",[100,1,0]);
i.trigger("stack:percentage",[100,2,m]);
i.trigger("stack:render","#6ed69f")
}else{if(l.type==="none"){i.trigger("stack:clear");
i.trigger("stack:percentage",[100,0,0]);
i.trigger("stack:percentage",[100,1,0]);
i.trigger("stack:percentage",[100,2,0]);
i.trigger("stack:render","#bbb")
}}}}}}};
this.showKey=function(l,j,i){var k;
if(j>1){$.each(l,function(m,n){k=$("li.accordian-"+i+"-link.source").after($("li.accordian-"+i+"-link.source").clone());
k.removeClass("source").find("a").attr("href",RR.route("SAVINGS")+"#!"+n.id);
k.removeClass("source").find("a span:first").text(n.name)
});
$("li.accordian-"+i+"-link.source").addClass("hidden")
}else{$("#"+i+"-savings-key > a").attr("href",RR.route("SAVINGS")+"#!"+l[0].id)
}}
});
RR.components.securityCheck=RR.defineComponent(function(){var a=["n/a","first","second","third","fourth","fifth","sixth","seventh","eighth","ninth","tenth","eleventh","twelfth","thirteenth","fourteenth","fifteenth"];
this.init=function(){this.closed=true;
this.attempts=0;
this.clicks=0;
this.id=this.$el.attr("id");
this.$inputs=[];
this.$inputs.push($("#"+this.id+"-sc1"));
this.$inputs.push($("#"+this.id+"-sc2"));
this.$inputs.push($("#"+this.id+"-sc3"));
this.on($("#"+this.id+"-action-continue-btn"),"click",this.submit);
_.each(this.$inputs,function(b){this.on(b,"focusout",this.validate)
},this);
this.on("hide",this.close);
this.on(RR,"uiStartSecurityCheck",this.startSecurityCheck)
};
this.startSecurityCheck=function(f,d){var b=this;
var c=RR.session("email");
if(d.guid&&this.closed&&c){this.closed=false;
this.owner=d.guid;
this.getSecurityCharacters(c).done(function(g,e){if(g===200){b.$el.find("#"+b.id+"-too-many-times").hide();
b.$el.find("#"+b.id+"-action-continue-btn").show();
b.$el.find("form").show();
b.securityCheckDetails=e;
b.renderSecurityCheckLabel(e);
b.reset()
}else{if(g===403){b.$el.find("#"+b.id+"-too-many-times").show();
b.$el.find("#"+b.id+"-action-continue-btn").hide();
b.$el.find("form").hide()
}}b.$el.modal("show")
})
}};
this.getSecurityCharacters=function(b){if(!this.securityCheckDetails){var c=new RR.api.Customer(b);
return c.securityCheck()
}else{var e=$.Deferred();
if(this.attempts===3){e.resolve(403,this.securityCheckDetails)
}else{e.resolve(200,this.securityCheckDetails)
}return e
}};
this.setSecurityCharacters=function(c,b){var d=new RR.api.Customer(c);
return d.securityCheck(b)
};
this.renderSecurityCheckLabel=function(b){$("#"+this.id+"-character1").html(a[b.character1]);
$("#"+this.id+"-character2").html(a[b.character2]);
$("#"+this.id+"-character3").html(a[b.character3]);
$("#"+this.id+"-sc1-label").html(a[b.character1]+" character");
$("#"+this.id+"-sc2-label").html(a[b.character2]+" character");
$("#"+this.id+"-sc3-label").html(a[b.character3]+" character")
};
this.reset=function(){this.clicks=0;
_.each(this.$inputs,function(b){b.val("")
},this);
RR.plugins.form.clearError(this.$inputs[0])
};
this.close=function(){this.closed=true
};
this.validate=function(){this.clicks=this.clicks<3?this.clicks+1:3;
if((!this.$inputs[0].val()||!this.$inputs[1].val()||!this.$inputs[2].val())&&this.clicks===3){RR.plugins.form.setError(this.$inputs[0],null,"Please complete all three fields.",true);
return false
}else{RR.plugins.form.clearError(this.$inputs[0]);
return true
}};
this.submit=function(f){f.preventDefault();
var b=this;
var d=RR.session("email");
var c=this.securityCheckDetails;
this.clicks=3;
if(this.validate()){c.answer1=this.$inputs[0].val();
c.answer2=this.$inputs[1].val();
c.answer3=this.$inputs[2].val();
this.setSecurityCharacters(d,this.securityCheckDetails).done(function(e){var g="three more attempts";
if(e===200){b.notifyOwner();
b.securityCheckDetails=null;
b.attempts=0
}else{if(e===406){b.attempts++;
if(b.attempts===1){g="two more attempts"
}else{if(b.attempts===2){g="one more attempt"
}}RR.plugins.form.setError(b.$inputs[0],null,"You entered the wrong details. Please try again. You have "+g+".",true);
$("#forgotten-memorable-word-link").removeClass("hidden")
}else{if(e===403){$(RR).trigger("navigateAwayModal:deactivate");
window.location=RR.route("ACCOUNT_LOCKED")
}}}})
}return false
};
this.notifyOwner=function(){this.$el.modal("hide");
this.trigger(RR,"uiSecurityCheckCompleted",{guid:this.owner})
}
});
RR.components.riskProfileResult=RR.defineComponent(function(){this.init=function(){if(!RR.utils.isAuthor()){var a="CustomerDetails";
this.rendered=false;
$(RR).on("data"+a,$.proxy(this.populate,this));
$(RR).trigger("uiNeeds"+a)
}else{$(".risk-description").removeClass("hidden")
}};
this.updateFunction=function(a){$(".risk-description").addClass("hidden");
$("#risk-description-"+a).removeClass("hidden");
RR.pages.RISK_PROFILE_RESULTS.currentRisk=a
};
this.getMonthNameFromInt=function(b){var a=["January","February","March","April","May","June","July","August","September","October","November","December"];
return a[b]
};
this.populate=function(f,d){if(!this.rendered&&d){if(_.isObject(d.latestRiskScore)){var c=d.latestRiskScore.score;
var b=new Date(d.latestRiskScore.created);
var g=b.getDate();
var a=this.getMonthNameFromInt(b.getMonth());
var i=b.getFullYear();
var h={day:g,month:a,year:i};
$("#sliderRail1").attr("data-startValue",c);
$("#riskProfileContainer").addClass("indicator-"+c);
$(".selection-info").attr("class","selection-info");
$(".selection-info").html($(".selection-info").html().replace("{placeholder}","<span id='riskDesc'></span>"));
$("#riskDesc").html($(".risk-color-"+c).attr("descriptive-text"));
$(".selection-info").addClass("risk-"+c);
$("#risk-description-"+c).removeClass("hidden");
$("[name=lastRiskAssessmentMessage]").each(function(){var e=$(this).html();
$(this).html(_.template(e,h))
});
RR.plugins.ARIA_SLIDER.init(this.updateFunction);
this.rendered=true
}else{$("#risk-description-0").removeClass("hidden");
$(".risk-profiler .selection-info").addClass("risk-0").html($(".selection-info").html().replace("{placeholder}","<span>"+$(".risk-color-0").html()+"</span>"))
}}}
});
RR.components.apiForm=RR.defineComponent(function(){var a,b,f=$("#confirm-change-email .modal-body .email"),c=f.html();
var d="Y";
var g="N";
var i="Y";
var h="N";
var e="N";
this.init=function(){this.type=this.params.type;
if(RR.session("email")){switch(this.type){case"customerDetails":this.initCustomerDetailsForm();
break;
case"customerSecurityQuestions":this.customerSecurityQuestionsFormInit();
break;
case"customerSecurityPassword":this.customerSecurityPasswordFormInit();
break;
case"customerMemorableWord":this.customerMemorableWordFormInit();
break;
case"isaOut":this.isaOutFormInit();
break;
case"goalsDetails":this.goalsFormInit();
break;
default:break
}}};
this.customerSecurityQuestionsFormInit=function(){var k=this.$el.find("[name^=question]");
var m=this.$el.find("[name^=answer]");
var j=k.first().find("option");
var l=[];
j.each(function(n){if(n!==0&&n!==j.length-1){l[$(this).val().replace(" ","")]=null
}});
this.on("uiCancelAction",this.resetSecurityQuestionFields);
k.each(function(p){var o=p+1;
var n=$(this);
var q=$("[name='userQuestion"+o+"']");
n.attr("data-rr-val",$(this).val());
n.on("change focusout",function(){var t=$(this).val();
var r=$(this).attr("data-rr-val");
if(t===$(this).find("option").last().val()){t=""
}if(t){k.filter("[name!='"+$(this).attr("name")+"']").find("option[value='"+t+"']").remove()
}if(r!==t&&r){k.filter("[name!='"+$(this).attr("name")+"']").find("option:eq(0)").after(j.filter("option[value='"+r+"']").clone())
}$(this).attr("data-rr-val",t)
})
});
m.on("focusout keyup",function(){$(this).siblings(".confirm-icon").remove();
$(this).removeClass("confirm-input");
if(!$(this).closest(".control-group").hasClass("error")){if($(this).val().length>=5){$(this).addClass("confirm-input");
$(this).after('<div class="confirm-icon"><span aria-hidden="false">Confirmed</span><span class="ico" aria-hidden="true">&#xf707;</span></div>')
}}});
this.$el.parsley("addListener",{onFormSubmit:$.proxy(this.customerSecurityQuestionsFormSubmit,this)})
};
this.resetSecurityQuestionFields=function(){$("[name=answer1]").val("");
$("[name=answer1]").siblings(".confirm-icon").remove();
$("[name=answer1]").removeClass("confirm-input");
$("[name=answer2]").val("");
$("[name=answer2]").siblings(".confirm-icon").remove();
$("[name=answer2]").removeClass("confirm-input");
$("[name=answer3]").val("");
$("[name=answer3]").siblings(".confirm-icon").remove();
$("[name=answer3]").removeClass("confirm-input");
$("#question1").val("");
$("#question2").val("");
$("#question3").val("");
$("#security-questions-form").parsley("reset")
};
this.customerSecurityQuestionsFormSubmit=function(p,o){o.preventDefault();
var k=this;
var m={};
var j=this.$el.find("[name^=question]");
var l=RR.session("email");
var n=new RR.api.Customer(l);
if(p&&l){m.securityQuestions=[];
j.each(function(r){var q=r+1;
var t={};
if($(this).val()!==$(this).find("option").last().val()){t.question=$(this).find("option[value='"+$(this).val()+"']").text();
t.answer=$("[name='answer"+q+"']").val()
}else{t.question=$("[name='userQuestion"+q+"']").val().trim();
t.answer=$("[name='answer"+q+"']").val().trim()
}m.securityQuestions.push(t)
});
n.securityQuestions(m).done(function(q){if(q===200){$("[name=answer1]").val("");
$("[name=answer1]").siblings(".confirm-icon").remove();
$("[name=answer1]").removeClass("confirm-input");
$("[name=answer2]").val("");
$("[name=answer2]").siblings(".confirm-icon").remove();
$("[name=answer2]").removeClass("confirm-input");
$("[name=answer3]").val("");
$("[name=answer3]").siblings(".confirm-icon").remove();
$("[name=answer3]").removeClass("confirm-input");
$("#question1").val("");
$("#question2").val("");
$("#question3").val("");
$("#security-questions-form").parsley("reset");
k.trigger("uiFormSubmitted");
$("#security-questions-updated").modal("show")
}})
}};
this.customerSecurityPasswordFormInit=function(){RR.plugins.PASSWORD_CREATION.validatePassword();
this.on("uiCancelAction",this.resetPasswordFields);
this.$el.parsley("addListener",{onFormSubmit:$.proxy(this.customerSecurityPasswordFormSubmit,this)})
};
this.customerSecurityPasswordFormSubmit=function(o,n){n.preventDefault();
var j=this;
var k=RR.session("email");
var m=new RR.api.Customer(k);
var l=RR.plugins.PASSWORD_CREATION.validatePassword(true);
if(l&&o){m.securityPassword({oldPassword:$("#old-password-field").val(),newPassword:$("#password-field").val(),confirmNewPassword:$("#confirm-password-field").val()}).done(function(p){if(p===200){$("#old-password-field").val("");
$("#password-field").val("");
$("#confirm-password-field").val("");
$("#change-password").parsley("reset");
$("#password-length").removeClass("complete");
$("#password-length span").html("");
$("#password-contain-number").removeClass("complete");
$("#password-contain-number span").html("");
$("#password-mixed-case").removeClass("complete");
$("#password-mixed-case span").html("");
$("#confirm-password-field").siblings(".confirm-icon").hide();
j.trigger("uiFormSubmitted");
j.showSuccessPasswordModal()
}else{if(p===406){RR.plugins.form.setError("#old-password-field",null,"The password provided is incorrect.")
}}})
}j.reset();
return false
};
this.resetPasswordFields=function(){$("#old-password-field").val("");
$("#password-field").val("");
$("#confirm-password-field").val("");
$("#change-password").parsley("reset");
$("#password-length").removeClass("complete");
$("#password-length span").html("");
$("#password-contain-number").removeClass("complete");
$("#password-contain-number span").html("");
$("#password-mixed-case").removeClass("complete");
$("#password-mixed-case span").html("");
$("#confirm-password-field").siblings(".confirm-icon").hide()
};
this.customerMemorableWordFormInit=function(){this.on("uiCancelAction",this.resetMemorableWord);
this.$el.parsley("addListener",{onFormSubmit:$.proxy(this.customerMemorableWordFormSubmit,this)})
};
this.resetMemorableWord=function(){$("#memorableWord").val("");
$("#memorable-word-form").parsley("reset")
};
this.customerMemorableWordFormSubmit=function(n,m){m.preventDefault();
var j=this;
var k=RR.session("email");
var l=new RR.api.Customer(k);
if(n){l.securityChangeMemorableWord({memorableWord:$("#memorableWord").val()}).done(function(o){if(o===200){$("#memorableWord").val("");
$("#memorable-word-form").parsley("reset");
j.trigger("uiFormSubmitted");
$("#memorable-word-updated").modal("show")
}})
}return false
};
this.customerDetailsFormMarketingChannels=["email","post","sms","phone"];
this.initCustomerDetailsFormWithEmailAddressForm=function(){if(this.$el.find("[name=change-email-button]").length){var j=this.$el.find("[name=emailAddressConfirm]");
this.hasEmailAddressFields=true;
this.hideEmailAddressFields();
j.on("paste",function(k){k.preventDefault()
});
this.on(this.$el.find("[name=change-email-button]"),"click",this.onClickChangeEmailAddressButton)
}};
this.initCustomerDetailsFormWithMarketingPreferencesField=function(){if(this.$el.find("[data-id=marketingPreferencesField]").length){this.hasMarketingPreferencesField=true;
this.marketingPreferencesFieldName=this.$el.find("[data-id=marketingPreferencesField]").data("name");
this.on(this.customerDetailsFormMarketingChannelCheckBox("email").closest("label"),"click",this.toggleMarketingPreferencesCheckBoxes)
}};
this.customerDetailsFormMarketingChannelCheckBox=function(j){return this.$el.find("[name='"+this.marketingPreferencesFieldName+"."+j+"']")
};
this.customerDetailsFormEnableMarketingChannelCheckBox=function(j){this.customerDetailsFormMarketingChannelCheckBox(j).prop("disabled",false).parent().removeClass("disabled")
};
this.customerDetailsFormDisableMarketingChannelCheckBox=function(j){this.customerDetailsFormMarketingChannelCheckBox(j).prop("disabled",false).prop("checked",false).prop("disabled",true).parent().addClass("disabled")
};
this.toggleMarketingPreferencesCheckBoxes=function(){var j=_.without(this.customerDetailsFormMarketingChannels,"email");
if(this.$el.find("[name='"+this.marketingPreferencesFieldName+".email']").prop("checked")){_.each(j,this.customerDetailsFormEnableMarketingChannelCheckBox,this)
}else{_.each(j,this.customerDetailsFormDisableMarketingChannelCheckBox,this)
}};
this.hideEmailAddressFields=function(){var k=this.$el.find("[name=change-email-button]");
var j=this.$el.find("[name=emailAddress]");
var l=this.$el.find("[name=emailAddressConfirm]");
k.show();
j.prop("disabled",true);
l.closest(".control-group").hide();
this.$el.find(".alert").hide()
};
this.displayEmailAddressFields=function(m,l){if(l.guid===this.guid){var k=this.$el.find("[name=change-email-button]");
var j=this.$el.find("[name=emailAddress]");
var n=this.$el.find("[name=emailAddressConfirm]");
k.hide();
j.prop("disabled",false);
n.closest(".control-group").show();
this.$el.find(".alert").show();
j.focus()
}};
this.onClickChangeEmailAddressButton=function(k){var j={guid:this.guid};
if(RR.utils.isRegisteredProspect()){this.displayEmailAddressFields({},j)
}else{$(RR).trigger("uiStartSecurityCheck",j);
this.on(RR,"uiSecurityCheckCompleted",this.displayEmailAddressFields)
}return false
};
this.reset=function(){if(this.hasEmailAddressFields){this.hideEmailAddressFields()
}this.newEmailAddress=null;
RR.components.object2form(this.$el,this.data)
};
this.initPhoneFieldsGroup=function(){var j=this;
var k=this.$el.find("[data-onenotempty=phone]");
if(k.length){this.hasPhoneFields=true;
k.each(function(l,m){$(m).on("change focusout keyup",function(){j.validatePhoneFieldsGroup()
})
})
}};
this.validatePhoneFieldsGroup=function(){var j=this;
var k=this.$el.find("[data-onenotempty=phone]");
var l=0;
k.each(function(m,n){if($(n).parsley("isValid")===null){l++
}});
if(l===k.length){this.validatePhoneFieldsFailed=true;
k.each(function(m,n){RR.plugins.form.setError(n,"nophonenumber","You need to enter at least one phone number.",1)
});
return false
}else{if(this.validatePhoneFieldsFailed===true){k.each(function(m,n){RR.plugins.form.clearError(n)
});
this.validatePhoneFieldsFailed=false
}return true
}};
this.removeBankDetails=function(j){if(_.isEmpty(j.bankDetails)){return j
}if(j.bankDetails&&j.bankDetails[0]&&j.bankDetails[0].accountNumber&&j.bankDetails[0].accountNumber.length>0){j.bankDetails[0].starredAccountNumber=_.clone(j.bankDetails[0].accountNumber);
j.bankDetails[0].starredSortCode=_.clone(j.bankDetails[0].sortCode)
}j.bankDetails[0].accountNumber="";
j.bankDetails[0].sortCode[0]="";
j.bankDetails[0].sortCode[1]="";
j.bankDetails[0].sortCode[2]="";
return j
};
this.initCustomerDetailsForm=function(){var q=this;
var o=RR.session("email");
var m=new RR.api.Customer(o);
var j=new RR.api.BankDetails();
this.initCustomerDetailsFormWithEmailAddressForm();
this.initCustomerDetailsFormWithMarketingPreferencesField();
this.initPhoneFieldsGroup();
this.isEmailChangeConfirmed=false;
var k="";
var p="";
var n="";
var v="N";
var u="N";
var r="";
var t="";
var l="";
$(RR).on("dataCustomerDetails",function(x,w){q.data=q.removeBankDetails(w);
if(!w.bankDetails||!w.bankDetails[0]){e="Y"
}RR.components.object2form(q.$el,q.data);
q.toggleMarketingPreferencesCheckBoxes()
});
$("#employment-details-amend-button").click(function(){v="Y";
k=$("#salaryDropdown option:selected").val();
p=$("#employmentStatusDropdown option:selected").val();
n=$("#industryDropdown option:selected").val()
});
$("#contact-details-amend-button").click(function(){u="Y";
r=$("#homePhone_id").val();
t=$("#workPhone_id").val();
l=$("#mobilePhone_id").val()
});
$("#contact-details-save-button").click(function(){v="N";
u="Y"
});
$("#employment-status-cancel-button").click(function(){v="N"
});
$("#contact-details-cancel-button").click(function(){u="N"
});
q.on("uiCancelAction",this.reset);
$("#employment-status-save-button").click(function(){v="Y";
u="N"
});
q.$el.parsley("addListener",{onFormSubmit:function(B,A){if(B){var y;
d="Y";
g="N";
i="N";
h="N";
if(q.hasPhoneFields&&!q.validatePhoneFieldsGroup()){return false
}var x=RR.components.form2object(q.$el,null,null,true);
if(!x){x={}
}if(!q.isEmailChangeConfirmed&&x.emailAddressConfirm){var D=RR.session("email");
var C=q.$el.find("[name=emailAddress]").val();
if(D!==C){var z=m.search({policyNumberOrEmail:C});
z.done(function(E){if(E===200){$(RR).trigger("hideProcessingButton");
RR.plugins.form.setError(q.$el.find("[name=emailAddress]"),"","Provided email address is already in use")
}else{$("#confirm-change-email .actionButton").off("click").on("click",function(){q.isEmailChangeConfirmed=true;
q.hideEmailAddressFields();
q.$el.submit()
});
$("#confirm-change-email .cancelButton").off("click").on("click",function(){$(RR).trigger("hideProcessingButton")
});
f.html(_.template(c,{email:C}));
$("#confirm-change-email").modal()
}})
}return false
}if(x.hasOwnProperty("industryOther")){if(x.industryOther){x.industry=x.industryOther
}delete x.industryOther
}if(x.hasOwnProperty("emailAddressConfirm")){if(x.emailAddress!==q.data.emailAddress){q.newEmailAddress=x.emailAddress
}delete x.emailAddressConfirm
}if(x.hasOwnProperty("emailAddress")){delete x.emailAddress
}if(x.industry===n&&x.employmentStatus===p&&x.salary===k){g="N"
}else{g="Y"
}if(x.homePhone===r&&x.workPhone===t&&x.mobilePhone===l&&q.isEmailChangeConfirmed===false){h="N"
}else{h="Y"
}if(x.bankDetails&&x.bankDetails[0]&&x.bankDetails[0].accountNumber.length>0){d="N";
q.bankDetails=RR.api.BankDetails();
j.validate({accountNumber:x.bankDetails[0].accountNumber,sortCode:[x.bankDetails[0].sortCode[0],x.bankDetails[0].sortCode[1],x.bankDetails[0].sortCode[2]]}).done(function(E,F){if(E===200&&F.bankDetailsValid===true){d="Y";
var G=q.customerDetailsFormSave(x,q.data)
}else{d="N";
RR.plugins.form.setError("[name='bankDetails[0].accountNumber']","invalidbankdetails","The bank details provided are invalid.",1);
return false
}})
}if((d==="Y"&&g==="Y"&&v==="Y")||(d==="Y"&&h==="Y"&&u==="Y")||(d==="Y"&&v==="N"&&u==="N")){i="Y"
}if(i==="Y"){var w=q.customerDetailsFormSave(x,q.data)
}q.isEmailChangeConfirmed=false;
g="N";
v="N";
h="N";
u="N"
}return false
}})
};
this.goalsFormInit=function(){var j=this;
var k=RR.api.Goals();
$(RR).trigger("uiNeedsGoalsDetails");
$(RR).on("dataGoalsDetails",function(m,l){j.data=l;
if(l.taxFreeLumpSum){l.taxFreeLumpSum="true"
}else{l.taxFreeLumpSum="false"
}RR.components.object2form(j.$el,j.data)
});
j.on("uiCancelAction",function(){$("#yourGoals").show();
$("#goalsSetting").hide();
this.reset()
});
j.$el.parsley("addListener",{onFormSubmit:function(o,n){if(o){var l=$('[name="personalDetails.retirementAge"]');
var m=l.val();
var p=RR.components.form2object(j.$el,"personalDetails",null,true);
if(p.taxFreeLumpSum==="true"){p.taxFreeLumpSum=true
}else{p.taxFreeLumpSum=false
}p.retirementAge=m;
if(!p){p={}
}j.goalsDetailsFormSave(p)
}return false
}})
};
this.goalsDetailsFormSave=function(l){var j=this;
var k=RR.api.Score();
k.postGoalsDetails(l).done(function(m,o){if(m===200){var n=k.triggerUpdate(RR.api.SCORE_CONSTANTS.UPDATE_PROFILE);
n.always(function(q,r,p){j.data=l;
j.$el.trigger("uiFormSubmitted",l);
j.showSuccessModal(l)
})
}})
};
this.isaOutFormInit=function(){var j=this;
var l=RR.url.parameter("productId");
var n=new RR.api.Product(l);
$(RR).on("uiSecurityCheckCompleted",$.proxy(this.submit,this));
n.get().done(function(u,r){if(u===200){a=r;
var q=r.value;
var p=$("#isa-withdrawal-rules");
var x=p.html();
var w={value:RR.utils.formatStringAsCurrency(q,"&pound;")};
p.html(_.template(x,w));
var t=$("#isa-value");
var y=t.html();
b=q*0.99;
$("[name=amount]").parsley("addConstraint",{maxwithdrawal:b});
var v={value:RR.utils.formatStringAsCurrency(b,"&pound;")};
t.html(_.template(y,v));
if(r.regularWithdrawal){$("[name=amount]").val(r.regularWithdrawal.amount);
$("[name=paymentFrequency]").val(r.regularWithdrawal.frequency);
$("[name=paymentFrequency]").val("").prop("selected",true);
$("#secondaryAction2").on("click",function(){$("#isaCancelModal").modal("show")
});
$("#startDate-outer").show()
}else{$("#secondaryAction2").hide()
}}});
$("#paymentFrequency").on("change",function(){$("#startDate-outer").show();
var p=RR.utils.calculatePaymentMonthForMoneyOut()+1;
$("[name=startDate]").val(p).prop("selected",true)
});
$("#form-button2").bind("click",function(){window.location=RR.route("BASIC_PROFILE")
});
$(RR).on("dataCustomerDetails",function(r,q){j.data=q;
var p=q.bankDetails;
if(p[0]===null||p[0]===undefined){$("#form-button2").removeClass("hidden");
$("#secondary-form-actions").addClass("hidden");
$(".form-panel-fieldset").addClass("hidden")
}else{$("#form-button").removeClass("hidden")
}});
j.on("uiCancelAction",this.reset);
j.$el.parsley("addListener",{onFormSubmit:$.proxy(this.startSecurityCheck,this)});
var k=new Date();
if(k.getMonth()===11){k=new Date(k.getFullYear()+1,1)
}var o=[];
var m=[];
this.$el.find("[name=startDate] option").each(function(){var q=$(this).clone();
$(this).remove();
if(q.val()){var p=k.getYear()+1900;
if(Number(q.val())<RR.utils.calculatePaymentMonthForMoneyOut()+1){p+=1;
q.html(q.html()+" "+p);
m.push(q)
}else{q.html(q.html()+" "+p);
o.push(q)
}}});
this.$el.find("[name=startDate]").append(o);
this.$el.find("[name=startDate]").append(m);
$(RR).trigger("uiNeedsDataCustomerDetails")
};
this.extractTransferData=function(){var j=null;
var m=RR.components.form2object(this.$el);
var k;
if(m.startDate){k=m.startDate
}else{k=RR.utils.calculatePaymentMonthForMoneyOut()+1
}try{if(this.params.type==="oneoff"){j={percentage:false,amount:Number(m.amount),operation:"single"}
}else{if(a.regularWithdrawal){j={percentage:false,oldAmount:Number(a.regularWithdrawal.amount),oldFrequency:a.regularWithdrawal.frequency,amount:Number(m.amount),operation:"regular",frequency:m.paymentFrequency,startMonth:Number(k),id:a.regularWithdrawal.id,availableBalance:b}
}else{j={percentage:false,amount:Number(m.amount),operation:"regular",frequency:m.paymentFrequency,startMonth:Number(k),availableBalance:b}
}}}catch(l){}j.productId=RR.url.parameter("productId");
return j
};
this.startSecurityCheck=function(k,j){if(k){$(RR).trigger("uiStartSecurityCheck",{guid:this.guid})
}return false
};
this.submit=function(l,k){if(k.guid===this.guid){var j=this.extractTransferData();
if(j){RR.session("transferOut",j).done(function(){RR.url.redirect("MANAGE_ISA_FUNDS_CONFIRM")
})
}else{}}};
this.customerDetailsFormSave=function(k,m){var j=this;
var l=RR.session("email");
var n=new RR.api.Customer(l);
if(j.hasMarketingPreferencesField){_.each(this.customerDetailsFormMarketingChannels,function(o){if(!k[this.marketingPreferencesFieldName].hasOwnProperty(o)){k[this.marketingPreferencesFieldName][o]=false
}else{k[this.marketingPreferencesFieldName][o]=true
}},this)
}_.each(k,function(p,o){if(k[o]!==undefined&&_.isEmpty(k[o])){k[o]=null
}});
if(e==="Y"){n.details(k).done(function(o){if(o===200){$(RR).trigger("hideProcessingButton");
if(j.newEmailAddress){j.customerDetailsFormSaveNewEmailAddressAndLogout(j.newEmailAddress)
}else{j.data=k;
j.$el.trigger("uiFormSubmitted",k);
j.showSuccessModal(k);
RR.components.object2form(j.$el,j.removeBankDetails(k))
}return o
}})
}else{n.details(k,m).done(function(o){if(o===200){$(RR).trigger("hideProcessingButton");
if(j.newEmailAddress){j.customerDetailsFormSaveNewEmailAddressAndLogout(j.newEmailAddress)
}else{j.data=k;
j.$el.trigger("uiFormSubmitted",k);
j.showSuccessModal(k);
RR.components.object2form(j.$el,j.removeBankDetails(k))
}return o
}})
}};
this.isaWithdrawalFormSubmit=function(l){var j=this;
var k=RR.url.parameter("productId");
var m=new RR.api.Product(k);
m.transferOut(l).done(function(n){if(n===200){if(j.newEmailAddress){j.customerDetailsFormSaveNewEmailAddressAndLogout(j.newEmailAddress)
}else{j.data=l;
j.$el.trigger("uiFormSubmitted",l)
}}})
};
this.customerDetailsFormSaveNewEmailAddressAndLogout=function(k){var j=this;
j.customerDetailsFormSaveNewEmailAddress(j.newEmailAddress).done(function(){j.customerDetailsFormLogout("CHANGE_YOUR_USERNAME")
})
};
this.customerDetailsFormSaveNewEmailAddress=function(j){var k=RR.session("email");
var l=new RR.api.Customer(k);
var m=$.Deferred();
l.securityChangeUsernameNotify({username:j,confirmUsername:j}).done(function(n){if(n===200){m.resolve()
}else{m.reject()
}}).fail(function(){m.reject()
});
return m
};
this.customerDetailsFormLogout=function(l){l=l||"HOME_SIGNED_OUT";
var j=RR.session("email");
var k=new RR.api.Customer(j);
k.logout().done(function(m){if(m===200){RR.url.redirect(l)
}})
};
this.showSuccessModal=function(j){if(this.params.type==="goalsDetails"){$("#goals-details-updated").modal("show")
}if(j.bankDetails){$("#bank-details-updated").modal("show")
}else{if(j.employmentStatus){$("#employment-updated").modal("show")
}else{if(j.emailAddress){$("#contact-details-updated").modal("show")
}}}};
this.showSuccessPasswordModal=function(){$("#password-details-updated").modal("show")
}
});
RR.components.tabbedArea=RR.defineComponent(function(){var a=this;
this.init=function(b,c){this.initEvents(a.$el)
};
this.initEvents=function(b){$(RR).on("productSelectionRender",a.updateDate);
b.find(".panel.border-gray-dark.background-flat-top li").click(function(d){b.find(".accordion-toggle h3").html($(this).find("a").html());
try{$(RR).trigger("analyticsevent",{event:("Tab-"+$(this).find("a").html())})
}catch(c){}})
};
this.updateDate=function(g,d){var b=localStorage.getItem("multipleFunds");
if(d.type==="pension"||d.type==="isa"){if(b==="true"){$("#tab04HeaderButton").trigger("click");
localStorage.removeItem("multipleFunds")
}var c="<span>"+$("span.todaysDate").html()+"</span>";
var f=$("h3.selected-date").html($("h3.selected-date").html().replace("{{todaysDate}}",c))
}if(d.target==="fundActivityBreakdown"){$("h3.selected-date span").html(RR.utils.stringToDateFormatted(d.singleDate))
}}
});
RR.components.datepicker=RR.defineComponent(function(){var a=this;
this.populateDate=function(e){var d=$(e),h=d.attr("class"),b=["day","month","year"],g,f,c;
_.each(b,function(i){if(a.$el.find(".select-"+i).val().toLowerCase()!=="na"){a[i]=a.$el.find(".select-"+i).val()
}else{a[i]=""
}});
if(this.day&&this.month&&this.year){g=[this.year,this.month-1,this.day];
f=window.moment(g).isValid();
c=window.moment().isBefore(window.moment(g));
if(f===true&&c===false){a.$dateElement.val(window.moment(g).format("YYYY-MM-DD")).trigger("change",{validDateSet:true});
_.each(b,function(i){a[i]=""
})
}else{a.$dateElement.val("");
a.dynamicErrorMessage(a.$dateElement,"date is invalid")
}}else{if(a.$dateElement.is(":visible")===false){a.$dateElement.val("");
a.dynamicErrorMessage(a.$dateElement,"date is required")
}}};
this.dynamicErrorMessage=function(d,e){var c=e.replace(/\w\S*/g,function(f){return f.charAt(0).toUpperCase()+f.substr(1).toLowerCase()
}),b;
if(this.prefix){b=this.prefix+" "+e+". "
}else{b=c+". "
}if(this.$el.closest('[data-component="rangeFilter"]').length>0){if(d.data("required-message")!==b){a.$dateElement.parsley().updateConstraint({required:true},b);
d.data("required-message",b)
}}};
this.debugDate=function(){var b={component:a.$el.attr("id"),day:a.day,month:a.month,year:a.year,dateField:a.$el.find('[type="date"]').val()};
if(RR.options.debug){window.console.log(b)
}};
this.initEvents=function(){this.$el.on("change",function(c,f){if(f!==undefined&&f.validDateSet){return
}var b=$(c.target);
a.populateDate(c.target)
})
};
this.init=function(){this.$dateElement=this.$el.find('[type="date"]');
this.prefix=this.params.prefix&&this.params.prefix.replace(/\w\S*/g,function(b){return b.charAt(0).toUpperCase()+b.substr(1).toLowerCase()
});
this.dynamicErrorMessage(this.$dateElement,"date is required");
this.initEvents()
}
});
RR.components.formMenu=RR.defineComponent(function(){this.showForm=function(d,c){var b=$(d.target);
var a=this.$forms.eq(b.attr("data-index"));
d.preventDefault();
this.currentForm=b.attr("data-index");
if(a.length){if(this.params.secure){this.trigger(RR,"uiStartSecurityCheck",{guid:this.guid+"-"+this.currentForm})
}else{a.show();
this.$el.hide()
}}};
this.showSecureForm=function(c,b){var a;
if(b.guid===this.guid+"-"+this.currentForm){a=this.$forms.eq(this.currentForm);
a.show();
this.$el.hide()
}};
this.hideAllForms=function(){this.$forms.hide();
this.$el.show()
};
this.init=function(){var a=this;
this.params=this.params?this.params:{};
this.params.secure=!RR.utils.isRegisteredProspect();
this.$links=this.$el.find("a");
this.$forms=this.$el.parent().find("form");
this.$links.each(function(b){$(this).attr("data-index",b)
});
this.on(this.$links,"click",this.showForm);
this.on(this.$forms,"uiCancelAction",this.hideAllForms);
this.on(this.$forms,"uiFormSubmitted",this.hideAllForms);
this.on(RR,"uiSecurityCheckCompleted",this.showSecureForm);
this.hideAllForms()
}
});
RR.components.modal=RR.defineComponent(function(){this.init=function(){}
});
RR.components.mailbox=RR.defineComponent(function(){var e=$("#conversationList"),f=$("#messageThreadItems"),b=$("#webchatTranscriptMessages"),g=$("#threadHeading"),d=$("#webchatDate"),a=$("#threadCaseId"),c=$("#messageThreadItems dd p");
this.defaultPageSize=10;
this.pageNumber=1;
this.niceDateFormat=function(i){var h=window.moment(i).format("Do MMMM YYYY h:mma");
h=h.split(" ");
h[0]=h[0].replace("st","<sup>st</sup>").replace("nd","<sup>nd</sup>").replace("rd","<sup>rd</sup>").replace("th","<sup>th</sup>");
if(h.join(" ")==="Invalid date"){return false
}else{return h.join(" ")
}};
this.showContentBlock=function(h){var i={SELECT_MSG:"selectMessagesDiv",NO_MSG:"noMessagesDiv",WEB_FORM:"messageThreadItems",WEB_CHAT:"webchatTranscriptMessages"};
_.each(i,function(k,j){$("#"+k).toggleClass("hidden",h!==j)
});
$("#messageThread").toggleClass("hidden",h==="SELECT_MSG"||h==="NO_MSG");
$("#replyButton").toggleClass("hidden",h!=="WEB_FORM");
$("body").toggleClass("mailbox-empty",h==="NO_MSG")
};
this.messageForm=function(j){var i=$("#replyForm"),h=$("#replyButton");
j=j||"show";
i.toggleClass("hidden",j==="hidden");
h.toggleClass("hidden",j!=="hidden")
};
this.sendReply=function(j){var l,k={conversationId:this.currentConversationId,subject:g.html()},h,i=this;
_.each(j,function(m){if(m.name==="newMessage"){l=m.value
}});
k.body=l;
$(RR).trigger("headway:showSpinner");
h=this.mailboxApi.newMessage(k);
h.done(function(m,o){var n={accordionItemHeadClass:"horizontal-mailbox-read",accordionItemBodyClass:"in",messageId:o.id,messageIcon:"&#xf701;",messageActor:"You",messageTimeValue:window.moment(o.timeSent).format(),messageTimeDisplay:i.niceDateFormat(o.timeSent),messageBody:o.body};
f.find(".accordion-heading").removeClass("open");
if(typeof f.find(".accordion-body.in").collapse==="function"){f.find(".accordion-body.in").collapse("hide")
}i.addMessage(n,true);
i.messageForm("hidden")
})
};
this.changeConversationState=function(h){var k=true,j=e.find("[data-href="+this.currentConversationId+"]").parent("li");
var i=function(l,m){_.each(m.messages,function(o){if(o.isRead===false){k=false
}});
if(k){var n=j.attr("data-prevclass");
if(n){j.attr("data-prevclass",n.replace("mailbox-unread","mailbox-read"))
}}};
if(h){i(200,h)
}else{this.mailboxApi.getConversation(this.currentConversationId).done(i)
}};
this.markMessageAsRead=function(h,i){i=i||"";
if(i){i.removeClass("horizontal-mailbox-unread").addClass("horizontal-mailbox-read")
}var j=this.mailboxApi.updateMessage({conversationId:this.currentConversationId,messageId:h,subject:g.html(),isRead:true});
j.done(function(){var k=_.every($("#messageThread dt"),function(l){return $(l).hasClass("horizontal-mailbox-read")
});
if(k){$(RR).trigger("uiMailboxConversationRead")
}});
return j
};
this.addConversation=function(i){var h=_.template(this.conversationTemplate,i);
e.append(h)
};
this.addMessage=function(i,k){var h=_.template(this.messageTemplate,i),j=(k)?"append":"prepend";
h=$(h).removeAttr("style");
$(h).find("a").attr("href","#"+$(h).find("a").attr("data-href"));
f[j](h);
this.linkgenerator()
};
this.addChatMessage=function(i){var h=_.template(this.webchatTemplate,i);
h=$(h).removeAttr("style");
b.append(h)
};
this.populateConversations=function(j){var i=this.mailboxApi.getConversations({pageSize:this.defaultPageSize,pageNumber:j||this.pageNumber}),h=this,k=$.Deferred();
i.done(function(l,m){var n=m?m.conversations:{};
if(l===404||!n||!n.length||n.length===0){h.showContentBlock("NO_MSG");
return
}_.each(n,function(q,p){var w=(q.unreadMessages)?"horizontal-mailbox-unread":"horizontal-mailbox-read",u=h.niceDateFormat(q.latestMessageDateTime),o={WEB_FORM:{CSR:{icon:"&#xf702;",sender:"Retiready"},CUSTOMER:{icon:"&#xf701;",sender:"You"}},WEB_CHAT:{CSR:{icon:"&#xf716;",sender:"WebChat"},CUSTOMER:{icon:"&#xf716;",sender:"WebChat"}}},t=o[q.type][q.latestActor].icon,r=o[q.type][q.latestActor].sender,v={threadItemStatus:w||"",threadItemLink:q.id,threadTypeIcon:t,sender:r,threadTitle:q.subject,caseId:q.id,threadTimeValue:window.moment(q.latestMessageDateTime).format(),threadTimeDisplay:u};
h.addConversation(v)
});
h.initPagination(m.totalConversations);
k.resolve()
});
i.fail(function(l,m){h.showContentBlock("NO_MSG")
});
return k.promise()
};
this.populateMessages=function(l){var n=l.threadId||"",k=l.threadTitle||"",i=this,j=this.mailboxApi.getConversation(n),m,h;
j.done(function(o,p){var q=p.messages,r;
g.html(_.template(i.threadHeadingTemplate,{messageThreadTitle:k}));
a.html(_.template(i.caseIdTemplate,{caseId:n}));
if(p.type==="WEB_CHAT"){m=q&&q[0]&&window.moment(q[0].endTime).format()||"";
h=i.niceDateFormat(m)||""
}d.html(_.template(i.webchatDateTemplate,{webchatDateValue:m||"",webchatDateDisplay:h||""}));
i.showContentBlock(p.type);
if(p.type==="WEB_FORM"){f.html("");
_.each(q,function(z,v){var u=(z.isRead)?"horizontal-mailbox-read":"horizontal-mailbox-unread",t=(v===0)?"in":"",x=(z.actor==="CUSTOMER")?"You":"Retiready",w=(z.actor==="CUSTOMER")?"&#xf701;":"&#xf702;",y;
if(v===0){u+=" open";
if(z.isRead===false){u="horizontal-mailbox-read open";
i.markMessageAsRead(z.id).done(function(){p.messages[v].isRead=true;
i.changeConversationState(p)
})
}}y={accordionItemHeadClass:u,accordionItemBodyClass:t,messageId:z.id,messageIcon:w,messageActor:x,messageTimeValue:window.moment(z.timeSent).format(),messageTimeDisplay:i.niceDateFormat(z.timeSent),messageBody:z.body};
i.addMessage(y)
})
}if(p.type==="WEB_CHAT"){r=q[0].transcript;
b.html("");
_.each(r,function(z,x){var w=(z.actor==="CUSTOMER")?"pull-right":"pull-left",t=(z.actor==="CUSTOMER")?"You":"Retiready",u=(z.actor==="CUSTOMER")?"&#xf701;":"&#xf702;",v=(z.actor==="CUSTOMER")?"client":"operator",y={webchatMessageClass:w,webchatMessageActor:t,webchatMessageIcon:u,webchatBubbleActor:v,webchatMessage:z.message};
i.addChatMessage(y)
})
}})
};
this.linkgenerator=function(){$("#messageThreadItems dd p").each(function(){var k=$(this).html();
var j=k.replace("http:  ","http://").replace("https:  ","https://");
var h=/(https?:\/\/([-\w\.]+)+(:\d+)?(\/([-\w\/_\.]*(\?\S+)?)?)?)/ig;
var i=j.replace(h,"<a href='$1' target='_blank'>$1</a>");
$(this).html(i)
})
};
this.changeConversationStatus=function(){var h=e.find(".active"),i=$(this);
h.attr("class",h.attr("data-prevclass"));
i.attr("data-prevclass",i.attr("class"));
i.attr("class","mailbox-selected active")
};
this.initPagination=function(i){var j=$("#paginationButton"),h=this.pageNumber*this.defaultPageSize;
if(i>h){j.show()
}else{j.hide()
}};
this.initTemplates=function(){this.conversationTemplate=e.html();
e.html("");
this.messageTemplate=f.html();
f.html("");
this.threadHeadingTemplate=g.html();
this.webchatDateTemplate=d.html();
this.caseIdTemplate=a.html();
this.webchatTemplate=$("#webchatTranscriptMessages").html()
};
this.initEvents=function(){var h=this,i=$("#paginationButton");
e.on("click","li",function(l){$(RR).trigger("headway:showSpinner");
var k=$(this),m={threadId:k.find("a").attr("data-href"),threadTitle:k.find("h3").text()},j=RR.utils.detectDevice();
h.currentConversationId=m.threadId;
window.location.hash="!"+m.threadId;
$("body").toggleClass("mailbox-item-selected",window.location.hash!=="");
h.changeConversationStatus.call(this);
h.populateMessages(m);
return false
});
$("#replyButton").on("click",function(){h.messageForm("show")
});
$("#cancelButton").on("click",function(){h.messageForm("hidden")
});
$("#replyForm").on("submit",function(l){var k=$(this),j=k.serializeArray();
l.preventDefault();
if(k.parsley("isValid")===true){h.sendReply(j);
k[0].reset()
}return false
});
f.on("shown",".accordion-body",function(){var k=$(this).prev("dt"),l=k.hasClass("horizontal-mailbox-unread"),j=k.find("a").attr("data-href");
k.find(".accordion-chevron").html("&#xf709;");
k.find(".accordion-chevron-label").html("Expand");
if(l){h.markMessageAsRead(j,k).done(function(){h.changeConversationState()
})
}});
f.on("hidden",".accordion-body",function(){var j=$(this).prev("dt");
j.find(".accordion-chevron").html("&#xf70a;");
j.find(".accordion-chevron-label").html("Collapse")
});
i.on("click",function(){h.pageNumber+=1;
h.populateConversations(h.pageNumber);
h.initPagination()
});
$(window).on("hashchange",function(){var j=(window.location.hash&&window.location.hash.length>2)?window.location.hash.substr(2):"";
if(h.currentConversationId===j){return
}$("body").toggleClass("mailbox-item-selected",j!=="");
$("body").toggleClass("mailbox",j==="");
if(j===""){h.showContentBlock("SELECT_MSG")
}else{window.scrollTo(0,0);
e.find('[data-href="'+j+'"]').click()
}})
};
this.initRouting=function(){var i=(window.location.hash)?window.location.hash.substr(2):"",h=e.find('[data-href="'+i+'"]');
if(i){h.click()
}};
this.init=function(){var h=this;
$("body").addClass("mailbox");
this.emailAddress=RR.session("email")||"";
this.mailboxApi=new RR.api.Mailbox(this.emailAddress);
this.showContentBlock("SELECT_MSG");
this.initTemplates();
this.populateConversations().done(function(){h.initRouting()
});
this.initEvents();
if(window.platform.name==="IE"){$("header .btn-back").remove()
}}
});
RR.components.fundSwitcher=RR.defineComponent(function(){var b=this;
var a;
this.init=function(){var c=RR.session("journey");
c=_.isObject(c)?c:{};
$("#autoTermsPanel").hide();
a=new RR.api.Account(RR.session("email"),"CONFIRMED_AUTO_UPGRADE");
if(RR.session("autoUpgradeUser")===true){this.gettermsAndCondition()
}this.newFundId=c.newFund;
this.oldFundId=c.oldFund;
this.productId=c.productId;
this.confirmNoRiskProfile=c.confirmNoRiskProfile;
this.confirmRiskProfileMatchesFund=c.confirmRiskProfileMatchesFund;
this.confirmRiskProfileDifference=c.confirmRiskProfileDifference;
this.$form=this.$el.next("form");
if(this.$form){this.$form.parsley("addListener",{onFormSubmit:$.proxy(this.submit,this)})
}this.render()
};
this.gettermsAndCondition=function(){var c=a.gettermscondition();
c.done(function(d,e){if(_.isEmpty(e)){$("#autoTermsPanel").show()
}})
};
this.getProductDetails=function(){var f=new RR.api.Product(this.productId);
var c;
var e;
var g=$.Deferred();
c=f.get({});
c.done(function(d,h){if(d===200){return g.resolve(h.type)
}});
return g.promise()
};
this.submit=function(h,g){g.preventDefault();
var f=new RR.api.Product(this.productId);
var d={selectedFund:this.newFundId,acceptedTermsAndConditions:h,confirmNoRiskProfile:this.confirmNoRiskProfile,confirmRiskProfileMatchesFund:this.confirmRiskProfileMatchesFund,confirmRiskProfileDifference:this.confirmRiskProfileDifference};
if(h){if($("input[name='confirm_auto_terms']").prop("checked")===true){var c={productType:"ISA",journeyType:"EXISTING_CUSTOMER_SHOP",consentType:"CONFIRMED_AUTO_UPGRADE"};
a.posttermscondition(c)
}f.fundTransfer({fundDetails:d}).done(function(e,i){if(e===200){b.getProductDetails().done(function(k){var j;
if(k==="PENSION"){j="SIPPCHANGEFUND"
}else{if(k==="ISA"){j="ISACHANGEFUND"
}}RR.plugins.notifications.setNotificationFlag(j).done(function(){RR.url.redirect("SAVINGS")
})
})
}})
}};
this.getFundData=function(c){var d=_.findWhere(this.params,{fundId:c});
return d
};
this.render=function(){var c;
this.template=this.template?this.template:this.$el.html();
var d={fromFund:this.getFundData(this.oldFundId),toFund:this.getFundData(this.newFundId)};
c=_.template(this.template,d);
this.$el.html(c)
}
});
RR.components.carousel=RR.defineComponent(function(){this.carousel=null;
var a=this,b=0;
this.init=function(){this.on(this.$el.find(".right"),"click",this.next);
this.on(this.$el.find(".left"),"click",this.prev);
this.on("uiCarouselNext",this.next);
this.on("uiCarouselPrev",this.prev);
this.initCarousel()
};
this.next=function(c){if(c){c.preventDefault()
}this.carousel.next()
};
this.prev=function(c){if(c){c.preventDefault()
}this.carousel.prev()
};
this.initCarousel=function(){this.carousel=window.Swipe(this.$el.find("#slider")[0],{startSlide:0,speed:400,continuous:true,disableScroll:false,stopPropagation:false,callback:function(c,d){$(".carousel-circle").removeClass("active");
$(".carousel-circle").each(function(e,f){if($(f).html()!==""){$(f).html($(f).html().replace(" (Current)",""))
}});
$(".article-circle-"+(c+1)).addClass("active");
$(".article-circle-"+(c+1)).find(">:first-child").html($("#article-circle-"+(c+1)).find(">:first-child").html()+" (Current)")
},transitionEnd:function(c,d){if($(d).hasClass("skip-this-slide")){if(a.previousIndex===0){a.prev()
}else{a.next()
}}a.previousIndex=c
}})
};
this.killBill=function(){this.carousel.kill()
}
});
RR.components.resetMemorableWordModal=RR.defineComponent(function(){this.resetMemorableWord=function(){var a=RR.session("email");
var b=new RR.api.Customer(a);
if(a){b.securityResetMemorableWordNotify().done(function(c){if(c===200){$("#resetMemorableWordModal").modal("hide")
}})
}return false
};
this.init=function(){this.on(this.$el.find("[data-id=submit]"),"click",this.resetMemorableWord)
}
});
RR.components.memoAssetModal=RR.defineComponent(function(){var a=this;
this.email=RR.session("email");
this.$assetModal="";
this.$assetForm="";
this.$removeAssetModal="";
this.selectedAssetId="";
this.fakeSubmit=false;
this.linkLegacyMemo=false;
this.modals={ADD:"ADD",UPDATE:"UPDATE",DETAILS:"DETAILS"};
this.modalData={ADD:{title:"",button:""},UPDATE:{title:"",button:""},DETAILS:{title:"",button:""}};
this.init=function(b,c){a.initEvents();
a.$assetModal=a.$el;
a.$removeAssetModal=$("#removeMemoAssetModal");
a.$assetForm=this.$el.find("#add-asset-form");
a.$asOfDateField=$(".as-of-date [data-force-validation]");
a.$dateOfBirthField=$(".date-of-birth [data-force-validation]");
a.setTitleButtonText();
a.$assetForm.parsley("addListener",{onFormSubmit:a.onFormSubmit});
this.on(this.$el.find("[data-id=submit]"),"click",a.submitAddUpdateModalForm);
this.on(a.$removeAssetModal.find("[data-id=submit]"),"click",a.removeMemoAsset)
};
this.initEvents=function(){$(RR).on("renderMemoAssetModal",a.displayMemoAssetModal);
$(RR).on("renderLegacyMemoView",a.renderLegacyMemoView);
$(RR).on("provideProductDetails",a.getAssetDetails)
};
this.submitAddUpdateModalForm=function(){a.$assetForm.submit();
return false
};
this.onFormSubmit=function(c,b){b.preventDefault();
if(c&&!a.fakeSubmit){a.addUpdateAsset()
}return false
};
this.setupTypeOfSavings=function(){var b=a.$el.find("#type-of-saving");
var c=a.$el.find("#type-of-pension");
var f=a.$el.find("#type-of-isa");
var e=a.$el.find(".control-group.type-of-pension");
var h=a.$el.find(".control-group.type-of-isa");
function d(k){var l=$(k.currentTarget).val();
a.$el.find("#isa-alert").hide();
if(l!==""){if(l==="PENSION"){a.$el.find(".control-group.employers-monthly-contribution").show();
e.show();
g()
}else{if(l==="ISA"){a.$el.find(".control-group.employers-monthly-contribution").hide();
a.$el.find("#isa-alert").show();
h.show();
i()
}}}else{a.resetSavingTypes()
}}function j(){b.val("");
b.change(function(k){d(k)
});
i();
g()
}function i(){e.hide();
c.val("");
f.val("")
}function g(){h.hide();
f.val("");
c.val("")
}j()
};
this.setTitleButtonText=function(){function d(f,g,e){if(a.modalData[f]){a.modalData[f].title=g;
a.modalData[f].button=e
}}var c=a.$el.find(".help-modal-title").html().split("|");
var b=a.$el.find('[data-id="submit"]').html().split("|");
d(a.modals.ADD,$.trim(c[0]),$.trim(b[0]));
d(a.modals.UPDATE,$.trim(c[1]),$.trim(b[1]));
d(a.modals.DETAILS,$.trim(c[2]),$.trim(b[2]))
};
this.resetFormValidation=function(){a.$asOfDateField.removeAttr("data-force-validation");
a.$dateOfBirthField.removeAttr("data-force-validation");
a.fakeSubmit=true;
a.$assetForm.submit();
a.fakeSubmit=false;
a.$asOfDateField.attr("data-force-validation","true");
a.$dateOfBirthField.attr("data-force-validation","true")
};
this.renderTitleButton=function(b){a.$el.find(".help-modal-title").html(a.modalData[b].title);
a.$el.find('[data-id="submit"]').html(a.modalData[b].button)
};
this.resetModalDisplay=function(){a.$el.find("#isa-alert").hide();
a.$el.find(".asset-intro-message").hide();
a.$el.find(".control-group.employers-monthly-contribution").hide();
a.$assetForm.find("input, select").prop("disabled",false);
a.$el.find(".toggle-group label.checked").removeClass("checked");
a.$assetForm.trigger("reset");
a.$el.find(".actionButton").show();
a.setupTypeOfSavings()
};
this.displayMemoAssetModal=function(d,b){a.resetModalDisplay();
a.resetFormValidation();
a.initLegacyOption(b.legacy);
if(!b.type){return
}var c=a.getSelectedAssetInfo();
if(c.memoAssetId){a.selectedAssetId=c.memoAssetId
}switch(b.type){case"add":a.renderTitleButton(a.modals.ADD);
a.selectedAssetId="";
a.renderAddUpdateModal(true);
break;
case"update":a.renderTitleButton(a.modals.UPDATE);
a.renderAddUpdateModal(false);
break;
case"remove":a.renderRemoveModal(false)
}};
this.initLegacyOption=function(b){if(b){a.$el.find("#other-saving").hide();
a.$el.find("#aegon-saving").show();
a.$el.find("#account-provider").show();
a.$el.find("#account-provider input").on("click",function(){var c=$(this);
if(c.val()==="aegon"){a.$el.find("#aegon-saving").show();
a.$el.find("#other-saving").hide();
a.$dateOfBirthField.attr("data-force-validation","true");
a.$asOfDateField.removeAttr("data-force-validation");
a.linkLegacyMemo=true
}else{if(c.val()==="other"){a.$el.find("#other-saving").show();
a.$el.find("#aegon-saving").hide();
a.$asOfDateField.attr("data-force-validation","true");
a.$dateOfBirthField.removeAttr("data-force-validation");
a.linkLegacyMemo=false
}}});
a.$el.find("#verify-by-type").change(function(){a.$el.find(".policyNumber").hide();
a.$el.find(".nin").hide();
if(this.value==="p"){a.$el.find(".policyNumber").show()
}else{if(this.value==="n"){a.$el.find(".nin").show()
}}});
a.$el.find(".policyNumber").hide();
a.$el.find(".nin").hide();
a.linkLegacyMemo=true;
a.$asOfDateField.removeAttr("data-force-validation")
}else{a.$el.find("#aegon-saving").hide();
a.$el.find("#account-provider").hide();
a.$el.find("#other-saving").show();
a.$dateOfBirthField.removeAttr("data-force-validation")
}};
this.renderLegacyMemoView=function(d,b){a.$asOfDateField.removeAttr("data-force-validation");
a.$dateOfBirthField.removeAttr("data-force-validation");
var c=new RR.api.Customer(a.email);
c.details().done(function(e,g){var f=false;
if(!g.dateOfBirth){f=true
}else{if(g.dateOfBirth&&g.dateOfBirthSource&&g.dateOfBirthSource!=="ACCOUNT"){f=true
}}$(RR).trigger("renderMemoAssetModal",{type:"add",legacy:f})
})
};
this.renderRemoveModal=function(){var b=a.getSelectedAssetInfo();
var c=a.$removeAssetModal.find(".help-modal-title");
var d=a.$removeAssetModal.find(".asset-remove-message");
c.html(c.html().replace("{{assetname}}","<span></span>"));
d.html(d.html().replace("{{amount}}","<span></span>"));
c.find("span").html(b.name);
d.find("span").html(RR.utils.formatStringAsCurrency(b.value,"&pound;"))
};
this.removeMemoAsset=function(){if(a.selectedAssetId!==""){a.product=new RR.api.Product("");
var b=a.product.deleteMemoAsset({emailAddress:a.email,memoAssetId:a.selectedAssetId});
b.done(function(c,d){if(c===200){RR.utils.reloadPage()
}})
}};
this.getAssetDetails=function(c,b){if(b.asset){a.populateAssetDetails(b.asset)
}};
this.populateAssetDetails=function(d){if(d.type){var b=d.value||0,c=d.personalContribution||0,e=d.employerContribution||0;
$("[name=saving-title]").val(d.name);
$("#type-of-saving").val(d.type).change();
$("#type-of-pension").val(d.subType);
$("#type-of-isa").val(d.subType);
$("[name=saving-value]").val(b);
$("[name=monthly-contribution]").val(c);
if(d.type.toUpperCase()==="PENSION"){$("[name=employers-monthly-contribution]").val(e)
}$(".as-of-date [name=startday]").val(d.effectiveDate[2]).change();
$(".as-of-date [name=startmonth]").val(d.effectiveDate[1]).change();
$(".as-of-date [name=startyear]").val(d.effectiveDate[0]).change();
if(d.source==="LEGACY"){a.renderLegacyAsset()
}}};
this.renderLegacyAsset=function(){a.$assetForm.find("input, select").prop("disabled",true);
a.$el.find(".actionButton").hide();
a.renderTitleButton(a.modals.DETAILS)
};
this.renderAddUpdateModal=function(b){if(b){a.$el.find(".asset-intro-message").show();
a.$assetModal.modal("show")
}else{$(RR).trigger("uiNeedsProductDetail",{assetId:a.selectedAssetId})
}};
this.addUpdateAsset=function(){var l=a.$assetForm.serializeObject(),d=l["type-of-pension"]||"",c,m,i;
$(RR).trigger("headway:showSpinner");
if(d===""){d=l["type-of-isa"]
}if(d!==""&&!a.linkLegacyMemo){a.product=new RR.api.Product("");
var k;
if($.isArray(l.startDate)){k=l.startDate[0].split("-")
}else{k=l.startDate.split("-")
}var g={impl:"memoAsset",emailAddress:a.email,name:$.trim(l["saving-title"]),type:$.trim(l["type-of-saving"]),subType:$.trim(d),value:parseFloat(l["saving-value"]),personalContribution:parseFloat(l["monthly-contribution"]),effectiveDate:k};
if(g.type==="PENSION"){g.employerContribution=parseFloat(l["employers-monthly-contribution"])
}g.effectiveDate=[parseInt(g.effectiveDate[0],10),parseInt(g.effectiveDate[1],10),parseInt(g.effectiveDate[2],10)];
if(a.selectedAssetId!==""){g.memoAssetId=a.selectedAssetId
}m=a.product.postMemoAsset(g);
m.done(function(n,o){if(n===200||n===201){c=new RR.api.Score();
i=c.triggerUpdate(RR.api.SCORE_CONSTANTS.UPDATE_MEMO_ASSET);
i.always(function(q,r,p){window.location.hash="";
RR.utils.reloadPage()
})
}})
}else{if(a.linkLegacyMemo){var h=a.$el.find('input[name="nin"]').val();
var j=a.$el.find('input[name="policyNumber"]').val();
var f=new RR.api.Customer(a.email);
var e=l.Date.split("-");
e=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)];
var b={dateOfBirth:e};
if(h){b.nationalInsuranceNumber=h
}else{if(j){b.existingPolicyNumber=j
}}f.linkLegacyMemo(b).done(function(n,o){if(n===200){window.location.hash="";
RR.utils.reloadPage()
}})
}}};
this.getSelectedAssetInfo=function(){var b=$("#savingsMenu li.active");
if(b.attr("data-type")==="memoasset"){var c={name:b.find("a h3").html(),memoAssetId:b.attr("data-account-number"),value:b.attr("data-value"),source:b.attr("data-source"),element:b};
return c
}return false
}
});
RR.components.customerProducts=RR.defineComponent(function(){var a=this;
this.init=function(){localStorage.removeItem("multipleFunds");
this.getProducts().done(function(b,d){var c=[];
$.each(d.products.PENSION,function(e,f){f.originaltype=f.type;
f.type="PENSION";
c.push(f)
});
$.each(d.products.ISA,function(e,f){f.originaltype=f.type;
f.type="ISA";
c.push(f)
});
a.populateProducts(c)
});
if(!RR.utils.isAuthor()){$(".multiple-funds,.currentInvestmentMultiple").addClass("hidden")
}$("body").on("click",".manage-pension",function(){var b=$(this).attr("data-product-id");
window.location=RR.route("SAVINGS")+"#!"+b
});
$("body").on("click",".manage-isa",function(){var b=$(this).attr("data-product-id");
window.location=RR.route("SAVINGS")+"#!"+b
});
$("body").on("click",".multiple-funds",function(){localStorage.setItem("multipleFunds",true)
})
};
this.getProducts=function(){var b=RR.session("email");
var c=new RR.api.Account(b);
var e=$.Deferred();
return c.productsmap({})
};
this.convertCharToPaymentPeriod=function(b){switch(b){case"W":return"per week";
case"M":return"per month";
case"A":return"anual"
}};
this.productFundMapping=function(h,f,e,c,g){var d=$(".user-product"+[c]+" .js-aegon-fund");
switch(h){case"A":d.removeClass("hidden").addClass("fund-1");
d.find(".fundName span").text("1");
break;
case"B":d.removeClass("hidden").addClass("fund-2");
d.find(".fundName span").text("2");
break;
case"C":d.removeClass("hidden").addClass("fund-3");
d.find(".fundName span").text("3");
break;
case"D":d.removeClass("hidden").addClass("fund-4");
d.find(".fundName span").text("4");
break;
case"E":d.removeClass("hidden").addClass("fund-5");
d.find(".fundName span").text("5");
break;
default:var b=$(".user-product"+[c]).find(".fund-aegon");
if(_.isNull(e)||_.isEmpty(e)){b.removeClass("hidden");
b.find(".fundName").text("No fund information available");
b.find(".riskLevel").html("")
}else{b.removeClass("hidden");
b.find(".fundName strong").text(e.displayName);
if(e.riskRating){b.find(".riskLevel span").text(e.riskRating)
}else{b.find(".riskLevel span").text("Not available")
}}}};
this.showproductTemplate=function(m,j,f){var h=$("."+j+"-product.source").after($("."+j+"-product.source").clone());
h.removeClass("source").addClass("user-product"+f);
var g=$(".user-product"+f);
var b=0;
var i=$(".user-product"+f).html();
var d=$(".user-product"+f).find(".small-txt");
var k=$(".user-product"+f).find("."+j+"-regular-contribs");
var l=$(".user-product"+f).find("."+j+"-employeeContribution");
var c=$(".user-product"+f).find("."+j+"-employerContribution");
var e=$(".user-product"+f).find("."+j+"-salarySacrifice");
var n=$(".user-product"+f).find("."+j+"-one-off-contribs");
if(!RR.utils.isAuthor()){k.hide();
c.hide();
l.hide();
n.hide();
e.hide()
}d.html(_.template(d.html(),_.extend(m)));
g.find(".manage-btn").attr("data-product-id",m.id);
if(m.regularPayment){k.html(_.template(k.html(),_.extend(m,{contribution:m.regularPayment.amount,frequency:this.convertCharToPaymentPeriod(m.regularPayment.frequency)})));
k.show()
}else{if(m.latestPayment){if(!_.isNull(m.latestPayment.employerContribution)||!_.isNull(m.latestPayment.employeeContribution)||!_.isNull(m.latestPayment.salarySacrificeContribution)){if(m.latestPayment.employeeContribution){n.remove();
l.show();
l.html(_.template(l.html(),_.extend(m,{date:RR.utils.arrayToDateFormatted(m.latestPayment.date)})))
}if(m.latestPayment.employerContribution){n.remove();
c.show();
c.html(_.template(c.html(),_.extend(m,{date:RR.utils.arrayToDateFormatted(m.latestPayment.date)})))
}if(m.latestPayment.salarySacrificeContribution){n.remove();
e.show();
e.html(_.template(e.html(),_.extend(m,{date:RR.utils.arrayToDateFormatted(m.latestPayment.date)})))
}}else{n.show();
n.html(_.template(n.html(),_.extend(m,{contribution:m.latestPayment.amount,date:RR.utils.arrayToDateFormatted(m.latestPayment.date)})))
}}else{$(".user-product"+f).find(".currentInvestment").remove();
$(".user-product"+f).find(".manage-"+j).addClass("margin-bottom margin-top")
}}if(m.source!=="RR"){$(".user-product"+f+"> h3").text(m.name)
}if(m.source==="RR"){$(".user-product"+f).find(".currentInvestment").removeClass("hidden")
}$(".user-product"+f).find(".manage-"+j).attr("data-product-id",m.id);
if(m.source==="WORKPLACE"){$.each(m.fund,function(o,p){b++
});
if(b>1){$(".user-product"+f).find(".multiple-funds").removeClass("hidden");
$(".user-product"+f).find(".currentInvestment .multiple").removeClass("hidden");
$(".user-product"+f).find(".multiple-funds").attr("href",RR.route("SAVINGS")+"#!"+m.id);
$(".user-product"+f).find(".currentInvestmentMultiple").removeClass("hidden")
}else{$(".user-product"+f).find(".currentInvestment").removeClass("hidden");
this.productFundMapping(m.selectedFund,j,m.fund[0],f,m.source)
}}else{this.productFundMapping(m.selectedFund,j,m.fund,f,m.source)
}};
this.populateProducts=function(d){var g=false;
var f=false;
var e=false;
var c=["RR","WORKPLACE","PACKAGED"];
var b;
_.each(d,function(i,h){b=_.contains(c,i.source);
if(i.type==="PENSION"&&b){g=true;
if(i.source==="WORKPLACE"){e=true
}a.showproductTemplate(i,"pension",[h])
}else{if(i.type==="ISA"&&b){f=true;
a.showproductTemplate(i,"isa",[h])
}}});
if(g){$(".pension-product.source").remove()
}if(f){$(".isa-product.source").remove()
}if(!g&&!RR.utils.isAuthor()){$(".pension-product").remove();
$("#pension-product-upsell").removeClass("hidden")
}if(!f&&!RR.utils.isAuthor()){$(".isa-product").remove();
$("#isa-product-upsell").removeClass("hidden");
if(e){$("#isa-product-upsell").find(".js-button a").attr("href",RR.route("NEW_COMPARISON_ISA"))
}}}
});
RR.components.isaFundsWithdrawer=RR.defineComponent(function(){function a(b,d){var c;
switch(b){case"single":c="oneOff";
break;
case"regular":if(d.id){c="update";
break
}else{c="regular";
break
}break;
default:break
}return c
}this.setFlashForWithdrawType=function(b){var d=a(b,this.data);
var c={data:{emailAddress:RR.session("email")},modal:this.params[d].modal};
return RR.session("flash",c)
};
this.submit=function(){var b=this;
var c=this.data.productId;
var d=new RR.api.Product(c);
d.transferOut(this.data).done(function(e){if(e===200){b.setFlashForWithdrawType(b.data.operation).done(function(){RR.session("transferOut",{}).done(function(){RR.url.redirect("SAVINGS")
})
})
}else{if(e===409){b.setFlashForWithdrawType(b.data.operation).done(function(){RR.session("transferOut",{}).done(function(){RR.url.redirect("SAVINGS")
})
})
}}})
};
this.showTypeSpecificMessages=function(c){var b=this;
var e=a(c,this.data);
var d="";
_.each(this.params,function(h,g){if(h.className){var f=this.$el.find("."+h.className);
if(g===e){d=h.className
}f.hide()
}},this);
if(d){this.$el.find("."+d).show()
}return this
};
this.isUserGoingToDepleteAccount=function(d){if(d.frequency){var f={W:1,F:2,M:4,Q:12,A:52};
var e=d.availableBalance;
var c=f[d.frequency];
var b=d.amount;
return(e/52)-(b/c)<0
}else{return false
}};
this.render=function(d){var e={W:"weekly",F:"fortnightly",M:"monthly",Q:"quaterly",A:"annually"};
var b=this.$el.find(".js-template");
var c=_.extend({},d);
if(!this.isUserGoingToDepleteAccount(d)){this.$el.find(".isa-funds-critical").hide()
}if(c.frequency){c.frequency=e[c.frequency]
}if(c.oldFrequency){c.oldFrequency=e[c.oldFrequency]
}if(c.amount){c.amount=RR.utils.formatStringAsCurrency(c.amount,"")
}c.startMonth=window.moment(this.data.startMonth,"M").format("MMMM");
if(c.oldAmount){c.oldAmount=RR.utils.formatStringAsCurrency(c.oldAmount,"")
}b.each(function(){var g=$(this).html();
var f=g;
try{f=_.template(g,c)
}catch(h){}$(this).html(f)
})
};
this.init=function(){this.data=RR.session("transferOut");
this.render(this.data);
this.showTypeSpecificMessages(this.data.operation,this.data.id);
this.on(this.$el.find("button"),"click",this.submit)
}
});
RR.components.beneficiariesList=RR.defineComponent(function(){var a=this;
this.init=function(b,d){RR.plugins.loader.hide(".detail-list");
RR.plugins.loader.hide(".no-beneficiaries-message");
$(".detail-list").addClass("template");
var c=RR.url.parameter("productId");
if(c){this.product=new RR.api.Product(c);
this.getBeneficiariesInfo(c)
}};
this.initEvents=function(){};
this.getBeneficiariesInfo=function(c){var b;
var d;
b=this.product.getBeneficiaries({});
b.done(function(e,f){if(e===200){a.populate(f)
}})
};
this.populate=function(b){if(null===b.beneficiaries||!b.beneficiaries.length){$(".no-beneficiaries-message").show();
return
}$.each(b.beneficiaries,function(d,e){e.dateOfBirth=RR.utils.arrayToDateFormatted(e.dateOfBirth);
var c=$(".template");
var f=c.clone().removeClass("template").addClass("a");
f.children("p").each(function(){var g=_.template($(this).html(),e);
$(this).html(g)
});
if(d>=1){c.after("<hr/>")
}f.show();
c.after(f)
})
}
});
RR.components.twoHeadingParagraph=RR.defineComponent(function(){this.init=function(){this.type=this.params.type;
var a=RR.session("email");
if(a!==null&&a!==undefined){switch(this.type){case"bankDetails":$(RR).trigger("uiNeedsCustomerDetails");
$(RR).on("dataCustomerDetails",this.bankDetailsParagraph);
break;
default:break
}}};
this.bankDetailsParagraph=function(c,a){var b=a.bankDetails;
if(b[0]===null||b[0]===undefined){$("#no-bank-account").removeClass("hidden")
}else{if(b[0].updateInProgress===null||b[0].updateInProgress===undefined){if(b[0].updateInProgress===true){$("#bank-account-update-in-progress").removeClass("hidden")
}}}}
});
RR.components.moneyOutPanel=RR.defineComponent(function(){this.init=function(){if(!RR.utils.isAuthor()){this.revealBankAccountContent("setup");
$(RR).on("dataCustomerDetails",$.proxy(this.getBankAccountSetupStatus,this));
$(RR).on("uiSecurityCheckCompleted",$.proxy(this.submit,this));
$(RR).trigger("uiNeedsCustomerDetails");
this.$el.find("form").parsley("addListener",{onFormSubmit:$.proxy(this.startSecurityCheck,this)});
this.fetchAndRenderProductDetails()
}};
this.fetchAndRenderProductDetails=function(){var a=RR.url.parameter("productId");
var b=RR.api.Product(a);
return b.get().done($.proxy(function(c,d){this.renderProductDetails(d)
},this))
};
this.renderProductDetails=function(a){var b=_.extend({},a);
var c=b.value*0.99;
this.availableBalance=c;
this.$el.find("form [name=amount]").parsley("addConstraint",{maxwithdrawal:c});
b.value=RR.utils.formatStringAsCurrency(b.value,"");
this.$el.find("#isa-withdrawal-rules").each(function(){var f=$(this).html();
var d=f;
try{d=_.template(f,b)
}catch(g){}$(this).html(d)
});
b.value=RR.utils.formatStringAsCurrency(c,"");
this.$el.find("form .js-template").each(function(){var f=$(this).html();
var d=f;
try{d=_.template(f,b)
}catch(g){}$(this).html(d)
});
return this
};
this.getBankAccountSetupStatus=function(d,a){var c=a.bankDetails;
var b="none";
if(_.isArray(c)){if(c[0]){if(c[0].updateInProgress){b="inprogress"
}else{b="setup"
}}}return this.revealBankAccountContent(b)
};
this.revealBankAccountContent=function(a){_.each(this.params.bankAccountClasses,function(c,b){if(c){if(b===a){$("."+c).show()
}else{$("."+c).hide()
}}},this);
return a
};
this.startSecurityCheck=function(b,a){if(b){$(RR).trigger("uiStartSecurityCheck",{guid:this.guid})
}return false
};
this.submit=function(c,b){if(b.guid===this.guid){var a=this.extractTransferData();
if(a){RR.session("transferOut",a).done(function(){RR.url.redirect("MANAGE_ISA_FUNDS_CONFIRM")
})
}else{}}};
this.extractTransferData=function(){var a=null;
var c=RR.components.form2object(this.$el.find("form"));
try{if(this.params.type==="oneoff"){a={percentage:false,amount:Number(c.amount),operation:"single",availableBalance:this.availableBalance}
}}catch(b){}a.productId=RR.url.parameter("productId");
return a
}
});
RR.components.transferIn=RR.defineComponent(function(){var o=this;
var f=$("#paymentDueDiv"),k=$("#currentMonthlyPaymentDiv"),c=$('[name="Amount"]'),g=$("#bankDetails"),n=$("#confirmPayment"),j=$("#stopPayment"),h=$("header h1"),m=$("#alertRpi"),b=$("#paymentAmountForm fieldset:first h3"),l=$("#cancelPayment"),d=l.find(".actionButton"),i=l.find(".cancelButton"),e=$("#paymentAmountForm"),a=$("#additionalSignatureCheck");
this.init=function(){var q,p=this;
this.email=RR.session("email")||"";
this.accountApi=new RR.api.Account(this.email);
$(RR).on("dataCustomerDetails",function(t,r){if(r.bankDetails){RR.session("bankDetails",r.bankDetails[0])
}});
this.additionalSignatureRequired=false;
q=this.getProductData();
q.done(function(r){if(p.params.paymentAction==="regular"){p.initRegularPayment()
}else{p.initSinglePayment()
}if(p.params.productType==="ISA"){p.setIsaAllowance(p.product.id)
}p.initEvents()
});
q.fail(function(){})
};
this.toggleBankDetailsForm=function(r,p){var q=p.bankDetails;
if(o.params.paymentAction==="regular"){if((!_.isArray(p.bankDetails))||(!p.bankDetails.length)){g.show();
this.bankDetailsVisible=true
}else{g.hide();
o.prePopulateBankDetails(p);
this.bankDetailsVisible=false
}}};
this.prePopulateBankDetails=function(p){var q=p.bankDetails[0];
g.find('input[name="bankDetails.accountName"]').val(q.accountName);
g.find('input[name="bankDetails.accountNumber"]').val(q.accountNumber);
g.find('input[name="bankDetails.sortCode0"]').val(q.sortCode[0]);
g.find('input[name="bankDetails.sortCode1"]').val(q.sortCode[1]);
g.find('input[name="bankDetails.sortCode2"]').val(q.sortCode[2]);
g.find('input[name="bankDetails.additionalSignatureRequest"]').val(q.additionalSignatureRequest)
};
this.getProductData=function(){var q,p=this,r=$.Deferred();
q=this.accountApi.products({});
q.done(function(t,u){_.each(u.products,function(v){if(v.type===p.params.productType&&v.source==="RR"){p.product=v
}});
if(p.product){r.resolve(p.product)
}else{r.reject()
}});
q.fail(function(){RR.utils.debugMessage("Failed to get products list for a user");
r.reject()
});
return r.promise()
};
this.toggleButtons=function(){};
this.paymentDueBlock=function(){var q,r=moment(),t=this.product.regularPayment?this.product.regularPayment.amount:null,p=l.find(".cancel-payment-text"),u=p.html(),v,w;
if(t){q=this.getCurrentNextPaymentDate();
if(q&&r.date()>15&&q.isBefore(r.endOf("month"))){w=q.diff(r,"days");
v={numdays:w,month:q.add("months",1).format("MMMM")};
v.numdays+=(w>1)?" days":" day";
p.html(_.template(u,v));
p.show()
}else{p.hide()
}}};
this.getCurrentNextPaymentDate=function(){var p=(o.product.regularPayment)?o.product.regularPayment.nextPaymentDate:null;
if(p&&p.length>1){p[1]=p[1]-1;
p=moment(p);
return(p.isValid())?p:null
}else{return null
}};
this.getNewNextPaymentDate=function(){var p=o.getCurrentMoment(),q=(p.date()<=15)?1:2;
return p.date(2).add("months",q)
};
this.getCurrentMoment=function(){return window.moment()
};
this.monthlyPaymentBlock=function(){var p=k.html(),q;
if(this.product.regularPayment&&this.params.paymentAction==="regular"){q={currentMonthlyPayment:RR.utils.formatStringAsCurrency(this.product.regularPayment.amount,"&pound;")};
k.html(_.template(p,q))
}else{k.hide()
}};
this.headingsBlocks=function(){var u=this.product.regularPayment?this.product.regularPayment.amount:null,q=!u||u<=0,t,p,v=h.html(),w=b.html(),x,r,y;
if(q){t="Setup a regular payment";
y=(o.params.productType==="PENSION")?"Pension":"ISA";
p="How much would you like to pay into your Retiready "+y+"?"
}else{t="Amend a regular payment";
p="Current monthly payment"
}x={pageHeading:t};
r={paymentHeading:p};
h.html(_.template(v,x));
b.html(_.template(w,r))
};
this.populateAmount=function(){if(this.product.regularPayment){c.val(this.product.regularPayment.amount)
}};
this.toggleStopPaymentButton=function(){if(this.product.regularPayment&&this.params.paymentAction==="regular"){j.show()
}else{j.hide()
}};
this.toggleRpiBoostCheckBox=function(){var p=this.product.regularPayment?this.product.regularPayment.amount:null;
var r=!p||p<=0;
var q=$("#boostmeId");
if(r){m.remove()
}else{if(!this.product.regularPayment.boostPensionInlineWithRPI){m.remove()
}else{this.on(q,"click",this.revealRpiAlert)
}if(q.prop("checked")!==this.product.regularPayment.boostPensionInlineWithRPI){q.click()
}else{this.revealRpiAlert()
}}};
this.revealRpiAlert=function(){var p=$("#boostmeId");
if(p.prop("checked")){m.hide()
}else{m.show()
}};
this.initRegularPayment=function(){this.headingsBlocks();
this.populateAmount();
this.paymentDueBlock();
this.monthlyPaymentBlock();
this.toggleStopPaymentButton();
this.toggleRpiBoostCheckBox();
$(RR).trigger("uiNeedsCustomerDetails")
};
this.initSinglePayment=function(){this.monthlyPaymentBlock();
this.toggleStopPaymentButton();
$(RR).trigger("uiNeedsCustomerDetails")
};
this.storeDataInSession=function(t){var q,p=this,r={operation:p.params.paymentAction,productId:p.product.id,amount:t.Amount};
if(r.operation==="regular"&&p.product.regularPayment){r.oldAmount=p.product.regularPayment.amount.toString()
}if(p.params.productType==="PENSION"){r.boostPensionInlineWithRPI=(t.boostmeName||t["im-boosted"])?true:false
}r.bankDetails={};
if(RR.session("bankDetails")){r.bankDetails.bankAccountId=RR.session("bankDetails").bankAccountId
}r.bankDetails.accountNumber=t["bankDetails.accountNumber"];
r.bankDetails.accountName=t["bankDetails.accountName"];
r.bankDetails.sortCode=[t["bankDetails.sortCode0"],t["bankDetails.sortCode1"],t["bankDetails.sortCode2"]];
r.bankDetails.startDate=p.getNewNextPaymentDate().format("MMMM YYYY");
if(t["bankDetails.additionalSignatureRequest"]){r.bankDetails.additionalSignatureRequest=true
}else{r.bankDetails.additionalSignatureRequest=false
}RR.session("transferIn",r).done(function(){var u=window.location.pathname.split(".html")[0]+"/confirm.html";
window.location=u
})
};
this.clearBankDetailsErrors=function(){RR.plugins.form.clearError("[name='bankDetails.accountNumber']");
$("[name='bankDetails.sortCode0']").closest(".control-group").removeClass("error");
$("[name='bankDetails.accountNumber']").off("keydown.clearBankDetailserrros");
$("[name='bankDetails.sortCode0']").off("keydown.clearBankDetailserrros");
$("[name='bankDetails.sortCode1']").off("keydown.clearBankDetailserrros");
$("[name='bankDetails.sortCode2']").off("keydown.clearBankDetailserrros")
};
this.submitForm=function(y,u,x){var w=this;
var p=0;
var A=o.$el.find("form");
var z=A.serializeObject();
var q;
var v=this.bankDetailsVisible&&!this.additionalSignatureRequired;
var t=z.Amount;
if(o.product.regularPayment){if(w.product.regularPayment.amount){var r=w.product.regularPayment.amount.toString();
if(t===r){RR.plugins.form.setError("[name='Amount']","","Please enter a different amount. This amount is the same as your current amount.",1);
return false
}}}if(!y){p++
}if(v){$("[name='bankDetails.sortCode0']").trigger("focusout");
$("[name='bankDetails.sortCode1']").trigger("focusout");
$("[name='bankDetails.sortCode2']").trigger("focusout");
if($(".error [name='bankDetails.sortCode0']").length){p++
}}if(!p){if(v){q=new RR.api.BankDetails();
q.validate({accountNumber:z["bankDetails.accountNumber"],sortCode:[z["bankDetails.sortCode0"],z["bankDetails.sortCode1"],z["bankDetails.sortCode2"]]}).done(function(B,C){if(B===200&&C.bankDetailsValid===true){w.storeDataInSession(z)
}else{$(".btn-processing").addClass("hidden");
$(".actions-primary #confirmPayment").removeClass("hidden");
RR.plugins.form.setError("[name='bankDetails.accountNumber']","invalidbankdetails","The bank details provided are invalid.",1);
$("[name='bankDetails.sortCode0']").closest(".control-group").addClass("error");
$("[name='bankDetails.accountNumber']").on("keydown.clearBankDetailserrros",w.clearBankDetailsErrors);
$("[name='bankDetails.sortCode0']").on("keydown.clearBankDetailserrros",w.clearBankDetailsErrors);
$("[name='bankDetails.sortCode1']").on("keydown.clearBankDetailserrros",w.clearBankDetailsErrors);
$("[name='bankDetails.sortCode2']").on("keydown.clearBankDetailserrros",w.clearBankDetailsErrors)
}}).fail()
}else{this.storeDataInSession(z)
}}return false
};
this.toggleAdditionalSignatureAlert=function(){var v=this.$el.find("#signatureAlert");
var u=this.$el.find("#additionalSignatureCheck");
var t=$("[name='bankDetails.sortCode0']");
var r=$("[name='bankDetails.sortCode1']");
var q=$("[name='bankDetails.sortCode2']");
var p=$("[name='bankDetails.accountNumber']");
if(u.prop("checked")){v.removeClass("hidden");
RR.plugins.form.clearError(p);
RR.plugins.form.clearError(t);
p.prop("disabled",true).val("");
t.prop("disabled",true).val("");
r.prop("disabled",true).val("");
q.prop("disabled",true).val("");
p.parsley("removeConstraint","required");
p.parsley("validate");
this.additionalSignatureRequired=true
}else{v.addClass("hidden");
p.prop("disabled",false);
t.prop("disabled",false);
r.prop("disabled",false);
q.prop("disabled",false);
$("[name='bankDetails[0].accountNumber']").parsley("addConstraint",{required:true});
this.additionalSignatureRequired=false
}};
this.initEvents=function(){var p=this;
this.$el.find("form").parsley("addListener",{onFormSubmit:$.proxy(p.submitForm,p)});
n.attr("type","submit");
this.on(a,"click",this.toggleAdditionalSignatureAlert);
j.on("click",function(q){q.preventDefault();
l.modal("show")
});
d.on("click",function(u){u.preventDefault();
var q=p.product.id,r=new RR.api.Product(q),w=e.serializeObject(),v={operation:"stop",amount:0};
var t;
if(p.params.productType==="PENSION"){v.boostPensionInlineWithRPI=(w.boostmeName||w["im-boosted"])?true:false;
t="moneyInPensionPaymentCancellation"
}else{if(p.params.productType==="ISA"){t="moneyInISAPaymentCancellation"
}}v.bankDetails={};
v.bankDetails.accountNumber=w["bankDetails.accountNumber"];
v.bankDetails.accountName=w["bankDetails.accountName"];
v.bankDetails.sortCode=[w["bankDetails.sortCode0"],w["bankDetails.sortCode1"],w["bankDetails.sortCode2"]];
v.bankDetails.additionalSignatureRequest=(undefined===w["bankDetails.additionalSignatureRequest"])?true:false;
r.transferIn(v).done(function(x){if(x===200||x===409){RR.session("flash",{modal:t}).done(function(){RR.url.redirect("SAVINGS")
})
}}).fail(function(x){})
});
$(RR).on("dataCustomerDetails",$.proxy(p.toggleBankDetailsForm,p))
};
this.setIsaAllowance=function(p){var q=new RR.api.Product(p);
var r=$.Deferred();
q.isaAllowance().done(function(t,u){if(t===200){var v=u.remainingAllowance;
if(v||v===0){c.parsley("addConstraint",{maxisaallowance:v})
}r.resolve()
}else{r.reject()
}});
return r
}
});
RR.components.transferInConfirm=RR.defineComponent(function(){var a=this;
var d=false;
var b=false;
var c;
this.renderIllustrations=function(){var f=$("#illustrationDummyDocument").hide(),i=new RR.api.Policy("rr",""),g={illustrationType:"T",productType:a.params.productType,fundOption:a.selectedFund,fundValue:a.transfer.amount,accountId:a.transfer.productId,fundTransferOperation:this.transfer.operation.toUpperCase()},e=RR.session("transferIn")||{},h;
if(g.fundTransferOperation==="REGULAR"){g.boostPension=e.boostPensionInlineWithRPI
}h=i.illustration({basicProjectionOptions:g});
h.done(function(j,k){if(j===200){f.find("a").attr("href",k.filePath);
f.find(".file-descriptor").html("PDF");
f.find(".file-date").text(moment().format("D MMMM YYYY"));
f.show()
}})
};
this.paymentBlock=function(){var e=$("#paymentBlock"),f=e.html(),g={payingAmount:RR.utils.formatStringAsCurrency(this.transfer.amount,"&pound;")};
if(e.length){e.html(_.template(f,g))
}};
this.investmentBlock=function(){var g=$("#investmentBlock");
var e=$("#paymentBlock + p");
if(g){var f=g.html();
var h="{{chosenInvestmentFund}}";
a.productApi.get().done(function(i,j){if(i===200){h=RR.utils.toNumbers(j.selectedFund);
a.selectedFund=j.selectedFund;
a.renderIllustrations();
if(j.fund.type==="OTHER"&&j.source==="RR"){d=true;
a.gettermsAndCondition();
c=j.type
}}var k={chosenInvestmentFund:h};
if(g.length){g.html(_.template(f,k))
}if(e.length){e.html(_.template(e.html(),k))
}})
}};
this.redirectOnSuccessfulSubmit=function(e,g){var h;
var i="";
var f=this.transfer.operation;
var j=this.params.productType;
if(e===200||e===409){var k=g.sowTriggered;
if(k){i=i+"sourceOfWealth-"
}if(j==="ISA"){if(f==="single"){i=i+"moneyInISAOneOffPaymentConfirmation"
}else{i=i+"moneyInISARegularSetupConfirmation"
}}else{if(f==="single"){i=i+"moneyInPensionOneOffPaymentConfirmation"
}else{i=i+"moneyInPensionRegularSetupConfirmation"
}}h={modal:i,data:{emailAddress:RR.session("email")}};
RR.session("flash",h).done(function(){RR.session("transferIn",{}).done(function(){RR.url.redirect("SAVINGS")
})
})
}};
this.initEvents=function(){var f=this.$el.find("form"),e=this;
this.on(this.$el.find("#bank-details-amend-button"),"click",function(){var g=window.location.pathname.replace("/confirm","");
window.location=g
});
f.on("submit",function(i){var k=$(this),h,j,l=k.serializeObject();
i.preventDefault();
j=k.parsley("isValid");
if(j===true&&l["permanent-residence-toggle"]==="no"){scrollToElement(("[for=permanent-residence-yes]"));
j=false
}if(j===true){e.transfer.ukResident=(l["permanent-residence-toggle"]==="yes")?true:false;
e.transfer.sourceOfWealth=l["sources-of-wealth-dropdown"];
e.transfer.termsAndConditionsAccepted=(l.acceptTsAndCs)?true:false;
if(_.isObject(e.transfer.bankDetails)){if(e.transfer.bankDetails.startDate){delete e.transfer.bankDetails.startDate
}}if(b&&($("input[name='confirm_auto_terms']").prop("checked")===true)){var g={productType:c,journeyType:"EXISTING_CUSTOMER_SHOP",consentType:"CONFIRMED_AUTO_UPGRADE"};
e.accountApi.posttermscondition(g)
}$(RR).trigger("headway:showSpinner");
h=e.productApi.transferIn(e.transfer);
h.done($.proxy(e.redirectOnSuccessfulSubmit,e));
h.fail(function(){})
}return false
})
};
this.hideOrShowPanels=function(){if(!this.transfer.bankDetails.additionalSignatureRequest){$("#directDebitSetup").hide()
}if(this.transfer.operation==="regular"&&this.transfer.oldAmount!==null){var e=this.transfer.oldAmount?parseFloat(this.transfer.oldAmount,10):0,f=parseFloat(this.transfer.amount,10),g=(this.transfer.productType==="PENSION")?true:false;
if(f>=e){}else{if(g){$("#sources-of-wealth-fieldset").hide();
$(".form-panel-fieldset").hide()
}else{$("#sources-of-wealth-fieldset").hide();
$(".form-panel-fieldset").hide();
$("#CSKF").hide()
}}}};
this.gettermsAndCondition=function(){var e=a.accountApi.gettermscondition();
e.done(function(f,g){if(_.isEmpty(g)){b=true;
$("#autoTermsPanel").show()
}})
};
this.init=function(){this.transfer=RR.session("transferIn");
this.productApi=new RR.api.Product(this.transfer.productId);
this.accountApi=new RR.api.Account(RR.session("email"),"CONFIRMED_AUTO_UPGRADE");
$("#autoTermsPanel").hide();
this.initEvents();
if(this.transfer.operation==="single"){this.paymentBlock()
}this.investmentBlock();
this.hideOrShowPanels()
}
});
RR.components.fundInfo=RR.defineComponent(function(){var a=this;
this.init=function(b,c){$(RR).on("productSelectionRender",a.switchFund)
};
this.switchFund=function(c,b){a.$el.find(".switch-fund").unbind("click").bind("click",function(d){if($(".actions.info-panel:not(.hidden)").attr("id")==="pensionLinks"){window.location=(RR.route("CHANGE_FUND_PENSION")+"?productId="+b.productId)
}else{if($(".actions.info-panel:not(.hidden)").attr("id")==="isaLinks"){window.location=(RR.route("CHANGE_FUND_ISA")+"?productId="+b.productId)
}}})
}
});
RR.components.confirmCancelAPI=RR.defineComponent(function(){this.init=function(){this.type=this.params.type;
switch(this.type){case"isaOut":this.initIsaOutModal();
break;
default:break
}};
this.initIsaOutModal=function(){this.$saveButton=$("#confirm-cancel-withdrawal");
this.$cancelButton=$("#cancel-action");
this.on(this.$saveButton,"click",this.clickSaveButtonIsa);
this.on(this.$cancelButton,"click",this.clickCancelButtonIsa)
};
this.clickSaveButtonIsa=function(){this.$el.trigger("uiSaveAction");
var a=this;
var c=RR.url.parameter("productId");
var d=new RR.api.Product(c);
var b={percentage:false,amount:Number(0),operation:"stop",frequency:"A"};
d.transferOut(b).done(function(e){if(e===200){a.setFlashForWithdrawType().done(function(){RR.session("transferOut",{}).done(function(){RR.url.redirect("SAVINGS")
})
})
}else{if(e===409){a.setFlashForWithdrawType().done(function(){RR.session("transferOut",{}).done(function(){RR.url.redirect("SAVINGS")
})
})
}}})
};
this.clickCancelButtonIsa=function(){this.$el.trigger("uiCancelAction")
};
this.setFlashForWithdrawType=function(){var a={data:{emailAddress:RR.session("email")},modal:"moneyOutCancelConfirmation"};
return RR.session("flash",a)
}
});
RR.components.isaTransfer=RR.defineComponent(function(){var b=this,c={},d,a;
this.init=function(e,f){this.initFields();
this.initTransferPanel();
this.initEvents();
this.populateTransferDetails()
};
this.initEvents=function(){c.addTransferButton.click(function(){b.viewTransferDetailsState()
});
c.removeTransferButton.click(function(){b.resetTransferPanel();
if(a||RR.session("registeredShop")){b.removeTransfer()
}});
c.typeOfISASelect.change(function(){c.providersSelect.change();
var e=c.typeOfISASelect.val();
if(e==="None"){b.isaNoMatchState()
}else{b.viewTransferDetailsState()
}});
c.providersSelect.change(function(){var e=c.providersSelect.val();
if(e==="Other"){c.otherProvider.show()
}else{c.otherProvider.hide()
}})
};
this.initFields=function(){c.transferPanel=this.$el;
c.addTransferButton=this.$el.find("#add-transfer");
c.removeTransferButton=this.$el.find("[id^=remove-transfer]");
c.typeOfISASelect=this.$el.find("#typeOfISA");
c.providersSelect=this.$el.find("#selectedProvider");
c.addTransferInfo=c.transferPanel.find(".add-transfer-info");
c.otherProvider=c.transferPanel.find(".otherProvider");
c.typeOfISA=c.transferPanel.find(".typeOfISA");
c.approxTransferValue=c.transferPanel.find(".approxTransferValue");
c.amountPaidThisYear=c.transferPanel.find(".amountPaidThisYear");
c.transferAccountNumber=c.transferPanel.find(".transferAccountNumber");
c.providers=c.transferPanel.find(".providers");
var e="_isa";
_.each(["providersSelect","otherProvider","approxTransferValue","transferAccountNumber"],function(f){if(c[f].length===0){c[f]=c.transferPanel.find(c[f].selector+e)
}});
c.addTransferButton.show();
c.removeTransferButton.show();
c.typeOfISASelect.show();
c.providersSelect.show()
};
this.initTransferPanel=function(){a=false;
if(this.params){a=this.params.instanceName==="detail"
}if(!RR.utils.isAuthor()){d=RR.session("hasTransferDetails");
var e=RR.session("purchase");
if(e!==undefined&&e.route==="ISA"&&d){c.addTransferButton.hide()
}else{b.resetTransferPanel()
}}};
this.resetTransferPanel=function(){c.transferPanel.find(":input").val("");
if(!a){c.transferPanel.children(".panel").children().hide()
}c.addTransferInfo.show();
c.otherProvider.hide();
c.addTransferButton.show()
};
this.viewTransferDetailsState=function(){c.addTransferButton.hide();
c.removeTransferButton.show();
c.typeOfISA.show();
c.approxTransferValue.show();
c.amountPaidThisYear.show();
if(a){c.transferAccountNumber.show();
c.providers.show()
}};
this.isaNoMatchState=function(){c.approxTransferValue.hide();
c.amountPaidThisYear.hide();
if(a){c.transferAccountNumber.hide();
c.providers.hide();
c.otherProvider.hide()
}};
this.removeTransfer=function(){c.transferPanel.remove();
$(".form-actions button[type=submit]").show();
RR.session("hasTransferDetails",false)
};
this.populateTransferDetails=function(h,g){d=RR.session("hasTransferDetails");
var f={};
if(d){if(RR.session("NEW_CUSTOMER_CONFIRM_DETAILS_FORM")){f=RR.session("NEW_CUSTOMER_CONFIRM_DETAILS_FORM")
}else{if(RR.session("NEW_CUSTOMER_PURCHASE_ISA_FORM")){f=RR.session("NEW_CUSTOMER_PURCHASE_ISA_FORM")
}else{if(RR.session("REGISTERED_CUSTOMER_PURCHASE_ISA_FORM")){f=RR.session("REGISTERED_CUSTOMER_PURCHASE_ISA_FORM")
}else{if(RR.session("REGISTERED_CUSTOMER_CONFIRM_DETAILS_FORM")){f=RR.session("REGISTERED_CUSTOMER_CONFIRM_DETAILS_FORM")
}else{if(RR.session("REGISTERED_PROSPECT_CONFIRM_DETAILS_FORM")){f=RR.session("REGISTERED_PROSPECT_CONFIRM_DETAILS_FORM")
}else{if(RR.session("REGISTERED_PROSPECT_PURCHASE_ISA_FORM")){f=RR.session("REGISTERED_PROSPECT_PURCHASE_ISA_FORM")
}}}}}}}if(f){c.typeOfISASelect.val(f.typeOfISA);
c.approxTransferValue.find(".controls input").val(f.approxTransferValue);
c.amountPaidThisYear.find(".controls input").val(f.amountPaidThisYear);
c.transferAccountNumber.find(".controls input").val(f.transferAccountNumber);
c.providersSelect.val(f.providers).change();
c.otherProvider.find(".controls input").val(f.otherProvider)
}}
});
RR.components.pensionTransfer=RR.defineComponent(function(){var b=this,d={},e,a,c;
this.init=function(f,g){this.initFields();
this.initTransferPanel();
this.initEvents();
this.populateTransferDetails()
};
this.initEvents=function(){d.addTransferButton.click(function(){b.readTransferPageState()
});
d.removeTransferButton.click(function(){b.resetTransferPanel();
if(a||RR.session("registeredShop")){b.removeTransfer()
}});
d.confirmPensionTransferCheckbox.click(function(){if(c){c=false;
this.checked=false
}if(this.checked&&!c){b.confirmReadTransferPageState()
}else{b.resetTransferPanel();
b.readTransferPageState()
}});
d.typeOfPensionSelect.change(function(){d.providersSelect.change();
var f=d.typeOfPensionSelect.val();
if(f==="None"){b.pensionNoMatchState()
}else{b.confirmReadTransferPageState()
}});
d.providersSelect.change(function(){var f=d.providersSelect.val();
if(f==="Other"){d.otherProvider.show()
}else{d.otherProvider.hide()
}})
};
this.initFields=function(){d.transferPanel=this.$el;
d.addTransferButton=this.$el.find("#add-transfer");
d.removeTransferButton=this.$el.find("[id^=remove-transfer]");
d.typeOfPensionSelect=this.$el.find("#typeOfPension");
d.providersSelect=this.$el.find("#selectedProvider");
d.addTransferInfo=d.transferPanel.find(".add-transfer-info");
d.otherProvider=d.transferPanel.find(".otherProvider");
d.transferDetailsConfirmHeading=d.transferPanel.find(".transfer-details-confirm-heading");
d.confirmPensionTransfer=d.transferPanel.find(".confirmPensionTransfer");
d.typeOfPension=d.transferPanel.find(".typeOfPension");
d.transferDetailsHeading=d.transferPanel.find(".transfer-details-heading");
d.confirmPensionNotIncludes=d.transferPanel.find(".confirmPensionNotIncludes");
d.approxTransferValue=d.transferPanel.find(".approxTransferValue");
d.transferAccountNumber=d.transferPanel.find(".transferAccountNumber");
d.providers=d.transferPanel.find(".providers");
d.confirmPensionTransferCheckbox=d.transferPanel.find("#confirmPensionTransfer");
var f="_pension";
_.each(["providersSelect","otherProvider","approxTransferValue","transferAccountNumber"],function(g){if(d[g].length===0){d[g]=d.transferPanel.find(d[g].selector+f)
}});
d.addTransferButton.show();
d.removeTransferButton.show();
d.typeOfPensionSelect.show();
d.providersSelect.show()
};
this.initTransferPanel=function(){a=false;
if(this.params){a=this.params.instanceName==="detail"
}if(!RR.utils.isAuthor()){e=RR.session("hasTransferDetails");
var f=RR.session("purchase");
if(f!==undefined&&f.route==="PENSION"&&e){d.addTransferButton.hide()
}else{b.resetTransferPanel()
}}};
this.resetTransferValues=function(){d.transferPanel.find(":input").val("");
d.transferPanel.find("input:checkbox").val("true");
d.confirmPensionNotIncludes.find("#confirmPensionNotIncludes").attr("checked",false);
d.confirmPensionNotIncludes.find("label").removeClass("c_on");
d.confirmPensionTransfer.find("#confirmPensionTransfer").attr("checked",false);
d.confirmPensionTransfer.find("label").removeClass("c_on");
if(c){d.confirmPensionTransferCheckbox.trigger("click")
}};
this.resetTransferPanel=function(){c=false;
b.resetTransferValues();
d.transferPanel.children(".panel").children().hide();
d.transferPanel.find(".panel a").show();
d.addTransferInfo.show();
d.otherProvider.hide();
d.addTransferButton.show();
if(a){b.readTransferPageState()
}};
this.readTransferPageState=function(){d.addTransferButton.hide();
d.removeTransferButton.show();
d.transferDetailsConfirmHeading.show();
d.confirmPensionTransfer.show()
};
this.confirmReadTransferPageState=function(){c=true;
d.typeOfPension.show();
d.transferDetailsHeading.show();
d.confirmPensionNotIncludes.show();
d.approxTransferValue.show();
if(a){d.transferAccountNumber.show();
d.providers.show()
}};
this.pensionNoMatchState=function(){d.confirmPensionNotIncludes.hide();
d.approxTransferValue.hide();
if(a){d.transferAccountNumber.hide();
d.providers.hide();
d.otherProvider.hide()
}};
this.removeTransfer=function(){d.transferPanel.remove();
$(".form-actions button[type=submit]").show();
RR.session("hasTransferDetails",false)
};
this.populateTransferDetails=function(h,g){e=RR.session("hasTransferDetails");
var f={};
if(e){if(RR.session("NEW_CUSTOMER_CONFIRM_DETAILS_FORM")){f=RR.session("NEW_CUSTOMER_CONFIRM_DETAILS_FORM")
}else{if(RR.session("NEW_CUSTOMER_PURCHASE_PENSION_FORM")){f=RR.session("NEW_CUSTOMER_PURCHASE_PENSION_FORM")
}else{if(RR.session("REGISTERED_CUSTOMER_PURCHASE_PENSION_FORM")){f=RR.session("REGISTERED_CUSTOMER_PURCHASE_PENSION_FORM")
}else{if(RR.session("REGISTERED_CUSTOMER_CONFIRM_DETAILS_FORM")){f=RR.session("REGISTERED_CUSTOMER_CONFIRM_DETAILS_FORM")
}else{if(RR.session("REGISTERED_PROSPECT_CONFIRM_DETAILS_FORM")){f=RR.session("REGISTERED_PROSPECT_CONFIRM_DETAILS_FORM")
}else{if(RR.session("REGISTERED_PROSPECT_PURCHASE_PENSION_FORM")){f=RR.session("REGISTERED_PROSPECT_PURCHASE_PENSION_FORM")
}}}}}}}if(f){d.typeOfPensionSelect.val(f.typeOfPension);
d.confirmPensionNotIncludes.find(".controls input").attr("checked",f.confirmPensionTransfer==="true");
d.confirmPensionTransfer.find("#confirmPensionTransfer").attr("checked",f.confirmPensionTransfer==="true");
d.approxTransferValue.find(".controls input").val(f.approxTransferValue);
d.transferAccountNumber.find(".controls input").val(f.transferAccountNumber);
d.providersSelect.val(f.providers).change();
d.otherProvider.find(".controls input").val(f.otherProvider)
}}
});
RR.components.isaOutForm=RR.defineComponent(function(){var b;
var a;
this.init=function(){this.type=this.params.type;
if(RR.session("email")){switch(this.type){case"isaOut":this.isaOutFormInit();
break;
default:break
}}};
this.isaOutFormInit=function(){var c=this;
var e=RR.url.parameter("productId");
var f=new RR.api.Product(e);
$(RR).on("uiSecurityCheckCompleted",$.proxy(this.submit,this));
f.get().done(function(g,i){if(g===200){b=i;
var h=$("#isa-value");
var k=h.html();
var l=i.value;
a=l*0.99;
$("[name=amount]").parsley("addConstraint",{maxwithdrawal:a});
var j={value:RR.utils.formatStringAsCurrency(a,"")};
h.html(_.template(k,j));
if(i.regularWithdrawal){$("[name=amount]").val(i.regularWithdrawal.amount);
$("[name=paymentFrequency]").val(i.regularWithdrawal.frequency);
$("#secondaryAction2").on("click",function(){$("#isaCancelModal").modal("show")
})
}else{$("#startDate-outer").show()
}}});
$("#paymentFrequency").on("change",function(){$("#startDate-outer").show();
var g=RR.utils.calculatePaymentMonthForMoneyOut()+1;
$("[name=startDate]").val(g).prop("selected",true)
});
$("#form-button2").bind("click",function(){window.location=RR.route("BASIC_PROFILE")
});
$(RR).on("dataCustomerDetails",function(i,h){c.data=h;
var g=h.bankDetails;
if(g[0]===null||g[0]===undefined){$("#form-button2").removeClass("hidden");
$("#secondary-form-actions").addClass("hidden");
$(".form-panel-fieldset").addClass("hidden")
}else{$("#form-button").removeClass("hidden")
}});
c.on("uiCancelAction",this.reset);
c.$el.parsley("addListener",{onFormSubmit:$.proxy(this.startSecurityCheck,this)});
var d=new Date();
if(d.getMonth()===11){d=new Date(d.getFullYear()+1,1)
}this.$el.find("[name=startDate] option").each(function(){var h=$(this);
if(h.val()){var g=d.getYear()+1900;
if(Number(h.val())<RR.utils.calculatePaymentMonthForMoneyOut()+1){g+=1
}h.html(h.html()+" "+g)
}});
$(RR).trigger("uiNeedsDataCustomerDetails")
};
this.extractTransferData=function(){var c=null;
var g=RR.components.form2object(this.$el);
var d;
if(g.startDate){d=g.startDate
}else{d=RR.utils.calculatePaymentMonthForMoneyOut()+1
}try{if(this.params.type==="oneoff"){c={percentage:false,amount:Number(g.amount),operation:"single"}
}else{if(b.regularWithdrawal){c={percentage:false,oldAmount:Number(b.regularWithdrawal.amount),oldFrequency:b.regularWithdrawal.frequency,amount:Number(g.amount),operation:"regular",frequency:g.paymentFrequency,startMonth:Number(d),id:b.regularWithdrawal.id,availableBalance:a}
}else{c={percentage:false,amount:Number(g.amount),operation:"regular",frequency:g.paymentFrequency,startMonth:Number(d),availableBalance:a}
}}}catch(f){}c.productId=RR.url.parameter("productId");
return c
};
this.startSecurityCheck=function(d,c){if(d){$(RR).trigger("uiStartSecurityCheck",{guid:this.guid})
}return false
};
this.submit=function(f,d){if(d.guid===this.guid){var c=this.extractTransferData();
if(c){RR.session("transferOut",c).done(function(){RR.url.redirect("MANAGE_ISA_FUNDS_CONFIRM")
})
}else{}}};
this.customerDetailsFormSave=function(d){var c=this;
var e=RR.session("email");
var f=new RR.api.Customer(e);
if(c.hasMarketingPreferencesField){_.each(this.customerDetailsFormMarketingChannels,function(g){if(!d[this.marketingPreferencesFieldName].hasOwnProperty(g)){d[this.marketingPreferencesFieldName][g]=false
}else{d[this.marketingPreferencesFieldName][g]=true
}},this)
}f.details(d).done(function(g){if(g===200){if(c.newEmailAddress){c.customerDetailsFormSaveNewEmailAddressAndLogout(c.newEmailAddress)
}else{c.data=d;
c.$el.trigger("uiFormSubmitted",d)
}}})
};
this.isaWithdrawalFormSubmit=function(e){var c=this;
var d=RR.url.parameter("productId");
var f=new RR.api.Product(d);
f.transferOut(e).done(function(g){if(g===200){if(c.newEmailAddress){c.customerDetailsFormSaveNewEmailAddressAndLogout(c.newEmailAddress)
}else{c.data=e;
c.$el.trigger("uiFormSubmitted",e)
}}})
}
});
RR.components.footerWarning=RR.defineComponent(function(){var d={};
var b=this;
var f=$("#cookie-statement");
var c=$("#cookieWarning");
var a=$("#browserWarning");
var e=$("#downtimeWarning");
this.init=function(){if(!RR.utils.isAuthor()){$(".fixed-footer-container").attr("id","fixed-footer")
}var i=this.$el.attr("data-cookie-warning-version");
var h=this.$el.attr("data-browser-warning-version");
var j=this.$el.attr("data-downtime-warning-version");
var g=this.$el.attr("data-downtimeActive");
this.checkAndSetCookie(i,h,j,g);
this.closeButton(this.$el,j)
};
this.checkAndSetCookie=function(i,h,k,g){var j=0;
if($.cookie("RR-cookie-warning")!==i){d.cookies=true;
f.removeClass("hidden");
c.removeClass("hidden");
$.cookie("RR-cookie-warning",i,{expires:999,path:"/"});
j=j+1
}if(b.checkBrowser(h)&&($.cookie("RR-browser-warning")!==h)){d.browser=true;
f.removeClass("hidden");
a.removeClass("hidden");
$.cookie("RR-browser-warning",h,{expires:999,path:"/"});
j=j+1
}if(($.cookie("RR-downtime-warning")!==k)&&(g==="true")){d.downtime=true;
f.removeClass("hidden");
e.removeClass("hidden");
j=j+1
}if((RR.utils.isAuthor())&(RR.currentPageId()==="HOME_SIGNED_OUT")){f.removeClass("hidden");
c.removeClass("hidden");
a.removeClass("hidden");
e.removeClass("hidden")
}if(j===1){$("#warningSingle").removeClass("hidden")
}else{if(j>1){$("#warningMultiple").removeClass("hidden")
}}};
this.checkBrowser=function(h){var g=jQuery.parseJSON(h.replace(/'/g,'"'));
var i=platform.version;
var j="";
if(i){j=parseInt(i.split(".")[0],10)
}if((platform.os.family==="Windows Phone OS")&&(g.iewp>=j)){return true
}else{if((platform.name==="IE")&&(g.ie>=j)){return true
}else{if((platform.name==="Firefox")&&(g.ff>=j)){return true
}else{if((platform.name==="Android Browser")&&(g.ffdroid>=j)){return true
}else{if((platform.name==="Chrome")&&(g.chromedesktop>=j)){return true
}else{if((platform.name==="Chrome Mobile")&&(platform.os.family==="iOS")&&(g.chromeios>=j)){return true
}else{if((platform.name==="Chrome Mobile")&&(platform.os.family==="Android")&&(g.chromedroid>=j)){return true
}else{if((platform.name==="Safari")&&(platform.os.family==="iOS")&&(g.safariios>=j)){return true
}else{return false
}}}}}}}}};
this.closeButton=function(g,h){if(d.cookies|d.browser|d.downtime){this.$el.find(".btn-cancel-icon.ico").click(function(){if(d.downtime){$.cookie("RR-downtime-warning",h,{expires:999,path:"/"})
}g.hide()
})
}}
});
RR.components.navigateAwayModal=RR.defineComponent(function(){var b=this,a;
this.init=function(){var d=$("#navigateAwayModal").data();
this.onModalsOnly=d.onModalsOnly;
var c=d.selectorsToWarnOn;
if(this.onModalsOnly){if(c&&c.selectors){b.activateOnModalsOnly(c.selectors)
}}else{$(RR).trigger("navigateAwayModal:init")
}};
this.activateOnModalsOnly=function(c){if(c&&c.length>0){$(RR).trigger("navigateAwayModal:deactivate");
_.each(c,function(d){$("body").on("show.bs.modal",d,function(){$(RR).trigger("navigateAwayModal:activate",{isModal:true})
});
$("body").on("hide.bs.modal",d,function(){$(RR).trigger("navigateAwayModal:deactivate")
})
})
}}
});
RR.components.sessionExpiringModal=RR.defineComponent(function(){this.reset=function(){if(this.timeout){window.clearTimeout(this.timeout)
}$(RR).trigger("uiSessionExpiringModalClosed")
};
this.startTimer=function(c){var a=this;
function b(){var d;
var f=a.template;
var h=moment(Math.max(0,c)).format("mm:ss");
try{d=_.template(f,{timer:h})
}catch(g){d=f
}a.$modalBody.html(d);
if(c>=1000){c-=1000;
a.timeout=window.setTimeout(b,1000)
}else{a.$el.find(".modal-action-button").hide()
}}b()
};
this.hide=function(){this.$el.modal("hide");
$(window).off("scrollEnd.sessionExpiringModal")
};
this.show=function(b,a){var c=a.timeLeft;
this.startTimer(c);
this.$el.modal("show");
$(window).on("scrollEnd.sessionExpiringModal",$.proxy(this.hide,this))
};
this.init=function(){this.timeout=null;
this.$modalBody=this.$el.find(".modal-body");
this.template=this.$modalBody.html();
this.on(RR,"uiShowSessionExpiringModal",$.proxy(this.show,this));
this.on("hide",this.reset)
}
});
RR.components.button=RR.defineComponent(function(){var b=this,d={},c,a;
this.showProcessingButton=function(e){b.$el.addClass("hidden");
b.$processingButton.removeClass("hidden");
if(e){b.stopCallTracker()
}else{b.startCallTracker()
}};
this.hideProcessingButton=function(f){b.$el.removeClass("hidden");
b.$processingButton.addClass("hidden")
};
this.startCallTracker=function(){a=a||new RR.callTracker();
if(a.startTracking(1)){$(a).on("callTracker:allCallsComplete",function(g,f){if(!f){b.hideProcessingButton()
}})
}};
this.stopCallTracker=function(){if(a){a.stopTrackingApiCalls();
$(a).off("callTracker:allCallsComplete");
a=null
}};
this.initEventListeners=function(){if(d.showSpinner){$("body").on("click",".show-spinner",function(f){b.showProcessingButton()
});
$(RR).on("hideProcessingButton",b.hideProcessingButton);
$(RR).on("showProcessingButton",function(f,g){g=!!g;
b.showProcessingButton(g)
})
}if(d.showPageSpinner){b.$el.click(function(){$(RR).trigger("headway:showSpinner")
})
}};
this.init=function(){d=this.$el.data();
if(d.showSpinner){var e=this.$el.siblings(".btn-processing");
if(e.length>0){this.$processingButton=$(e[0])
}}this.initEventListeners()
}
});
RR.components.termsWarning=RR.defineComponent(function(){var c={};
var b=this;
var a=$("#terms-modal");
this.init=function(){if(!RR.utils.isAuthor()){$(".fixed-footer-container").attr("id","fixed-footer")
}if(RR.session("CustomerIndex")){var d=this.$el.attr("data-terms-warning-version");
this.checkAndSetCookie(d);
this.closeButton(this.$el)
}};
this.checkAndSetCookie=function(e){var d=0;
if($.cookie("RR-terms-warning")!==e){c.cookies=true;
a.modal("show");
$.cookie("RR-terms-warning",e);
d=d+1
}};
this.closeButton=function(d){this.$el.find(".btn-cancel-icon.ico").click(function(){d.modal("hide")
})
}
});
RR.components.updateProfileModal=RR.defineComponent(function(){var a=this;
var b=$("#update-modal");
this.init=function(){if(RR.utils.isRegisteredCustomer()){this.initEvent();
$(RR).trigger("uiNeedsCustomerDetails");
$(RR).on("spinnerFinished",this.initModal())
}};
this.initButtonStyle=function(){var c=$(".cancelButton");
var d=$(".actionButton");
c.removeClass().show();
c.addClass("btn btn-secondary").show();
d.removeClass().show();
d.addClass("btn btn-primary").show()
};
this.initEvent=function(){$(RR).on("dataCustomerDetails",function(d,c){a.data=c;
a.renderData()
})
};
this.renderData=function(){var c=b.html();
b.html(_.template(c,a.data))
};
this.initModal=function(){var c=new moment();
var d=new moment(RR.session("lastLogin"));
d.add("month",6).calendar();
if(d.isBefore(c)){this.initButtonStyle();
b.modal("show")
}}
});
RR.components.coachAlert=RR.defineComponent(function(){var a=this;
this.actionTaken=function(d,e){var c=$.Deferred(),b=this.coachApi.performAction({activityType:d,actionId:a.alertId});
e=e===undefined?true:e;
b.done(function(f,g){if(d==="done"){c.resolve();
if(e){a.$coachAlert.addClass("hidden");
a.$coachConfirm.removeClass("hidden");
window.setTimeout(function(){a.$coachConfirm.fadeOut(2000)
},3000)
}a.initEvents()
}if(d==="dismiss"){a.$coachAlert.fadeOut(2000);
a.initEvents();
c.resolve()
}});
return c.promise()
};
this.renderNotification=function(){var c,e={},d=a.$coachAlert.html(),f={SIGNED_IN_HOME:"H",BASIC_PROFILE:"P",LANDING_SHOP_HOME:"Sh",SAVINGS:"Sa",GOALS_DASHBOARD:"G",GOALS_LANDING:"G"},b=RR.currentPageId();
if(b in f){e.activityContext=f[b]
}else{e.activityContext=RR.currentPageId()
}e.peerContext="";
c=this.coachApi.nextBestAction(e);
c.done(function(h,i){var g;
if(i.actions&&i.actions.length>0){a.$coachAlert.html(_.template(d,i.actions[0]));
g=a.$coachAlert.find(".actions-primary");
a.$coachAlert.find('[data-visible="false"]').hide();
g.toggleClass("hidden",g.find("a").attr("data-href")==="");
a.alertId=i.actions[0].actionId||"";
a.$coachAlert.removeClass("hidden")
}})
};
this.initEvents=function(){$("body").on("click",".coach-confirm-button",function(b){b.preventDefault();
a.actionTaken("done")
});
$("body").on("click",".coach-pause-button",function(b){b.preventDefault();
a.actionTaken("dismiss")
});
$("body").on("click",".actions-primary a",function(c){c.preventDefault();
$(RR).trigger("headway:showSpinner");
var b=a.actionTaken("done",false);
b.done(function(){window.location=a.$coachAlert.find(".actions-primary a").attr("data-href")
})
})
};
this.init=function(){this.$coachAlert=this.$el.find(".coach-alert");
this.$coachConfirm=this.$el.find(".coach-confirmation");
this.$completeButton=this.$coachAlert.find(".coach-confirm-button");
this.$doLaterButton=this.$coachAlert.find(".coach-pause-button");
this.$actionButton=this.$coachAlert.find(".actions-primary a");
this.emailAddress=RR.session("email")||"";
this.coachApi=new RR.api.Coach(this.emailAddress);
if(RR.utils.isUserLoggedIn()){this.initEvents();
this.renderNotification()
}}
});
RR.components.scorePanel=RR.defineComponent(function(){var i=this,c="MASTER",f,d,g,b,h=85,a=65,j=46,e;
this.init=function(){var k;
this.scoreApi=new RR.api.Score();
this.$panelWithScore=$("#scorePanel");
this.$panelWithoutScore=$("#scorePanel-noScore");
this.$ratingsBreakdown=$("#scorePanel-breakdowns");
this.$breakdownModal=$("#score-advisory-modal");
if(RR.session.exists()){k=this.scoreApi.retrieveScore();
k.done(function(l,n,m){if(l===200){e=true;
$(RR).trigger("getScore",{hasScore:e});
i.showPanelWithScore(n)
}else{e=false;
$(RR).trigger("getScore",{hasScore:e});
i.showPanelWithoutScore()
}})
}else{e=false;
$(RR).trigger("getScore",{hasScore:e});
i.showPanelWithoutScore()
}this.initEvents()
};
this.initEvents=function(){$(RR).on("scorePanel:display",function(){i.displayScorePanel()
})
};
this.showPanelWithScore=function(k){var m=k.scores[c].scoreValue;
var l=""+m;
i.updateScorePanelColour(m);
i.$panelWithScore.find(".screenreader-visible").text(l+"/100");
i.$panelWithScore.find(".widget-counter > div").not(".non-flipboard").remove();
_.each(l.split("").reverse(),function(n){i.$panelWithScore.find(".widget-counter").prepend("<div><span>"+n+"</span></div>")
});
i.$panelWithScore.find(".score-advisory-text").text(k.scores[c].advisoryShortText);
i.$breakdownModal.find(".score-advisory-intro").text(k.scores[c].advisoryLongText);
_.each(k.scores,function(q,n,p){var o=k.scores[n].starCount;
$(".breakdown-"+n+" .rating-ico span").slice(0,o).each(function(r){$(this).addClass("preset")
})
});
i.$ratingsBreakdown.find(".breakdown-MASTER").hide();
i.$breakdownModal.find(".modal-body").addClass("score-modal").removeClass("help-modal-body");
i.$ratingsBreakdown.appendTo(i.$breakdownModal.find(".modal-body")).removeClass("hide");
i.displayScorePanel()
};
this.displayScorePanel=function(){i.$panelWithScore.toggleClass("hide",!e);
i.$panelWithoutScore.toggleClass("hide",e);
i.$panelWithoutScore.remove()
};
this.showPanelWithoutScore=function(){i.displayScorePanel()
};
this.updateScorePanelColour=function(l){l=parseInt(l,10);
var k="";
_.each(["score-low","score-medium","score-high","score-very-high"],function(m){i.$panelWithScore.removeClass(m)
});
if(l>=h){k="score-very-high"
}else{if(l>=a){k="score-high"
}else{if(l>=j){k="score-medium"
}else{k="score-low"
}}}i.$panelWithScore.addClass(k)
}
});
RR.components.lifestylePlanner=RR.defineComponent(function(){var b=this,a=$(".btn-add .title").eq(0).html(),c={personalDetails:{},lifestyleOptions:{}};
this.resetClick=function(){$("#reset-group1items .actionButton").click(function(){b.resetItems("group1")
});
$("#reset-group2items .actionButton").click(function(){b.resetItems("group2")
})
};
this.resetItems=function(d){b.clearItem(d);
b.repopulateItems(c);
b.getScore(false)
};
this.clearItem=function(f){var e=c.lifestyleOptions.costUnits;
for(var d=0;
d<e.length;
d++){if(e[d].group===f){if(e[d].custom===true){e[d].costUnitName=""
}e[d].costPresentValue=0;
e[d].costFrequency="WEEK"
}}c.lifestyleOptions.costUnits=e
};
this.addAmountClick=function(){$(".add-button").click(function(d){d.preventDefault();
b.addAmount($(this))
})
};
this.addAmount=function(e,g){var d=e.closest(".modal");
var f=d.data("item-id");
var h=d.data("title");
var j=$("#title-"+f).val();
if($("#form-"+f).parsley("validate")){if(parseInt($("#paymentInput-"+f).val(),10)!==0){$("#-value-"+f).html("&pound;"+$("#paymentInput-"+f).val());
$("#-frequency-"+f).text($("#select-type-"+f+" :selected").text());
$("#-frequencyValue-"+f).val($("#select-type-"+f+" :selected").val());
$("#-anchor-"+f).addClass("btn active");
if(d.data("custom")===true){$("#-frequency-"+f).removeClass("hidden");
$("#-anchor-"+f).removeClass("btn-add");
$("#-remaining-"+f).addClass("hidden");
$("#-title-"+f).html(j);
$("#-anchor-"+f).attr("title",j);
$("#"+f+" .remove-button").removeClass("hidden");
b.updateSibling(f,h,"costUnitName",$("#title-"+f).val());
b.showCustom(h,f+1)
}b.updateSibling(f,h,"costPresentValue",$("#paymentInput-"+f).val());
b.updateSibling(f,h,"costFrequency",$("#-frequencyValue-"+f).val());
if(g){}else{b.getScore()
}$("#"+f).modal("hide")
}else{b.removeItem(e,g);
$("#"+f).modal("hide")
}}};
this.removeItemClick=function(){$(".remove-button").click(function(d){d.preventDefault();
b.removeItem($(this))
})
};
this.removeItem=function(e,g){var f=e.closest(".modal").data("item-id");
var j=e.closest(".modal").data("title");
var h=e.data("custom");
$("#-value-"+f).text("");
$("#-frequency-"+f).text("per month");
$("#-anchor-"+f).removeAttr("class");
$("#-anchor-"+f).attr("class","btn");
var d=e.closest(".modal");
b.updateSibling(f,j,"costPresentValue",0);
$("#paymentInput-"+f).val("");
if(d.data("custom")===true){$("#-frequency-"+f).addClass("hidden");
$("#-anchor-"+f).addClass("btn-add");
$("#-remaining-"+f).removeClass("hidden");
b.updateSibling(f,j,"costUnitName",a);
$("#-title-"+f).html(a);
$("#title-"+f).val("");
$("#-anchor-"+f).attr("title",a);
$("#"+f+" .remove-button").addClass("hidden");
b.hideCustom(j,f+1)
}if(g){}else{b.getScore()
}};
this.scrapeDataFromPage=function(d,e){return{costUnitID:d.data("index"),costUnitName:d.find(".title").html(),costPresentValue:0,costFutureValue:0,costCategory:e,costFrequency:d.find(".frequencyValue").val(),custom:d.data("custom"),costUnitOrder:d.data("index"),group:d.data("group")}
};
this.updateSibling=function(k,j,f,h){var e=c.lifestyleOptions.costUnits;
var g;
for(var d=0;
d<e.length;
d++){if((parseInt(e[d].costUnitID,10)===k)&&(e[d].group===j)){g=d
}}c.lifestyleOptions.costUnits[g][f]=h
};
this.createDefaultCostUnits=function(){var d=[];
$("#group1-items li").each(function(e){d.push(b.scrapeDataFromPage($(this),"Basic"))
});
$("#group2-items li").each(function(e){d.push(b.scrapeDataFromPage($(this),"Luxury"))
});
return d
};
this.cleanDataForAPI=function(e){for(var d=0;
d<e.lifestyleOptions.costUnits.length;
d++){delete e.lifestyleOptions.costUnits[d].group
}return e
};
this.reorderCustomCostUnits=function(m,h,l){var g=[],e=[],i;
if(!_.isArray(m)||h===undefined||l===undefined){return m
}m=_(m).sortBy(function(j){return parseInt(j.costUnitID,10)
});
for(var f=0;
f<l;
f++){i=m[h+f];
if(i.costPresentValue>0){g.push(i)
}else{e.push(i)
}}g=g.concat(e);
for(var d=0;
d<g.length;
d++){m[h+d]=g[d];
m[h+d].costUnitOrder=h+d;
m[h+d].costUnitID=(h+d).toString()
}return m
};
this.repopulateItems=function(g){g.lifestyleOptions.costUnits=this.reorderCustomCostUnits(g.lifestyleOptions.costUnits,9,3);
g.lifestyleOptions.costUnits=this.reorderCustomCostUnits(g.lifestyleOptions.costUnits,17,3);
for(var f in g.lifestyleOptions.costUnits){var d=g.lifestyleOptions.costUnits[f];
var e=parseInt(d.costUnitID,10);
$("#paymentInput-"+e).val(d.costPresentValue);
if(d.custom){if(d.costUnitName!==a){$("#title-"+e).val(d.costUnitName)
}}if(parseInt(d.costPresentValue,10)!==0){$("#select-type-"+e).val([]);
$("#select-type-"+e+" option[value="+d.costFrequency+"]").prop("selected","selected");
b.addAmount($("#"+e),true);
$("#modal-action-btn-remove--"+e).removeClass("hidden")
}else{b.removeItem($("#"+e),true);
$("#paymentInput-"+e).val("");
$("#-value-"+e).text("");
$("#-anchor-"+e).removeClass("active");
$("#modal-action-btn-remove--"+e).addClass("hidden")
}}};
this.getScore=function(f){if(f===null||f===undefined){f=true
}$(RR).trigger("headway:showSpinner");
var g=b.cleanDataForAPI(jQuery.extend(true,{},c));
var d=new RR.api.Lifestyle();
var e=d.calculate(g);
e.done(function(h,i){if(h===200){b.populateAmount(i.lifestyleOptions.presentCostTotal,i.lifestyleOptions.futureCostTotal);
if(f){b.repopulateItems(i)
}}})
};
this.populateAmount=function(e,f){e=Math.round(e).toString(10);
f=Math.round(f).toString(10);
$(".widget-counter").empty();
$(".widget-counter").append('<div class="non-flipboard">&pound;</div>');
e=RR.utils.formatStringAsCurrency(e,"").split(".")[0];
for(var d=0;
d<e.length;
d++){if(e.charAt(d)===","){$(".widget-counter").append('<div class="non-flipboard">,</div>')
}else{$(".widget-counter").append("<div><span>"+e.charAt(d)+"</span></div>")
}}$("#totalAmt").html("&#163;"+e);
$("#inflationAmount").html(RR.utils.formatStringAsCurrency(f,"&#163;").split(".")[0])
};
this.getPreviousData=function(){this.lifestyle=new RR.api.Lifestyle();
var d=this.lifestyle.getLifestyle();
d.done(function(e,f){if(e===200){b.repopulateItems(f)
}else{if(e===204){b.getScore()
}}})
};
this.saveDataClick=function(){$("#makeTarget").click(function(d){d.preventDefault();
b.saveData()
})
};
this.manageCustomRemoveButtons=function(){};
this.saveData=function(){var g=b.cleanDataForAPI(jQuery.extend(true,{},c));
var e=new RR.api.Lifestyle();
var f=e.saveLifestyle(g);
var d=parseInt($("#totalAmt").text().replace(/[^0-9\.]+/g,""),10);
RR.session("plannerTarget",d);
f.done(function(h,i){if(h===200){RR.url.redirect("GOAL_PLANNER")
}})
};
this.showFirstCustom=function(d){$("li[data-group='"+d+"'][data-custom='true']").eq(0).removeClass("hidden")
};
this.showCustom=function(e,d){$("li[data-index='"+d+"']").removeClass("hidden")
};
this.hideCustom=function(e,d){if($("li[data-index='"+d+"']").data("custom")){$("li[data-index='"+d+"']").addClass("hidden")
}};
this.init=function(){RR.utils.redirectIfNoScore("GOALS_LANDING");
b.addAmountClick();
b.removeItemClick();
b.resetClick();
b.saveDataClick();
if(RR.utils.isAuthor()){$("li[data-custom='true'").removeClass("hidden")
}c.lifestyleOptions.costUnits=b.createDefaultCostUnits();
c.lifestyleOptions.inflationRate=$("#inflationValue").val();
RR.session("plannerTarget",-1);
this.scoreApi=new RR.api.Score();
var d=this.scoreApi.getPopulateDetails();
d.done(function(e,h,g){var f=$("#retirementYear");
c.personalDetails.retirementAge=h.personalDetails.retirementAge;
c.personalDetails.dateOfBirth=h.personalDetails.dateOfBirth;
f.html(_.template(f.html(),{retirementYear:h.personalDetails.retirementYear}));
b.getPreviousData();
b.showFirstCustom("group1",0);
b.showFirstCustom("group2",0)
})
}
});
RR.components.coachChecklist=RR.defineComponent(function(){var a=this;
this.renderNotifications=function(f){var g="",b=a.$container.html(),c,e=(a.requestData.length>a.offset+f)?a.offset+f:a.requestData.length,h,d;
a.lastNotificationId=a.lastNotificationId||"";
a.lastNotificationDate=a.lastNotificationDate||"";
for(c=a.offset;
c<e;
c++){if(a.params.instanceName==="soFar"){h=_.where(a.requestData,{actionId:a.requestData[c].actionId});
if(h.length>1){a.requestData[c].actionId+="-"+c
}if(RR.utils.arrayToDateFormatted(a.requestData[c].lastModifiedDate)!==a.lastNotificationDate){g+="<p>Completed "+RR.utils.arrayToDateFormatted(a.requestData[c].lastModifiedDate)+"</p>"
}a.lastNotificationDate=RR.utils.arrayToDateFormatted(a.requestData[c].lastModifiedDate)
}d=a.requestData[c];
d.soFarId=a.requestData[c].actionId;
g+=_.template(a.notificationsTemplate,d);
a.lastNotificationId=a.requestData[c].actionId
}a.$container.html(b+g);
a.offset+=f;
a.noNotificationsMessage();
a.$container.find('[data-visible="false"]').hide();
a.$container.find(".checklist-action-button").each(function(){var i=$(this);
i.toggleClass("hidden",i.attr("data-href")==="")
});
if(a.offset>=a.requestData.length){a.hidePaginationLink()
}};
this.getNotifications=function(b){var c=this.coachApi.getNotifications({activityType:b});
c.done(function(d,e){if(e.actions){a.requestData=e.actions;
a.notificationsCount=e.actions.length;
a.renderNotifications(a.notificationsPerPage)
}});
c.fail(function(){a.noNotificationsMessage()
})
};
this.actionTaken=function(f,e){var d=$.Deferred(),c=e.closest(".accordion-body").attr("id"),g=e.closest("fieldset"),b=this.coachApi.performAction({activityType:f,actionId:c});
b.done(function(h,i){if(f==="done"){d.resolve();
g.html(a.completedActionTemplate).fadeOut(2000,function(){g.remove();
a.notificationsCount-=1;
a.noNotificationsMessage();
if(a.$container.find("fieldset").length===0&&a.notificationsCount>0){a.renderNotifications(a.notificationsPerPage)
}})
}});
return d.promise()
};
this.noNotificationsMessage=function(){var b=a.notificationsCount!==0;
a.$el.find(".noNotificationsMessage").toggleClass("hidden",b);
a.$el.find(".coachIntroText").toggleClass("hidden",b);
if(!b){this.hidePaginationLink()
}};
this.hidePaginationLink=function(){a.$el.find(".pagination-more").hide()
};
this.resetNotifications=function(){this.offset=0;
this.notificationsCount=0;
this.$container.html("")
};
this.initEvents=function(){$("#more-info-panel").hide();
$('[href="#yourjourney"]').on("click",function(){$(RR).trigger("scorePanel:display");
$("#more-info-panel").hide()
});
$('[href="#sofar"]').on("click",function(){$(RR).trigger("scorePanel:display");
$("#more-info-panel").hide()
});
this.$container.next(".pagination-more").on("click",function(b){a.renderNotifications(a.notificationsPerPage)
});
if(a.params.instanceName==="soFar"){$("[href=#sofar]").on("click",function(){a.resetNotifications();
a.notificationsPerPage=5;
a.getNotifications(a.activityType)
})
}if(a.params.instanceName==="yourJourney"){$("body").on("click",".checklist-confirm-button",function(b){b.preventDefault();
a.actionTaken("done",$(this))
});
$("body").on("click",".checklist-action-button",function(d){d.preventDefault();
var c=$(this),b=a.actionTaken("done",c);
b.done(function(){window.location=c.attr("data-href")
})
});
$('[data-target="#collapse1"]').on("click",function(){$('[data-target="#collapse1"]').toggle()
})
}};
this.init=function(){var b=$("#coach-checklist-confirmation"),c;
this.emailAddress=RR.session("email")||"";
a.offset=0;
a.notificationsCount=0;
if(a.params.instanceName==="yourJourney"){a.completedActionTemplate=b.html();
b.remove();
c=this.$el.find(".coach-actions");
c.find("fieldset").removeClass("hidden");
a.notificationsTemplate=c.html();
c.find("fieldset").remove();
a.notificationsPerPage=5;
this.activityType="dismiss";
a.$container=this.$el.find("#accordion1")
}if(a.params.instanceName==="soFar"){c=this.$el.find(".coach-actions");
c.find(".coach-so-far").removeClass("hidden");
a.notificationsTemplate=c.html();
c.html("");
a.notificationsPerPage=10;
this.activityType="done";
a.$container=this.$el.find("#accordion2")
}if(RR.utils.isUserLoggedIn()){this.coachApi=new RR.api.Coach(this.emailAddress);
this.initEvents();
this.getNotifications(a.activityType)
}}
});
RR.components.multipleChoice=RR.defineComponent(function(){var a=this;
var b={selectedLabel:"label.r_on",formCorrect:"chosen-correct-answer",formWrong:"chosen-wrong-answer",correctAnswer:"correct-answer",wrongAnswer:"incorrect-answer",correctAnswerMessage:"correct-notification",incorrectAnswerMessage:"incorrect-notification"};
this.init=function(){$(RR).on("multipleChoice:checkAnswer",this.checkAnswer)
};
this.checkAnswer=function(){var d=a.$el.data();
var c=a.getChosenLabel();
if(d.answer===c.find("span").text()){a.$el.removeClass(b.formWrong).addClass(b.formCorrect);
a.$el.find("."+b.wrongAnswer).removeClass(b.wrongAnswer);
c.addClass(b.correctAnswer)
}else{a.$el.removeClass(b.formCorrect).addClass(b.formWrong);
a.$el.find("."+b.correctAnswer).removeClass(b.correctAnswer);
c.addClass(b.wrongAnswer)
}a.showAnswerMessage()
};
this.getChosenLabel=function(){return a.$el.find(b.selectedLabel)
};
this.showAnswerMessage=function(f,e){_.each([b.correctAnswerMessage,b.incorrectAnswerMessage],function(i,g,h){a.$el.find("."+i).hide()
});
var d=a.$el.hasClass(b.formCorrect);
var c=(d)?b.correctAnswerMessage:b.incorrectAnswerMessage;
a.$el.find("."+c).insertBefore(a.getChosenLabel()).show().find(".notification-text").focus()
}
});
RR.components.savingsHome=RR.defineComponent(function(){var b,a=this;
this.getSavingProductsMap=function(){var d=RR.session("email");
var h=new RR.api.Account(d);
var e;
var g;
var c=[];
var f;
e=h.productsmap({});
e.done(function(i,k){if(RR.utils.isAuthor()){a.processData({totalValue:0,products:[]})
}else{RR.plugins.docParams.keyDocParam(k);
$.each(k.products.PENSION,function(l,m){m.type="PENSION";
c.push(m)
});
$.each(k.products.ISA,function(l,m){m.type="ISA";
c.push(m)
});
$.each(k.products.OTHER,function(l,m){m.type="OTHER";
c.push(m)
});
var j={products:c,totalValue:k.totalValue,pendingProducts:k.pendingProducts};
a.processData(j)
}})
};
this.processData=function(d){var c=a.getMaxValueLength(d);
$("#widgetCounter").removeClass().addClass("widget-counter-"+c);
$("#widgetCounter").attr("data-maxlength",c);
a.showSavingProducts(d);
$(".overview").removeClass("hidden")
};
this.init=function(c,d){this.getSavingProductsMap();
this.initEvents()
};
this.initEvents=function(){$(RR).on("productSelection",a.productSelectionAction)
};
this.showSavingProducts=function(e){var d=0;
var g=0;
var c=0;
var h=0;
var f="none";
if(e.products){d=e.totalValue;
$(".block-list-menu-advanced .savings-total h3").text($("#productDetailHeader").text());
$("#summaryLinksAction ul li").hide();
a.products={};
$.each(e.products,function(i,j){if(j.source==="RR"){$(RR).trigger("productPerformance",{productId:j.id})
}a.products[j.id]={};
_.each(j,function(l,k){a.products[j.id][k]=l
});
if(j.type==="PENSION"){g+=j.value
}if(j.type==="ISA"){c+=j.value
}if(j.source==="USER"){h+=j.value
}});
$(".savings-total").attr("data-type","total");
b={totalpension:g,totalisa:c,totalmemoasset:h};
f="total"
}$(RR).trigger("productSelection",{productType:f,noHashChange:true});
$(".savings-memo.hidden").hide()
};
this.getMaxValueLength=function(d){var c=Math.round(d.totalValue).toString().replace(/[^0-9]+/g,"").length;
if(c<6){c=6
}$.each(d.products,function(f,e){var g=Math.round(e.value).toString().replace(/[^0-9]+/g,"").length;
if(g>c){c=g
}});
return c
};
this.productSelectionAction=function(f,i){var h=new Date();
var m=h.getDay();
var g=h.getMonth()+1;
var j=h.getFullYear();
var k=[j,g,m];
var l=b.totalpension+b.totalisa+b.totalmemoasset;
var c;
$(RR).trigger("productSelectionRender",{productId:"",value:l,locked:false,title:"Total savings",total:l,type:"total",source:"",effectiveDate:"",item:"--undefined",pension:b.totalpension,isa:b.totalisa,memoasset:b.totalmemoasset,asOfDate:k,contributions:c,homeView:true,userProducts:a.products})
}
});
RR.components.goalsAndScore=RR.defineComponent(function(){var a=this;
this.init=function(){this.goalsApi=new RR.api.Goals();
$(RR).on("getScore",a.initScoreInfo);
if(a.params.instanceName==="savingsscore"){a.getScore()
}};
this.getScore=function(){var b;
this.scoreApi=new RR.api.Score();
if(RR.session.exists()){b=this.scoreApi.retrieveScore();
b.done(function(c,e,d){if(c===200){$(RR).trigger("getScore",{hasScore:true})
}else{$(RR).trigger("getScore",{hasScore:false})
}})
}else{$(RR).trigger("getScore",{hasScore:false})
}};
this.initScoreInfo=function(d,b){if(!RR.utils.isAuthor()){if(RR.utils.isUserLoggedIn()&&b.hasScore){a.populateScoreInformation();
var c=a.goalsApi.getPopulateDetails();
c.done(function(e,g,f){a.prepopulateData(g);
a.makeForecastProjection(g)
});
c.fail(function(e,g,f){a.showScoreInformation()
})
}else{a.showScoreInformation()
}}};
this.prepopulateData=function(c){RR.utils.renderWidgetCounter($(".retirementAge"),c.personalDetails.retirementAge);
var b={};
b.RETIREMENT_YEAR=c.personalDetails.retirementYear||"{{activeUser.RETIREMENT_YEAR}}";
RR.plugins.templates.setTemplateVar("activeUser",b).render();
RR.utils.renderWidgetCounter($(".annualIncome"),RR.utils.formatAmount(c.targetAnnualIncome,"G"));
if(c.tfcPercentage<=0){$(".annualIncome").find(".lumsum").remove()
}};
this.makeForecastProjection=function(b){var c=this.goalsApi.makeProjection(b);
c.done(function(f,h,g){var d=(h.ageShortFall<=0);
var e=(h.incomeShortfall<=0);
if(d&&e){$(".not-on-track").remove()
}else{$(".on-track").remove()
}})
};
this.populateScoreInformation=function(b){$(".withoutScore").remove()
};
this.showScoreInformation=function(){$(".withScore").remove();
if(a.params.instanceName==="profilescore"){$(".withoutScore").remove()
}}
});
RR.components.taskList=RR.defineComponent(function(){var b=this,a;
this.init=function(){this.goalsApi=new RR.api.Goals();
var c=this.goalsApi.getTaskList();
c.done(function(d,f,e){if(d===200){if(f.length>0){b.showTaskList(f);
if($(".authMode").length===0){$("#redirectLifplanner").show();
$("#redirectPublicshop").hide()
}}else{b.hideTaskList()
}}else{b.hideTaskList()
}});
c.fail(function(d,f,e){b.hideTaskList()
});
this.fundNames=this.getFundNameMappings();
b.$todosPromoPanel=$(".todos-promo-panel");
b.$todoList=this.$el.find(".to-do-list");
this.initEvents()
};
this.initEvents=function(){$("#clearList").on("click","button.btn-primary",b.onClearList)
};
this.getFundNameMappings=function(){var d=this.$el.data(),c={};
_.each(["A","B","C","D","E"],function(e){c[e]=d["fund"+e+"Name"]
});
return c
};
this.showTaskList=function(f){var d=RR.utils.isUserLoggedIn(),e=["UPDATE_RR_PENSION_PRODUCT_OPTION","UPDATE_RR_ISA_PRODUCT_OPTION"],c;
b.$todoList.find("li").each(function(g){c=$(this).data();
if(c.secondaryText){$(this).find("p").text(c.secondaryText)
}else{$(this).find("p").remove()
}if(d){if(c.primaryTitle){$(this).find("h3").text(c.primaryTitle)
}}else{if(c.prospectTitle){$(this).find("h3").text(c.prospectTitle)
}else{if(c.primaryTitle){$(this).find("h3").text(c.primaryTitle)
}}}$(this).hide()
});
_.each(f,function(g){var i=b.$todoList.find("#task-"+g.taskName);
if(e.indexOf(g.taskName)>=0){g.taskNewValue=b.fundNames[g.taskNewValue];
if(g.taskOldValue){g.taskOldValue=b.fundNames[g.taskOldValue]
}}if(i.length>0){var k,h,j=i.find("h3"),l=i.find("p");
if(j.text().indexOf("{{")>=0){k=RR.utils.formatStringAsCurrency(g.taskNewValue,"");
j.text(j.text().replace("{{","{{"))
}else{k=g.taskNewValue
}RR.utils.replaceTemplateString(j,"{{value}}",k);
if(l.length>0){if(l.text().indexOf("{{")>=0){h=RR.utils.formatStringAsCurrency(g.taskOldValue,"");
l.text(l.text().replace("{{","{{"))
}else{h=g.taskOldValue
}RR.utils.replaceTemplateString(l,"{{value}}",h)
}i.show()
}});
b.$todosPromoPanel.hide();
b.$todoList.show()
};
this.hideTaskList=function(){if($(".authMode").length===0){if(!RR.utils.isUserLoggedIn()){$("#redirectLifplanner .todos-promo-panel").hide()
}else{$("#redirectPublicshop").hide()
}}b.$todosPromoPanel.show();
b.$todoList.hide()
};
this.onClearList=function(d){d.preventDefault();
var c=b.goalsApi.deleteTaskList();
c.done(function(e,g,f){b.hideTaskList();
if($(".authMode").length===0){if(RR.utils.isUserLoggedIn()){$("#redirectLifplanner .todos-promo-panel").show()
}else{$("#redirectPublicshop").show();
$("#redirectLifplanner").hide()
}}})
}
});
RR.components.scoreTool=RR.defineComponent(function(){var a=this,d=$(".input-slider-hidden-value"),c=$(".date-select-range-html5 input");
this.config={currentPage:0,totalPages:3,submitButtons:[],forms:[],articlePrefix:"#score-section",controlsSelector:"div.controls",controlGroupSelector:"div.control-group"};
this.mappings={"$RECENCY":$("#score-recency"),"$CONSOLIDATION":$("#score-consolidation"),"$PERFORMANCE":$("#score-performance"),"$QUIZ":$("#score-multiple-choice"),"$dateOfBirthField":$(".date-select-range-html5 input"),"$dateOfBirthDay":$("select[name=day]"),"$dateOfBirthMonth":$("select[name=month]"),"$dateOfBirthYear":$("select[name=year]"),"$gender":$('[name="personalDetails.gender"]'),"$grossSalary":$('[name="salary"]'),"$retirementAge":$(".control-group.Age .sliderThumb1"),"$pensionValue":$("[name=pensionValue]"),"$pensionPersonalContributions":$("[name=pensionPersonalContributions]"),"$memoPensionValue":$("[name=memoPensionValue]"),"$memoPensionPersonalContributions":$("[name=memoPensionPersonalContributions]"),"$memoPensionEmployerContributions":$("[name=memoPensionEmployerContributions]"),"$isaValue":$("[name=isaValue]"),"$isaPersonalContributions":$("[name=isaPersonalContributions]"),"$memoIsaValue":$("[name=memoIsaValue]"),"$memoIsaPersonalContributions":$("[name=memoIsaPersonalContributions]"),"$targetAnnualIncome":$("[name=targetRetirementIncome]"),"$guaranteedAnnualIncome":$("[name=guaranteedAnnualIncome]"),"$postcode":$("[name=postcode]")};
var b={selectedLabel:"label.r_on",requireValidation:"incorrect-validation","score-multiple-choice":"score-multiple-choice"};
this.prepopulateData=function(A){var B=A&&A.personalDetails;
if(B){if(B.dateOfBirth&&B.dateOfBirth.length===3){var u=B.dateOfBirth[2],z=B.dateOfBirth[1],l=B.dateOfBirth[0];
a.mappings.$dateOfBirthYear.val(l).prop("disabled",true);
a.mappings.$dateOfBirthMonth.val(z).prop("disabled",true);
a.mappings.$dateOfBirthDay.val(u).prop("disabled",true);
a.mappings.$dateOfBirthField.change();
var r=""+u+"/"+z+"/"+l;
a.replaceControlsForElementWithText(a.mappings.$dateOfBirthYear,r)
}if(B.gender){a.mappings.$gender.filter("[value="+B.gender+"]").prop("checked",true);
a.mappings.$gender.prop("disabled",true);
var e=(B.gender==="M")?"Male":"Female";
a.replaceControlsForElementWithText(a.mappings.$gender,e)
}if(B.retirementAge){$(".Age .input-slider").attr("data-startvalue",B.retirementAge);
RR.plugins.ARIA_SLIDER.updateSliderFromElement();
a.replaceControlsForElementWithText(a.mappings.$retirementAge,B.retirementAge)
}if(B.grossSalary!==null&&B.grossSalary!==undefined){a.mappings.$grossSalary.val(B.grossSalary).prop("disabled",true);
var g=RR.utils.formatStringAsCurrency(B.grossSalary,"");
a.replaceControlsForElementWithText(a.mappings.$grossSalary,g)
}}var o=A.pension;
if(o){if(o.value!==null){a.mappings.$pensionValue.val(o.value);
var j=RR.utils.formatStringAsCurrency(o.value,"");
if(!RR.utils.isRegisteredProspect()){a.mappings.$pensionValue.prop("disabled",true);
a.replaceControlsForElementWithText(a.mappings.$pensionValue,j)
}}if(o.regularPayment&&o.regularPayment.amount!==null){a.mappings.$pensionPersonalContributions.val(o.regularPayment.amount);
var h=RR.utils.formatStringAsCurrency(o.regularPayment.amount,"");
if(!RR.utils.isRegisteredProspect()){a.mappings.$pensionPersonalContributions.prop("disabled",true);
a.replaceControlsForElementWithText(a.mappings.$pensionPersonalContributions,h)
}}}var t=A.memoPension;
if(t){if(t.value!==null){a.mappings.$memoPensionValue.val(t.value);
var f=RR.utils.formatStringAsCurrency(t.value,"");
if(!RR.utils.isRegisteredProspect()){a.mappings.$memoPensionValue.prop("disabled",true);
a.replaceControlsForElementWithText(a.mappings.$memoPensionValue,f)
}}if(t.regularPayment&&t.regularPayment.amount!==null){a.mappings.$memoPensionPersonalContributions.val(t.regularPayment.amount);
var y=RR.utils.formatStringAsCurrency(t.regularPayment.amount,"");
if(!RR.utils.isRegisteredProspect()){a.mappings.$memoPensionPersonalContributions.prop("disabled",true);
a.replaceControlsForElementWithText(a.mappings.$memoPensionPersonalContributions,y)
}}if(t.employerMonthlyContribution&&t.employerMonthlyContribution.amount!==null){a.mappings.$memoPensionEmployerContributions.val(t.employerMonthlyContribution.amount);
var x=RR.utils.formatStringAsCurrency(t.employerMonthlyContribution.amount,"");
if(!RR.utils.isRegisteredProspect()){a.mappings.$memoPensionEmployerContributions.prop("disabled",true);
a.replaceControlsForElementWithText(a.mappings.$memoPensionEmployerContributions,x)
}}}var v=A.isa;
if(v){if(v.value!==null){a.mappings.$isaValue.val(v.value);
var m=RR.utils.formatStringAsCurrency(v.value,"");
if(!RR.utils.isRegisteredProspect()){a.mappings.$isaValue.prop("disabled",true);
a.replaceControlsForElementWithText(a.mappings.$isaValue,m)
}}if(v.regularPayment&&v.regularPayment.amount!==null){a.mappings.$isaPersonalContributions.val(v.regularPayment.amount);
var n=RR.utils.formatStringAsCurrency(v.regularPayment.amount,"");
if(!RR.utils.isRegisteredProspect()){a.mappings.$isaPersonalContributions.prop("disabled",true);
a.replaceControlsForElementWithText(a.mappings.$isaPersonalContributions,n)
}}}var w=A.memoIsa;
if(w){if(w.value!==null){a.mappings.$memoIsaValue.val(w.value);
var q=RR.utils.formatStringAsCurrency(w.value,"");
if(!RR.utils.isRegisteredProspect()){a.mappings.$memoIsaValue.prop("disabled",true);
a.replaceControlsForElementWithText(a.mappings.$memoIsaValue,q)
}}if(w.regularPayment&&w.regularPayment.amount!==null){a.mappings.$memoIsaPersonalContributions.val(w.regularPayment.amount);
var k=RR.utils.formatStringAsCurrency(w.regularPayment.amount,"");
if(!RR.utils.isRegisteredProspect()){a.mappings.$memoIsaPersonalContributions.prop("disabled",true);
a.replaceControlsForElementWithText(a.mappings.$memoIsaPersonalContributions,k)
}}}};
this.buildRequestObject=function(){var e={questionnaire:[{questionReference:"RECENCY",answer:a.mappings.$RECENCY.val()},{questionReference:"CONSOLIDATION",answer:a.mappings.$CONSOLIDATION.val()},{questionReference:"PERFORMANCE",answer:a.mappings.$PERFORMANCE.val()},{questionReference:"QUIZ",answer:(a.mappings.$QUIZ.hasClass("chosen-correct-answer"))?"Yes":"No"},{questionReference:"TAX_FREE_CASH",answer:$("#"+$("#lumpSum .toggle-group label.checked").attr("for")).val()}],personalDetails:{dateOfBirth:RR.utils.convertDateFieldToNumericArray(a.mappings.$dateOfBirthField.val()),gender:a.mappings.$gender.val(),grossSalary:a.getFieldValueWithDefault(a.mappings.$grossSalary,"0"),retirementAge:a.mappings.$retirementAge.attr("aria-valuenow")},contactDetails:{emailAddress:$("#email").val()},contactPreferences:{email:$("input[name='marketing.email']").prop("checked")},pension:{impl:"rrProduct",value:a.getFieldValueWithDefault(a.mappings.$pensionValue,"0"),regularPayment:{amount:a.getFieldValueWithDefault(a.mappings.$pensionPersonalContributions,"0")}},memoPension:{impl:"rrProduct",value:a.getFieldValueWithDefault(a.mappings.$memoPensionValue,"0"),regularPayment:{amount:a.getFieldValueWithDefault(a.mappings.$memoPensionPersonalContributions,"0")},employerMonthlyContribution:{amount:a.getFieldValueWithDefault(a.mappings.$memoPensionEmployerContributions,"0")}},isa:{impl:"rrProduct",value:a.getFieldValueWithDefault(a.mappings.$isaValue,"0"),regularPayment:{amount:a.getFieldValueWithDefault(a.mappings.$isaPersonalContributions,"0")}},memoIsa:{impl:"rrProduct",value:a.getFieldValueWithDefault(a.mappings.$memoIsaValue,"0"),regularPayment:{amount:a.getFieldValueWithDefault(a.mappings.$memoIsaPersonalContributions,"0")}},targetAnnualIncome:a.getFieldValueWithDefault(a.mappings.$targetAnnualIncome,"0"),guaranteedAnnualIncome:a.getFieldValueWithDefault(a.mappings.$guaranteedAnnualIncome,"0"),address:{postcode:a.getFieldValueWithDefault(a.mappings.$postcode,null)}};
if(!RR.utils.isAuthor()){if(!RR.utils.isUserLoggedIn()){var g={emailAddress:$("#email").val()};
e.contactDetails=g;
var f={email:$("input[name='marketing.email']").prop("checked")};
e.contactPreferences=f;
if(!RR.utils.isUserLoggedIn()){sessionStorage.setItem("prospectEmail",e.contactDetails.emailAddress);
sessionStorage.setItem("prospectCntPref",e.contactPreferences.email)
}}}return e
};
this.getFieldValueWithDefault=function(f,e){var g=f.val();
return(g&&g.length>0)?g:e
};
this.getChosenLabel=function(){return a.$el.find(b.selectedLabel)
};
this.onGetForecast=function(h){h.preventDefault();
var f=a.buildRequestObject();
var g=a.scoreApi.calculateScore(f);
g.done(function(i,j,e){RR.url.redirect("GOALS_DASHBOARD")
})
};
this.checkAnswer=function(){$(RR).trigger("multipleChoice:checkAnswer");
a.config.submitButtons[a.config.currentPage].hide();
$("body").on("click","#getForecast",a.onGetForecast);
$("#getForecast").removeClass("hidden")
};
this.goToNextPage=function(){if(a.config.currentPage+1===a.config.totalPages){a.checkAnswer()
}else{$(a.config.articlePrefix+a.config.currentPage).hide();
a.config.currentPage++;
$(a.config.articlePrefix+a.config.currentPage).show();
$("html, body").animate({scrollTop:0})
}};
this.onSubmitButtonClicked=function(h){h.preventDefault();
var g=true;
var f=a.getChosenLabel();
a.config.forms[a.config.currentPage].each(function(e,i){if(!$(i).parsley("validate")){g=false
}});
$("#score-multiple-choice").each(function(e,i){if(!$(i).parsley("validate")){g=false
}});
if($(this).parents("#score-multiple-choice").hasClass("inputForm")){if(f.find("span").text()===""){g=false;
a.$el.find("."+b.requireValidation).show()
}else{a.$el.find("."+b.requireValidation).hide()
}}if(g){a.goToNextPage()
}};
this.hideControlGroupForElement=function(e){e.closest(a.config.controlGroupSelector).hide()
};
this.replaceControlsForElementWithText=function(f,g){var e=f.closest(a.config.controlsSelector);
e.find(".help-icon").insertBefore(e);
e.children().hide();
e.prepend('<p class="labeltxt" style="text-align:left;">'+g+"</p>")
};
this.hideFieldsForProspects=function(){if(RR.utils.isAuthor()){return
}a.hideControlGroupForElement(a.mappings.$isaValue);
a.hideControlGroupForElement(a.mappings.$isaPersonalContributions);
a.hideControlGroupForElement(a.mappings.$pensionValue);
a.hideControlGroupForElement(a.mappings.$pensionPersonalContributions)
};
this.hideFieldsForCustomers=function(e){if(RR.utils.isAuthor()){return
}if(e.pension&&e.pension.value===0&&e.pension.regularPayment.amount===0){a.hideControlGroupForElement(a.mappings.$pensionValue);
a.hideControlGroupForElement(a.mappings.$pensionPersonalContributions)
}if(e.isa&&e.isa.value===0&&e.isa.regularPayment.amount===0){a.hideControlGroupForElement(a.mappings.$isaValue);
a.hideControlGroupForElement(a.mappings.$isaPersonalContributions)
}a.hideControlGroupForElement(a.mappings.$postcode)
};
this.rewordSavingsQuestionsForProspects=function(){$("label[data-alternate-label]").each(function(e){var g=$(this),f=g.data();
if(f.alternateLabel){g.text(f.alternateLabel)
}})
};
this.loadScoreFormData=function(){if(RR.utils.isUserLoggedIn()){var e=a.scoreApi.getPopulateDetails();
e.done(function(f,h,g){a.prepopulateData(h);
a.hideFieldsForCustomers(h)
})
}else{$(RR).trigger("removeLoadingSpinner")
}if(!RR.utils.isRegisteredCustomer()){a.hideFieldsForProspects();
a.rewordSavingsQuestionsForProspects()
}};
this.initMinRetirementAgeValidation=function(){var f=c.val(),e=RR.utils.calcAge(f);
if(!_.isNaN(e)){d.parsley().updateConstraint({min:e+1},d.data("number-message"));
d.blur()
}};
this.init=function(){this.scoreApi=new RR.api.Score();
if(RR.session.exists()){var e=a.scoreApi.retrieveScore();
e.done(function(g,i,h){if(g===200){RR.url.redirect("GOALS_DASHBOARD")
}else{a.loadScoreFormData()
}})
}else{a.loadScoreFormData()
}if(RR.utils.isUserLoggedIn()){$(".marketing-preferences").hide();
$("[data-component=prosPectContactDetails]").parent().hide()
}if(!RR.utils.isAuthor()){for(var f=0;
f<a.config.totalPages;
f++){a.config.submitButtons.push($("#submitGetScore"+f));
a.config.forms.push($("#score-section"+f+" .scoreform"));
a.config.submitButtons[f].on("click",a.onSubmitButtonClicked)
}}this.initMinRetirementAgeValidation();
c.change(function(){a.initMinRetirementAgeValidation()
})
}
});
RR.components.goalsDashboard=RR.defineComponent(function(){var a=this;
this.config={goalsApi:null,$agePanel:$("#goal-age"),$incomePanel:$("#goal-income"),$paydaysPanel:$("#goal-paydays"),$targetIncomePanel:$("#income"),$targetAgePanel:$("#age"),$shortfallPanel:$("#goal-shortfall"),populatedData:null};
this.init=function(){a.config.goalsApi=RR.api.Goals();
var b=a.config.goalsApi.getPopulateDetails();
b.done(function(c,e,d){if(c===200){a.config.populatedData=e;
a.prepopulateData(e);
a.makeForecastProjection(e);
if(e.pension.id){RR.session("fundGoalDetails",{fundId:e.pension.fund.investmentId})
}else{if(e.isa.id){RR.session("fundGoalDetails",{fundId:e.isa.fund.investmentId})
}else{RR.session("fundGoalDetails",{fundId:"NOPRODUCT"})
}}}});
a.initEvents()
};
this.initEvents=function(){$("#goal-shortfall").on("click","button",a.onGoalPlannerButtonClicked);
$(RR).on("getScore",a.goalsSessionRedirect)
};
this.goalsSessionRedirect=function(c,b){if(!RR.utils.isAuthor()&&!b.hasScore){$(RR).trigger("headway:showSpinner");
RR.url.redirect("GOALS_LANDING")
}};
this.prepopulateData=function(c){RR.utils.renderWidgetCounter(a.config.$agePanel,c.personalDetails.retirementAge);
var b=a.config.$agePanel.find(".counter-advisory-text");
RR.utils.replaceTemplateString(b,"{{retire-year}}",c.personalDetails.retirementYear);
a.renderedTargetIncome=RR.utils.formatAmount(c.targetAnnualIncome,"G");
RR.utils.renderWidgetCounter(a.config.$incomePanel,a.renderedTargetIncome);
if(c.tfcPercentage>0){a.config.$incomePanel.find("#lump-sum").show();
a.config.$incomePanel.find("#no-lump-sum").hide()
}else{a.config.$incomePanel.find("#lump-sum").hide();
a.config.$incomePanel.find("#no-lump-sum").show()
}RR.utils.renderWidgetCounter(a.config.$paydaysPanel,c.personalDetails.numberOfPayDays)
};
this.makeForecastProjection=function(b){var c=a.config.goalsApi.makeProjection(b);
c.done(function(d,f,e){a.populateForecast(f)
})
};
this.populateForecast=function(f){var i=Math.floor(f.totalProjections[0].income);
var g=RR.utils.formatAmount(i,"G");
RR.utils.renderWidgetCounter(a.config.$targetIncomePanel,g);
var m=a.config.$targetIncomePanel.find(".counter-advisory-text");
RR.utils.replaceTemplateString(m,"{{retire-age}}",a.config.populatedData.personalDetails.retirementAge);
RR.utils.renderWidgetCounter(a.config.$targetAgePanel,f.ageTargetIncomeAchieved);
var k=a.config.$targetAgePanel.find(".counter-advisory-text");
var b=RR.utils.formatAmount(a.config.populatedData.targetAnnualIncome);
RR.utils.replaceTemplateString(k,"{{income}}",b);
var c,n,e=f.ageShortFall,h=(f.ageShortFall<=0),l=(f.incomeShortfall<=0);
if(h){if(parseInt(f.ageShortFall,10)===-1){a.config.$shortfallPanel.find(".surplus-text-1-year").removeClass("hidden")
}else{n=a.config.$shortfallPanel.find(".surplus-text-multi-year");
RR.utils.replaceTemplateString(n,"{{value}}",e*-1);
n.removeClass("hidden")
}}else{if(parseInt(f.ageShortFall,10)===1){a.config.$shortfallPanel.find(".shortfall-text-1-year").removeClass("hidden")
}else{if(f.ageTargetIncomeAchieved>=100){e=99-a.config.populatedData.personalDetails.retirementAge+"+"
}c=a.config.$shortfallPanel.find(".shortfall-text-multi-year");
RR.utils.replaceTemplateString(c,"{{value}}",e);
c.removeClass("hidden")
}}var d=RR.utils.getNumberFromString(a.renderedTargetIncome)-RR.utils.getNumberFromString(g);
if(l){a.config.$shortfallPanel.find(".surplus-text-income").each(function(p){var o=RR.utils.formatAmount(d*-1,"G");
RR.utils.replaceTemplateString($(this),"{{value}}",o);
$(this).removeClass("hidden")
})
}else{c=a.config.$shortfallPanel.find(".shortfall-text-income");
var j=RR.utils.formatAmount(d,"G");
RR.utils.replaceTemplateString(c,"{{value}}",j);
c.removeClass("hidden")
}if(h&&l){a.config.$shortfallPanel.children(".panel").removeClass("off-track").addClass("on-track").show();
a.config.$shortfallPanel.find(".ico-on-target").removeClass("hidden");
a.config.$shortfallPanel.find("#on-track-btn").show();
a.config.$shortfallPanel.find("#below-track-btn").hide()
}else{a.config.$shortfallPanel.children(".panel").removeClass("on-track").addClass("off-track").show();
a.config.$shortfallPanel.find(".ico-off-target").removeClass("hidden")
}};
this.onGoalPlannerButtonClicked=function(b){b.preventDefault();
RR.url.redirect("GOAL_PLANNER")
}
});
RR.components.goalPlanner=RR.defineComponent(function(){var a=this;
this.config={populatedData:null,amendedData:null,onTargetRange:500,initialProjectionMade:false,disabledFundIndex:1,$retirementAgeModal:$("#retirementAgeModal"),$annualIncomeModal:$("#annualIncomeModal"),$pensionOneOffModal:$("#pensionOneOffPaymentModal"),$pensionMonthlyModal:$("#pensionMonthlyPaymentModal"),$isaOneOffModal:$("#isaOneOffPaymentModal"),$isaMonthlyModal:$("#isaMonthlyPaymentModal"),$memoPensionValueModal:$("#memoPensionValueModal"),$memoPensionPersonalContributionsModal:$("#memoPensionPersonalContributionsModal"),$memoPensionEmployerContributionsModal:$("#memoPensionEmployerContributionsModal"),$memoIsaValueModal:$("#memoIsaValueModal"),$memoIsaPersonalContributionsModal:$("#memoIsaPersonalContributionsModal"),$guaranteedAnnualIncomeModal:$("#guaranteedAnnualIncomeModal"),$retirementAgeSlider:$(".targetRetirementAge .input-slider"),$annualIncomeSlider:$(".targetAnnualIncome .input-slider"),$pensionOneOffSlider:$(".pensionOneOffPayment .input-slider"),$pensionRegularSlider:$(".pensionRegularContributions .input-slider"),$isaOneOffSlider:$(".isaOneOffPayment .input-slider"),$isaRegularSlider:$(".isaRegularContributions .input-slider"),$memoPensionValueSlider:$(".memoPensionValue .input-slider"),$memoPensionPersonalContributionsSlider:$(".memoPensionPersonalContributions .input-slider"),$memoPensionEmployerContributionsSlider:$(".memoPensionEmployerContributions .input-slider"),$memoIsaValueSlider:$(".memoIsaValue .input-slider"),$memoIsaPersonalContributionsSlider:$(".memoIsaPersonalContributions .input-slider"),$guaranteedAnnualIncomeSlider:$(".guaranteedAnnualIncome .input-slider"),$isaFundSelectorAlert:$("#isa-fund-selector .alert"),$pensionFundSelectorAlert:$("#pension-fund-selector .alert"),$goalPlannerForm:$("#acc1-content .accordion-inner > p a"),clearaction:false};
this.data={isaAlertInitialText:this.config.$isaFundSelectorAlert.text(),pensionAlertInitialText:this.config.$pensionFundSelectorAlert.text()};
this.taskMappings=[{taskName:"RETIREMENT_AGE",dataPath:"personalDetails.retirementAge"},{taskName:"TARGET_ANNUAL_INCOME",dataPath:"targetAnnualIncome"},{taskName:"GUARANTEED_ANNUAL_INCOME",dataPath:"guaranteedAnnualIncome"},{taskName:"TAX_FREE_LUMPSUM_PREFERENCE",dataPath:"taxFreeLumpSum"},{taskName:"NEW_RR_PENSION_WITH_ONEOFFPAYMENT",dataPath:"pension.oneOffPayment.amount"},{taskName:"NEW_RR_PENSION_WITH_MONTHLYPAYMENTS",dataPath:"pension.regularPayment.amount"},{taskName:"UPDATE_RR_PENSION_PRODUCT_OPTION",dataPath:"pension.selectedFund"},{taskName:"UPDATE_RR_PENSION_WITH_ONEOFFPAYMENT",dataPath:"pension.oneOffPayment.amount"},{taskName:"UPDATE_RR_PENSION_WITH_MONTHLYPAYMENTS",dataPath:"pension.regularPayment.amount"},{taskName:"UPDATE_RR_PENSION_MONTHLYPAYMENT_WITH_RPI_OPTION",dataPath:"pension.regularPayment.boostPensionInlineWithRPI"},{taskName:"NEW_RR_ISA_WITH_ONEOFFPAYMENT",dataPath:"isa.oneOffPayment.amount"},{taskName:"NEW_RR_ISA_WITH_MONTHLYPAYMENTS",dataPath:"isa.regularPayment.amount"},{taskName:"UPDATE_RR_ISA_PRODUCT_OPTION",dataPath:"isa.selectedFund"},{taskName:"UPDATE_RR_ISA_WITH_ONEOFFPAYMENT",dataPath:"isa.oneOffPayment.amount"},{taskName:"UPDATE_RR_ISA_WITH_MONTHLYPAYMENTS",dataPath:"isa.regularPayment.amount"},{taskName:"UPDATE_PENSION_MEMO_ASSET_TOTAL",dataPath:"memoPension.value"},{taskName:"UPDATE_PENSION_MEMO_ASSET_MONTHLYPAYMENTS",dataPath:"memoPension.regularPayment.amount"},{taskName:"UPDATE_PENSION_MEMO_ASSET_MONTHLYEMPLOYERPAYMENTS",dataPath:"memoPension.employerMonthlyContribution.amount"},{taskName:"UPDATE_ISA_MEMO_ASSET_TOTAL",dataPath:"memoIsa.value"},{taskName:"UPDATE_ISA_MEMO_ASSET_MONTHLYPAYMENTS",dataPath:"memoIsa.regularPayment.amount"}];
this.init=function(){RR.utils.redirectIfNoScore("GOALS_LANDING");
$(".control-group").addClass("clear");
this.goalsApi=RR.api.Goals();
if(!RR.utils.isRegisteredCustomer()){a.hideFieldsFromProspects()
}var b=a.goalsApi.getPopulateDetails();
b.done(function(c,e,d){if(e.pension.id){RR.session("fundGoalDetails",{fundId:e.pension.fund.investmentId})
}else{if(e.isa.id){RR.session("fundGoalDetails",{fundId:e.isa.fund.investmentId})
}else{RR.session("fundGoalDetails",{fundId:"NOPRODUCT"})
}}if(e.latestRiskScore>0){$(".selection-info.user").show();
$(".selection-info.user").attr("class","selection-info user risk-"+e.latestRiskScore);
$(".selection-info.user").html($(".selection-info.user").html().replace("{{placeholder}}",e.latestRiskScore));
$("#riskDesc").html($(".risk-color-"+e.latestRiskScore).attr("descriptive-text"));
$(".riskAssessment").show()
}var f;
if(RR.prevRoute(RR.route("LIFESTYLE_PLANNER"))){RR.session("defaultProfileData","y");
if(RR.session("defaultProfileData")==="y"){RR.session("defaultProfileData",e)
}}if(_.isNumber(a.config.disabledFundIndex)){a.$el.find(".fund-selections > li:nth-child("+a.config.disabledFundIndex+") > button").prop("disabled",true)
}a.config.populatedData=e;
a.config.amendedData=e;
a.prepopulateData(e);
a.makeProjectionCall(e);
a.switchGoalPlannerFund(e)
});
a.initEvents();
a.responsiveVisuals();
$("fieldset.accordion-group").each(function(c){var d=(c===0)?true:false;
RR.components.accordionForm.init($(this),d)
})
};
this.initEvents=function(){$("#clearActionPlan").on("click","button",a.onClearActionPlan);
$("#pension-fund-selector").on("click","button",a.onFundSelected);
$("#isa-fund-selector").on("click","button",a.onFundSelected);
$(".selection-navigation a.right").on("click",a.onFundPrevious);
$(".selection-navigation a.left").on("click",a.onFundNext);
$("#goal-planner-form").on("change",a.onGoalPlannerChanged);
$(RR).on("ariaSlider:updated",a.onSliderValueChanged);
$("#action-update-forecast").on("click","button",a.onUpdateProjections);
$("#action-save-todos").on("click","button",a.onSaveTaskList);
a.config.$retirementAgeModal.on("click","button",a.onEnterAnotherRetirementAge);
a.config.$annualIncomeModal.on("click","button",a.onEnterAnotherAnnualIncome);
a.config.$pensionOneOffModal.on("click","button",a.onEnterAnotherPensionOneOff);
a.config.$pensionMonthlyModal.on("click","button",a.onEnterAnotherPensionRegular);
a.config.$isaOneOffModal.on("click","button",a.onEnterAnotherIsaOneOff);
a.config.$isaMonthlyModal.on("click","button",a.onEnterAnotherIsaRegular);
a.config.$memoPensionValueModal.on("click","button",a.onEnterAnotherMemoPensionValue);
a.config.$memoPensionPersonalContributionsModal.on("click","button",a.onEnterAnotherMemoPensionPersonalContributions);
a.config.$memoPensionEmployerContributionsModal.on("click","button",a.onEnterAnotherMemoPensionEmployerContributions);
a.config.$memoIsaValueModal.on("click","button",a.onEnterAnotherMemoIsaValue);
a.config.$memoIsaPersonalContributionsModal.on("click","button",a.onEnterAnotherMemoIsaPersonalContributions);
a.config.$guaranteedAnnualIncomeModal.on("click","button",a.onEnterAnotherGuaranteedAnnualIncome);
a.config.$goalPlannerForm.on("click",a.storingSessionGoalPlannerData)
};
this.storingSessionGoalPlannerData=function(){var b=$(".targetRetirementAge").find(".sliderThumb").attr("aria-valuenow");
var c=$(".targetAnnualIncome").find(".sliderValue").text().slice(1);
var m=$(".pensionOneOffPayment").find(".sliderValue").text().slice(1);
var l=$(".pensionRegularContributions").find(".sliderValue").text().slice(1);
var e=$(".isaOneOffPayment").find(".sliderValue").text().slice(1);
var d=$(".isaRegularContributions").find(".sliderValue").text().slice(1);
var h=$(".memoPensionValue").find(".sliderValue").text().slice(1);
var k=$(".memoPensionPersonalContributions").find(".sliderValue").text().slice(1);
var g=$(".memoPensionEmployerContributions").find(".sliderValue").text().slice(1);
var j=$(".memoIsaValue").find(".sliderValue").text().slice(1);
var f=$(".memoIsaPersonalContributions").find(".sliderValue").text().slice(1);
var i=$(".guaranteedAnnualIncome").find(".sliderValue").text().slice(1);
if(!($('label[for="goalsIncreasePensionRpi"]').find("input").is(":checked"))){RR.session("goalsIncreasePensionRpi","y")
}else{RR.session("goalsIncreasePensionRpi","n")
}if(!($('label[for="taxFreeLumpSum"]').find("input").is(":checked"))){RR.session("taxFreeLumpSum","y")
}else{RR.session("taxFreeLumpSum","n")
}RR.session("plannertargetRetirementAge",b);
RR.session("plannertargetAnnualIncome",c);
RR.session("plannerpensionOneOffPayment",m);
RR.session("plannerpensionRegularContributions",l);
RR.session("plannerisaOneOffPayment",e);
RR.session("plannerisaRegularContributions",d);
RR.session("plannermemoPensionValue",h);
RR.session("plannermemoPensionPersonalContributions",k);
RR.session("plannermemoPensionEmployerContributions",g);
RR.session("plannermemoIsaValue",j);
RR.session("plannermemoIsaPersonalContributions",f);
RR.session("plannerguaranteedAnnualIncome",i)
};
this.switchGoalPlannerFund=function(c){var b=c.pension;
if(b.id){RR.session("fundDetails",{fundName:b.fund.displayName,riskLevel:b.fund.riskRating,fundId:b.fund.investmentId});
if(b.fund.type==="OTHER"){$(".jsSwicthFunds").show();
$(".jsFundName").text(b.fund.displayName);
$(".jsSelectedFund").addClass("risk-"+b.fund.riskRating);
$(".jsSelectedFund").find(".risk-level-rating").show().text(b.fund.riskRating);
$(".jsFundHintText").show()
}else{$(".jsSwicthFunds").hide();
$(".jsFundModal").hide();
$("#pensionCurrentFund").removeClass("active");
$("#pensionRetireadyFunds").addClass("active");
$(".jsFundHintText").hide()
}}else{$(".jsSwicthFunds").hide();
$("#pensionCurrentFund").removeClass("active");
$("#pensionRetireadyFunds").addClass("active");
$(".jsFundHintText").hide()
}};
this.prepopulateData=function(B){var p;
if((RR.prevRoute(RR.route("LIFESTYLE_PLANNER")))&&(a.config.clearaction===false)){if(RR.session("plannertargetRetirementAge")!==undefined){var y=RR.session("plannertargetRetirementAge");
var C=RR.session("plannerpensionOneOffPayment");
var m=RR.session("plannerpensionRegularContributions");
var h=RR.session("plannerisaOneOffPayment");
var t=RR.session("plannerisaRegularContributions");
var d=RR.session("plannermemoPensionValue");
var A=RR.session("plannermemoPensionPersonalContributions");
var b=RR.session("plannermemoPensionEmployerContributions");
var q=RR.session("plannermemoIsaValue");
var n=RR.session("plannermemoIsaPersonalContributions");
var f=RR.session("plannerguaranteedAnnualIncome");
B.personalDetails.retirementAge=y;
$(".pensionOneOffPayment .input-slider").attr("data-startvalue",C);
B.pension.regularPayment.amount=m;
$(".isaOneOffPayment .input-slider").attr("data-startvalue",h);
B.isa.regularPayment.amount=t;
B.memoPension.value=d;
B.memoPension.regularPayment.amount=A;
B.memoPension.employerMonthlyContribution.amount=b;
B.memoIsa.value=q;
B.memoIsa.regularPayment.amount=n;
B.guaranteedAnnualIncome=f
}var o=RR.session("plannerTarget");
var x=RR.session("plannertargetAnnualIncome");
if(o>=0){B.targetAnnualIncome=o
}else{B.targetAnnualIncome=x
}}$(".label_check").each(function(E){$(this).removeClass("c_on").find("input").prop("checked",false)
});
var z=a.config.$retirementAgeModal.find('input[type="number"]');
var i=RR.utils.calcAge(B.personalDetails.dateOfBirth);
if(i>=55){a.config.$retirementAgeSlider.attr("data-minvalue",i+1).attr("data-maxvalue",i+21);
if(i>=z.data("min")){var w=parseInt(z.data("max"),10),v=parseInt(z.data("min"),10),k=i+1,j=w+(k-v);
z.data("min",k).attr("data-min",k).data("max",j).attr("data-max",j)
}}RR.plugins.ARIA_SLIDER.createSliderFromElement(a.config.$retirementAgeSlider);
var g=a.config.$retirementAgeModal.find(".help-block"),e=a.config.$retirementAgeSlider.closest(".control-group").find(".helpIconText p"),l={min:z.data("min"),max:z.data("max")};
_.each([g,e],function(E){E.html(_.template(E.html(),l))
});
a.config.$retirementAgeSlider.attr("data-startvalue",Math.floor(B.personalDetails.retirementAge));
a.config.$annualIncomeSlider.attr("data-startvalue",Math.floor(B.targetAnnualIncome));
a.config.$pensionRegularSlider.attr("data-startvalue",Math.floor(B.pension.regularPayment.amount));
a.config.$isaRegularSlider.attr("data-startvalue",Math.floor(B.isa.regularPayment.amount));
a.config.$memoPensionValueSlider.attr("data-startvalue",Math.floor(B.memoPension.value));
a.config.$memoPensionPersonalContributionsSlider.attr("data-startvalue",Math.floor(B.memoPension.regularPayment.amount));
a.config.$memoPensionEmployerContributionsSlider.attr("data-startvalue",Math.floor(B.memoPension.employerMonthlyContribution.amount));
a.config.$memoIsaValueSlider.attr("data-startvalue",Math.floor(B.memoIsa.value));
a.config.$memoIsaPersonalContributionsSlider.attr("data-startvalue",Math.floor(B.memoIsa.regularPayment.amount));
a.config.$guaranteedAnnualIncomeSlider.attr("data-startvalue",Math.floor(B.guaranteedAnnualIncome));
RR.plugins.ARIA_SLIDER.updateSliderFromElement();
var r;
window.setTimeout(function(){$(".input-slider").each(function(F){r=$(this).attr("data-startvalue");
var E=$(this).closest(".input-slider").data("prepend");
if(E===null){E=""
}$(this).find(".sliderValue").first().text(E+r)
})
},350);
var c=$('label[for="taxFreeLumpSum"]');
if(RR.session("taxFreeLumpSum")==="y"){c.removeClass("c_on").find("input").prop("checked",false)
}else{if(Math.floor(B.tfcPercentage)>0){c.addClass("c_on").find("input").prop("checked",true)
}}if(Math.floor(B.pension.value)===0){$(".pension-current-value").hide()
}else{p=RR.utils.formatStringAsCurrency(B.pension.value,"");
RR.utils.replaceTemplateString($(".pension-current-value"),"{{goalCurrentPensionValue}}",p)
}var u=$('label[for="goalsIncreasePensionRpi"]');
if(RR.session("goalsIncreasePensionRpi")==="y"){u.removeClass("c_on").find("input").prop("checked",false)
}else{if((B.pension.regularPayment.boostPensionInlineWithRPI)||(RR.session("goalsIncreasePensionRpi")==="n")){u.addClass("c_on").find("input").prop("checked",true)
}}if(Math.floor(B.pension.value)===0){$(".isa-current-value").hide()
}else{p=RR.utils.formatStringAsCurrency(B.isa.value,"");
RR.utils.replaceTemplateString($(".isa-current-value"),"{{goalCurrentIsaValue}}",p)
}var D=[{"$container":$("#pensionRetireadyFunds"),value:B.pension.selectedFund},{"$container":$("#isa-fund-selector"),value:B.isa.selectedFund}];
_.each(D,function(E){E.$container.find(".selector li").each(function(F){var G=a.getFundNameFromListItem($(this));
if(G===E.value){a.selectFund(E.$container,F+1)
}})
});
a.hideActionButtons();
if(B.pension.id){if((B.pension.fund.type==="OTHER")&&(a.config.clearaction===true)){$(".jsSwicthFunds li").removeClass("active");
$(".jsSwicthFunds li:first").addClass("active");
$("#pension-fund-selector .tab-content .tab-pane").removeClass("active");
$("#pension-fund-selector .tab-content .tab-pane:first").addClass("active")
}}};
this.onFundSelected=function(c){c.preventDefault();
var d=$(this).closest(".selector-container-parent");
var b=$(this).closest("li").index()+1;
a.selectFund(d,b)
};
this.onFundPrevious=function(c){c.preventDefault();
var d=$(this).closest(".selector-container-parent");
var b=a.getCurrentlySelectedFund(d);
if(b!==null){a.selectFund(d,b.index-1)
}};
this.onFundNext=function(c){c.preventDefault();
var d=$(this).closest(".selector-container-parent");
var b=a.getCurrentlySelectedFund(d);
if(b!==null){a.selectFund(d,b.index+1)
}};
this.selectFund=function(l,g){if(g===a.config.disabledFundIndex){return
}l.find(".enlarged").removeClass("enlarged").closest("li").attr("aria-selected",false).attr("aria-checked",false);
var j=l.find("li.risk-level-"+g).attr("aria-selected",true).attr("aria-checked",true);
j.find("button").addClass("enlarged");
var i=l.find("#pensionRetireadyFunds .selection-info-panel.selection-info");
i.removeClass().addClass("selection-info-panel selection-info risk-"+g);
var k=a.getFundDisplayNameFromListItem(j);
i.find(".risk-id").text(k);
var e=l.find(".alert");
var c=e.html();
var d={chosenFund:k};
if(e.data("originalText")===undefined){e.data("originalText",e.html());
e.html(_.template(c,d));
e.removeClass("hidden")
}else{e.html(_.template(e.data("originalText"),d))
}var h=l.find("li.risk-color-"+g).attr("descriptive-text");
i.find(".risk-level-rating").attr(h);
var b=l.find(".selection-navigation a.right").show();
var f=l.find(".selection-navigation a.left").show();
if(j.is(":first-child")||g-1===a.config.disabledFundIndex){b.hide()
}else{if(j.is(":last-child")||g+1===a.config.disabledFundIndex){f.hide()
}}a.onGoalPlannerChanged()
};
this.getCurrentlySelectedFund=function(c){var b=c.find("li[aria-selected=true]");
if(b.length>0){return{name:a.getFundNameFromListItem(b),index:b.index()+1}
}else{return null
}};
this.getFundNameFromListItem=function(b){return b.data("api-id")
};
this.getFundDisplayNameFromListItem=function(b){return b.find(".fund-name-label").html()
};
this.hideFieldsFromCustomers=function(){$(".memoPensionRegularContributions").hide();
$(".memoIsaRegularContributions").hide()
};
this.hideFieldsFromProspects=function(){if(!RR.utils.isAuthor()){$("#pension-fund-selector").hide();
$("#isa-fund-selector").hide()
}};
this.populateIntroParagraph=function(b){var c=$(".planner-summary-intro p");
if(c.length>0){c.each(function(d){if($(this).data("placeholderText")===undefined){$(this).data("placeholderText",$(this).html())
}$(this).html($(this).data("placeholderText"));
RR.utils.replaceTemplateString($(this),"{{goalsAge}}",b)
});
c.last().append($("#link-how-calculated").html())
}};
this.makeProjectionCall=function(b){a.populateIntroParagraph(b.personalDetails.retirementAge);
a.config.amendedData=b;
var c=a.goalsApi.makeProjection(b);
c.done(function(e,v,k){var j,o;
var d=Math.floor(v.totalProjections[0].income);
var f=Math.floor(a.config.amendedData.targetAnnualIncome);
var p=v.pensionProjections&&v.pensionProjections[0].tfclumpSum||0;
var q=v.isaProjections&&v.isaProjections[0].tfclumpSum||0;
RR.utils.renderWidgetCounter($("#stack-annual-income-total"),RR.utils.formatAmount(d,"G"));
RR.utils.renderWidgetCounter($("#stack-lump-sum-total"),RR.utils.formatAmount(v.totalProjections[0].tfclumpSum,"G"));
if(d===0||(v.pensionProjections&&v.pensionProjections[0].income>0)){$("#breakdown-pensions .stack-total").text(RR.utils.formatAmount(v.pensionProjections[0].income,"B"));
$("#breakdown-pensions").show()
}else{$("#breakdown-pensions").hide()
}if(v.isaProjections&&v.isaProjections[0].income>0){$("#breakdown-isas .stack-total").text(RR.utils.formatAmount(v.isaProjections[0].income,"B"));
$("#breakdown-isas").show()
}else{$("#breakdown-isas").hide()
}var t=v.statePensionProjections[0].income;
if(_.isNumber(t)&&t>0){$("#state-pension").show();
$("#no-state-pension").hide();
$("#state-pension .stack-total").text(RR.utils.formatAmount(t,"B"))
}else{$("#state-pension").hide();
$("#no-state-pension").show()
}if(p>0){$("#breakdown-lump-pensions .stack-total").text(RR.utils.formatAmount(p,"B"));
$("#breakdown-lump-pensions").show()
}else{$("#breakdown-lump-pensions").hide()
}if(q>0){$("#breakdown-lump-isas .stack-total").text(RR.utils.formatAmount(q,"B"));
$("#breakdown-lump-isas").show()
}else{$("#breakdown-lump-isas").hide()
}$("#lumpsum-breakdown").toggleClass("hidden",!q&&!p);
var u=$("#stack-container-inner");
var r=(d/f)*0.8*100;
if(r>0&&r<1){r=1
}else{if(r>100){r=100
}}if($.trim(u.html()).length===0){u.Stack({hasContainer:true,animation:true,stacks:[{percentage:r,primaryColor:"#6ed69f",secondaryColor:"#6ed69f",label:"Projected Annual Income"}]})
}else{u.trigger("stack:clear");
u.trigger("stack:percentage",[100,0,r]);
u.trigger("stack:render")
}var l=$(".forecast-results");
var m=$(".value-on-track");
var h=$(".value-surplus");
var g=$(".value-deficit");
_.each([m,h,g],function(w){w.hide()
});
_.each(["on-track","overshoot","shortfall"],function(w){l.removeClass(w)
});
if(d<f-a.config.onTargetRange){g.show();
l.addClass("shortfall");
o=RR.utils.formatAmount(f-d);
var i=g.find("h3");
i.html(i.data("message"));
RR.utils.replaceTemplateString(i,"{{amount}}",o)
}else{if(d>f+a.config.onTargetRange){h.show();
l.addClass("on-track");
o=RR.utils.formatAmount(d-f);
var n=h.find("h3");
n.html(n.data("message"));
RR.utils.replaceTemplateString(n,"{{amount}}",o)
}else{m.show();
l.addClass("on-track")
}}a.hideActionButtons();
if(RR.prevRoute(RR.route("LIFESTYLE_PLANNER"))){a.showSaveplanButtons()
}if(a.config.initialProjectionMade){a.showSaveplanButtons()
}a.config.initialProjectionMade=true
})
};
this.onGoalPlannerChanged=function(b){$("#action-save-todos").hide();
$("#action-update-forecast").show()
};
this.onSliderValueChanged=function(c,b){a.onGoalPlannerChanged()
};
this.showSaveButton=function(){$("#action-save-todos").show();
$("#action-update-forecast").hide()
};
this.hideActionButtons=function(){$("#action-save-todos").hide();
$("#action-update-forecast").hide()
};
this.showSaveplanButtons=function(){$("#action-save-todos").show()
};
this.onUpdateProjections=function(f){f.preventDefault();
var b=a.getCurrentlySelectedFund($("#pension-fund-selector"));
var g=a.getCurrentlySelectedFund($("#isa-fund-selector"));
var d=Math.floor(a.config.populatedData.pension.value);
var h=Math.floor(a.config.populatedData.isa.value);
var c={personalDetails:{dateOfBirth:a.config.populatedData.personalDetails.dateOfBirth,gender:a.config.populatedData.personalDetails.gender,retirementAge:a.getSliderValue($(".targetRetirementAge")),retirementYear:"",numberOfPayDays:""},targetAnnualIncome:a.getSliderValue($(".targetAnnualIncome")),guaranteedAnnualIncome:a.getSliderValue($(".guaranteedAnnualIncome")),taxFreeLumpSum:$("#taxFreeLumpSum").prop("checked"),tfcPercentage:$("#taxFreeLumpSum").prop("checked")?"25":"0",pension:{impl:a.config.populatedData.pension.impl,value:d,regularPayment:{amount:a.getSliderValue($(".pensionRegularContributions")),boostPensionInlineWithRPI:$("#goalsIncreasePensionRpi").prop("checked")},oneOffPayment:{amount:Math.floor(a.getSliderValue($(".pensionOneOffPayment")))},selectedFund:(b===null)?"":b.name},memoPension:{impl:a.config.populatedData.memoPension.impl,value:a.getSliderValue($(".memoPensionValue")),regularPayment:{amount:a.getSliderValue($(".memoPensionPersonalContributions")),boostPensionInlineWithRPI:false},employerMonthlyContribution:{amount:a.getSliderValue($(".memoPensionEmployerContributions"))}},isa:{impl:a.config.populatedData.isa.impl,value:h,regularPayment:{amount:a.getSliderValue($(".isaRegularContributions")),boostPensionInlineWithRPI:false},oneOffPayment:{amount:Math.floor(a.getSliderValue($(".isaOneOffPayment")))},selectedFund:(g===null)?"":g.name},memoIsa:{impl:a.config.populatedData.memoIsa.impl,value:a.getSliderValue($(".memoIsaValue")),regularPayment:{amount:a.getSliderValue($(".memoIsaPersonalContributions")),boostPensionInlineWithRPI:false}}};
$("html, body").animate({scrollTop:0});
a.makeProjectionCall(c)
};
this.getSliderValue=function(e){var c=e.find(".sliderValue").first().text(),b=["0","1","2","3","4","5","6","7","8","9"],d="";
_.each(c.split(""),function(f){if(b.indexOf(f)>=0){d+=f
}});
return Math.floor(d)
};
this.setSliderValue=function(c,g){var d=a.getSliderValue(c),h=Math.floor(c.attr("data-maxValue")),f=Math.floor(c.attr("data-minValue")),e=Math.floor(c.attr("data-bigincrement")),b=c.data("prepend");
g=Math.floor(g,10);
$(RR).one("ariaSlider:updateAnimationComplete",function(){c.find(".sliderValue").first().text(b+g);
if(d>h){RR.plugins.ARIA_SLIDER.repositionLabel(c,1)
}a.onGoalPlannerChanged()
});
if((d>=h&&g>=h)||(d<=f&&g<=f)||(e&&g>d-e&&g<d+e)){$(RR).trigger("ariaSlider:updateAnimationComplete")
}else{c.attr("data-startvalue",g);
RR.plugins.ARIA_SLIDER.updateSliderFromElement(c)
}};
this.updateSliderFromModal=function(f,b){var g=b.find(".controls input").first(),d=Math.floor(g.val()),c=Math.floor(g.data("min")),e=Math.floor(g.data("max"));
if(_.isNumber(d)&&!isNaN(d)){if(_.isNumber(c)&&d<c){d=c
}else{if(_.isNumber(e)&&d>e){d=e
}}a.setSliderValue(f,d)
}g.val("")
};
this.responsiveVisuals=function(){$(window).on("debouncedresize",function(){$("#stack-container-inner").trigger("stack:clear").trigger("stack:rerender")
})
};
this.onEnterAnotherRetirementAge=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$retirementAgeSlider,a.config.$retirementAgeModal)
};
this.onEnterAnotherAnnualIncome=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$annualIncomeSlider,a.config.$annualIncomeModal)
};
this.onEnterAnotherPensionOneOff=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$pensionOneOffSlider,a.config.$pensionOneOffModal)
};
this.onEnterAnotherPensionRegular=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$pensionRegularSlider,a.config.$pensionMonthlyModal)
};
this.onEnterAnotherIsaOneOff=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$isaOneOffSlider,a.config.$isaOneOffModal)
};
this.onEnterAnotherIsaRegular=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$isaRegularSlider,a.config.$isaMonthlyModal)
};
this.onEnterAnotherMemoPensionValue=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$memoPensionValueSlider,a.config.$memoPensionValueModal)
};
this.onEnterAnotherMemoPensionPersonalContributions=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$memoPensionPersonalContributionsSlider,a.config.$memoPensionPersonalContributionsModal)
};
this.onEnterAnotherMemoPensionEmployerContributions=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$memoPensionEmployerContributionsSlider,a.config.$memoPensionEmployerContributionsModal)
};
this.onEnterAnotherMemoIsaValue=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$memoIsaValueSlider,a.config.$memoIsaValueModal)
};
this.onEnterAnotherMemoIsaPersonalContributions=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$memoIsaPersonalContributionsSlider,a.config.$memoIsaPersonalContributionsModal)
};
this.onEnterAnotherGuaranteedAnnualIncome=function(b){b.preventDefault();
a.updateSliderFromModal(a.config.$guaranteedAnnualIncomeSlider,a.config.$guaranteedAnnualIncomeModal)
};
this.onClearActionPlan=function(b){b.preventDefault();
a.config.clearaction=true;
a.config.initialProjectionMade=false;
if(RR.prevRoute(RR.route("LIFESTYLE_PLANNER"))){a.config.populatedData=RR.session("defaultProfileData")
}a.prepopulateData(a.config.populatedData);
a.makeProjectionCall(a.config.populatedData)
};
this.onSaveTaskList=function(c){c.preventDefault();
var d=a.calculateTasks(),b;
if(d.length>0){b=a.goalsApi.postTaskList({taskList:d})
}else{b=a.goalsApi.deleteTaskList()
}b.done(function(e,g,f){RR.url.redirect("GOALS_DASHBOARD")
})
};
this.calculateTasks=function(){var c={},b=false;
if(RR.prevRoute(RR.route("LIFESTYLE_PLANNER"))){a.config.populatedData=RR.session("defaultProfileData")
}_.each(a.taskMappings,function(e){var d=RR.utils.getDeepValueFromObject(a.config.populatedData,e.dataPath);
var f=RR.utils.getDeepValueFromObject(a.config.amendedData,e.dataPath);
b=false;
if(_.isNumber(f)){if((f<=d-1)||(f>=d+1)){b=true
}}else{if(d!==f){if(f!==""&&f!==null&&f!==undefined){b=true
}}}if(b){c[e.taskName]={taskName:e.taskName,taskNewValue:f,taskOldValue:d}
}});
if(!a.config.populatedData.pension.id){delete c.UPDATE_RR_PENSION_WITH_ONEOFFPAYMENT;
delete c.UPDATE_RR_PENSION_WITH_MONTHLYPAYMENTS
}else{delete c.NEW_RR_PENSION_WITH_ONEOFFPAYMENT;
delete c.NEW_RR_PENSION_WITH_MONTHLYPAYMENTS
}if(!a.config.populatedData.isa.id){delete c.UPDATE_RR_ISA_WITH_ONEOFFPAYMENT;
delete c.UPDATE_RR_ISA_WITH_MONTHLYPAYMENTS
}else{delete c.NEW_RR_ISA_WITH_ONEOFFPAYMENT;
delete c.NEW_RR_ISA_WITH_MONTHLYPAYMENTS
}_.each(["UPDATE_RR_PENSION_WITH_ONEOFFPAYMENT","UPDATE_RR_ISA_WITH_ONEOFFPAYMENT"],function(d){if(c[d]){c[d].taskNewValue=c[d].taskNewValue-c[d].taskOldValue
}});
return _.values(c)
}
});
RR.components.responsiveCarousel=RR.defineComponent(function(){this.carousel=null;
var a=this,b=0;
this.init=function(){this.on(this.$el.find(".right"),"click",this.next);
this.on(this.$el.find(".left"),"click",this.prev);
this.on("uiCarouselNext",this.next);
this.on("uiCarouselPrev",this.prev);
var d;
if(this.params){d=this.params.responsiveRule
}var c;
switch(d){case"small-tablet-mobile":c=function(){if(window.innerWidth<921){return true
}else{return false
}};
break;
case"mobile":c=function(){if(window.innerWidth<600){return true
}else{return false
}}
}this.initCarousel(c)
};
this.next=function(c){if(c){c.preventDefault()
}this.carousel.next()
};
this.prev=function(c){if(c){c.preventDefault()
}this.carousel.prev()
};
this.initCarousel=function(d){var c=this.$el.find(".slider")[0];
this.carousel=window.SwipeResponsive(c,{startSlide:0,speed:400,continuous:true,disableScroll:false,stopPropagation:false,responsiveRule:d,callback:function(e,f){if($(f).hasClass("cloned")){switch(e){case 2:e=0;
break;
case 3:e=1;
break;
default:break
}}$(".carousel-circle").removeClass("active");
$(".carousel-circle").each(function(g,h){if($(h).html()!==""){$(h).html($(h).html().replace(" (Current)",""))
}});
$(".carousel-li-"+(e)).addClass("active");
$(".carousel-li-"+(e)).find(">:first-child").html($("#carousel-li-"+(e)).find(">:first-child").html()+" (Current)")
},transitionEnd:function(e,f){if($(f).hasClass("skip-this-slide")){if(a.previousIndex===0){a.prev()
}else{a.next()
}}a.previousIndex=e
}})
}
});
RR.components.insightCategoryList=RR.defineComponent(function(){var a=this;
this.loadPopularFaqs=function(){var d=window.popularInsightsQueryString||"";
var b="/bin/querybuilder.json?"+d,c=$.get(b);
return c
};
this.displayPopularInsights=function(e){var c='<li><a href="{{url}}"><h4>{{title}}<span aria-hidden="true" class="ico">&#xf719;</span></h4> <p><span class="link-descriptor">{{description}}</span><span class="link-date">{{created}}</span></p></a></li>',f="<li>{{message}}</li>",h={message:"No popular Insights found."},d=RR.url.pathRoot,g=".html",b=$("#popular-insights-list");
if(e.success===true){if(e.results===0){b.append(_.template(f,h))
}else{$.each(e.hits,function(j,k){var i={url:k.path.replace(d,"")+g,title:k.title,description:k.excerpt,created:RR.utils.stringToDateFormatted(k.created,"")};
b.append(_.template(c,i))
})
}}else{a.popularLoadError("Error loading popular Insights.")
}return this
};
this.popularLoadError=function(d){var b=$("#popular-insights-list"),e={message:d},c="<li>{{message}}</li>";
b.append(_.template(c,e));
RR.utils.debugMessage(d)
};
this.initNavTabs=function(){$('.nav-tabs-btn a[data-toggle="tab"]').on("shown",function(b){window.location.hash="!tab_"+b.target.hash.substr(1);
$('input[name="q"]').val("");
return false
});
if(window.location.hash!==""){$('.nav-tabs-btn a[href="'+location.hash.replace("!tab_","")+'"]').tab("show")
}else{$(".nav-tabs-btn a:first").tab("show")
}};
this.setInsightsPageDesign=function(){$("#accordion3 .accordion-body").css("height","auto");
$("#scorePanel").addClass("hide");
$("#more-info-panel").show()
};
this.initEvents=function(){$('[href="#insight"]').on("click",function(){a.setInsightsPageDesign()
});
$(window).on("hashchange",function(){var b="#!tab_",d=window.location.hash,c;
if(d.length>0){c="#"+d.substr(b.length)
}else{c=$(".nav-tabs-btn li:first-child a").attr("href")
}$('.nav-tabs-btn a[href="'+c+'"]').click();
$(RR).trigger("uiCloseFlyoutMenu")
})
};
this.init=function(){if(!RR.session("loggedIn")){$(".tabs-to-accordion").remove()
}var b=a.loadPopularFaqs();
b.done(function(d){a.displayPopularInsights(d);
var c=RR.utils.detectDevice();
if(c!=="phone"){$("#accordion3 .accordion-body").collapse("show")
}else{$("#accordion3 .accordion-body").collapse("hide")
}if(window.location.hash.indexOf("insight")>=0){a.setInsightsPageDesign()
}});
b.fail(function(c){a.popularLoadError("Error loading popular Insights.")
});
$(window).on("debouncedresize",function(){var c=RR.utils.detectDevice();
if(c!=="phone"){$("#accordion3 .accordion-body").collapse("show")
}else{$("#accordion3 .accordion-body").collapse("hide")
}});
a.initNavTabs();
a.insightInit();
this.initEvents()
};
this.blockEmptySearch=function(){var c=$("#searchForm"),b=c.find('input[name="q"]');
c.on("submit",function(d){if(b.val()===""){d.preventDefault();
return false
}else{return true
}})
};
this.accordionChevronToggle=function(){var b=$("#accordion3");
b.on("hidden",function(c){var d=$(c.target).attr("id");
b.find('a[href="#'+d+'"] .ico').html("&#xf70a;")
});
b.on("shown",function(c){var d=$(c.target).attr("id");
b.find('a[href="#'+d+'"] .ico').html("&#xf709;")
})
};
this.insightInit=function(){a.blockEmptySearch();
a.accordionChevronToggle();
RR.components.feedback.init();
a.analytics()
};
this.analytics=function(){$(".nav.nav-tabs-btn li a").click(function(){try{$(RR).trigger("analyticsevent",{event:("Tab-"+$(this)[0].hash)})
}catch(b){}})
}
});
RR.components.pageHeader=RR.defineComponent(function(){var a=this,d,c,b=767;
this.activateBackButton=function(){var e=RR.url.getParametersAsObject();
if(typeof e!=="undefined"){if(e.hideBackButton){$("header .btn-back").remove()
}}if($(".backRiskProfile").length===0){$(".btn-back").on("click",function(g){g.preventDefault();
var f=$(this).data();
$(window).off("beforeunload");
if(_.isString(f.href)&&f.href!==""){RR.url.goToUrl(f.href)
}else{if(RR.findRoute(RR.route("MAILBOX"))&&$(window).width()<=b){RR.url.goToUrl(RR.route("MAILBOX"))
}else{RR.url.goBack()
}}})
}};
this.activateRiskAssessmentCustomCloseButton=function(f){f.preventDefault();
RR.plugins.RISK_PROFILER.redirectToSelectFundPage(c)
};
this.redirect=function(e){window.location=RR.route(e)
};
this.initEvents=function(){a.activateBackButton();
if(a.params.instanceName==="riskProfileCloseButton"){c=RR.session("journey");
d=RR.session("score");
var f=a.$el.find(".btn.btn-cancel");
var e=a.$el.find(".btn.btn-back.backRiskProfile");
f.on("click",function(g,h){a.activateRiskAssessmentCustomCloseButton(g)
});
e.on("click",function(g,h){a.activateRiskAssessmentCustomCloseButton(g)
})
}};
this.init=function(){this.initEvents()
}
});
RR.components.toggleGender=RR.defineComponent(function(){var a=this;
a.titles=[];
a.femaleTitles=["Mrs","Miss","Ms"];
a.maleTitles=["Mr","Master"];
this.init=function(){this.populateTitlesList();
this.hideGenderSpecificTitles();
this.$el.find('input:radio[name="personalDetails.gender"]').on("change",this.hideGenderSpecificTitles);
this.$el.find('input:radio[name="gender"]').on("change",this.hideGenderSpecificTitles)
};
this.hideGenderSpecificTitles=function(){var b=$('input:radio[name="personalDetails.gender"]:checked').val();
if(!b){b=$('input:radio[name="gender"]:checked').val()
}switch(b){case"M":var d=_.difference(a.titles,a.femaleTitles);
a.clearTitles(d);
break;
case"F":var c=_.difference(a.titles,a.maleTitles);
a.clearTitles(c);
break
}};
this.populateTitlesList=function(){$("#title option").each(function(){a.titles.push($(this).val())
})
};
this.clearTitles=function(b){var c=$("#title");
c.find("option").remove();
$.each(b,function(e,d){c.append($("<option></option>").val(d).html(d))
})
}
});
RR.components.videoModal=RR.defineComponent(function(){var b=this;
var a;
this.init=function(){$("body").on("shown.bs.modal",".modal-video",this.insertVideo).on("hidden.bs.modal",".modal-video",this.removeVideo);
$("body").on("click",".js-content-video",function(c){a=$(this).next("iframe");
if(a.length===0){a=$(this).next(".phone-video-wrapper")
}})
};
this.insertVideo=function(d){var f=$("iframe.hero-video");
if(!f.length){f=a
}var c=f.clone().removeClass().removeAttr("width").removeAttr("height");
b.$el.find(".modal-body").prepend(c)
};
this.removeVideo=function(c){b.$el.find(".modal-body iframe").remove()
}
});
RR.components.goalsProspectSignUp=RR.defineComponent(function(){var a,b;
this.init=function(c,d){a=this;
a.$el=this.$node();
a.hasProspectSignedUp=RR.session("hasProspectSignedUp")||false;
a.getElements();
a.initEvents();
a.bindButtons();
a.notifyUser();
a.showMarketingMessage({},{});
this.hasUserSignedUp()
};
this.hasUserSignedUp=function(){var c=RR.url.parameter("signedUp");
if(c&&!a.hasProspectSignedUp){RR.session("hasProspectSignedUp",true).done(function(){$(RR).trigger("prospectSignUp:signUp",{hasProspectSignedUp:true});
try{$(RR).trigger("analyticsevent",{event:("Prospect-Signed-Up")})
}catch(d){}})
}};
this.getElements=function(){a.$message=a.$el.find(".message");
a.$signUpBtn=a.$el.find(".message a.signup-button");
a.$confirmation=a.$el.find(".confirmation");
a.$dismissBtn=a.$el.find(".confirmation a.btn")
};
this.initEvents=function(){$(RR).on("getScore",a.showMarketingMessage);
$(RR).on("prospectSignUp:signUp",a.showMarketingMessage)
};
this.bindButtons=function(){a.$signUpBtn.click(function(c){c.preventDefault();
$(RR).trigger("prospectSignUp:showModal",{})
});
a.$dismissBtn.click(function(c){c.preventDefault();
a.$message.remove();
a.$confirmation.remove()
})
};
this.showMarketingMessage=function(d,c){if(c.hasScore){a.notifyUser("MESSAGE")
}else{if(c.hasProspectSignedUp){a.notifyUser("CONFIRM")
}else{if(!a.hasProspectSignedUp){RR.session("hasProspectSignedUp",false);
a.notifyUser("MESSAGE")
}else{a.$message.remove();
a.$confirmation.remove()
}}}};
this.notifyUser=function(c){if(RR.utils.isAuthor()){a.$message.removeClass("hidden");
a.$confirmation.removeClass("hidden");
return
}else{if(c==="MESSAGE"){a.$message.removeClass("hidden")
}else{if(c==="CONFIRM"){a.$confirmation.removeClass("hidden");
a.$message.remove()
}}}}
});
RR.components.rulesBasedWebchat=RR.defineComponent(function(){this.init=function(){if(!RR.utils.isAuthor()){var a=($.cookie("webchatDontBother")==="true")?true:false;
if(!a){$(RR).on("webchat:promptReady",function(){if(!this.initiateNavigationBasedPrompt()){this.initiateTimebasedPrompt()
}}.bind(this))
}}};
this.initiateNavigationBasedPrompt=function(){var c=this.$el.data("origins"),b,d=false,a;
a=document.referrer;
a=a.substring(0,a.indexOf(".html"));
if(_.isString(c)&&c.length>0){b=c.split(";;;")
}d=_.some(b,function(e){return(a.indexOf(e)===a.length-e.length)
});
if(d){this.showNavBasedChatPrompt()
}return d
};
this.initiateTimebasedPrompt=function(){var a=parseInt(this.$el.data("time"),10)||0;
if(a>0){setTimeout(this.showTimeBasedChatPrompt.bind(this),a*1000)
}};
this.showTimeBasedChatPrompt=function(){$(RR).trigger("webchat:showTimePrompt")
};
this.showNavBasedChatPrompt=function(){$(RR).trigger("webchat:showNavPrompt")
}
});
RR.components.webchatPromptModal=RR.defineComponent(function(){var a="#dontPromptAgain",b;
this.init=function(){$(RR).on("webchat:showTimePrompt",function(){b="TimeBased";
this.showModal()
}.bind(this)).on("webchat:showNavPrompt",function(){b="NavigationBased";
this.showModal()
}.bind(this)).on("webchat:hidePrompt",this.hideModal.bind(this)).trigger("webchat:promptReady")
};
this.initiate=_.once(function(){var c=RR.session("forename");
if(_.isString(c)&&c.length>0){RR.utils.replaceTemplateString(this.$el.find(".with-name"),"{{name}}",c);
this.$el.find(".without-name").remove()
}else{this.$el.find(".with-name").remove()
}this.$el.find(".btn-primary").on("click",function(d){d.preventDefault();
this.hideModal();
RR.plugins.webchat.showPrechatForm(b)
}.bind(this));
$(a).change(this.onDontBotherCheckboxChanged.bind(this))
});
this.onDontBotherCheckboxChanged=function(d){var c=$(a).is(":checked");
this.$el.find(".btn-primary").attr("disabled",c);
$.cookie("webchatDontBother",c)
};
this.showModal=function(){var f=moment();
var d=this.fetchOperatingTimeFields(f.day());
if(this.isEmpty(d.start)||this.isEmpty(d.end)){return
}var e=this.constructTime(d.start,d.format);
var c=this.constructTime(d.end,d.format);
if(!(this.availableToday(e,c)&&this.withinWorkingHours(e,c,f))){return
}this.initiate();
this.$el.modal("show")
};
this.fetchOperatingTimeFields=function(d){var e=null;
var c=null;
switch(d){case 0:e=$("#opening_times").data("sun-start");
c=$("#opening_times").data("sun-end");
break;
case 6:e=$("#opening_times").data("sat-start");
c=$("#opening_times").data("sat-end");
break;
default:e=$("#opening_times").data("week-start");
c=$("#opening_times").data("week-end");
break
}return{format:"hh:mm A",start:e,end:c}
};
this.constructTime=function(c,d){return moment(c,d)
};
this.availableToday=function(d,c){return d!==c
};
this.withinWorkingHours=function(f,c,g){var d=(f<g);
var e=(c>g);
return d&&e
};
this.hideModal=function(){this.$el.modal("hide")
};
this.isEmpty=function(c){return(!c||0===c.length)
}
});
RR.components.prospectSignUpModal=RR.defineComponent(function(){var a=this;
this.init=function(b,c){a.initEvents();
a.$form=a.$el.find("form");
a.$form.parsley("addListener",{onFormSubmit:a.onFormSubmit});
this.on(a.$el.find("[data-id=submit]"),"click",a.submitModalForm)
};
this.initEvents=function(){$(RR).on("prospectSignUp:showModal",a.renderDialog)
};
this.submitModalForm=function(){a.$form.submit();
return false
};
this.renderDialog=function(d,b){a.$el.modal();
try{$(RR).trigger("analyticsevent",{event:("Prospect-Signup-Form-Shown")})
}catch(c){}};
this.onFormSubmit=function(c,b){b.preventDefault();
if(c){a.verifyExistingCustomer()
}return false
};
this.signUpProspect=function(){a.$el.modal("hide");
a.$form.unbind().submit()
};
this.verifyExistingCustomer=function(){var c=a.$el.find("[name=email]").val();
var d=new RR.api.Customer("");
var b=d.search({policyNumberOrEmail:c});
b.done(function(e){if(e===200){var f="<a href='"+RR.route("SIGN_IN")+"'>Sign in</a>";
RR.plugins.form.setError(a.$el.find("[name=email]"),"","Provided email address is already in use, "+f)
}else{a.setSFDCHiddenParams()
}})
};
this.setSFDCHiddenParams=function(){var b=RR.api.Score("interim").retrieveScore();
var c=RR.api.Goals("interim").getPopulateDetails();
b.done(function(e,d,f){c.done(function(k,m,l){var i=m.address||"";
var h=location.search.length?"&":"?";
var j=location.href+h+"signedUp=true";
var g={"signup-name":$("#signup-name").val()+" "+$("#signup-surname").val(),"signup-retURL":j,"signup-postcode":i.postcode||"","signup-annual-salary":m.personalDetails.grossSalary,"signup-pensions-savings":m.memoPension.value,"signup-pension-regular-premiums":m.memoPension.regularPayment.amount,"signup-employer-contributions":m.memoPension.employerMonthlyContribution.amount,"signup-consolidation-considered":m.questionnaire[1].answer,"signup-isa-savings":m.memoIsa.value,"signup-isa-regular-premiums":m.memoIsa.regularPayment.amount,"signup-last-review-savings":m.questionnaire[0].answer,"signup-last-review-investment-performance":m.questionnaire[2].answer,"signup-tax-free-cash":m.questionnaire[4].answer,"signup-score":d.scores.MASTER.scoreValue,"signup-score-behaviour-percentage":d.scores.BEHAVIOUR.scoreValue,"signup-score-awareness-percentage":d.scores.AWARENESS.scoreValue,"signup-score-finance-percentage":d.scores.FINANCE.scoreValue,"signup-date-of-birth":RR.utils.arrayToDateFormatted(m.personalDetails.dateOfBirth,"DD/MM/YYYY")};
_.each(g,function(n,o){a.$el.find("form #"+o).val(n)
});
a.signUpProspect()
})
})
}
});
RR.components.accordionToggleButton=RR.defineComponent(function(){this.init=function(){if(RR.utils.isAuthor()){return
}var a=this.$el.data("target-id");
this.$el.on("click",function(d){d.preventDefault();
$("#"+a+"-content").collapse("show");
var c=$("#full-width-header"),b=(c.length>0)?c.height():0;
b=(b+20)*-1;
scrollToElement($("#"+a),undefined,b)
})
}
});
RR.components.heroBanner=RR.defineComponent(function(){var a=this,b;
this.init=function(e,g){if(a.$el.find(".slider-img").length){a.initSliderDelay();
a.initSlider();
a.setSliderBackground()
}var c=this.$el.find(".hero-left-wrapper"),f=this.$el.find(".hero-top");
if(c.height()>=f.height()){c.removeClass("absolute-vertical-center-desktop")
}if(RR.utils.isAuthor()){var d=setInterval(function(){var h=$(".cq-element-hero");
if(h.length){h.removeClass("hero");
clearInterval(d)
}},500)
}RR.utils.scrollInPageLinksInElement(this.$el)
};
this.initSliderDelay=function(){var c=this.$el.data("sliderDelay")||5;
b=c*1000
};
this.initSlider=function(){var f=a.$el.find(".slider-img ul li"),c=f.length;
f.hide();
f.first().show();
var e=0;
function d(){var g=f.eq(e);
g.fadeIn("fast");
var i=e;
i++;
var h=$(".slider-img ul li:eq("+i+") img");
if(!h.attr("src")){h.attr("src",h.attr("data-src"))
}setTimeout(function(){g.fadeOut("slow",function(){e++;
if(e>=c){e=0
}d()
})
},b)
}d()
};
this.setSliderBackground=function(){var c=this.$el.data("sliderBackground");
if(c){this.$el.find(".slider-img ul").css({"background-image":'url("'+c+'")'})
}}
});
RR.components.twoColumn=RR.defineComponent(function(){this.init=function(){this.setFullwidthVideosOnMobile()
};
this.setFullwidthVideosOnMobile=function(){this.$el.find(".visible-phone > iframe").each(function(){$(this).closest(".container").addClass("no-horizontal-padding-on-mobile")
})
}
});
RR.components.scrollInPageLinks=RR.defineComponent(function(){this.init=function(){RR.utils.scrollInPageLinksInElement(this.$el)
}
});
RR.components.comparisonTable=RR.defineComponent(function(){var d=["Waiver","SelfInvestmentOption","LifeAssuranceBenefit"];
var b=this;
var a=[];
var c={policyChanges:""};
this.init=function(){this.getPolicyComparison()
};
this.getPolicyComparison=function(){var l=$(".comparisonTable");
var f=RR.session("policyNumber");
var k=new RR.api.Policy("interim",f);
var e=[];
var g=0;
var h=k.comparison({currentPolicyNumber:f});
if(!RR.utils.isAuthor()){l.children(".accordion-heading").hide()
}var i=k.valuation();
i.done(function(j,m){if(j===200){if(m.changes){$.each(m.changes,function(n,o){if(o==="SurrenderCharge"){a.push("SurrenderCharge")
}})
}h.done(function(n,o){if(n===200){if(o.changes){$.each(o.changes,function(p,q){a.push(q)
})
}if(a){$.each(a,function(p,q){l.children("#dynamic_"+q).show()
})
}$.grep(d,function(p){if($.inArray(p,a)===-1){e.push(p);
g++
}});
if(e){$.each(e,function(p,q){l.children("#static_"+q).show()
})
}}})
}})
}
});
RR.components.shopDetailsPanel=RR.defineComponent(function(){var a=this;
var d=false;
var c=false;
var b=false;
this.init=function(){if(!RR.utils.isAuthor()){a.getSavingProductsMap();
$(".pension-detail-box,.isa-detail-box").addClass("hidden")
}else{$(".pension-detail-box, .isa-detail-box").removeClass("hidden")
}};
a.getSavingProductsMap=function(){var e=RR.session("email");
var i=new RR.api.Account(e);
var f;
var h;
var g;
f=i.productsmap({});
f.done(function(j,k){RR.plugins.docParams.keyDocParam(k);
a.showSavingProducts(k)
})
};
a.showSavingProducts=function(f){var e="";
var g="";
if(f.products){$.each(f.products.PENSION,function(h,i){if(i.source==="RR"||i.source==="WORKPLACE"){if(i.source==="WORKPLACE"){b=true
}if(h===0){a.showProductDetail(".pension",i.id,i.value,i.effectiveDate,i.locked,i.source)
}else{d=true
}e+='<option data-item=".pension" data-producdid="'+i.id+'" data-value="'+i.value+'" data-source="'+i.source+'" data-effectiveDate="'+i.effectiveDate+'" data-locked="'+i.locked+'">'+i.name+"</option>";
$("#selectPension").empty().append(e)
}});
$.each(f.products.ISA,function(h,i){if(i.source==="RR"||i.source==="WORKPLACE"){if(h===0){a.showProductDetail(".isa",i.id,i.value,i.effectiveDate,i.locked,i.source)
}else{c=true
}g+='<option data-item=".isa" data-producdid="'+i.id+'" data-value="'+i.value+'" data-source="'+i.source+'" data-effectiveDate="'+i.effectiveDate+'" data-locked="'+i.locked+'">'+i.name+"</option>";
$("#selectISA").empty().append(g)
}});
if(d){$(".pension-detail-box > h3").hide()
}else{$("#selectPension").hide()
}if(c){$(".isa-detail-box > h3").hide()
}else{$("#selectISA").hide()
}if(b){$(".isa-info-box").find(".link-wrapper a").attr("href",RR.route("NEW_COMPARISON_ISA"))
}}a.selectProductChange()
};
a.selectProductChange=function(){$("#selectISA , #selectPension").on("change",function(){var j=$("option:selected",this);
var g=j.attr("data-item");
var l=parseInt(j.attr("data-producdid"),10);
var i=parseInt(j.attr("data-value"),10);
var k=j.attr("data-effectivedate");
var e=j.attr("data-locked");
var h=j.attr("data-source");
var f=[];
f.push.apply(f,k.split(",").map(Number));
a.showProductDetail(g,l,i,f,e,h)
})
};
a.showProductDetail=function(n,i,m,l,j,e){var f=$(n+"-info-box");
var k=$(n+"-detail-box");
a.setCounterDigits(k,m);
k.find(".screenreader-visible").html(m);
if(!j){k.find(".locked-icon").hide()
}if(e==="WORKPLACE"){k.find(".single-product").attr("href",RR.route("SUPPORT"))
}else{if(n===".pension"){k.find(".single-product").attr("href",RR.route("MANAGE_PENSION_SINGLE"))
}else{if(n===".isa"){k.find(".single-product").attr("href",RR.route("MANAGE_ISA_SINGLE"))
}}}if(n===".pension"){if(e==="WORKPLACE"){k.find(".transferPension").attr("href",RR.route("SUPPORT"))
}else{k.find(".transferPension").attr("href",RR.route("SHOP_PENSION_BEFORE_YOU_APPLY")+"?t=true")
}}if(n===".isa"){if(e==="WORKPLACE"){k.find(".transferIsa").attr("href",RR.route("NEW_COMPARISON_ISA"))
}else{k.find(".transferIsa").attr("href",RR.route("SHOP_ISA_BEFORE_YOU_APPLY")+"?t=true")
}}k.find(".manage-product").attr("href",RR.route("SAVINGS")+"#!"+i);
var h=k.find(".link-wrapper a.btn-link");
var g=k.find(".link-wrapper .btn-block");
h.attr("href",h.attr("href")+"#!"+i);
k.find(".effective-date span").html(RR.utils.arrayToDateFormatted(l));
k.find(".account-no span").html(i);
k.removeClass("hidden");
f.addClass("hidden")
};
a.setCounterDigits=function(f,g){g=Math.floor(g);
var e=g.toString().replace(/[^0-9]+/g,"").length;
if(e<6){e=6
}g=a.padString(" ",e,g.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","));
RR.utils.renderWidgetCounter(f,""+g)
};
a.padString=function(f,h,g){var e=0;
e=(g.split(",").length-1);
return(new Array(h+1).join(f)+g).slice(-(h+e))
}
});
RR.components.prospectRegistrationForm=RR.defineComponent(function(){var a=this;
this.init=function(b,c){a.initEvents();
if(!RR.utils.isAuthor()){a.initVerifyBy()
}RR.plugins.PASSWORD_CREATION.validatePassword(false)
};
this.initEvents=function(){a.$el.parsley("addListener",{onFormSubmit:a.onFormSubmit});
var c=sessionStorage.getItem("prospectEmail");
if(c){$("#email").val(c);
$("#confirmEmail").val(c)
}$(".accordion-group").on("show",".accordion-body",function(){$(".date-select-range-html5 input").attr("data-force-validation","true")
});
$(".accordion-group").on("hide",".accordion-body",function(){$(".date-select-range-html5 input").removeAttr("data-force-validation")
});
$(".date-select-range-html5 input").removeAttr("data-force-validation");
$(".homePhoneNumber").hide();
$(document).on("click",".landline-btn",function(){$(".homePhoneNumber").show();
$(".mobilePhoneNumber .help-block").hide()
});
$("input[name='marketing.post'], input[name='marketing.sms'], input[name='marketing.phone'], input[name='marketing.email']").prop("checked",true);
var b=sessionStorage.getItem("prospectCntPref");
if(b==="false"){$("input[name='marketing.email']").prop("checked",false)
}};
this.onFormSubmit=function(d,c){c.preventDefault();
var b=RR.plugins.PASSWORD_CREATION.validatePassword(true);
if(d&&b){a.verifyExistingCustomer()
}};
this.initVerifyBy=function(){function b(){var c=a.$el.find("#type").val();
a.$el.find(".policyNumber").hide();
a.$el.find(".nin").hide();
if(c==="p"){a.$el.find(".policyNumber").show()
}else{if(c==="n"){a.$el.find(".nin").show()
}}}a.$el.find(".type").change(b);
a.$el.find(".policyNumber").hide();
a.$el.find(".nin").hide()
};
this.verifyExistingCustomer=function(){var c=a.$el.find("[name=email]").val();
var d=new RR.api.Customer("");
var b=d.search({policyNumberOrEmail:c});
b.done(function(e){if(e===200){var f="<a href='"+RR.route("SIGN_IN")+"'>Sign in</a>";
RR.plugins.form.setError("[name=email]","","Provided email address is already in use, "+f);
$(RR).trigger("hideProcessingButton");
scrollToElement("[name=firstname]")
}else{a.submitForm()
}})
};
this.verifyMarketingPreferences=function(){var b=$("#dateOfBirth-day").val();
var d=$("input#mobilePhoneNumber_id").val();
var c=$("input#homePhoneNumber_id").val();
if(Modernizr.touch){if($("#dateOfBirth-date").val()===""){$("input[name='marketing.post']").prop("checked",false)
}}else{if(b==="na"){$("input[name='marketing.post']").prop("checked",false)
}}if(!d){$("input[name='marketing.sms']").prop("checked",false);
$("input[name='marketing.phone']").prop("checked",false)
}if(!d){if(!c){$("input[name='marketing.phone']").prop("checked",false)
}else{$("input[name='marketing.phone']").prop("checked",true)
}}};
this.submitForm=function(){var c=RR.components.form2object(a.$el);
var b=new RR.api.Policy("rrp");
b.create().done(function(l,i){var k=i.policyNumber;
var o=new RR.api.Policy("rrp",k);
var j=!a.$el.find("[name=confirmation]").parent().hasClass("c_on");
a.verifyMarketingPreferences();
var p=$("input[name='marketing.email']").prop("checked"),g=$("input[name='marketing.phone']").prop("checked"),h=$("input[name='marketing.sms']").prop("checked"),m=$("input[name='marketing.post']").prop("checked");
var d={personalDetails:{forename:c.firstname,surname:c.surname},contactDetails:{emailAddress:c.email,mobilePhoneNumber:c.mobilePhoneNumber,homePhoneNumber:c.homePhoneNumber},confirmationDetails:{contactPreferences:{preferredContactMethod:"EMAIL",email:p,post:m,sms:h,phone:g}},securityDetails:{password:c.passwordField},confirmedEmailAddress:c.confirmEmail};
var f=a.$el.find('#dateOfBirth input[type="date"]').val();
if(f&&f.length){var e={dateOfBirth:RR.utils.convertDateFieldToNumericArray(f)};
var n=a.$el.find('input[name="nin"]').val();
var q=a.$el.find('input[name="policyNumber"]').val();
if(n&&n.length){e.nationalInsuranceNumber=n
}if(q&&q.length){e.existingPolicyNumber=q
}d.personalDetails=_.extend(e,d.personalDetails)
}o.customer(d).done(function(r,t){if(r===200){o.notify({notificationType:"verifyProspectRegistration"}).done(function(u){if(u===200){sessionStorage.clear();
RR.session({policyType:"rrp",policyNumber:k,email:c.email}).done(function(){RR.url.redirect("REGISTER_PROSPECT_VERIFY_EMAIL")
})
}})
}})
})
}
});
RR.components.amendEmailForm=RR.defineComponent(function(){var a=this;
this.init=function(b,c){a.initEvents()
};
this.initEvents=function(){a.$el.parsley("addListener",{onFormSubmit:a.onFormSubmit})
};
this.onFormSubmit=function(c,b){b.preventDefault();
if(c){a.verifyExistingCustomer()
}};
this.verifyExistingCustomer=function(){var c=a.$el.find("[name=email]").val();
var d=new RR.api.Customer("");
var b=d.search({policyNumberOrEmail:c});
b.done(function(e){if(e===200){var f="<a href='"+RR.route("SIGN_IN")+"'>Sign in</a>";
RR.plugins.form.setError("[name=email]","","Provided email address is already in use, "+f);
$(RR).trigger("hideProcessingButton");
scrollToElement("[name=firstname]")
}else{a.processUpdateEmail()
}})
};
a.processUpdateEmail=function(){var c=RR.session("policyNumber");
if(!c){c=RR.url.parameter("policyNumber")
}var b=this.params.instanceName;
var e=new RR.api.Policy(b,c);
var d=RR.components.form2object(a.$el);
a.updateEmail(e,d.email,d.confirmEmailAddress).done(function(f){if(f===200){a.resendPolicyVerificationCode(e).done(function(g){if(g===200){if(RR.session.exists()){RR.session("email",d.email).done(function(){if(b==="rrp"){RR.url.redirect("NEW_CUSTOMER_VERIFY_EMAIL")
}else{if(b==="upgrade"){RR.url.redirect("AUTO_EMAIL")
}else{if(b==="wps"){RR.url.redirect("WORKPLACE_EMAIL")
}}}})
}else{RR.url.redirect("NEW_CUSTOMER_VERIFY_EMAIL")
}}})
}})
};
a.resendPolicyVerificationCode=function(b){return b.resendVerificationCode()
};
a.updateEmail=function(d,c,b){return d.changeUsername({newEmailAddress:c,confirmedEmailAddress:b})
}
});
RR.components.orphanAuthenticationForm=RR.defineComponent(function(){var b=this;
var a;
var d;
var e=$("#pensionPlanNumberOrNIN");
var g={};
var c=RR.session("email");
var f=new RR.api.Customer(c);
this.onFormSubmit=function(i,h){h.preventDefault();
g=a.serializeObject();
if(i){d.button("loading");
if(g.email){b.searchCustomerByEmail()
}else{b.searchUpgradeNumber()
}}};
this.searchUpgradeNumber=function(){var h=f.legacySearch({upgradeNumber:encodeURIComponent(g.upgradeNumber)});
h.done(function(i,j){if(i===200){if(j.upgradeNumberStatus==="ACTIVE"){RR.session({upgradeNumber:g.upgradeNumber,forename:j.forename,surname:j.surname,email:g.email,nationalInsuranceNumber:g.nationalInsuranceNumber}).done(function(){b.authenticateUser()
})
}else{if(j.upgradeNumberStatus==="EXPIRED"){window.location=RR.route("ORPHAN_AUTH_REQUEST_ID")
}}}else{if(i===404){d.button("reset");
$(RR).trigger("hideProcessingButton");
RR.plugins.form.setError("input[name=upgradeNumber]","invalidupgradenumber","This unique customer ID is not correct, please try again.")
}}})
};
this.authenticateUser=function(){d.button("loading");
var h=f.legacyAuth({upgradeNumber:g.upgradeNumber,nationalInsuranceNumber:g.nationalInsuranceNumber,dateOfBirth:RR.utils.convertDateFieldToNumericArray(g.Date),policyNumber:g.pensionPlanNumber,emailAddress:RR.session("email")});
h.done(function(i,j){if(i===200){if(j.customerType==="TARGETED_ORPHAN"){RR.session("policyNumber",j.policyNumber).done(function(){window.location=RR.route("ORPHAN_COMPARISON_HOME")
})
}else{if(j.customerType!=="TARGETED_ORPHAN"){window.location=RR.route("ORPHAN_AUTH_ALREADY_REGISTERED")
}}}else{if(i===403){d.button("reset");
RR.plugins.form.setError("form","invaliddetails","At least one of your answers to the security questions below was incorrect.")
}}})
};
this.searchCustomerByEmail=function(){var h=f.search({policyNumberOrEmail:encodeURIComponent(g.email)});
h.done(function(i,j){if(i===404){b.searchUpgradeNumber()
}else{if(i===200){d.button("reset");
$(RR).trigger("hideProcessingButton");
RR.plugins.form.setError("input[name=email]","existingemail","Sorry, the email address entered is already registered with Retiready, please try again or <a href="+RR.route("SIGN_IN")+">login</a>.")
}}})
};
this.initEvents=function(){e.on("change",function(h){if($("#pensionPlanNumberOrNIN").val()==="n"){$(".pensionPlanNumber").addClass("hidden");
$(".nationalInsuranceNumber").removeClass("hidden");
$("#pensionPlanNumber_id").val("")
}else{$(".nationalInsuranceNumber").addClass("hidden");
$(".pensionPlanNumber").removeClass("hidden");
$("#nationalInsuranceNumber_id").val("")
}})
};
this.init=function(){a=$("form#panel-form-component-id");
a.parsley("addListener",{onFormSubmit:b.onFormSubmit});
$(".pensionPlanNumber").addClass("hidden");
$("#pensionPlanNumberOrNIN").val("n");
d=$("form [type=submit]");
d.attr("data-loading-text","Loading ...")
}
});
RR.components.initialiseUpgradeForm=RR.defineComponent(function(){var g=this;
var i;
var a;
var d;
var c={};
var f=$("#pensionPlanNumberOrNIN");
var h={};
var b=new RR.api.Customer();
d={year:0,month:0,day:0};
this.init=function(k,l){i=$("form#panel-form-component-id");
i.parsley("addListener",{onFormSubmit:e});
var j=RR.url.parameter("upgradeNumber");
if(j){RR.plugins.form.populate("form",{upgradeNumber:j})
}a=$("form [type=submit]");
a.attr("data-loading-text","Loading ...");
$("#full-width-header .navigation, #full-width-header .dropdown").css("visibility","hidden")
};
function e(k,j){j.preventDefault();
h=i.serializeObject();
if(k){a.button("loading");
g.searchUpgradeNumber()
}}g.searchUpgradeNumber=function(){var k=this.params.instanceName;
if(k===null){k="upgrade"
}var j=b.initialiseUpgrade(k,{upgradeNumber:encodeURIComponent(h.upgradeNumber),dateOfBirth:RR.utils.convertDateFieldToNumericArray(h.Date),nationalInsuranceNumber:h.nationalInsuranceNumber});
j.done(function(l,m){if(l===200){if(m.upgradeNumberStatus==="ACTIVE"){RR.session({upgradeNumber:h.upgradeNumber,forename:m.forename,surname:m.surname,policyNumber:m.policyNumber}).done(function(){if(k==="wps"){window.location=RR.route("WORKPLACE_PROFILE")
}else{window.location=RR.route("AUTO_PROFILE")
}})
}else{if(m.upgradeNumberStatus==="EXPIRED"){RR.plugins.form.setError("input[name=upgradeNumber]","invalidupgradenumber","This unique customer ID is expired.")
}}}else{if(l===404){a.button("reset");
$(RR).trigger("hideProcessingButton");
RR.plugins.form.setError("input[name=upgradeNumber]","invalidupgradenumber","This unique customer ID is not correct, please try again.")
}else{if(l===406){a.button("reset");
RR.plugins.form.setError("form","invaliddetails","At least one of your answers to the security questions below was incorrect.")
}else{if(l===403){a.button("reset");
var n="<a href='"+RR.route("SIGN_IN")+"'>Sign in</a>";
RR.plugins.form.setError("form","invaliddetails","This unique customer ID is registered.Please "+n+" or contact customer services to resolve.")
}}}}})
}
});
RR.components.verifyEmailForm=RR.defineComponent(function(){var b=this,d="";
var c;
var a=$("form#panel-form-component-id");
this.init=function(e,f){b.initEvents();
b.initParams();
b.renderTemplate()
};
this.onFormSubmit=function(g,f){var h;
h=a.serializeObject();
if(g){d.purchase({verificationCode:h.verificationCode}).done(function(e){if(e===200){if(c==="upgrade"){window.location=RR.route("AUTO_WELCOME")
}else{if(c==="interim"){window.location=RR.route("WELCOME")
}else{if(c==="wps"){window.location=RR.route("WORKPLACE_WELCOME")
}}}}else{if(e===500){RR.plugins.form.setError("[name=verificationCode]","notmatching","This verification code is incorrect.")
}}}).fail(function(){})
}return false
};
this.initEvents=function(){$("#secondaryAction2").on("click",function(){$(window).off("beforeunload")
});
$("#secondaryAction1").click(function(f){f.preventDefault();
b.getVerificationCode()
})
};
b.initParams=function(i){var g=$("form#panel-form-component-id");
var f=RR.session("policyNumber");
var e=RR.url.parameter("verificationCode");
c=this.params.instanceName;
$("#full-width-header .navigation, #full-width-header .dropdown").css("visibility', 'hidden");
if(c==="interim"){b.productTemplate()
}if(c==="rrp"){b.initErrors()
}if(!f){f=RR.url.parameter("policyNumber");
var h=$("#secondaryAction2 a").attr("href");
$("#secondaryAction2 a").attr("href",h+"?policyNumber="+f)
}if(e){RR.plugins.form.populate("form",{verificationCode:e})
}d=new RR.api.Policy(c,f);
if(c==="rrp"){$("#prospect-verify-email").attr("action",d.getRegisterURL());
this.$el.parsley("addListener",{onFormSubmit:function(j){if(j){$(RR).trigger("showProcessingButton",[true])
}}})
}else{g.parsley("addListener",{onFormSubmit:this.onFormSubmit})
}RR.plugins.loader.hide("#send-confirmation")
};
b.renderTemplate=function(){var e=RR.session("email");
var f=RR.templateVars||{};
f.email=e||"your email address";
if(RR.plugins.templates){RR.plugins.templates.render()
}};
b.productTemplate=function(){if(c==="interim"){var e=RR.session("purchase")?RR.session("purchase").route:null;
if(e&&e.toLowerCase()==="pension"){e="Pension"
}else{if(e&&e.toLowerCase()==="isa"){e="ISA"
}else{e="Product"
}}if(e!==null){$(".main-header").html($(".main-header").html().replace("{PRODUCT}",e))
}}};
b.getVerificationCode=function(){var e=$("#send-confirmation");
d.resendVerificationCode().done(function(f){if(f===200){e.removeClass("panel").addClass("alert");
e.prepend('<span class="ico" aria-hidden="true">&#xf70e;</span>');
e.show()
}})
};
b.initErrors=function(){var e=RR.url.parameter("status");
if(e&&(e==="406"||e==="500")){RR.plugins.form.setError("[name=verificationCode]","notmatching","This verification code is incorrect.")
}else{if(e&&e==="502"){RR.url.redirect("PROSPECT_CUSTOMER_ACCOUNT_CREATION_FAILED")
}}}
});
RR.plugins.headway=(function(f){var e={},c=this,g=f("#loadingSpinner"),b=f("#screenreader-loading-message"),d=f("#content"),a;
e.showSpinner=function(h){g.show();
b.text("Loading Page");
d.attr("aria-hidden",true);
f(RR).trigger("headway:spinnerShown");
if(!h){e.startCallTracker()
}};
e.hideSpinner=function(){g.hide();
b.text("Page Loaded");
d.attr("aria-hidden",false);
f(a).off("callTracker:allCallsComplete");
f(RR).trigger("headway:spinnerHidden")
};
e.startCallTracker=function(){a=a||new RR.callTracker();
if(a.startTracking()){f(a).on("callTracker:allCallsComplete",function(i,h){e.hideSpinner()
})
}};
e.initEvents=function(){f(RR).on("headway:showSpinner",function(h,i){g.css("opacity","0.7");
e.showSpinner(i)
});
f(window).on("pageshow",function(h){if(h.originalEvent&&h.originalEvent.persisted){e.hideSpinner()
}})
};
e.init=function(){e.startCallTracker();
this.initEvents()
};
return e
}(jQuery));
RR.plugins.parsley=(function(c,d,a){var b={};
c.ParsleyConfig={exclude:":disabled",messages:{defaultMessage:"This value seems to be invalid. ",type:{email:"This value should be a valid email. ",url:"This value should be a valid url. ",urlstrict:"This value should be a valid url. ",question:"This value should be alphanumeric. ",number:"This value should be a valid number. ",digits:"This value should be digits. ",dateIso:"This value should be a valid date (YYYY-MM-DD). ",alphanum:"This value should be alphanumeric. ",alphanum_nospaces:"This value should be alphanumeric and cannot contain any spaces. ",phone:"This value should be a valid phone number. ",nino:"This value should be a valid National Insurance number. ",currency:"This value should be a valid currency number. ",postcode:"This value should be a valid postcode. ",addressline:"This is not a valid residential address. "},notnull:"This value should not be null. ",notblank:"This value should not be blank. ",required:"This value is required. ",regexp:"This value seems to be invalid. ",min:"This value should be greater than or equal to %s. ",max:"This value should be lower than or equal to %s. ",range:"This value should be between %s and %s. ",minlength:"This value is too short. It should have %s characters or more. ",maxlength:"This value is too long. It should have %s characters or less. ",rangelength:"This value length is invalid. It should be between %s and %s characters long. ",mincheck:"You must select at least %s choices. ",maxcheck:"You must select %s choices or less. ",rangecheck:"You must select between %s and %s choices. ",equalto:"This value should be the same. ",daterange:"Date range is invalid. ",maxwithdrawal:"You can't withdraw this amount. ",maxisaallowance:"You can't contribute this amount. ",minage:"You need to be %s years old or more.",maxage:"You need to be %s years old or less."},validators:{type:function(k,j){var h;
switch(j){case"number":h=/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/;
break;
case"digits":h=/^\d+$/;
break;
case"alphanum":h=/^(?![\s]*['-])[\s\w-'YyINNin]+$/;
break;
case"alphanum_nospaces":h=/^(?!['-])[\w-'YyINNin]+$/;
break;
case"question":h=/^(?![\s]*['-])[\s\w-'\?YyINNin]+$/;
break;
case"email":h=/([a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4})/i;
break;
case"url":k=new RegExp("(https?|s?ftp|git)","i").test(k)?k:"http://"+k;
case"urlstrict":h=/^(https?|s?ftp|git):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i;
break;
case"dateIso":h=/^(\d{4})\D?(0[1-9]|1[0-2])\D?([12]\d|0[1-9]|3[01])$/;
break;
case"phone":h=/^((\+\d{1,3}(-| )?\(?\d\)?(-| )?\d{1,5})|(\(?\d{2,6}\)?))(-| )?(\d{3,4})(-| )?(\d{4})(( x| ext)\d{1,5}){0,1}$/;
break;
case"nino":h=/^(?!BG|GB|NK|KN|TN|NT|ZZ)[A-CEGHJ-PR-TW-Z]{1}[A-CEGHJ-NPR-TW-Z]{1}\s?[0-9]{2}\s?[0-9]{2}\s?[0-9]{2}\s?[A-D]{1}$/i;
break;
case"currency":h=/^(\d+)(\.\d{1,2})?$/;
break;
case"postcode":h=/^(([A-z]{1,2})([0-9Rr][0-9A-z]?)\s?([0-9])([aAbBdD-hHjJlLnNpP-uUwW-zZ]{2}))$/i;
break;
case"addressline":h=/^(?![\s]*['-])[\s\w-'YyINNin]+$/;
break;
default:return false
}if(j==="addressline"){var i=["care of","care","co","c-o","po-box","po box","p.o. box","post office","post office box","pobox"];
var g=""!==k.trim()?h.test(k):false;
var f=true;
var e=k.toLowerCase().trim()+" ";
a.each(i,function(l){if(e.indexOf(l+" ")===0){f=false
}});
if(f){if(e.match("po box ")&&e.indexOf("po box ")!==0){f=false
}}return(g&&f)
}else{if(j==="alphanum"||j==="question"){return""!==k.trim()?h.test(k):false
}else{return""!==k?h.test(k):false
}}},rrdate:function(x,k,l){var w=l.$element,r=w.closest("form").find(".date-select-range").length,p=w.closest(".date-select-range"),o=p.find(".select-day").val(),v=p.find(".select-month").val(),j=p.find(".select-year").val(),u,i,t,m,f,n,h,e,q,g=w.closest("form");
if(r===1){u=moment([j,v-1,o]);
return u.isValid()
}if(r===2){i=g.find("[name=startday]").val();
t=g.find("[name=startmonth]").val();
m=g.find("[name=startyear]").val();
f=g.find("[name=endday]").val();
n=g.find("[name=endmonth]").val();
h=g.find("[name=endyear]").val();
e=moment([m,t-1,i]);
q=moment([h,n-1,f]);
if(e.isValid()&&q.isValid()){return q.isAfter(e)
}else{return false
}}},maxwithdrawal:function(f,e){if(f){return Number(f)<=e
}else{return true
}},maxisaallowance:function(f,e){if(f){return Number(f)<=e
}else{return true
}},daterange:function(e,g,k){var m=k.$element,i=m.closest("form").find("input[name=startDate]"),l=m.closest("form").find("input[name=endDate]"),f=Date.parse(i.val()),h=Date.parse(l.val());
if(i.length===0||l.length===0){return true
}if(m.attr("name")==="startDate"){var j=l.data("parsleyField");
j.valid=null;
j.validatedOnce=false;
l.data("parsleyField",j);
return true
}else{return f<h
}},minage:function(g,f){var e=RR.utils.calcAge(g);
f=parseInt(f,10);
if(a.isNaN(e)||a.isNaN(f)){return false
}return e>=f
},maxage:function(g,f){var e=RR.utils.calcAge(g);
f=parseInt(f,10);
if(a.isNaN(e)||a.isNaN(f)){return false
}return e<=f
},onenotempty:function(i,f,e){e.options.validateIfUnchanged=true;
var g=false,h=true;
f=f.split(",");
d.each(f,function(j,k){if(d(k).val()!==""){g=true;
h=false
}});
return(g)
}}};
b.init=function(){};
return b
}(window,jQuery,_));
RR.plugins.form=(function(g){var e={};
var f;
e.field={};
f={animate:false,successClass:"",errorClass:"error",focus:"first",trigger:"focusout",validationMinlength:0,excluded:"input[type=hidden][data-force-validation!=true], input[type=file], :disabled",errors:{classHandler:function(i){return g(i).closest(".control-group")
},container:function(i,j){return e.getFieldErrorContainer(i)
},errorsWrapper:'<div style="display:inline;"></div>',errorElem:'<div  style="display:inline;"></div>'},listeners:{onFieldSuccess:function(j,k,i){b(j)
}}};
e.parsleyOptions=f;
e.clearError=function(l){var j;
var k;
var i;
j=g(l);
if(j.length){i=j.prop("tagName");
if(i==="FORM"){h(j)
}else{b(j)
}return true
}else{return false
}};
e.setError=function(p,j,i,o){var m;
var n;
var k;
var l;
m=g(p);
if(m.length){k=j?m.attr("data-"+j+"-message")||i:i;
l=m.prop("tagName");
if(l==="FORM"){d(m,k)
}else{a(m,k)
}if(!o){m.on("keyup.RR submit.RR change.RR",function(){e.clearError(p);
m.off("keyup.RR submit.RR change.RR")
})
}return true
}else{return false
}};
e.getFieldErrorContainer=function(j){var i=g(j);
var k=i.closest(".control-group").children(".help-inline").eq(0);
if(k.length===0){k=g("<span class='help-inline controls' aria-hidden='false' name='help-inline'><span class='ico' aria-hidden='true'>&#xf70e;</span></span>").insertBefore(i.closest(".control-group").children("label").eq(0))
}if(k.length===0){k=g("<span class='help-inline controls' aria-hidden='false' name='help-inline'><span class='ico' aria-hidden='true'>&#xf70e;</span></span>").prependTo(i.closest(".control-group"))
}return k
};
function c(i){var j=g(i).parent().children("div.alert.alert-error");
if(j.length===0){j=g("<div class='alert alert-error'><h3><span class='ico' aria-hidden='true'>&#xf70e;</span></h3></div>").insertBefore(i)
}return j
}function d(i,j){c(i).find("h3").append(j)
}function h(i){c(i).remove()
}function a(j,i){j.closest(".control-group").addClass("error");
e.getFieldErrorContainer(j).html("<span class='ico' aria-hidden='true'>&#xf70e;</span>"+i)
}function b(i){i.closest(".control-group").removeClass("error");
e.getFieldErrorContainer(i).remove()
}e.populateFieldWithValue=function(j,m){var o=g(j);
var l=o.attr("type");
var k=o.prop("tagName");
try{if(k==="SELECT"){if(o.find('option[value="'+m+'"]').length){o.val(m)
}}else{switch(l){case"checkbox":o.filter('[value="'+m+'"]').prop("checked",true);
break;
case"radio":var i=o.siblings("label");
o.prop("checked",false);
i.removeClass("checked");
o=o.filter('[value="'+m+'"]');
o.prop("checked",true);
i.filter('[for="'+o.attr("id")+'"]').addClass("checked");
break;
default:o.val(m)
}}if(o.filter("[data-child]")){o.trigger("change.RRpluginFormFieldChild")
}o.trigger("change")
}catch(n){}};
e.populate=function(j,i){_.each(i,function(l,k){if(_.isArray(l)){_.each(l,function(n,m){e.populateFieldWithValue(j+" [name="+k+""+m+"]",n)
})
}else{e.populateFieldWithValue(j+" [name="+k+"]",l)
}})
};
e.initIncrementorField=function(i){g(i).each(function(){var p=g(this);
var o=isNaN(Number(p.val()))?0:Number(p.val());
var j=p.attr("data-min")?Number(p.attr("data-min")):null;
var n=p.attr("data-max")?Number(p.attr("data-max")):null;
var m=g(this).siblings("button").first();
var k=g(this).siblings("button").last();
function l(){return isNaN(Number(p.val()))?o:Number(p.val())
}m.click(function(){p.val(l()-1);
p.parsley("validate")
});
k.click(function(){p.val(l()+1);
p.parsley("validate")
})
})
};
e.field.maxLength=function(j,i){var k=g(j);
k.on("keyup focusout",function(){var l=g(this);
if(l.val().length>i){l.val(l.val().substring(0,i))
}})
};
e.field.sortCode=function(j){function i(l){var k=l.val();
if(k.length!==2){return false
}if(isNaN(Number(k))){return false
}return true
}g(j).each(function(){var m;
var k=g(this).children("input");
var l={};
l[k.eq(0).attr("name")]=0;
l[k.eq(1).attr("name")]=0;
l[k.eq(2).attr("name")]=0;
_.each(l,function(n){g(this).closest("form").parsley("removeItem",'[name="'+n+'"]')
});
e.field.maxLength(k,2);
k.on("focusout",function(){l[g(this).attr("name")]=1;
if(l[k.eq(0).attr("name")]&&l[k.eq(1).attr("name")]&&l[k.eq(2).attr("name")]){if(i(k.eq(0))&&i(k.eq(1))&&i(k.eq(2))){RR.plugins.form.clearError(l[k.eq(0).attr("name")][0])
}else{m=k.eq(0).val()+k.eq(1).val()+k.eq(2).val();
if(m.length){RR.plugins.form.setError("[name='"+k.eq(0).attr("name")+"']","invalid","This seems to be invalid.",1)
}else{RR.plugins.form.setError("[name='"+k.eq(0).attr("name")+"']","required","This value is required.",1)
}}}});
k.on("keyup",function(n){if(n.which!==9&&i(k.eq(0))&&i(k.eq(1))&&i(k.eq(2))){RR.plugins.form.clearError(j)
}})
})
};
e.field.toggle=function(i){g(i).each(function(){var k=g(this).find("input[type=radio]");
var j=g(this).find("label");
k.focusin(function(){g(this).closest(".toggle-group").addClass("focus")
});
k.focusout(function(){g(this).closest(".toggle-group").removeClass("focus")
});
k.click(function(){j.removeClass("checked");
if(g(this).is(":checked")){j.filter("[for='"+g(this).attr("id")+"']").addClass("checked")
}})
})
};
e.field.dateOfBirth=function(i){g(i).each(function(){var j=g(this).find(".date-select-range-html5 input");
j.change(function(){j.parsley().validate()
})
})
};
e.init=function(){g.fn.serializeObject=function(){var i=this.serializeArray();
var j={};
g.each(i,function(){if(j[this.name]){if(!j[this.name].push){j[this.name]=[j[this.name]]
}j[this.name].push(this.value||"")
}else{j[this.name]=this.value||""
}});
return j
};
g("form").attr("novalidate","novalidate");
g("form").each(function(){g(this).parsley(f);
g(this).parsley("addListener",{onFieldValidate:function(j,i){if(i.valid){g(RR).trigger("navigateAwayModal:deactivate")
}if((!g(j).is(":visible")||g(j).is(":disabled"))&&!g(j).attr("data-force-validation")){return true
}return false
}})
});
e.initIncrementorField("form .incrementor > input");
e.field.toggle("form .toggle-group");
e.field.sortCode("form .sort-code");
e.field.dateOfBirth("form .date-of-birth");
g("form [type=submit]").button()
};
return e
}(jQuery));
RR.plugins.templates=(function(c,a){var b={};
b.setupTemplates=function(){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g};
a.templateVars=a.templateVars||{}
};
b.setTemplateVar=function(d,e){a.templateVars=a.templateVars||{};
a.templateVars[d]=c.extend(a.templateVars[d]||{},e);
return this
};
b.render=function(d,f){var g=d||".js-template",h=f||a.templateVars,e;
for(e in h){if(h.hasOwnProperty(e)){if(!h[e]){h[e]="undefined";
a.utils.debugMessage("template variable "+e+"is undefined")
}}}c(g).each(function(){var j=c(this),i=j.html();
j.html(_.template(i,h))
});
return this
};
b.init=function(){if(a.options.templates){this.setupTemplates()
}};
return b
}(jQuery,RR));
RR.plugins.webchat=(function(e,b){var c={},l,g,o,r,h,f=e("#prechat"),n=f.find('button[type="submit"]'),q=e(".webchat-open"),a="https://c.la2w1cs.salesforceliveagent.com/content/g/js/29.0/deployment.js",i={},p,j;
c.isLiveagentInitialised=false;
p=window.sfdcVariables||"";
e("#liveagent_button_offline_").attr("id","liveagent_button_offline_"+p.buttonId);
e("#liveagent_button_online_").attr("id","liveagent_button_online_"+p.buttonId);
j='liveagent.showWhenOnline("'+p.buttonId+'",';
j+='document.getElementById("liveagent_button_online_'+p.buttonId+'"));';
j+='liveagent.showWhenOffline("'+p.buttonId+'",';
j+='document.getElementById("liveagent_button_offline_'+p.buttonId+'"));';
if(!window._laq){window._laq=[]
}window._laq.push(new Function(j));
function m(){l.children("option").eq(-2).remove()
}function k(t){if(!e(".cq-wcm-edit").length){t.closest(".control-group").hide()
}}function d(v){var u=e(this).val();
var t=true;
if(u===""||u===l.children("option").last().val()){t=false
}if(t){o.map(function(w){return e(this).parent("span").length===0?this:null
}).wrap("<span>").hide();
o.hide();
o.first().show();
h.each(function(x){var w=e(this);
o.each(function(y){var z=e(this);
if(w.text()===u){if(z.val()===w.val()){z.unwrap().show().change()
}}})
});
g.val("");
o.first().unwrap().show();
g.closest(".control-group").show();
g.trigger("change")
}else{k(g)
}}c.loadLiveAgent=function(){return e.getScript(a)
};
c.hidePrechat=function(){f.find('[type="submit"]').removeAttr("disabled");
f.slideToggle("slow",function(){f.hide()
})
};
c.startChat=function(){b.utils.debugMessage("starting web chat");
liveagent.startChatWithWindow(p.buttonId,"retireready");
c.hidePrechat()
};
c.initDropDowns=function(){l=e("#type");
g=e("#rr_topic__c");
o=g.children("option");
r=e("#relationship");
h=r.children("option");
m();
k(g);
k(r);
l.change(d)
};
c.showPrechatForm=function(t){c.loadLiveAgentJSFiles();
var u=e("#"+p.buttonId),B=e("#prechatForm"),A=B.find(".control-group.name"),z=B.find(".control-group.email"),y;
f.show();
f.find(".btn.close").on("click",function(){f.hide()
});
B.on("submit",function(I){var J=B.find('[name="liveagent.prechat.email"]').val(),C=B.find('[name="liveagent.prechat.name"]').val(),D=e("#type option:selected").val(),G=e("#rr_topic__c option:selected").val(),H=b.session("sfdcAccountId")||"",F=e('meta[property="og:title"]').attr("content"),K;
I.preventDefault();
if((B).parsley("isValid")===true){if(!c.isLiveagentInitialised){liveagent.setName(C);
liveagent.addCustomDetail("Email",J).map("Account","rr_account_Email__c",false,true);
liveagent.addCustomDetail("Type",D).map("Case","Type",true,false);
liveagent.addCustomDetail("Topic",G).map("Case","rr_Topic__c",true,false);
liveagent.addCustomDetail("Account",H).map("Case","accountid",true,false);
liveagent.addCustomDetail("Email_Anonymous",J).map("Case","rr_Email_Anonymous__c",true,false);
liveagent.addCustomDetail("Page_Title",F).map("Case","PageTriggeredTitle__c",true,false);
if(!H){liveagent.addCustomDetail("Origin","Web Chat Anonymous").map("Case","rr_Origin__c",true,false)
}else{liveagent.addCustomDetail("Origin","Web Chat LoggedIn").map("Case","rr_Origin__c",true,false)
}var E=liveagent.findOrCreate("Case").map("Type","Type","Topic","Account").map("rr_Topic__c","Topic","Type","Account").map("rr_Origin__c","Origin","Type","Topic").map("AccountId","Account","Type","Topic").map("rr_Email_Anonymous__c","Email_Anonymous","Type","Topic").map("PageTriggeredTitle__c","Page_Title","Type","Topic");
if(_.isString(t)&&t.length){liveagent.addCustomDetail("Type_Of_Prompt",t).map("Case","RuleType__c",true,false);
E.map("RuleType__c","Type_Of_Prompt","Type","Topic")
}E.saveToTranscript("caseid").showOnCreate()
}liveagent.init(p.url,p.deploymentId,p.organizationId);
c.isLiveagentInitialised=true;
B.find('[type="submit"]').attr("disabled","disabled");
K=liveagent._.handlePing;
liveagent._.handlePing=function(L){window.setTimeout(c.startChat,100);
liveagent._.handlePing=K;
liveagent._.handlePing(L)
}
}return false
});
if(!b.session("forename")||!b.session("surname")){A.show()
}else{B.find('[name="liveagent.prechat.name"]').val(b.session("forename")+" "+b.session("surname"));
A.hide()
}if(!b.session("email")){z.show()
}else{B.find('[name="liveagent.prechat.email"]').val(b.session("email"));
z.hide()
}var w=e("#rulesBasedWebchat").data(),x=w.primaryCategory,v=w.subcategory;
if(_.isString(x)&&x.length>0){B.find("#type").val(x).change();
if(_.isString(v)&&v.length>0){B.find("#rr_topic__c").val(v).change()
}}};
c.loadLiveAgentJSFiles=function(){var t=this.loadLiveAgent();
t.done(function(){n.attr("disabled",false);
b.utils.debugMessage("liveagent initialised")
});
t.fail(function(){b.utils.debugMessage("Failed to load Live Agent","err")
})
};
c.init=function(){c.initDropDowns();
q.on("click",function(t){t.preventDefault();
c.showPrechatForm()
});
n.attr("disabled",true)
};
return c
}(jQuery,RR));
RR.plugins.hacks=(function(b){var a={};
a.init=function(){this.disableCopyPaste()
};
a.disableCopyPaste=function(){b(".no-copy-paste").bind("cut copy paste",function(c){c.preventDefault()
})
};
return a
}(jQuery));
RR.plugins.loader=(function(b){var a={};
a.init=function(){a.bindButtonLink();
a.removeBackButton();
a.dropDownContextHelp();
a.toggleExpandCollapse();
a.setDevice()
};
a.hide=function(c){if(!b(".cq-wcm-edit").length){b(c).hide()
}};
a.setDevice=function(){var c=RR.utils.detectDevice();
b("html").addClass(c)
};
a.bindButtonLink=function(){b("button[data-href],a[data-href]").click(function(d){var c=b(d.target);
if(c.hasClass("exclude-from-nav-warning")){b(RR).trigger("navigateAwayModal:deactivate")
}var e=b(this).attr("data-href");
if(!b.isEmptyObject(e)&&e!=="#"){window.location=e
}})
};
a.removeBackButton=function(){if(b(".remove-back-button").length){b("header .btn-back").remove()
}};
a.toggleExpandCollapse=function(){b("button.more, button.less").click(function(){var d=b(this);
var c=d.attr("id");
if(d.hasClass("more")){RR.plugins.loader.hide(d.parent())
}else{if(d.hasClass("less")){c="#"+c.replace("-collapse","-expand");
b(c).parent().show()
}}})
};
a.dropDownContextHelp=function(){b("p[data-context-help]").hide();
b(".form-dropdown").on("change",function(){var e=b(this),d=e.parent(),c=e.find("option:selected").val(),f=d.find('[data-context-help = "'+c+'"]');
d.find("p[data-context-help]").hide();
if(f.length){f.show()
}})
};
a.removeNavigation=function(){b(".module-nav, .fixed-tools").remove()
};
return a
}(jQuery));
RR.plugins.dynamicReveal=(function(c,d,a){var b={};
b.hide$controlGroup=function(f,e){f.slideUp(e)
};
b.show$controlGroup=function(f,e){f.slideDown(e)
};
b.reveal$child=function(f,e){var g;
g=f.closest(".control-group");
if(f.attr("data-parent-val").toLowerCase()===e.toLowerCase()){if(!g.is(":visible")){b.show$controlGroup(g,300)
}}else{if(f.prop("tagName")==="INPUT"){f.val("")
}b.hide$controlGroup(g,300)
}};
b.init$element=function(e){var f;
f=e.closest("form").find("[name='"+e.attr("data-parent")+"']");
f.attr("data-child",e.attr("name"));
if(f.length){f.on("change.RRpluginDynamicReveal",function(j){var i;
var h;
var g;
i=d(this);
h=i.closest("form").find("[name='"+i.attr("data-child")+"']");
if(i.attr("type")==="radio"){g=i.filter(":checked").val()
}else{g=i.val()
}b.reveal$child(h,g)
})
}f.trigger("change.RRpluginDynamicReveal")
};
b.activateDynamicReveal=function(e){d(e).each(function(g){var f=d(this);
b.hide$controlGroup(f.closest(".control-group"),0);
b.init$element(f)
})
};
b.init=function(){b.activateDynamicReveal("form [data-parent][data-parent-val]")
};
return b
}(window,jQuery,_));
RR.plugins.PASSWORD_CREATION=(function(c){var b={};
var a=false;
b.init=function(){};
b.validatePassword=function(e){if(!e){c("#confirm-password-field").siblings(".confirm-icon").hide()
}c("#confirm-password-field").keyup(function(){var f=c("#password-field").val();
var g=c("#confirm-password-field").val();
if(f===g){c("#confirm-password-field").siblings(".confirm-icon").show()
}else{c("#confirm-password-field").siblings(".confirm-icon").hide()
}});
c("#password-field").keyup(function(){var f=c("#password-field").val();
a=true;
if(f.length>=8){c("#password-length").addClass("complete");
c("#password-length span").html("&#xf707;")
}else{c("#password-length").removeClass("complete");
c("#password-length span").html("");
a=false
}if(f.match(/\d+/g)!==null){c("#password-contain-number").addClass("complete");
c("#password-contain-number span").html("&#xf707;")
}else{c("#password-contain-number").removeClass("complete");
c("#password-contain-number span").html("");
a=false
}if(f.match(/[a-z]/)&&f.match(/[A-Z]/)){c("#password-mixed-case").addClass("complete");
c("#password-mixed-case span").html("&#xf707;")
}else{c("#password-mixed-case").removeClass("complete");
c("#password-mixed-case span").html("");
a=false
}if(!a){c("#confirm-password-field").siblings(".confirm-icon").hide()
}});
c("#password-field").blur(function(){if(!a){d()
}});
if(!a&&e){d()
}return a
};
function d(){RR.plugins.form.setError("#password-field","invalidpassword","Please enter a valid password");
scrollToElement(RR.plugins.form.getFieldErrorContainer("#password-field"))
}return b
}(jQuery));
RR.plugins.helpModal=(function(f){var e={};
var d=f("a.form-help");
var c=f("a.inline-help").not(".no-help-popup");
var a=f("#help-modal");
function b(j){j.preventDefault();
var h=f(f(j.currentTarget).attr("href"));
var k=!h.length;
if(k){h=a;
var g;
var i;
g=f(this).attr("data-help-title");
i=f(this).siblings(".helpIconText").html();
h.find(".help-modal-title").html(g);
h.find(".help-modal-body").html(i)
}if(k){h.modal("show")
}else{if(!f(".cq-wcm-edit").length){h.modal("show")
}else{f("html, body").animate({scrollTop:h.offset().top},500)
}}}e.init=function(){d.click(b);
c.click(b);
a.modal({show:false})
};
return e
}(jQuery));
RR.plugins.fundModal=(function(e){var d={};
var g=e("#fund-modal");
var c=e("#fundDetailModal");
var f="N";
function a(m){m.preventDefault();
var o=e(e(m.currentTarget).attr("href"));
var i=!o.length;
var j=RR.session("fundGoalDetails");
var l=j.fundId;
if(f==="N"){var n=new RR.api.Fund();
var h=n.getRRFundDetails();
h.done(function(q,t){if(q===200){var r="";
var u=t[0].serviceCharges;
e.each(t,function(v,w){r+="<tr><td>"+w.displayName+"</td><td>"+w.growthRates[0].value+"</td></tr>"
});
e("#fundDetailModal .growthRate table").append(r);
e.each(u,function(v,w){e(".chargesAndCost table tbody tr:eq("+v+") td:eq(1)").html(w.value);
e(".chargesAndCost table tbody tr:eq("+v+") td:eq(2)").html(t[1].fundCost)
})
}});
if(l!=="NOPRODUCT"){var k=new RR.api.Fund(l);
var p=k.getFundDetails();
p.done(function(r,u){if(r===200){if(u.type==="RR"){e(".otherFunds").hide();
e("<h3> Your Invested Fund: "+u.displayName+"</h3>").insertBefore(".chargesAndCost table")
}else{var t=u.serviceCharges;
e("<h3>Retiready Solutions</h3>").insertBefore(".chargesAndCost table");
e.each(t,function(v,w){e(".otherFunds table tbody tr:eq("+v+") td:eq(1)").html(w.value);
e(".otherFunds table tbody tr:eq("+v+") td:eq(2)").html(u.fundCost)
});
var q="<tr><td>"+u.displayName+"</td><td>"+u.growthRates[1].value+"</td></tr>";
e(".growthRate table").append(q);
e("<h3>Your Invested Fund: "+u.displayName+"</h3>").insertBefore(".otherFunds table")
}}})
}else{e(".growthRate").hide();
e(".otherFunds").hide()
}f="Y"
}}function b(l){l.preventDefault();
if(!RR.utils.isAuthor()){e(".js-fund-content, .js-risk-content, .js-factsheet-content, .js-no-content").hide()
}var j=e(this).attr("data-investmentid");
var k=new RR.api.Product(j);
var i=k.getFundDetails();
var h=e(e(l.currentTarget).attr("href"));
var m=!h.length;
i.done(function(n,o){if(n===200){if(m){h=g;
h.find(".help-modal-title").text(o.displayName);
h.find(".fundName").text(o.displayName);
if(o.riskRating){h.find(".fundRiskLevel span").text(o.riskRating)
}else{h.find(".fundRiskLevel span").text("Not Available")
}h.find(".block-list-documents-alt h4 span").text(o.displayName);
if(o.factSheetUrl){h.find(".block-list-documents-alt a").attr("href",o.factSheetUrl)
}else{h.find(".block-list-documents-alt").hide()
}h.find(".block-list-documents-alt h4 span").text(o.displayName);
if(o.type==="RR"){h.find(".fund-selected-long").removeClass().addClass("fund-selected fund-selected-long fund-"+o.riskRating)
}else{h.find(".fund-selected-long").removeClass().addClass("fund-selected fund-selected-long fund-aegon")
}if(o.riskRating&&o.factSheetUrl){e(".js-fund-content").show()
}else{if(!o.riskRating&&o.factSheetUrl){e(".js-risk-content").show()
}else{if(o.riskRating&&!o.factSheetUrl){e(".js-factsheet-content").show()
}else{e(".js-no-content").show()
}}}}if(m){h.modal("show")
}else{if(!e(".cq-wcm-edit").length){h.modal("show")
}else{e("html, body").animate({scrollTop:h.offset().top},500)
}}}})
}d.init=function(){e("#fundBreakdown").on("click",".fund-help",b);
e(document).on("click",".jsFundModal",b);
g.modal({show:false});
e(document).on("click",".js-fund-goal-modal",a);
c.modal({show:false})
};
return d
}(jQuery));
RR.plugins.ARIA_SLIDER=(function(e){var d={};
d.init=function(g){e(".input-slider").not('[data-valuename="targetRetirementAge"]').each(function(h){d.createSliderFromElement(e(this),g)
});
e(RR).on("ariaSlider:updateSliderFromElement",function(h,i){d.updateSliderFromElement(e(i))
});
e(RR).on("ariaSlider:updated",function(i,h){d.updateHiddenTextField(h)
});
e(RR).on("ariaSlider:updateAnimationComplete",function(i,h){d.updateHiddenTextField(h)
})
};
d.createSliderFromElement=function(i,h){var g=a(i,parseInt(i.attr("data-minValue"),10),parseInt(i.attr("data-maxValue"),10),parseInt(i.attr("data-startValue"),10),i.attr("data-valueName"),parseInt(i.attr("data-bigincrement"),10),parseInt(i.attr("data-smallincrement"),10),(i.attr("data-showOutput")==="true"),h,i.data("prepend"));
i.data("aria-slider",g);
d.updateHiddenTextField(i)
};
d.updateHiddenTextField=function(h){var k=e(h),i=k.find(".sliderThumb"),j=k.find(".input-slider-hidden-value"),g=i.attr("aria-valuenow");
if(j.val()!==g){j.val(g);
j.blur()
}};
d.updateSliderFromElement=function(g){var h;
if(g!==null&&g!==undefined&&!_.isEmpty(g)){h=g
}else{h=e(".input-slider")
}h.each(function(k){var m=parseInt(e(this).attr("data-minValue"),10);
var l=b(e(this).data("aria-slider"),m);
var j=(parseInt(e(this).attr("data-startValue"),10)-m)/parseInt(e(this).attr("data-bigincrement"),10);
var n=j-l;
c(e(this).data("aria-slider"),n,m)
})
};
d.repositionLabel=function(i,k){var h=e(i).find(".sliderValue"),g=24,j=34;
if(h.length>0){if((k<0.1)&&(h.outerWidth()>j)){h.css("margin-left","0px")
}else{if((k>0.9)&&(h.outerWidth()>j)){h.css("margin-left","-"+(h.outerWidth()-j)+"px")
}else{h.css("margin-left","-"+((h.width()-g)/2)+"px")
}}}};
function a(o,r,n,i,p,l,v,k,q,u){e(o).find(".sliderThumb").attr({"aria-valuemin":r,"aria-valuemax":n});
e(o).children(".min-value").eq(0).html("Minimum "+p+": "+r);
e(o).children(".max-value").eq(0).html("Maximum "+p+": "+n);
var h=Math.round(((n-r)/l),10);
var m=(i-r)/(h);
var j=0;
if(h===5){j=0.065
}var g=e(o).find(".sliderValue");
var t=new Dragdealer(e(o).children(".sliderRail").eq(0).get(0),{steps:h+1,snap:true,speed:100,left:j,right:j,x:m,callback:function(w,A){var z=Math.round((((n-r)*(this.value.current)[0])+r),10);
e(RR).trigger("ariaSlider:updated",o,z)
},animationCallback:function(w,A){var z=Math.round((((n-r)*(this.value.current)[0])+r),10);
if(k){g.html(u+z);
d.repositionLabel(o,this.value.current[0]);
e(o).find(".sliderThumb").attr({"aria-valuenow":z,"aria-valuetext":p+" selector - currently "+z})
}if(q){q(z)
}e(RR).trigger("ariaSlider:updateAnimationComplete",o,z)
}});
f(t,o,r,n,l,v);
e(o).find(".sliderThumb").blur();
if(q===undefined){return t
}}function c(g,h,i){var k=b(g,i);
var j=k+h;
var l=j/(g.steps-1);
g.setValue(l)
}function b(g,h){return(g.value.current)[0]*(g.steps-1)
}function f(h,i,k,l,g,j){e(document).keydown(function(m){if(e(i).find(".sliderThumb").is(":focus")){switch(m.which){case 37:c(h,-j,k);
m.preventDefault();
break;
case 39:c(h,j,k);
m.preventDefault();
break;
case 33:c(h,g,k);
m.preventDefault();
break;
case 34:c(h,-g,k);
m.preventDefault();
break;
case 36:c(h,-(b(h,k)-k),k);
m.preventDefault();
break;
case 35:c(h,(b(h,k)+l),k);
m.preventDefault();
break;
case 27:e(i).find(".sliderThumb").blur();
break;
default:break
}}});
e(i).find(".sliderThumb").click(function(){e(this).focus();
return false
})
}return d
}(jQuery));
RR.plugins.RISK_PROFILER=(function(f){var g={},d="#selection1",e,a=20,b,i=false;
g.route=null;
g.init=function(){};
g.setSelectedFund=function(){if(RR.session("selectedFund")){g.changeEnlargedItem(".risk-level-"+g.toNumbers(RR.session("selectedFund")))
}if(RR.session("score")){b=RR.session("score");
f(".selection-info.user").show();
f(".selection-info.user").attr("class","selection-info user risk-"+b);
f(".selection-info.user").html(f(".selection-info.user").html().replace("{placeholder}","<span id='riskDesc'></span>"));
f("#riskDesc").html(f(".risk-color-"+b).attr("descriptive-text"));
f("#riskLevels").hide()
}if(!RR.utils.isAuthor()){this.rendered=false;
var k="CustomerDetails";
if(!RR.session("upgradeNumber")||RR.session("selectedFund")){if(RR.utils.isUserLoggedIn()){f(RR).on("data"+k,f.proxy(g.populate,this));
f(RR).trigger("uiNeeds"+k)
}}}};
g.setRiskscore=function(){if(RR.session("score")){b=RR.session("score");
f(".selection-info.user").show();
f(".selection-info.user").attr("class","selection-info user risk-"+b);
f(".selection-info.user").html(f(".selection-info.user").html().replace("{placeholder}","<span id='riskDesc'></span>"));
f("#riskDesc").html(f(".risk-color-"+b).attr("descriptive-text"));
f("#riskLevels").hide()
}if(!RR.utils.isAuthor()){this.rendered=false;
var k="CustomerDetails";
if(!RR.session("upgradeNumber")||RR.session("selectedFund")){if(RR.utils.isUserLoggedIn()){f(RR).on("data"+k,f.proxy(g.populate,this));
f(RR).trigger("uiNeeds"+k)
}}}};
g.populate=function(n,l){if(!this.rendered&&l){if(_.isObject(l.latestRiskScore)){b=l.latestRiskScore.score;
f(".selection-info.user").show();
f(".selection-info.user").attr("class","selection-info user risk-"+b);
f(".selection-info.user").html(f(".selection-info.user").html().replace("{placeholder}","<span id='riskDesc'></span>"));
f("#riskDesc").html(f(".risk-color-"+b).attr("descriptive-text"));
f("#riskLevels").hide();
var k=f(".fund-select-icon button.enlarged");
if(k.length>0){var m=g.getNumberFromParentID(k.closest(".fund-select-icon"));
g.showCorrectConfirmationCheckbox(m)
}}}};
g.setPolicyNumber=function(k){e=k
};
g.initCharts=function(){var k=new Array("low","medium","high");
f.each(k,function(l,m){f("#chart-bar-"+m).Stack({hasContainer:false,step:0.4,stripeAt:a,stacks:[{percentage:0,primaryColor:"#6ed69f",secondaryColor:"#6ed69f"}]})
})
};
g.moveEnlargedItem=function(l){var k=g.getNumberFromParentID(d);
var n;
var m=f(".fund-select-icon").length;
if(l==="plus"){n=parseInt(k,10)+1
}if(l==="minus"){n=parseInt(k,10)-1
}if(n===0){n=m
}if(n===(m+1)){n=1
}n=".risk-level-"+n;
g.changeEnlargedItem(n)
};
g.getNumberFromParentID=function(l){var k=(f(l).attr("class").match(/risk[\w-]level[\w-]*\b/))[0].split("-")[2];
return k
};
g.getNameFromParentID=function(k){return f(k).find("span").html()
};
g.changeEnlargedItem=function(o){var m=g.getNumberFromParentID(o),n=g.getNameFromParentID(o),k=(f(o).hasClass("fund-disabled"))?true:false;
f(".btn-selector").removeClass("enlarged");
f(o).find(">:first-child").addClass("enlarged");
f(".selection-info-panel").removeClass("hidden-element");
f(".risk-id").html(n);
f(".risk-level-rating").html(f(".risk-color-"+m).attr("descriptive-text"));
f(".selection-info-panel").removeClass(function(p,q){return(q.match(/\brisk-\S+/g)||[]).join(" ")
});
f(".selection-info-panel").addClass("risk-"+m);
f(".fund-box").hide();
f(".info").hide();
f(".block-list-documents, .get-projection, .projections-panel").toggleClass("hidden",k===true);
if(RR.currentPageId()==="SHOP_PAGES_OUR_INVESTMENT_FUNDS"){f(".projections-panel").removeClass("hidden")
}f("#fundDescription"+m).show();
f(".info-"+m).show();
if(!k){f(".get-projection").off().click(function(){f(".projections-panel").show("slide",function(){var p=new Array("low","medium","high");
f.each(p,function(r,t){var q=f("#chart-bar-"+t);
if((q).is(":visible")===true){q.trigger("stack:clear");
q.trigger("stack:percentage",[0,0,q.attr("data-percentage")]);
q.trigger("stack:render")
}})
});
f(".chart-bar").hide().show();
scrollToElement(".projections-panel",0,-100)
})
}f(".selected-fund").html(n);
if(RR.currentPageId()!=="SHOP_PAGES_OUR_INVESTMENT_FUNDS"){f("#continue-without-risk-profile-checkbox").parent().html(f("#continue-without-risk-profile-checkbox").parent().html().replace("{selected-fund}",g.toLetters(m)))
}d=o;
var l=null;
if(RR.session("purchase")){l=RR.session("purchase").route
}else{if(RR.session("journey")){l=RR.session("journey").productType
}}if(!k){if(l==="ISA"){c(g.toLetters(m),"Total");
f(".span3 .btn-group button").removeClass("active");
f(".span3 .btn-group button:contains('Total')").addClass("active");
f(".span3 .btn-group").addClass("hidden")
}else{c(g.toLetters(m),"")
}g.showCorrectConfirmationCheckbox(m)
}};
g.showCorrectConfirmationCheckbox=function(k){f(".label_check.c_on").removeClass("c_on").find("input").prop("checked",false);
f(".checkboxControl").hide();
if(!b){f("#checkbox1").show()
}else{if(String(b)===String(k)){f("#checkbox3").show()
}else{f("#checkbox2").show()
}}};
g.toLetters=function(k){return(k-1).toString(26).replace(/./g,function(l){return String.fromCharCode(l.charCodeAt(0)+(isNaN(+l)?10:49))
}).toUpperCase()
};
g.toNumbers=function(k){k=k.toUpperCase();
var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",m=0,l;
for(l=0;
l<k.length;
l++){m+=Math.pow(n.length,l)*(n.indexOf(k.substr(((l+1)*-1),1))+1)
}return m
};
function c(t,p){var y="Yearly";
var w="Total";
var k="";
var z=RR.session("fundValue");
var m=RR.session("journey");
var r="interim";
var x;
var o="N";
var n={};
var l=f("#continue-button-wrapper");
m=_.isObject(m)?m:{};
var q=m.oldFund;
var u="#fundDescription";
if(RR.session("journey")&&RR.session("journey").route==="CHANGEFUND"){o="R"
}if(RR.session("journey")&&RR.session("journey").route==="CHANGENONRRFUND"){o="R"
}if(RR.session("purchase")){x=RR.session("purchase").route
}else{if(RR.session("journey")){x=RR.session("journey").productType
}else{if(RR.session("upgradeNumber")){x="PENSION"
}}}if(p===""){k=f(".btn-group button.active").text()
}else{if(p!==""){k=p
}}n={basicProjectionOptions:{fundValue:z,fundOption:t,illustrationType:o,productType:x}};
u=u+RR.utils.fundToInt(n.basicProjectionOptions.fundOption);
if(m&&m.route&&((m.route==="CHANGEFUND")||(m.route==="CHANGENONRRFUND"))){r="rr";
o="R";
n.basicProjectionOptions.accountId=m.productId
}else{if(RR.session("registeredShop")){r="rr"
}else{if(RR.session("preRegisteredShop")){r="rrp"
}}}if(t===q){RR.plugins.form.clearError("form");
l.attr("disabled","disabled");
RR.plugins.form.setError("form","","This is the same as your current selection. If you want to make a change, please choose a different fund.",1)
}else{l.removeAttr("disabled");
RR.plugins.form.clearError("form")
}if(n.basicProjectionOptions.productType!==undefined){f(RR).trigger("headway:showSpinner");
var v=new RR.api.Policy(r,e);
var A=v.projection({basicProjectionOptions:n.basicProjectionOptions});
A.done(function(C,D){if(C===200){var B=(RR.utils.detectDevice()==="phone")?48:0;
RR.session("projectionCallStatus",C);
RR.session("projectionData",D);
h(k,C,D);
if(i){f("html,body").animate({scrollTop:f(".fund-box:visible").offset().top-B});
i=false
}}else{f(u).find("button").attr("disabled",true)
}})
}}g.submitFormDetails=function(k,n,m,o,t){var l=RR.session("purchase");
var p;
var q=RR.session("registeredShop");
var r=RR.session("preRegisteredShop");
if(q){p=new RR.api.Policy("rr",e)
}else{if(r){p=new RR.api.Policy("rrp",e)
}else{p=new RR.api.Policy("interim",e)
}}var u=p.customer({fundDetails:{selectedFund:k,productType:n,confirmNoRiskProfile:m,confirmRiskProfileMatchesFund:t,confirmRiskProfileDifference:o}});
u.done(function(v,w){if(v===200){var x=p.customer();
x.done(function(y,z){RR.session(z.fundDetails).done(function(){if(l){if(q){if(RR.session("hasTransferDetails")){if(l.route==="PENSION"){RR.url.redirect("REGISTERED_CUSTOMER_PENSION_CONFIRM_DETAILS")
}else{if(l.route==="ISA"){RR.url.redirect("REGISTERED_CUSTOMER_ISA_CONFIRM_DETAILS")
}}}else{if(l.route==="PENSION"){RR.url.redirect("REGISTERED_CUSTOMER_PENSION_TERMS")
}else{if(l.route==="ISA"){RR.url.redirect("REGISTERED_CUSTOMER_ISA_TERMS")
}}}}else{if(r){RR.url.redirect("REGISTERED_PROSPECT_CONFIRM_DETAILS")
}else{RR.url.redirect("NEW_CUSTOMER_CONFIRM_DETAILS")
}}}else{RR.url.redirect("ORPHAN_CONFIRM_DETAILS")
}})
})
}})
};
g.toggleButtonBindings=function(){f(".btn-group button").off().click(function(){j(f(this).text())
})
};
function j(m){var l="";
var o=f("#continue-button-wrapper");
if(m===""){l=f(".btn-group button.active").text()
}else{if(m!==""){l=m
}}var k=RR.session("projectionCallStatus");
var n=RR.session("projectionData");
h(l,k,n)
}function h(k,m,n){var v="Yearly";
var r="Total";
var p=(n.projections)?n.projections.high.projectedIncome:0,l=(n.projections)?n.projections.high.projectedValue:0,o,u,t=0,q=0;
if(m===200){if(n.projections){f("#Low, #Medium, #High").hide();
f.map(n.projections,function(x,w){u=f("#"+w+" span.chart-value");
o=f("#chart-bar-"+w);
f("#"+w).show();
if(k===v){u.html(RR.utils.formatAmount(x.projectedIncome));
t=x.projectedIncome*100/p
}else{if(k===r){u.html(RR.utils.formatAmount(x.projectedValue));
t=x.projectedValue*100/l
}}q=RR.utils.roundToNearest(a,t);
q=(q<a)?a:q;
if((o).is(":visible")===true){o.trigger("stack:clear");
o.trigger("stack:percentage",[0,0,q]);
o.trigger("stack:render")
}else{o.attr("data-percentage",q)
}})
}}}g.scrollerController=function(){f(".fund-select-icon").off().click(function(k){i=true;
g.changeEnlargedItem(f(this))
});
f(".right").off().click(function(k){k.preventDefault();
g.moveEnlargedItem("minus")
});
f(".left").off().click(function(k){k.preventDefault();
g.moveEnlargedItem("plus")
})
};
g.confirmFundChange=function(m,k,o,n){var l=RR.session("journey");
l.newFund=m;
l.confirmNoRiskProfile=k;
l.confirmRiskProfileMatchesFund=n;
l.confirmRiskProfileDifference=o;
RR.session("journey",l).done(function(){if(RR.session("rrFundSelected")==="N"){RR.url.redirect("CHANGE_OTHER_FUND_CONFIRMATION")
}else{RR.url.redirect("CHANGE_FUND_CONFIRMATION")
}})
};
g.continueController=function(){f("#continue-button-wrapper").off().click(function(n){n.preventDefault();
var m=RR.session("journey");
var k=_.isObject(m)?m.route:null;
var l=null;
if(RR.session("purchase")){l=RR.session("purchase").route
}else{if(RR.session("journey")){l=RR.session("journey").productType
}else{if(RR.session("upgradeNumber")){l="PENSION"
}}}if(f("#continue-without-risk-profile-checkbox").is(":checked")||f("#continue-fund-doesnt-match-risk-profile-checkbox").is(":checked")||f("#continue-fund-matches-risk-profile-checkbox").is(":checked")){if(m&&(k==="CHANGEFUND"||k==="CHANGENONRRFUND")){g.confirmFundChange(g.toLetters(g.getNumberFromParentID(d)),f("#continue-without-risk-profile-checkbox").is(":checked"),f("#continue-fund-doesnt-match-risk-profile-checkbox").is(":checked"),f("#continue-fund-matches-risk-profile-checkbox").is(":checked"))
}else{g.submitFormDetails(g.toLetters(g.getNumberFromParentID(d)),l,f("#continue-without-risk-profile-checkbox").is(":checked"),f("#continue-fund-doesnt-match-risk-profile-checkbox").is(":checked"),f("#continue-fund-matches-risk-profile-checkbox").is(":checked"))
}f("#validation-no-confirmation").addClass("hidden");
f("#validation-no-confirmation-container").removeClass("alert-error")
}else{f("#validation-no-confirmation").removeClass("hidden");
scrollToElement("#validation-no-confirmation");
f("#validation-no-confirmation-container").addClass("alert-error")
}})
};
g.redirectToSelectFundPage=function(l){var k=RR.session("purchase");
if(k){if(k.route==="PENSION"){if(k.registeredCustomer){RR.url.redirect("REGISTERED_FUND_SELECTION_PENSION")
}else{RR.url.redirect("FUND_SELECTION_PENSION")
}}else{if(k.route==="ISA"){if(k.registeredCustomer){RR.url.redirect("REGISTERED_FUND_SELECTION_ISA")
}else{RR.url.redirect("FUND_SELECTION_ISA")
}}}}else{if(l){if(l.route==="CHANGEFUND"){if(l.productType==="PENSION"){RR.url.redirect("CHANGE_FUND_PENSION")
}else{if(l.productType==="ISA"){RR.url.redirect("CHANGE_FUND_ISA")
}}}else{if(l.route==="CHANGENONRRFUND"){RR.url.redirect("CHANGE_FUND_NON_RR",{productId:l.productId})
}else{if(l.route==="PROFILEJOURNEY"){RR.url.redirect("BASIC_PROFILE")
}}}}else{RR.url.redirect("ORPHAN_FUND_PROJECTIONS")
}}};
return g
}(jQuery,RR));
RR.plugins.sessionFlashMessage=(function(c){var b={};
function a(d){return c("#"+d)
}b.renderFlashModal=function(d){var j=a(d.modal);
var i=j.find(".modal-body");
if(d.data&&j.length){var g=i.html();
var f;
try{f=_.template(g,d.data)
}catch(h){f=g
}i.html(f)
}};
b.revealFlashModal=function(d){var e=a(d.modal);
if(e.modal){e.modal("show")
}else{e.show()
}};
b.resetFlash=function(){RR.session("flash",{})
};
b.getFlash=function(){return RR.session("flash")
};
b.init=function(){var d=b.getFlash();
if(_.isObject(d)&&!c.isEmptyObject(d)){b.renderFlashModal(d);
b.revealFlashModal(d);
b.resetFlash()
}};
return b
}(jQuery));
RR.plugins.dataPublisher=(function(d){var c={};
var e;
var b;
var a=false;
var f={};
c.publishCustomerDetails=function(){var h;
var g=RR.session("email");
if(!e&&g){h=new RR.api.Customer(g);
h.details().done(function(i,j){b=j;
d(RR).trigger("dataCustomerDetails",b)
});
e=true
}};
c.publishGoalsDetails=function(){var g;
if(!a){g=new RR.api.Goals();
g.getPopulateDetails().done(function(h,j,i){f=j;
d(RR).trigger("dataGoalsDetails",f)
});
a=true
}};
c.init=function(){e=false;
b={};
a=false;
f={};
d(RR).on("uiNeedsCustomerDetails",c.publishCustomerDetails);
d(RR).on("uiNeedsGoalsDetails",c.publishGoalsDetails)
};
return c
}(jQuery));
RR.plugins.analytics=(function(e){var d={};
var b=["publish.localhost","author.localhost"];
var a=location.hostname;
var c="UA-45245980-3";
d.init=function(){d.createGAInstance();
e(RR).on("analyticsevent",d.sendPageEvent);
d.monitorExternalFiles();
d.inPageEvents()
};
d.createGAInstance=function(){var f="auto";
e.each(b,function(g,h){if(a===h){f="none"
}});
ga("create",c,f)
};
d.sendPseudoPage=function(f){ga("send","pageview",{page:f,title:f});
RR.utils.debugMessage("GA Page: "+f)
};
d.sendPageEvent=function(g,f){ga("send",{hitType:"event",eventCategory:"in-page-event",eventAction:"click",eventLabel:f.event});
RR.utils.debugMessage("GA Event: "+f.event)
};
d.inPageEvents=function(){e("body").on("click",".analytics",function(){try{e(RR).trigger("analyticsevent",{event:("Tab-"+e(this)[0].hash)})
}catch(f){}})
};
d.monitorExternalFiles=function(){if(typeof jQuery!=="undefined"){jQuery(document).ready(function(h){var f=/\.(zip|exe|dmg|pdf|doc.*|xls.*|ppt.*|mp3|txt|rar|wma|mov|avi|wmv|flv|wav)$/i;
var g="";
if(jQuery("base").attr("href")!==undefined){g=jQuery("base").attr("href")
}jQuery("a").on("click",function(m){var l=jQuery(this);
var i=true;
var o=[];
var j=(typeof(l.attr("href"))!=="undefined")?l.attr("href"):"";
var k=j.match(document.domain.split(".").reverse()[1]+"."+document.domain.split(".").reverse()[0]);
if(!j.match(/^javascript:/i)){o.value=0;
o.non_i=false;
if(j.match(/^mailto\:/i)){o.category="email";
o.action="click";
o.label=j.replace(/^mailto\:/i,"");
o.loc=j
}else{if(j.match(f)){if(j.match(/^https?\:/i)&&!k){var n=(/[.]/.exec(j))?/[^.]+$/.exec(j):undefined;
o.category="download";
o.action="click-"+n[0];
o.label=j.replace(/ /g,"-");
o.loc=g+j
}else{d.sendPseudoPage(j.replace(/ /g,"-"));
i=false
}}else{if(j.match(/^https?\:/i)&&!k){o.category="external";
o.action="click";
o.label=j.replace(/^https?\:\/\//i,"");
o.non_i=true;
o.loc=j
}else{if(j.match(/^tel\:/i)){o.category="telephone";
o.action="click";
o.label=j.replace(/^tel\:/i,"");
o.loc=j
}else{i=false
}}}}}if(i){ga("send",{hitType:"event",eventCategory:o.category.toLowerCase(),eventAction:o.action.toLowerCase(),eventLabel:o.label.toLowerCase(),eventValue:o.value,nonInteraction:o.non_i});
if(l.attr("target")===undefined||l.attr("target").toLowerCase()!=="_blank"){setTimeout(function(){location.href=o.loc
},400);
return false
}}})
})
}};
return d
}(jQuery));
RR.plugins.sessionManager=(function(c){var d={};
var b=1800000;
var i=300000;
var f=100;
var g=Math.round(b/f);
var e;
var a=true;
d.halftimeReached=false;
d.monitoringActivity=false;
d.sessionExpiringModalOpened=false;
var h=[{selector:"body",delegate:"a, button, img, input, textarea, select",eventName:"click"},{selector:window,eventName:"scrollEnd"},{selector:"body",delegate:"input, textarea, select",eventName:"keypress"},{selector:"input, textarea, select",eventName:"focusout"}];
function j(k){if(a){RR.utils.debugMessage(k)
}}d.closeSessionExpiringModal=function(){d.sessionExpiringModalOpened=false
};
d.newTimer=function(){var k=(new Date()).getTime();
RR.session("lastSessionRefreshTimestamp",k).done(function(){d.startTimer(k)
})
};
d.startTimer=function(r){var l;
var q;
var m;
var p;
var n;
var o;
l=r+b/2;
m=r+b;
q=m-i;
n=new Date().getTime();
o=n-r;
p=Math.round((m-n)/1000);
d.halftimeReached=false;
j("sessionManager: Session expires in "+p+" seconds");
function k(){var u;
var t;
var v;
t=new Date().getTime();
v=t-r;
p=Math.round((m-t)/1000);
u=v-o;
if(t>=l&&!d.halftimeReached){j("sessionManager: Halftime reached");
j("sessionManager: Session expires in "+p+" seconds");
d.halftimeReached=true;
d.monitorActivity()
}if(t>=q&&!d.sessionExpiringModalOpened){j("sessionManager: Notification time reached");
j("sessionManager: Session expires in "+p+" seconds");
d.sessionExpiringModalOpened=true;
c(RR).trigger("uiShowSessionExpiringModal",{timeLeft:m-t})
}if(t>=m){j("sessionManager: Stopping session timer");
d.stopTimer();
d.killSession()
}else{o+=g;
e=window.setTimeout(k,g-u)
}}k()
};
d.stopTimer=function(){if(e){window.clearTimeout(e)
}};
d.refreshSession=function(){d.halftimeReached=false;
d.stopTimer();
j("sessionManager: Refreshing session");
RR.session.refresh().done(d.newTimer)
};
d.refreshSessionAfterApiCall=function(m,l,k){if(k.url.indexOf("/api")>=0&&d.halftimeReached){j("sessionManager: API call captured");
d.refreshSession()
}};
d.refreshSessionAfterUserAction=function(){if(d.halftimeReached){j("sessionManager: User action captured");
d.refreshSession()
}};
d.monitorActivity=function(){if(!d.monitoringActivity){d.followUserAction();
d.followApiCalls();
d.monitoringActivity=true
}};
d.followApiCalls=function(){c(document).ajaxComplete(d.refreshSessionAfterApiCall)
};
d.followUserAction=function(){j("sessionManager: Following user actions");
_.each(h,function(m){var n=m.eventName.split(" ");
var k=null;
for(var l=0;
l<n.length;
l++){n[l]+=".sessionManager"
}k=n.join(" ");
if(m.delegate){c(m.selector).on(k,m.delegate,d.refreshSessionAfterUserAction)
}else{c(m.selector).on(k,d.refreshSessionAfterUserAction)
}})
};
d.killSession=function(){j("sessionManager: Terminate session");
c(RR).trigger("uiExpireSessionAction")
};
d.init=function(){c(window).scroll(function(){clearTimeout(c.data(this,"scrollTimer"));
c.data(this,"scrollTimer",setTimeout(function(){c(window).trigger("scrollEnd")
},250))
});
d.initSessionTimer();
c(window).on("pageshow",function(k){d.initSessionTimer()
})
};
d.initSessionTimer=function(){if(RR.session.exists()){var k=(new Date()).getTime();
var l=RR.session("lastSessionRefreshTimestamp");
c(RR).on("uiSessionExpiringModalClosed",d.closeSessionExpiringModal);
if(l&&k-l<(b/2-g)){j("sessionManager: Resuming an existing session timer");
d.startTimer(l)
}else{j("sessionManager: Starting a new session timer");
d.newTimer()
}}if(c.cookie("RR-session-plugin-url")!==RR.utils.removeHash(document.URL)){c.removeCookie("RR-session-plugin-url",{path:"/"})
}};
return d
}(jQuery));
RR.plugins.logout=(function(b){var a={};
a.currentUser=null;
a.logout=function(f,c){var d=RR.api.Customer(a.currentUser);
d.logout().done(function(e){if(e===200){var g="HOME_SIGNED_OUT";
if(c&&c.page){g=c.page
}RR.url.redirect(g)
}})
};
a.expireSession=function(){var c;
if(RR.utils.isUserLoggedIn()){c=RR.api.Customer(a.currentUser)
}else{c=RR.api.Interim()
}c.logout().done(function(d){if(d===200){RR.url.redirect("GLOBAL_SESSION_EXPIRY")
}})
};
a.init=function(){a.currentUser=RR.session("email");
if(a.currentUser){b(RR).on("uiLogoutAction",a.logout)
}b(RR).on("uiExpireSessionAction",a.expireSession)
};
return a
}(jQuery));
RR.plugins.cancelButton=(function(b){var a={};
a.saveCancelUrl=function(){var c=document.URL;
if(c.indexOf("/public/error/")===-1){b.cookie("RR-cancel-url",c,{path:"/"})
}};
a.activateCancelButton=function(){b("body").on("click",".btn-cancel",function(f){if(window.location.search.indexOf("hideBackButton")>-1){window.close()
}var c=b(this).data();
if(c.href&&c.href.length>0){RR.url.goToUrl(c.href)
}else{f.preventDefault();
var d=b.cookie("RR-cancel-url");
if(d!==undefined&&d.length>0){RR.url.goToUrl(d)
}else{RR.url.goBack()
}}})
};
a.clearCookieUrl=function(){b.removeCookie("RR-cancel-url",{path:"/"})
};
a.init=function(){var c=b("button.btn-cancel");
if(c.length>0){a.activateCancelButton()
}else{a.saveCancelUrl()
}};
return a
}(jQuery));
RR.plugins.notifications=(function(c){var b={};
var a;
b.initNotifications=function(){var d=RR.session("notifications");
if(!d&&RR.session.exists()){RR.session("notifications",{})
}};
b.initEvents=function(){c(RR).on("productSelectionRender",b.renderNotificationInTotal)
};
b.renderNotificationInTotal=function(f,d){if(d.type==="total"){RR.plugins.notifications.renderNotification()
}else{RR.plugins.notifications.removeNotification()
}};
b.setNotificationFlag=function(f){var d=new c.Deferred();
if(f){var e=RR.session("notifications");
if(_.isObject(e)){e[f]=f;
RR.session("notifications",e).done(function(){d.resolve()
})
}}return d.promise()
};
b.renderNotification=function(e){var d=RR.session("notifications");
if(_.isObject(d)&&!c.isEmptyObject(d)){_.each(d,function(g,f){_.each(a,function(i,h){if(f===h){b.displayNotification(i)
}})
})
}};
b.removeNotification=function(e){var d=RR.session("notifications");
if(_.isObject(d)&&!c.isEmptyObject(d)){_.each(d,function(g,f){_.each(a,function(i,h){if(f===h){b.hideNotification(i)
}})
})
}};
b.displayNotification=function(d){if(d.length){d.removeClass("hidden").show()
}};
b.hideNotification=function(d){if(d.length){d.addClass("hidden").show()
}};
b.init=function(){a={SIPPCONSOLIDATE:c("#consolidationSIPPMessage"),ISACONSOLIDATE:c("#consolidationISAMessage"),SIPPCHANGEFUND:c("#changedFundSIPPMessage"),ISACHANGEFUND:c("#changedFundISAMessage")};
b.initNotifications();
b.renderNotification();
b.initEvents()
};
return b
}(jQuery));
RR.plugins.navigateAwayModal=(function(c){var b={};
var a=false;
b.initEvents=function(){c(RR).on("navigateAwayModal:deactivate",b.deactivateWarning);
c(RR).on("navigateAwayModal:activate",b.activateWarning);
c(RR).on("navigateAwayModal:init",b.initNavigateAway);
c("body").on("click","a, button",this.filterLinks);
c("body").on("click",".exclude-from-nav-warning",function(){c(RR).trigger("navigateAwayModal:deactivate")
});
if(document.URL.indexOf("secure/")!==-1){c(RR).trigger("navigateAwayModal:init")
}};
b.initNavigateAway=function(){c(RR).trigger("navigateAwayModal:activate");
c("#content .container form").each(function(d){b.permitForm(c(this))
})
};
b.filterLinks=function(){var e;
var d=c(this);
if(d.attr("href")){e=d.attr("href")
}else{if(d.attr("data-href")){e=d.attr("data-href")
}}if(e){if(e.charAt(0)==="/"&&e.charAt(1)!=="/"){a=true
}else{if(RR.utils.contains(e,location.origin)){a=true
}}}};
b.permitForm=function(d){d.on("submit",function(){c(RR).trigger("navigateAwayModal:deactivate")
});
d.on("change",function(){c(RR).trigger("navigateAwayModal:activate")
})
};
b.activateWarning=function(f,d){if(d&&d.isModal){c(".modal form").each(function(e){b.permitForm(c(this))
})
}if(!RR.utils.isAuthor()){c(window).on("beforeunload",b.onWindowUnload)
}};
b.deactivateWarning=function(d){c(window).off("beforeunload")
};
b.onWindowUnload=function(){if(a){return
}else{return"Are you sure you want to leave this page? Your changes will be lost."
}};
b.init=function(){b.initEvents()
};
return b
}(jQuery));
RR.plugins.table=(function(c){var b={},a=0;
b.init=function(){b.findTable()
};
b.findTable=function(){c("table").each(function(){b.addTableRule(c(this))
})
};
b.addTableRule=function(e){var g,f=document.createElement("style"),i=[],d="",h;
a++;
g="responsiveTableClass-"+a;
e.addClass(g);
f.setAttribute("type","media","screen");
f.setAttribute("type","text/css");
f.appendChild(document.createTextNode(""));
document.head.appendChild(f);
e.find("thead tr th").each(function(){var j=c(this);
if(c(this).children("div").length>0){j=c(this).find("div:first")
}var k=j.text().replace(/[^a-z0-9\$%@_\.\,\&\*\^\-+=[\]\s]/gi,"");
i.push(k)
});
_.each(i,function(k,j){h=j+1;
d+="."+g+" tbody td:nth-child("+h+'):before { content:"'+k.trim()+'";}\n'
});
f.innerHTML=d
};
return b
}(jQuery));
RR.plugins.addUserType=(function(c){var b={},a=[];
b.init=function(){b.applyBodyClass();
b.removeHiddenElements()
};
b.applyBodyClass=function(){var d="";
if(RR.utils.isAuthor()){d+="is-author "
}else{if(RR.utils.isUserLoggedIn()){d+="is-logged-in ";
a.push("visible-logged-in");
if(RR.utils.isRegisteredCustomer()){d+="is-customer ";
a.push("visible-customer")
}else{d+="is-registered-prospect ";
a.push("visible-registered-prospect")
}}else{d+="is-logged-out ";
a.push("visible-logged-out")
}}c("body").addClass(d)
};
b.removeHiddenElements=function(){c(".visible-customer, .visible-registered-prospect, .visible-logged-in, .visible-logged-out").each(function(){var e=c(this),d=_.some(a,function(f){return e.hasClass(f)
});
if(!d){e.remove()
}})
};
return b
}(jQuery));
RR.plugins.docParams=(function(b){var a={};
a.init=function(){};
a.keyDocParam=function(f){var i=[];
var c=false;
var d=false;
var e=false;
var h=false;
var g=true;
if(f){b.each(f.products.PENSION,function(j,k){g=false;
if(f.products.PENSION[j].source==="WORKPLACE"){c=true;
i.push("wpsp","wptc","rris","wpis","rrtc")
}if(f.products.PENSION[j].source==="RR"){e=true;
if(!c){i.push("rrpn","rrtc","wpis","wptc","rris")
}}});
b.each(f.products.ISA,function(j,k){if(f.products.ISA[j].source==="WORKPLACE"){d=true;
i.push("rrpn","wptc","rris","wpis","rrtc")
}if(f.products.ISA[j].source==="RR"){h=true;
if(!d&&!g){i.push("rrpn","rrtc","rris")
}}});
b.map(i,function(k,j){if(i[j]==="wpsp"){i=_.without(i,"rrpn")
}if(!c&!d){i=_.without(i,"wpis");
i=_.without(i,"wptc")
}});
i=_.uniq(i,false);
if(i){b(".js-consolidate-button a").attr("href",RR.route("SHOP_CONSOLIDATION")+"?keyDoc="+i)
}if((c||d)&&(h||e)){b(".js-activate-wps a:last").css("visibility","hidden");
b(".js-investment-fund a").attr("href",b(".js-investment-fund a").attr("data-rrwpslink"))
}else{if(c||d){b(".js-activate-wps a:last").css("visibility","hidden");
b(".js-investment-fund a").attr("href",b(".js-investment-fund a").attr("data-wpslink"))
}}}};
return a
}(jQuery));
RR.pages.CONTACT_US=(function(c){var h={};
var n;
var e;
var l;
var j;
var d;
var i;
var m;
function b(){if(RR.utils.isUserLoggedIn()){c("div.un-registered").remove();
c("[name=first-name]").val(RR.session("forename"));
c("[name=surname]").val(RR.session("surname"));
c("[name=email]").val(RR.session("email"));
var o={CUSTOMER_FIRST_NAME:RR.session("forename")||"{{activeUser.CUSTOMER_FIRST_NAME}}",CUSTOMER_EMAIL:RR.session("email")||"{{activeUser.CUSTOMER_EMAIL}}"};
RR.plugins.templates.setTemplateVar("activeUser",o).render();
RR.plugins.loader.hide("div.first-name");
RR.plugins.loader.hide("div.surname");
RR.plugins.loader.hide("div.email")
}else{c("div.registered, div.message").remove()
}}function k(q,p){p.preventDefault();
RR.plugins.form.clearError(e);
RR.plugins.form.clearError(l);
if(e.val()===""){RR.plugins.form.setError(e,null,"Please select a valid category");
q=false
}if((e.val()!==""&&e.val()!==e.find("option").last().val())&&l.val()===""){RR.plugins.form.setError(l,null,"Please select a valid sub-category");
q=false
}var o=c("[name=first-name]").val()+" "+c("[name=surname]").val();
c("[name=name]").val(o);
if(q){if(RR.session("forename")){RR.session({customerName:c("[name=first-name]").val(),customerQueryType:c("#category-type option:selected").text(),customerEmail:c("[name=email]").val(),customerMessage:c("textarea[name=description]").val()}).done(function(){n.unbind("submit").submit()
})
}else{if(typeof(Storage)!=="undefined"){sessionStorage.CUSTOMER_NAME=RR.utils.replaceHTMLCharacters(c("[name=first-name]").val());
sessionStorage.CUSTOMER_QUERY_TYPE=RR.utils.replaceHTMLCharacters(c("#category-type option:selected").text());
sessionStorage.CUSTOMER_EMAIL=RR.utils.replaceHTMLCharacters(c("[name=email]").val());
sessionStorage.CUSTOMER_MESSAGE=RR.utils.replaceHTMLCharacters(c("textarea[name=description]").val())
}n.unbind("submit").submit()
}}else{c(RR).trigger("hideProcessingButton")
}}function g(o){if(!c(".cq-wcm-edit").length){o.closest(".control-group").hide()
}}function a(q){var p=c(this).val();
var o=true;
if(p===""||p===e.children("option").last().val()){o=false
}if(o){j.map(function(r){return c(this).parent("span").length===0?this:null
}).wrap("<span>").hide();
j.hide();
j.first().show();
i.each(function(t){var r=c(this);
j.each(function(u){var v=c(this);
if(r.text()===p){if(v.val()===r.val()){v.unwrap().show().change()
}}})
});
l.val("");
j.first().unwrap().show();
l.closest(".control-group").show();
l.trigger("change")
}else{g(l)
}if(m&&p===e.children("option").eq(-2).val()){l.val(l.find("option:eq(-2)").val()).change();
g(l)
}}function f(){if(!RR.utils.isUserLoggedIn()){e.children("option").eq(-2).remove();
m=false
}else{m=true;
var o=RR.url.parameter("suggest");
if(o){e.val(e.find("option:eq(-2)").val()).change();
l.val(l.find("option:eq(-2)").val()).change();
g(l)
}}}h.init=function(){b();
n=c("form#panel-form-component-id");
c("[data-context-help]").hide();
n.parsley("addListener",{onFormSubmit:k});
e=n.find("#category-type");
l=n.find("#subCategory_rr_Topic__c");
j=l.children("option");
d=n.find("#contactUsRelationship");
i=d.children("option");
g(l);
g(d);
e.change(a);
f();
var p=RR.url.parameter("customerType");
var o=RR.session("forename");
var q=RR.session("surname");
if(p){c("#category-type>option:eq(4)").attr("selected",true);
c("#description_id").text("email match");
c("#first-name_id").val(o);
c("#surname_id").val(q)
}};
return h
}(jQuery));
RR.pages.CONTACT_US_THANKS=(function(b){var a={};
a.init=function(){if(RR.session("forename")){b("#unregistered-thankyou-message").remove();
var d={CUSTOMER_NAME:RR.session("customerName")||"{{activeUser.CUSTOMER_NAME}}",CUSTOMER_EMAIL:RR.session("customerEmail")||"{{activeUser.CUSTOMER_EMAIL}}",CUSTOMER_QUERY_TYPE:RR.session("customerQueryType")||"{{activeUser.CUSTOMER_QUERY_TYPE}}",CUSTOMER_MESSAGE:RR.session("customerMessage")||"{{activeUser.CUSTOMER_MESSAGE}}"};
RR.plugins.templates.setTemplateVar("activeUser",d).render()
}else{b("#registered-thankyou-message").remove();
var c={CUSTOMER_NAME:sessionStorage.CUSTOMER_NAME||"{{activeUser.CUSTOMER_NAME}}",CUSTOMER_EMAIL:sessionStorage.CUSTOMER_EMAIL||"{{activeUser.CUSTOMER_EMAIL}}",CUSTOMER_QUERY_TYPE:sessionStorage.CUSTOMER_QUERY_TYPE||"{{activeUser.CUSTOMER_QUERY_TYPE}}",CUSTOMER_MESSAGE:sessionStorage.CUSTOMER_MESSAGE||"{{activeUser.CUSTOMER_MESSAGE}}"};
RR.plugins.templates.setTemplateVar("activeUser",c).render()
}};
return a
}(jQuery));
RR.pages.ORPHAN_AUTH_ID=(function(b){var j;
var a;
var e={};
var i={};
var f=RR.session("email");
var d=new RR.api.Customer(f);
function g(l,k){k.preventDefault();
i=j.serializeObject();
if(l){a.button("loading");
if(i.email){h()
}else{c()
}}}function c(){var k=d.legacySearch({upgradeNumber:encodeURIComponent(i.upgradeNumber)});
k.done(function(l,m){if(l===200){if(m.upgradeNumberStatus==="ACTIVE"){RR.session({upgradeNumber:i.upgradeNumber,forename:m.forename,surname:m.surname,email:i.email}).done(function(){window.location=RR.route("ORPHAN_AUTH_SECURITY")
})
}else{if(m.upgradeNumberStatus==="EXPIRED"){window.location=RR.route("ORPHAN_AUTH_REQUEST_ID")
}}}else{if(l===404){a.button("reset");
b(RR).trigger("hideProcessingButton");
RR.plugins.form.setError("input[name=upgradeNumber]","invalidupgradenumber","This unique customer ID is not correct, please try again.")
}}})
}function h(){var k=d.search({policyNumberOrEmail:encodeURIComponent(i.email)});
k.done(function(l,m){if(l===404){c()
}else{if(l===200){a.button("reset");
b(RR).trigger("hideProcessingButton");
RR.plugins.form.setError("input[name=email]","existingemail","Sorry, the email address entered is already registered with Retiready, please try again or <a href="+RR.route("SIGN_IN")+">login</a>.")
}}})
}e.init=function(){j=b("form#panel-form-component-id");
j.parsley("addListener",{onFormSubmit:g});
a=b("form [type=submit]");
a.attr("data-loading-text","Loading ...")
};
return e
}(jQuery));
RR.pages.ORPHAN_SINGLE_AUTH=(function(f){var a;
var c;
var d=f("#pensionPlanNumberOrNIN");
var e={};
var h={};
var b=RR.session("email");
var g=new RR.api.Customer(b);
e.onFormSubmit=function(j,i){i.preventDefault();
h=a.serializeObject();
if(j){c.button("loading");
if(h.email){e.searchCustomerByEmail()
}else{e.searchUpgradeNumber()
}}};
e.searchUpgradeNumber=function(){var i=g.legacySearch({upgradeNumber:encodeURIComponent(h.upgradeNumber)});
i.done(function(j,k){if(j===200){if(k.upgradeNumberStatus==="ACTIVE"){RR.session({upgradeNumber:h.upgradeNumber,forename:k.forename,surname:k.surname,email:h.email,nationalInsuranceNumber:h.nationalInsuranceNumber}).done(function(){e.authenticateUser()
})
}else{if(k.upgradeNumberStatus==="EXPIRED"){window.location=RR.route("ORPHAN_AUTH_REQUEST_ID")
}}}else{if(j===404){c.button("reset");
f(RR).trigger("hideProcessingButton");
RR.plugins.form.setError("input[name=upgradeNumber]","invalidupgradenumber","This unique customer ID is not correct, please try again.")
}}})
};
e.authenticateUser=function(){c.button("loading");
var i=g.legacyAuth({upgradeNumber:h.upgradeNumber,nationalInsuranceNumber:h.nationalInsuranceNumber,dateOfBirth:RR.utils.convertDateFieldToNumericArray(h.Date),policyNumber:h.pensionPlanNumber,emailAddress:RR.session("email")});
i.done(function(j,k){if(j===200){if(k.customerType==="TARGETED_ORPHAN"){RR.session("policyNumber",k.policyNumber).done(function(){window.location=RR.route("ORPHAN_COMPARISON_HOME")
})
}else{if(k.customerType!=="TARGETED_ORPHAN"){window.location=RR.route("ORPHAN_AUTH_ALREADY_REGISTERED")
}}}else{if(j===403){c.button("reset");
RR.plugins.form.setError("form","invaliddetails","At least one of your answers to the security questions below was incorrect.")
}}})
};
e.searchCustomerByEmail=function(){var i=g.search({policyNumberOrEmail:encodeURIComponent(h.email)});
i.done(function(j,k){if(j===404){e.searchUpgradeNumber()
}else{if(j===200){c.button("reset");
f(RR).trigger("hideProcessingButton");
RR.plugins.form.setError("input[name=email]","existingemail","Sorry, the email address entered is already registered with Retiready, please try again or <a href="+RR.route("SIGN_IN")+">login</a>.")
}}})
};
e.init=function(){a=f("form#panel-form-component-id");
a.parsley("addListener",{onFormSubmit:e.onFormSubmit});
f(".pensionPlanNumber").addClass("hidden");
f("#pensionPlanNumberOrNIN").val("n");
c=f("form [type=submit]");
c.attr("data-loading-text","Loading ...")
};
d.on("change",function(i){if(f("#pensionPlanNumberOrNIN").val()==="n"){f(".pensionPlanNumber").addClass("hidden");
f(".nationalInsuranceNumber").removeClass("hidden");
f("#pensionPlanNumber_id").val("")
}else{f(".nationalInsuranceNumber").addClass("hidden");
f(".pensionPlanNumber").removeClass("hidden");
f("#nationalInsuranceNumber_id").val("")
}});
return e
}(jQuery));
RR.pages.ORPHAN_AUTH_SECURITY=(function(c){var k;
var b;
var g;
var f={};
var j={};
var d;
var h=RR.session("email");
var e=new RR.api.Customer(h);
g={year:0,month:0,day:0};
function i(m,l){l.preventDefault();
j=k.serializeObject();
if(m){a()
}return false
}function a(){b.button("loading");
RR.session("policyNumber",j.policyNumber).done(function(){var l=e.legacyAuth({upgradeNumber:RR.session("upgradeNumber"),dateOfBirth:RR.utils.convertDateFieldToNumericArray(j.Date),policyNumber:j.policyNumber,emailAddress:RR.session("email")});
l.done(function(m,n){if(m===200){if(n.customerType==="TARGETED_ORPHAN"){window.location=RR.route("ORPHAN_COMPARISON_HOME")
}else{if(n.customerType!=="TARGETED_ORPHAN"){window.location=RR.route("ORPHAN_AUTH_ALREADY_REGISTERED")
}}}else{if(m===403){b.button("reset");
RR.plugins.form.setError("form","invaliddetails","At least one of your answers to the security questions below was incorrect.")
}}})
})
}f.init=function(){var l={};
l={CUSTOMER_FIRST_NAME:RR.session("forename")||"{{activeUser.CUSTOMER_FIRST_NAME}}",CUSTOMER_LAST_NAME:RR.session("surname")||"{{activeUser.CUSTOMER_LAST_NAME}}"};
RR.plugins.templates.setTemplateVar("activeUser",l).render();
k=c("form#panel-form-component-id");
k.parsley("addListener",{onFormSubmit:i});
b=k.find("[type=submit]");
b.attr("data-loading-text","Loading ...")
};
return f
}(jQuery));
RR.pages.ORPHAN_COMPARISON_HOME=(function(f){var j={};
var a={"1":"Waiver","2":"SelfInvestmentOption","3":"LifeAssuranceBenefit","4":"EscalationOfContributions","5":"StakeholderPension","6":"SurrenderCharge"};
var n={isSurrenderChargeEnabled:false,projectedIncome:0,projectedValue:0,pensionValue:0,policyChanges:""};
var e=RR.session("policyNumber");
var i=new RR.api.Policy("interim",e);
var m={};
j.init=function(){f("button[name=update-now]").prop("disabled",true);
m.ACCOUNT_NUMBER=e||"{{activeUser.ACCOUNT_NUMBER}}";
m.CUSTOMER_FIRST_NAME=RR.session("forename")||"{{activeUser.CUSTOMER_FIRST_NAME}}";
d();
if(f("label[for=ConfirmContinueOrphan]").length){g();
c()
}else{o()
}};
function c(){f("label[for=ConfirmContinueOrphan]").click(function(){RR.plugins.form.clearError("label[for=ConfirmContinueOrphan]");
if(f("label[for=ConfirmContinueOrphan]").hasClass("c_on")){f("button[name=update-now]").prop("disabled",true)
}else{f("button[name=update-now]").prop("disabled",false)
}})
}function g(){f("button[name=update-now]").click(function(){if(f("label[for=ConfirmContinueOrphan]").hasClass("c_on")){var p=i.migrate();
p.done(function(q,r){if(q===200||q===201){RR.session({policyNumber:r.policyNumber}).done(function(){window.location=RR.route("ORPHAN_FUNDS_EDUCATION")
})
}})
}else{scrollToElement(("label[for=ConfirmContinueOrphan]"));
f("button[name=update-now]").prop("disabled",true);
RR.plugins.form.setError("label[for='ConfirmContinueOrphan']","invalidbankdetails","This value is required",1)
}})
}function o(){f("button[name=update-now]").click(function(){var p=i.migrate();
p.done(function(q,r){if(q===200||q===201){RR.session({policyNumber:r.policyNumber}).done(function(){window.location=RR.route("ORPHAN_FUNDS_EDUCATION")
})
}})
})
}function d(){var p=i.valuation();
p.done(function(q,r){if(q===200){n.pensionValue=r.value;
RR.session({fundValue:r.value});
if(r.changes.SurrenderCharge){n.isSurrenderChargeEnabled=true
}if(r.valuationDate){m.VALUATION_DATE=RR.utils.arrayToDateFormatted(r.valuationDate)||"{{activeUser.VALUATION_DATE}}"
}else{m.VALUATION_DATE=RR.utils.stringToDateFormatted(new moment())||"{{activeUser.VALUATION_DATE}}"
}l(e)
}})
}function l(q){var p=i.comparison({currentPolicyNumber:q});
p.done(function(r,t){if(r===200){n.policyChanges=t.changes;
if(n.policyChanges){h(n.policyChanges)
}b(t.productReference)
}})
}function b(q){var p=i.legacyProjection({productReference:q});
p.done(function(r,t){if(r===200){if(t.projections){n.projectedIncome=t.projections.medium.projectedIncome;
n.projectedValue=t.projections.medium.projectedValue
}if(t.retirementYear){m.RETIREMENT_YEAR=t.retirementYear||"{{activeUser.RETIREMENT_YEAR}}"
}k()
}})
}function k(){RR.utils.renderWidgetCounter(f(".current"),RR.utils.formatAmount(n.pensionValue,"B"));
RR.utils.renderWidgetCounter(f(".projected"),RR.utils.formatAmount(n.projectedIncome));
RR.plugins.templates.setTemplateVar("activeUser",m).render();
f(RR).trigger("removeLoadingSpinner");
f("button[name=update-now]").prop("disabled",false)
}function h(p){var q=f("#lost-features-panel-2 ol.numbered");
if(!RR.utils.isAuthor()){q.children("li").hide()
}if(n.isSurrenderChargeEnabled){p["6"]="SurrenderCharge"
}if(!p.length&&!RR.utils.isAuthor()){f(".changes").hide();
return
}f.map(p,function(r,t){var u=r;
f.map(a,function(v,w){if(u===v){q.children("li[data-list-item="+w+"]").show()
}})
})
}return j
}(jQuery));
RR.pages.ORPHAN_CONFIRM_DETAILS=(function(f){var h={};
var l;
var k;
var a={};
var e={};
var j={};
var b;
var d;
var g;
var i=f("form#orphanDetails .accordion-group:eq(3)");
function c(o,p){var n=[];
function m(r,t,q){_.each(t,function(u,v){var w=r[v];
var x=(q||q===0)?q+(isNaN(Number(v))?"."+v:"["+v+"]"):v;
if(_.isObject(u)){m(r[v],u,x)
}else{if(u!==r[v]){n.push(x)
}}})
}m(o,p);
return n
}h.onFormSubmit=function(q,p,n){var r;
p.preventDefault();
var o=new RR.api.Customer();
if(h.areAddressDetailsValid()===false){k.eq(1).find(".accordion-body").collapse("show");
return false
}if(h.areContactDetailsValid()===false){k.eq(2).find(".accordion-body").collapse("show");
return false
}if(!q){k.eq(3).find(".accordion-body").collapse("show");
return false
}r=l.serializeObject();
j=f.extend(true,{},e);
j.confirmationDetails=j.confirmationDetails||{};
if(!j.bankDetails){j.bankDetails=[];
j.bankDetails.push({})
}if(!j.bankDetails[0]){j.bankDetails[0]={}
}j.bankDetails[0].accountName=r.accountName;
j.bankDetails[0].accountNumber=r.accountNumber;
j.bankDetails[0].primaryAccount=true;
j.bankDetails[0].sortCode=[r.sortCode0,r.sortCode1,r.sortCode2];
j.confirmationDetails.rpiConsent=(r.boostRPI==="1");
if(!j.contactDetails){j.contactDetails={}
}j.contactDetails.emailAddress=r.emailAddress.replace(/\s/g,"");
j.confirmedEmailAddress=r.confirmEmailAddress.replace(/\s/g,"");
j.contactDetails.homePhoneNumber=r.homePhoneNumber.replace(/\s/g,"");
j.contactDetails.mobilePhoneNumber=r.mobilePhoneNumber.replace(/\s/g,"");
if(!j.personalDetails){j.personalDetails={}
}j.personalDetails.gender=r.gender;
j.personalDetails.title=r.title.trim();
j.personalDetails.forename=r.forename.trim();
j.personalDetails.retirementAge=r.retirementAge;
j.personalDetails.nationality=f("[name=nationalityTog]:checked").val()==="GBR"?"GBR":r.nationality;
j.personalDetails.nationalInsuranceNumber=r.nationalInsuranceNumber.replace(/\s/g,"");
j.personalDetails.employmentStatus=r.employmentStatus;
j.personalDetails.dateOfBirth=RR.utils.convertDateFieldToNumericArray(l.find("input[name=Date]").val());
j.dirtyFields=["contactDetails","personalDetails","confirmationDetails.rpiConsent"];
if(i.length){j.dirtyFields.push("bankDetails")
}var m=function(){o.personalDetails({personalDetails:{forename:j.personalDetails.forename,surname:j.personalDetails.surname,dateOfBirth:j.personalDetails.dateOfBirth,nationalInsuranceNumber:j.personalDetails.nationalInsuranceNumber}}).done(function(u){if(u===200){var x="<a href='"+RR.route("SIGN_IN")+"'>Sign in</a>";
var w="<a href='"+RR.route("CONTACT_US")+"' target='_blank'>email</a>";
var t="<a href='"+RR.route("SUPPORT_SIGN_OUT")+"' target='_blank'>webchat</a>";
f(RR).trigger("hideProcessingButton");
f("form .accordion-group").eq(0).find(".accordion-body").collapse("show");
RR.plugins.form.setError("#gender","","It looks like you may already be registered with us. Please "+x+" to continue. If there's a problem, please contact us by "+w+" or "+t+".")
}else{if(u===404){var v=RR.post("/policy/interim/"+RR.session("policyNumber")+"/customer",[200],{data:j});
v.done(function(y,z){RR.session({email:r.emailAddress.replace(/\s/g,""),confirmEmailAddress:r.confirmEmailAddress.replace(/\s/g,"")}).done(function(){RR.url.redirect("ORPHAN_SECURITY_DETAILS")
})
});
v.fail(function(){})
}}})
};
if(i.length){h.validateBankDetails(m)
}else{m()
}};
h.clearBankDetailsErrors=function(){RR.plugins.form.clearError("[name=accountNumber]");
f("[name=sortCode0]").closest(".control-group").removeClass("error");
f("[name=accountNumber]").off("keydown.clearBankDetailserrros");
f("[name=sortCode0]").off("keydown.clearBankDetailserrros");
f("[name=sortCode1]").off("keydown.clearBankDetailserrros");
f("[name=sortCode2]").off("keydown.clearBankDetailserrros")
};
h.validateBankDetails=function(m){var n=RR.post("/bankdetails/validate",[200,406],{data:{bankDetails:{accountNumber:f("[name=accountNumber]").val(),sortCode:[f("[name=sortCode0]").val(),f("[name=sortCode1]").val(),f("[name=sortCode2]").val()]}}});
n.done(function(o,p){if(o===200&&p.bankDetailsValid===true){f("form .accordion-group").last().find(".accordion-body").collapse("hide");
if(_.isFunction(m)){m()
}}else{RR.plugins.form.setError("[name=accountNumber]","invalidbankdetails","The bank details provided are invalid.");
f("[name=sortCode0]").closest(".control-group").addClass("error");
f("[name=accountNumber]").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors);
f("[name=sortCode0]").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors);
f("[name=sortCode1]").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors);
f("[name=sortCode2]").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors)
}});
n.fail(function(o,q,p){})
};
h.populateFormWithPolicyCustomerDetails=function(o,m){var n=RR.get("/policy/interim/"+m+"/customer",[200,404]);
n.done(function(q,p){if(q===200){e=f.extend(true,{},p);
h.populateCustomerDetails(o,p);
RR.session("regularPremiumDetails",p.regularPremiumDetails);
h.verifyPaymentDetails(p.payments)
}else{if(q===404){}else{}}});
n.fail(function(p,r,q){})
};
h.populateCustomerDetails=function(n,m){a=m;
if(!a.addressDetails){a.addressDetails=[]
}h.populateCustomerPersonalDetails(n,a.personalDetails);
h.populateCustomerAddressDetails(n,a.addressDetails[0]);
h.populateCustomerContactDetails(n,a.contactDetails);
h.populateCustomerBankDetails(n,a);
h.initMinRetirementAgeValidation()
};
h.populateCustomerPersonalDetails=function(n,m){var o;
o=m.nationality===null?"":m.nationality;
m.day=m.dateOfBirth[2];
m.month=m.dateOfBirth[1];
m.year=m.dateOfBirth[0];
if(!o){o=""
}if(o.toUpperCase()==="GBR"||o===""){m.nationalityTog="GBR"
}else{m.nationalityTog="Other";
f("[name=nationalityTog]").click()
}RR.plugins.form.populate("form",_.omit(m,"dateOfBirth"))
};
h.populateCustomerAddressDetails=function(n,m){RR.plugins.form.populate(n,m)
};
h.populateCustomerContactDetails=function(n,m){RR.plugins.form.populate(n,m)
};
h.populateCustomerBankDetails=function(r,n){var y=f(r),u=y.find("[name=boostRPI]"),p=y.find(".boost-rpi-text"),v=y.find(".boost-rpi-text-zero"),q=n.bankDetails[0]||{},m=n.confirmationDetails,t=n.payments,o,w;
RR.plugins.form.populate(r,q);
if(m){var x=m.rpiConsent;
if(x!==undefined){u.prop("checked",x).closest("label").toggleClass("c_on",x)
}}if(t&&t.length>0){o=t[0].amount||0;
w=t[0].frequency||0
}else{o=w=0
}if(o>0&&w&&["S","R"].indexOf(w)===-1){v.remove();
o=RR.utils.formatAmount(o,"B",true);
w=RR.utils.frequencyToString(w);
p.find("p").each(function(){RR.utils.replaceTemplateString(f(this),"{{regularContribution}}",o+" "+w)
})
}else{p.remove();
u.closest(".control-group").remove()
}};
h.calculatePaymentMonth=function(){var m=moment();
if(m.date()>15){m.add("month",2);
return m.format("MMMM")
}else{m.add("month",1);
return m.format("MMMM")
}};
h.validateResidency=function(){if(f("[name=residency]:checked").val()==="No"){RR.plugins.form.setError("[name=residency]","noresidency","Sorry, you must be a UK resident to open a Retiready account.",1);
return false
}else{RR.plugins.form.clearError("[name=residency]");
return true
}};
h.validateTaxPayer=function(){if(f("[name=ukTax]:checked").val()==="No"){RR.plugins.form.setError("[name=ukTax]","notuktaxpayer","Sorry, you must be a UK tax payer to open a Retiready account.",1);
return false
}else{RR.plugins.form.clearError("[name=ukTax]");
return true
}};
h.validateNationality=function(){if(f("[name=nationalityTog]:checked").val()==="Other"&&f("[name=nationality]").val()===""){RR.plugins.form.setError("[name=nationality]","required","This value is required.",1);
return false
}else{RR.plugins.form.clearError("[name=nationality]");
return true
}};
h.validatePhoneNumber=function(){if(f("[name=mobilePhoneNumber]").parsley("isValid")===null&&f("[name=homePhoneNumber]").parsley("isValid")===null){g=true;
RR.plugins.form.setError("[name=mobilePhoneNumber]","nophonenumber","You need to enter at least one phone number.",1);
RR.plugins.form.setError("[name=homePhoneNumber]","nophonenumber","You need to enter at least one phone number.",1);
return false
}else{if(g){g=false;
RR.plugins.form.clearError("[name=mobilePhoneNumber]");
RR.plugins.form.clearError("[name=homePhoneNumber]")
}return true
}};
h.areAddressDetailsValid=function(){if(h.validateResidency()===false){return false
}if(h.validateNationality()===false){return false
}};
h.areContactDetailsValid=function(m){if(h.validatePhoneNumber()===false){return false
}if(m){h.verifyExistingCustomer();
return false
}if(f("[name=emailAddress]").closest(".control-group").hasClass("error")){return false
}if(f("[name=confirmEmailAddress]").closest(".control-group").hasClass("error")){return false
}};
h.verifyExistingCustomer=function(){var n=l.find("[name=emailAddress]").val();
var o=new RR.api.Customer("");
var m=o.search({policyNumberOrEmail:n});
m.done(function(p){if(p===200){var q=(RR.route("CONTACT_US")+"?customerType=registered");
var r="<a href='"+q+"'>get in touch</a>";
RR.plugins.form.setError("[name=emailAddress]","","This email address is already in use, please "+r)
}else{f("form .accordion-group:eq(2)").find(".accordion-body").collapse("hide");
if(i.length){i.find(".accordion-body").collapse("show")
}}})
};
h.areBankDetailsValid=function(m){if(m){h.validateBankDetails();
return false
}};
h.setProductTemplate=function(){var m=RR.session("productType")||"";
m=(m==="PENSION")?"Pension":m;
if(m){f(".main-header").html(f(".main-header").html().replace("{PRODUCT}",m));
f(".uk-residence-message").html(f(".uk-residence-message").html().replace("{{PRODUCT}}",m))
}};
h.initMinRetirementAgeValidation=function(){var m=f("select[name=day]"),o=f("select[name=month]"),n=f("select[name=year]"),q=n.val()+"-"+o.val()+"-"+m.val(),p=RR.utils.calcAge(q);
f("form [name=retireAge]").parsley("addConstraint",{min:p+1})
};
h.init=function(){b="form#orphanDetails";
l=f(b);
k=f("form .accordion-group");
l.parsley("addListener",{onFormSubmit:h.onFormSubmit});
RR.components.accordionForm.init(k.eq(0));
RR.components.accordionForm.init(k.eq(1),h.areAddressDetailsValid);
RR.components.accordionForm.init(k.eq(2),h.areContactDetailsValid);
f("[name=ukTax]").change(function(){h.validateTaxPayer()
});
f("[name=residency]").change(function(){h.validateResidency()
});
f("[name=nationalityTog]").change(function(){RR.plugins.form.clearError("[name=nationality]")
});
f("[name=homePhoneNumber]").on("change.ORPHAN_CONFIRM_DETAILS focusout keyup",function(){h.validatePhoneNumber()
});
f("[name=mobilePhoneNumber]").on("change.ORPHAN_CONFIRM_DETAILS focusout keyup",function(){h.validatePhoneNumber()
});
f("[name=nationality]").on("change focusout",function(){h.validateNationality()
});
h.populateFormWithPolicyCustomerDetails("form#orphanDetails",RR.session("policyNumber"));
f("[name=confirmEmailAddress]").val(RR.session("confirmEmailAddress"));
h.setProductTemplate();
var m=h.calculatePaymentMonth();
var n=RR.templateVars||{};
n.bankDetails={paymentMonth:m};
if(RR.plugins.templates){RR.plugins.templates.render()
}};
h.verifyPaymentDetails=function(o){var p=function(){i.remove();
i="";
RR.session("bankDetailsRemoved",true)
};
var n=function(){RR.components.accordionForm.init(i,h.areBankDetailsValid);
RR.session("bankDetailsRemoved",false)
};
if(o){for(var m in o){if(o[m].frequency&&o[m].frequency!==null&&o[m].frequency!=="S"){n();
return
}}p()
}else{p()
}};
return h
}(jQuery));
RR.pages.ORPHAN_FUNDS_EDUCATION=(function(b){var a={};
a.init=function(){b('[name="continue"]').on("click",function(){b(window).off("beforeunload")
})
};
a.killCarousel=function(){window.carousel.kill()
};
return a
}(jQuery));
RR.pages.ORPHAN_FUND_PROJECTIONS=(function(b){var a={};
a.init=function(){RR.plugins.RISK_PROFILER.setSelectedFund();
RR.plugins.RISK_PROFILER.setPolicyNumber(RR.session("policyNumber"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
b("#fund-selection-checkbox").html(b("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
b("#continue-button-wrapper").html(b("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"))
};
return a
}(jQuery));
RR.pages.ORPHAN_SECURITY_DETAILS=(function(d){var c={};
var e=300;
var f;
var b=false;
var a=d("form#orphanProfile");
c.populateFormFromSession=function(){var g=RR.session("ORPHAN_SECURITY_DETAILS");
if(g){RR.components.object2form("form#orphanProfile",g)
}};
c.onFormSubmit=function(k,j){var g=d("[name^=question]");
var i={};
var h;
b=RR.plugins.PASSWORD_CREATION.validatePassword(true);
if(k&&b){j.preventDefault();
i.memorablePhrase=d("[name=memorableWord]").val();
i.securityQuestions=[];
i.password=d("#password-field").val();
g.each(function(m){var l=m+1;
var n={};
if(d(this).val()!==d(this).find("option").last().val()){n.question=d(this).find("option[value='"+d(this).val()+"']").text();
n.answer=d("[name='answer"+l+"']").val()
}else{n.question=d("[name='userQuestion"+l+"']").val().trim();
n.answer=d("[name='answer"+l+"']").val().trim()
}i.securityQuestions.push(n)
});
h=f.customer({securityDetails:i});
h.done(function(l){if(l===200){RR.session("ORPHAN_SECURITY_DETAILS",RR.components.form2object("form#orphanProfile")).done(function(){RR.url.redirect("ORPHAN_TERMS_AND_CONDITIONS")
})
}});
h.fail(function(){})
}else{return false
}};
c.init=function(){var h=d("[name^=question]");
var j=d("[name^=answer]");
var g=h.first().find("option");
var i=[];
f=new RR.api.Policy("interim",RR.session("policyNumber"));
RR.plugins.PASSWORD_CREATION.validatePassword(false);
g.each(function(k){if(k!==0&&k!==g.length-1){i[d(this).val().replace(" ","")]=null
}});
h.each(function(m){var l=m+1;
var k=d(this);
var n=d("[name='userQuestion"+l+"']");
k.attr("data-rr-val",d(this).val());
k.on("change focusout",function(){var p=d(this).val();
var o=d(this).attr("data-rr-val");
if(p===d(this).find("option").last().val()){p=""
}if(p){h.filter("[name!='"+d(this).attr("name")+"']").find("option[value='"+p+"']").remove()
}if(o!==p&&o){h.filter("[name!='"+d(this).attr("name")+"']").find("option:eq(0)").after(g.filter("option[value='"+o+"']").clone())
}d(this).attr("data-rr-val",p)
})
});
c.populateFormFromSession();
j.on("focusout keyup",function(){d(this).siblings(".confirm-icon").remove();
d(this).removeClass("confirm-input");
if(!d(this).closest(".control-group").hasClass("error")){if(d(this).val().length>=5){d(this).addClass("confirm-input");
d(this).after('<div class="confirm-icon"><span aria-hidden="false">Confirmed</span><span class="ico" aria-hidden="true">&#xf707;</span></div>')
}}});
a.parsley("addListener",{onFormSubmit:c.onFormSubmit})
};
return c
}(jQuery));
RR.pages.ORPHAN_TERMS_AND_CONDITIONS=(function(d,b){var c={};
var e;
var a=d("form#termsAndConditions");
c.init=function(){c.getCustomerDetails(b.session("policyNumber"));
c.renderIllustrations();
a.parsley("addListener",{onFormSubmit:c.onFormSubmit});
var f=b.session("regularPremiumDetails");
if(!f){d("#directDebitGuarentee").hide()
}};
c.getCustomerDetails=function(f){var g=b.get("/policy/interim/"+f+"/customer",[200,404]);
g.done(function(i,h){if(i===200){c.renderTemplate(h)
}});
g.fail(function(h,j,i){})
};
c.renderTemplate=function(h){var f=b.templateVars||{};
var g=b.session("fundValue")?b.session("fundValue").toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):0;
f.activeUser={name:h.personalDetails.forename+" "+h.personalDetails.surname,dob:h.personalDetails.dateOfBirth[2]+"/"+h.personalDetails.dateOfBirth[1]+"/"+h.personalDetails.dateOfBirth[0],nin:b.utils.chunk(h.personalDetails.nationalInsuranceNumber,2),fund:d("#fundLabel").data("fund"+b.session("selectedFund").toLowerCase()),pensionValue:"&#163;"+g,accountNumber:b.session("policyNumber"),escalationOfContributions:true,employmentStatus:h.personalDetails.employmentStatus};
if(b.session("bankDetailsRemoved")){d(".detail-list:eq(1)").remove()
}else{f.activeUser.accountName=h.bankDetails[0].accountName;
f.activeUser.bankAccountNumber=h.bankDetails[0].accountNumber;
f.activeUser.sortCode=b.utils.formatSortCode(h.bankDetails[0].sortCode[0],h.bankDetails[0].sortCode[1],h.bankDetails[0].sortCode[2])
}b.utils.replaceClass(" .panel .fund-selected","fund-2","fund-"+b.utils.fundToInt(b.session("selectedFund")));
if(!h.confirmationDetails.rpiConsent){d("#rpiSection").parent().remove()
}if(b.plugins.templates){b.plugins.templates.render()
}b.utils.rrHide()
};
c.renderIllustrations=function(){e=new b.api.Policy("interim",b.session("policyNumber"));
var f=d("#illustrationDummyDocument").hide(),g=e.illustration({basicProjectionOptions:{illustrationType:"N",productType:b.session("productType"),fundOption:b.session("selectedFund")}});
g.done(function(h,i){if(h===200){f.find("a").attr("href",i.filePath);
f.find(".file-descriptor").html("PDF");
f.find(".file-date").text(moment().format("D MMMM YYYY"));
f.show()
}})
};
c.collectConfirmationDetails=function(f){var h={};
var g=f.serializeObject();
h.sourceOfWealth=g.sourceOfWealth;
h.employeePensionScheme=(g.employeePensionScheme.indexOf("true")>=0);
h.contactPreferences={email:f.find("[name=optionsCheckboxList1]:checked").length?true:false,post:f.find("[name=optionsCheckboxList2]:checked").length?true:false,sms:f.find("[name=optionsCheckboxList3]:checked").length?true:false,phone:f.find("[name=optionsCheckboxList4]:checked").length?true:false};
h.acceptKeyFeatures=f.find("[name=confirmation2]:checked").length?true:false;
return h
};
c.sendConfirmationDetails=function(g){e=new b.api.Policy("interim",b.session("policyNumber"));
var f=e.customer({confirmationDetails:g});
f.done(function(h){e.notify({notificationType:"verifyOrphanPurchase"}).done(function(i){if(i===200){window.location=b.route("ORPHAN_VERIFY_EMAIL")
}}).fail(function(){})
});
f.fail(function(){})
};
c.onFormSubmit=function(h,g,f){var i;
g.preventDefault();
if(h){i=c.collectConfirmationDetails(f.$element);
c.sendConfirmationDetails(i)
}};
return c
})(jQuery,RR);
RR.pages.ORPHAN_DM_LANDING=(function(b){var a={};
a.init=function(){b(".nav-right").click(function(){window.carousel.next()
});
b(".nav-left").click(function(){window.carousel.prev()
})
};
return a
}(jQuery));
RR.pages.ORPHAN_UPDATE_EMAIL=(function(c){var b={};
var a=c("form#panel-form-component-id");
b.onFormSubmit=function(f,d){if(f){b.verifyExistingCustomer()
}return false
};
b.processUpdateEmail=function(){var f;
var d=RR.session("policyNumber");
if(!d){d=RR.url.parameter("policyNumber")
}var e=new RR.api.Policy("interim",d);
f=a.serializeObject();
b.updateEmail(e,f.email,f.confirmEmailAddress).done(function(g){if(g===200){b.resendPolicyVerificationCode(e).done(function(h){if(h===200){if(RR.session.exists()){RR.session("email",f.email).done(function(){RR.url.redirect("ORPHAN_VERIFY_EMAIL")
})
}else{RR.url.redirect("ORPHAN_VERIFY_EMAIL")
}}})
}})
};
b.verifyExistingCustomer=function(){var e=a.find("[name=email]").val();
var f=new RR.api.Customer("");
var d=f.search({policyNumberOrEmail:e});
d.done(function(g){if(g===200){var h="<a href='"+RR.route("SIGN_IN")+"'>Sign in</a>";
RR.plugins.form.setError("[name=email]","","Provided email address is already in use, "+h);
c(RR).trigger("hideProcessingButton")
}else{b.processUpdateEmail()
}})
};
b.resendPolicyVerificationCode=function(d){return d.resendVerificationCode()
};
b.updateEmail=function(f,e,d){return f.changeUsername({newEmailAddress:e,confirmedEmailAddress:d})
};
b.init=function(){var d;
a.parsley("addListener",{onFormSubmit:b.onFormSubmit})
};
return b
}(jQuery));
RR.pages.SIGN_IN=(function(b){var a={};
a.init=function(){if(!RR.utils.isAuthor()){a.renderParams()
}b('form[name="sign-in-form"]').parsley("addListener",{onFormSubmit:function(c){if(c){b(RR).trigger("showProcessingButton",[true])
}}})
};
a.calculateTotal=function(g){var f=0,e=(g.length%3===0)?3:2,c,h;
for(var d=0;
d<g.length/e;
d++){h=d*e;
c=g.charAt(h)+g.charAt(h+1);
if(e>2){c+=+g.charAt(h+2)
}f+=parseInt(c,10)
}return f
};
a.renderParams=function(){var c=RR.url.parameter("s")&&RR.url.parameter("s").toString(),e=c&&a.calculateTotal(c);
if(e){switch(e){case 770:RR.url.redirect("ACCOUNT_LOCKED");
break;
case 129:b(".control-group.email").addClass("error");
b("#validation, .locked-out").removeClass("hidden");
try{b(RR).trigger("analyticsevent",{event:("PartialLock")})
}catch(d){}break;
default:b(".control-group.email").addClass("error");
b("#validation, .not-found").removeClass("hidden");
try{b(RR).trigger("analyticsevent",{event:("IncorrectDetails-UserNotFound")})
}catch(d){}break
}}};
return a
}(jQuery));
RR.pages.RESET_YOUR_PASSWORD=(function(d){var c={};
var e;
var b;
var a=false;
c.init=function(){RR.plugins.loader.hide("#validation, .incorrect-answer");
RR.plugins.loader.hide("#create-password-message, #create-password-form");
d("[name=answer]").keyup(function(){RR.plugins.loader.hide("#validation, .incorrect-answer")
});
var f=RR.url.parameter("token");
e=new RR.api.Customer("");
d("form[name=questions-form]").parsley("addListener",{onFormSubmit:c.onQuestionsFormSubmit});
c.validateToken(f)
};
c.onQuestionsFormSubmit=function(g,f){f.preventDefault();
RR.plugins.loader.hide("#validation, .incorrect-answer");
RR.plugins.loader.hide("#create-password-message, #create-password-form");
RR.plugins.PASSWORD_CREATION.validatePassword(false);
if(g){c.validateAnswer()
}else{return false
}};
c.onCreatePasswordFormSubmit=function(g,f){f.preventDefault();
a=RR.plugins.PASSWORD_CREATION.validatePassword(true);
if(g&&a){c.updatePassword()
}else{return false
}};
c.validateToken=function(f){b=e.resetPasswordInitiate({accessToken:f});
b.done(function(g,h){if(g===200){e=new RR.api.Customer(h.emailAddress);
if(h.customerType==="REGISTERED_CUSTOMER"){c.getQuestion(false)
}else{if(h.customerType==="REGISTERED_PROSPECT"){c.showCreatePasswordForm(h)
}else{RR.url.redirect("SIGNED_OUT_GLOBAL_SERVER_ERROR")
}}}else{if(g===404){RR.url.redirect("FORGOTTEN_PASSWORD",{expired:"true"})
}}})
};
c.getQuestion=function(f){b=e.resetPasswordQuestion();
b.done(function(g,h){if(g===200){d("div.answer label").html(h.questionText);
d("div.answer label").attr("identifier",h.questionIdentifier);
if(f){d(".incorrect-answer p span").html(h.questionsRemaining);
d("#validation, .incorrect-answer").show();
d("[name=answer]").val("")
}}else{if(g===403){window.location=RR.route("ACCOUNT_LOCKED")
}else{if(g===404){window.location=RR.route("SIGN_IN")
}}}})
};
c.validateAnswer=function(){var f=d("div.answer label").attr("identifier");
var g=d("input[name=answer]").val();
b=e.resetPasswordAnswer({questionIdentifier:f,answer:g});
b.done(function(h,j){if(h===200){if(j.correctAnswer){c.showCreatePasswordForm(j)
}else{if(j.correctAnswer===0){window.location=RR.route("ACCOUNT_LOCKED")
}else{try{d(RR).trigger("analyticsevent",{event:("New-Question")})
}catch(i){}c.getQuestion(true)
}}}else{if(h===404){}else{if(h===403){window.location=RR.route("ACCOUNT_LOCKED")
}}}})
};
c.showCreatePasswordForm=function(f){d("#create-password-message, #create-password-form").show();
RR.plugins.loader.hide("#security-question-form, .confirmation");
d("form[name=create-password-form]").parsley("addListener",{onFormSubmit:c.onCreatePasswordFormSubmit})
};
c.updatePassword=function(){var f=d("#confirm-password-field").val();
b=e.resetPassword({password:f});
b.done(function(g,i){if(g===200){try{d(RR).trigger("analyticsevent",{event:("New-Password")})
}catch(h){}window.location=RR.route("HOME_SIGNED_OUT")
}else{if(g===403){window.location=RR.route("ACCOUNT_LOCKED")
}else{if(g===404){}}}})
};
return c
}(jQuery));
RR.pages.FORGOTTEN_PASSWORD=(function(d){var c={};
var b=true;
var a=d("form#panel-form-component-id");
c.init=function(){RR.plugins.loader.hide("#email-confirmation-message");
RR.plugins.loader.hide("#validation, .not-found");
if(RR.url.parameter("expired")!=="true"){RR.plugins.loader.hide("#expired-link-message")
}a.parsley("addListener",{onFormSubmit:c.onFormSubmit})
};
c.onFormSubmit=function(k,j){j.preventDefault();
RR.plugins.loader.hide("#email-confirmation-message");
RR.plugins.loader.hide("#validation, .not-found");
RR.plugins.loader.hide("#expired-link-message");
var f=d("[name=email]").val();
var i=new RR.api.Customer(f);
var h={};
var g;
if(k){g=i.resetPasswordNotify();
g.done(function(e){if(e===200){d("#email-confirmation-message").show();
RR.plugins.loader.hide("form, div.panel p");
try{d(RR).trigger("analyticsevent",{event:("PasswordSent")})
}catch(l){}}else{if(e===403){window.location=RR.route("ACCOUNT_LOCKED")
}else{if(e===404){d("#validation, .not-found").show()
}}}})
}else{return false
}};
return c
}(jQuery));
RR.pages.NEW_CUSTOMER_PURCHASE_ISA=(function(d,b){var e={},f=false,j,q,g=d("form#form-purchase"),n=d("[name=oneOffPayment]"),m=d("[name=monthlyPayment]"),l=d("#email_id"),p=d("#confirmEmailAddress_id"),i=d("#confirm"),c=d("#voucherCodeCheck"),r=d("[name='voucherCode']"),a=d("#voucherCode_id"),o=d("#voucherCode-confirm"),h=d("#voucherCode-confirm-icon"),k=d("#approxTransferValue_id");
e.onFormSubmit=function(u,t){t.preventDefault();
if(!e.validatePayment()){return false
}e.verifyDiscountCode().done(function(v){if(u){e.verifyExistingCustomer()
}else{d(b).trigger("hideProcessingButton")
}})
};
e.verifyDiscountCode=function(v){var w=d.Deferred();
if(r.val()){var u=r.val();
var t=new b.api.Promo(u);
b.plugins.form.clearError("[name=voucherCode]");
t.validateCode().done(function(x,y){if(x===200){e.showConfirmationField(u);
w.resolve()
}else{b.plugins.form.setError("[name=voucherCode]","invalid","The voucher code you entered is not valid");
d("[name=voucherCode]").closest(".control-group").addClass("error");
w.reject()
}})
}else{w.resolve()
}return w.promise()
};
e.showConfirmationField=function(t){a.remove();
c.remove();
o.val(t);
o.closest(".input-append").removeClass("input-append");
o.removeClass("hidden");
h.removeClass("hidden")
};
e.verifyExistingCustomer=function(){var u=g.find("[name=email]").val();
var v=new b.api.Customer("");
var t=v.search({policyNumberOrEmail:u});
t.done(function(w){if(w===200){var x="<a href='"+b.route("SIGN_IN")+"'>Sign in</a>";
b.plugins.form.setError("[name=email]","","Provided email address is already in use, "+x);
d(b).trigger("hideProcessingButton")
}else{e.submitForm()
}})
};
e.submitForm=function(){d(b).trigger("headway:showSpinner");
q=b.components.form2object("form#form-purchase");
var t=false;
if(q.typeOfISA&&q.typeOfISA!=="None"){t=true
}j=new b.api.Policy("interim");
j.create().done(function(y,w){var x=w.policyNumber;
var B=new b.api.Policy("interim",x);
var z={};
z=r.val();
var v=[];
var A;
var u;
if(q.monthlyPayment){A={frequency:"M",amount:parseFloat(q.monthlyPayment)};
v.push(A)
}if(q.oneOffPayment){u={frequency:"S",amount:parseFloat(q.oneOffPayment)};
v.push(u)
}var D=[];
if(t===true){var F={amount:parseFloat(q.approxTransferValue),type:"ISA",subType:q.typeOfISA,amountPaidInThisYear:parseFloat(q.amountPaidThisYear)};
D.push(F)
}var C={emailAddress:q.email};
var E=p.val();
B.customer({payments:v,contactDetails:C,transferDetails:D,promoCode:z,confirmedEmailAddress:E}).done(function(G){if(G===200){b.session({NEW_CUSTOMER_PURCHASE_ISA_FORM:q,policyNumber:w.policyNumber,email:q.email,fundValue:50000,purchase:{route:"ISA",completedStep:1,policyNumber:w.policyNumber,oneOffPayment:q.oneOffPayment,monthlyPayment:q.monthlyPayment,email:q.email,confirmEligibility:q.confirm,registeredCustomer:false,promoCode:z,confirmedEmailAddress:E},hasTransferDetails:t}).done(function(){b.url.redirect("FUND_SELECTION_ISA")
})
}})
})
};
e.validatePayment=function(){var u=parseFloat(n.val())||0;
var t=parseFloat(m.val())||0;
var v=parseFloat(k.val())||0;
if(n.parsley("isValid")===null&&m.parsley("isValid")===null&&!k.val()){f=true;
b.plugins.form.setError(n,"nopayment","You need to enter at least one payment method.",1);
b.plugins.form.setError(m,"nopayment","You need to enter at least one payment method.",1);
scrollToElement(g);
return false
}else{if(u<=0&&t<=0&&v<=0){b.plugins.form.setError(n,"nopayment","At least one payment amount should be greater than zero.",1);
b.plugins.form.setError(m,"nopayment","At least one payment amount should be greater than zero.",1);
b.plugins.form.setError(k,"nopayment","At least one payment amount should be greater than zero.",1);
f=true;
return false
}else{if(f){f=false;
b.plugins.form.clearError(k);
b.plugins.form.clearError(n);
b.plugins.form.clearError(m)
}return true
}}};
e.populateFields=function(){var t=b.session("purchase");
if(t!==undefined&&t.route==="ISA"){n.val(t.oneOffPayment);
m.val(t.monthlyPayment);
l.val(t.email);
i.attr("checked",t.confirmEligibility==="true")
}};
e.initEvents=function(){n.on("change.NEW_CUSTOMER_PURCHASE_ISA focusout keyup",function(){e.validatePayment()
});
m.on("change.NEW_CUSTOMER_PURCHASE_ISA focusout keyup",function(){e.validatePayment()
});
k.on("focusout keyup",function(){e.validatePayment()
});
g.parsley("addListener",{onFormSubmit:e.onFormSubmit});
d(c).on("click",function(){e.verifyDiscountCode()
})
};
e.init=function(){e.populateFields();
e.initEvents()
};
return e
}(jQuery,RR));
RR.pages.NEW_CUSTOMER_PURCHASE_PENSION=(function(d,b){var e={},g=false,m,o,z,i=d("form#form-purchase"),u=d("[name=oneOffPayment]"),t=d("[name=monthlyPayment]"),n=d("#checkbox-boost"),q=d("#email_id"),x=d("#confirmEmailAddress_id"),v=d(".date-select-range-html5 input"),f=d("select[name=day]"),r=d("select[name=month]"),j=d("select[name=year]"),k=d(".input-slider"),c=d("#voucherCodeCheck"),y=d("[name='voucherCode']"),a=d("#voucherCode_id"),w=d("#voucherCode-confirm"),l=d("#voucherCode-confirm-icon"),h=d(".input-slider-hidden-value"),p=d("#approxTransferValue_id");
e.onFormSubmit=function(B,A){A.preventDefault();
m=0;
if(d(".control-group.date-of-birth").hasClass("error")){m++
}if(d("#typeOfPension").val()==="None"){b.plugins.form.setError("#typeOfPension","notnull","Please select a valid pension type",1);
scrollToElement(("#confirmPensionTransfer"));
m++
}if(!e.validatePayment()){m++
}e.verifyDiscountCode().done(function(C){if(!m&&B){e.verifyExistingCustomer()
}else{d(b).trigger("hideProcessingButton")
}})
};
e.verifyDiscountCode=function(C){var D=d.Deferred();
if(y.val()){var B=y.val();
var A=new b.api.Promo(B);
b.plugins.form.clearError("[name=voucherCode]");
A.validateCode().done(function(E,F){if(E===200){e.showConfirmationField(B);
D.resolve()
}else{b.plugins.form.setError("[name=voucherCode]","invalid","The voucher code you entered is not valid");
d("[name=voucherCode]").closest(".control-group").addClass("error");
D.reject()
}})
}else{D.resolve()
}return D.promise()
};
e.showConfirmationField=function(A){a.remove();
c.remove();
w.val(A);
w.closest(".input-append").removeClass("input-append");
w.removeClass("hidden");
l.removeClass("hidden")
};
e.verifyExistingCustomer=function(){var B=i.find("[name=email]").val();
var C=new b.api.Customer("");
var A=C.search({policyNumberOrEmail:B});
A.done(function(D){if(D===200){var E="<a href='"+b.route("SIGN_IN")+"'>Sign in</a>";
b.plugins.form.setError("[name=email]","","Provided email address is already in use, "+E);
d(b).trigger("hideProcessingButton")
}else{e.submitForm()
}})
};
e.submitForm=function(){d(b).trigger("headway:showSpinner");
z=b.components.form2object("form#form-purchase");
var A=false;
if(z.typeOfPension&&z.typeOfPension!=="None"){A=true
}o=new b.api.Policy("interim");
o.create().done(function(J,G){var I=G.policyNumber;
var L=new b.api.Policy("interim",I);
var B={};
B.rpiConsent=i.find("[name=checkbox-boost]:checked").length?true:false;
var K={};
K=y.val();
var F=[];
var C;
var M;
if(z.monthlyPayment){C={frequency:"M",amount:parseFloat(z.monthlyPayment),pensionBoost:B.rpiConsent};
F.push(C)
}if(z.oneOffPayment){M={frequency:"S",amount:parseFloat(z.oneOffPayment)};
F.push(M)
}var O=[];
if(A===true){var Q={amount:parseFloat(z.approxTransferValue),type:"PENSION",subType:z.typeOfPension};
O.push(Q)
}var H=Number(d(".sliderThumb1").attr("aria-valuenow"));
var E=b.utils.convertDateFieldToNumericArray(z.Date);
var D={retirementAge:H,dateOfBirth:E};
var N={emailAddress:z.email};
var P=x.val();
L.customer({payments:F,personalDetails:D,contactDetails:N,transferDetails:O,confirmationDetails:B,promoCode:K,confirmedEmailAddress:P}).done(function(R,S){if(R===200){b.session({NEW_CUSTOMER_PURCHASE_PENSION_FORM:z,policyNumber:I,email:z.email,fundValue:50000,purchase:{route:"PENSION",completedStep:1,policyNumber:S.policyNumber,oneOffPayment:z.oneOffPayment,monthlyPayment:z.monthlyPayment,email:z.email,day:z.day,month:z.month,year:z.year,confirmBoost:(z["checkbox-boost"]==="0"),retirementAge:H,promoCode:K,confirmedEmailAddress:P},hasTransferDetails:A}).done(function(){b.url.redirect("FUND_SELECTION_PENSION")
})
}})
})
};
e.validatePayment=function(){var B=parseFloat(u.val())||0;
var A=parseFloat(t.val())||0;
var C=parseFloat(p.val())||0;
if(u.parsley("isValid")===null&&t.parsley("isValid")===null&&!p.val()){g=true;
b.plugins.form.setError(u,"nopayment","You need to enter at least one payment method.",1);
b.plugins.form.setError(t,"nopayment","You need to enter at least one payment method.",1);
scrollToElement(i);
return false
}else{if(B<=0&&A<=0&&C<=0){scrollToElement(t);
b.plugins.form.setError(u,"nopayment","At least one payment amount should be greater than zero.",1);
b.plugins.form.setError(t,"nopayment","At least one payment amount should be greater than zero.",1);
b.plugins.form.setError(p,"nopayment","At least one payment amount should be greater than zero.",1);
g=true;
return false
}else{if(g){g=false;
b.plugins.form.clearError(p);
b.plugins.form.clearError(u);
b.plugins.form.clearError(t)
}return true
}}};
e.populateFields=function(){var A=b.session("purchase");
if(A!==undefined&&A.route==="PENSION"){u.val(A.oneOffPayment);
t.val(A.monthlyPayment);
n.attr("checked",A.confirmBoost);
f.val(A.day);
r.val(A.month);
j.val(A.year).change();
k.attr("data-startValue",A.retirementAge);
d(b).trigger("ariaSlider:updateSliderFromElement");
q.val(A.email)
}};
e.initMinRetirementAgeValidation=function(){var B=v.val(),A=b.utils.calcAge(B);
if(!_.isNaN(A)){h.parsley().updateConstraint({min:A+1},h.data("number-message"));
h.blur()
}};
e.initEvents=function(){d(u).on("change.NEW_CUSTOMER_PURCHASE_PENSION focusout keyup",function(){e.validatePayment()
});
d(t).on("change.NEW_CUSTOMER_PURCHASE_PENSION focusout keyup",function(){e.validatePayment()
});
p.on("focusout keyup",function(){e.validatePayment()
});
i.parsley("addListener",{onFormSubmit:e.onFormSubmit});
d(c).on("click",function(){e.verifyDiscountCode()
});
v.change(function(){e.initMinRetirementAgeValidation()
});
d("#monthlyPayment_id").on("input",function(){if(d("[name=monthlyPayment]").val()===""){d("#checkbox-boost").attr("checked",false);
d("#checkbox-boost").attr("disabled",true);
d("#checkbox-boost").parent().removeClass("focus c_on")
}else{d("#checkbox-boost").attr("disabled",false)
}})
};
e.init=function(){d("#checkbox-boost").attr("disabled",true);
e.populateFields();
e.initMinRetirementAgeValidation();
e.initEvents()
};
return e
}(jQuery,RR));
RR.pages.NEW_CUSTOMER_CONFIRM_DETAILS=(function(b){var g={};
var c,l="#houseNameNumber_id",j="#postcode_id",d=b(".date-select-range-html5 input"),k=b(".sliderThumb1"),h=b(".input-slider-hidden-value"),a=RR.session("purchase")||{},f=0.01,i=a.route&&b("#approxTransferValue_"+a.route.toLowerCase()),e=a.route&&b("#remove-transfer_"+a.route.toLowerCase());
g.onFormSubmit=function(t,r,q){var v=new RR.api.Policy("interim",RR.session("policyNumber"));
var o=new RR.api.Customer();
var n;
r.preventDefault();
var u=Number(k.attr("aria-valuenow"));
if(t){n=RR.components.form2object("#customerDetails",["addressSelector","day","nationalityTog","nationality","month","houseNameNumber","postcode","ukResidencyConfirm","employmentStatus","year","sortCode0","sortCode1","sortCode2","amountPaidThisYear","approxTransferValue","providers","transferAccountNumber","typeOfISA","typeOfPension","confirmPensionNotIncludes","otherProvider"],function(p){p.personalDetails.employmentStatus=p.employmentStatus;
p.personalDetails.dateOfBirth=RR.utils.convertDateFieldToNumericArray(p.Date);
if(a){p.contactDetails.emailAddress=a.email;
p.confirmedEmailAddress=a.confirmedEmailAddress
}if(p.sortCode0&&p.sortCode1&&p.sortCode2){p.bankDetails[0].sortCode=[p.sortCode0,p.sortCode1,p.sortCode2]
}p.transferDetails=null;
if(p.typeOfISA){p.transferDetails=[];
var w={amount:parseFloat(p.approxTransferValue,10),type:"ISA",subType:p.typeOfISA,accountNumber:p.transferAccountNumber,amountPaidInThisYear:parseInt(p.amountPaidThisYear,10),fundProviderName:(p.providers==="Other")?p.otherProvider||p.otherProvider_isa:p.providers};
p.transferDetails.push(w)
}if(p.typeOfPension){p.transferDetails=[];
var x={amount:parseFloat(p.approxTransferValue),type:"PENSION",subType:p.typeOfPension,accountNumber:p.transferAccountNumber,amountPaidInThisYear:parseInt(p.amountPaidThisYear,10),fundProviderName:(p.providers==="Other")?p.otherProvider||p.otherProvider_pension:p.providers};
p.transferDetails.push(x)
}if(p.addressDetails[0].country==="United Kingdom"){p.addressDetails[0].country="GBR"
}p.personalDetails.nationality=b("[name=nationalityTog]:checked").val()==="GBR"?"GBR":p.nationality;
p.addressDetails[0].type="A";
p.personalDetails.retirementAge=u
});
var m=RR.components.form2object("#customerDetails");
m.personalDetails.dateOfBirth=RR.utils.convertDateFieldToNumericArray(m.Date);
o.personalDetails({personalDetails:{forename:m.personalDetails.forename,surname:m.personalDetails.surname,dateOfBirth:m.personalDetails.dateOfBirth,nationalInsuranceNumber:m.personalDetails.nationalInsuranceNumber}}).done(function(w){if(w===200){var y="<a href='"+RR.route("SIGN_IN")+"'>Sign in</a>";
var x="<a href='"+RR.route("CONTACT_US",{hideBackButton:true})+"' target='_blank'>email</a>";
var p="<a href='"+RR.route("SUPPORT_SIGN_OUT")+"' target='_blank'>webchat</a>";
b(RR).trigger("hideProcessingButton");
b("form .accordion-group").eq(0).find(".accordion-body").collapse("show");
RR.plugins.form.setError("#gender","","It looks like you may already be registered with us. Please "+y+" to continue. If there's a problem, please contact us by "+x+" or "+p+".")
}else{if(w===404){v.customer(n).done(function(z,A){var C=RR.components.form2object("#customerDetails");
var B=(C.typeOfPension)?"#selectedProvider_pension":"#selectedProvider_isa";
C.providersText=b(B+" option:selected").text();
C.personalDetails.retirementAge=u;
RR.session("NEW_CUSTOMER_CONFIRM_DETAILS_FORM",C).done(function(){RR.url.redirect("NEW_CUSTOMER_SECURITY_DETAILS")
})
})
}}}).fail(function(){})
}return false
};
g.validateNationality=function(){if(b("[name=nationalityTog]:checked").val()==="Other"&&b("[name=nationality]").val()===""){RR.plugins.form.setError("[name=nationality]","required","This value is required.",1);
return false
}else{RR.plugins.form.clearError("[name=nationality]");
return true
}};
g.renderTemplate=function(m){var n=RR.templateVars||{};
n.bankDetails={paymentMonth:m};
if(RR.plugins.templates){RR.plugins.templates.render()
}};
g.populateFormFromSession=function(){var m=RR.session("NEW_CUSTOMER_CONFIRM_DETAILS_FORM");
if(m){RR.components.object2form("form#customerDetails",m);
if(m.nationalityTog!=="GBR"){g.populateNationality(m.nationality)
}g.showAddressDetails()
}};
g.populateNationality=function(o){var n=o===null?"":o;
if(!n){n=""
}var m={};
if(n.toUpperCase()==="GBR"||n===""){m.nationalityTog="GBR";
b("[name=nationality]").val("")
}else{m.nationalityTog="Other";
b("[name=nationalityTog]").click()
}RR.plugins.form.populate("form",m);
b("#british").val("GBR")
};
g.getAddressDetailsDropdownOption=function(n){var o=JSON.stringify(n);
var m="";
if(n.houseNameNumber){m+=n.houseNameNumber+", "
}if(n.addressLine1){m+=n.addressLine1+", "
}if(n.townCity){m+=n.townCity
}if(m.slice(-2)===", "){m=m.substring(0,m.length-2)
}return b("<option value='"+o+"'>"+m+"</option>")
};
g.populateAddressDetailsDropdown=function(m){var n=b("#addressSelector").find("option").eq(0);
var o=b("#addressSelector").html("");
o.append(n);
_.each(m,function(p){o.append(g.getAddressDetailsDropdownOption(p))
})
};
g.populateAddressDetailsFromDropdown=function(m){if(b(this).val()!==""){g.populateAddressDetails(JSON.parse(b(this).val()));
g.showAddressDetails()
}};
g.onFindAddressDetailsButtonClick=function(n){var m;
if(b("[name='postcode']").val()&&b("[name='postcode']").parsley("validate")){m=new RR.api.Address(b("[name='postcode']").val(),b("[name='houseNameNumber']").val());
RR.plugins.form.clearError("[name=postcode]");
g.hideAddressDetails();
g.hideAddressDetailsDropdown();
m.lookup().done(function(o,p){if(o===200){g.populateAddressDetailsDropdown(p);
g.showAddressDetailsDropdown()
}else{g.clearAddressDetails();
g.showAddressDetails();
if(o===500){RR.plugins.form.setError("[name=postcode]","servererror","Our postcode checker is currently not working. Please enter your address manually")
}else{RR.plugins.form.setError("[name=postcode]","notfound","Sorry, we can't find that postcode. Please check the format and try again or enter your address manually")
}b("[name=postcode]").closest(".control-group").addClass("error");
b("[name='addressDetails[0].addressLine1']").on("keydown.clearPostcodeErrors",g.clearPostcodeErrors);
b("[name='addressDetails[0].addressLine2']").on("keydown.clearPostcodeErrors",g.clearPostcodeErrors);
b("[name='addressDetails[0].townCity']").on("keydown.clearPostcodeErrors",g.clearPostcodeErrors);
b("[name='addressDetails[0].postcode']").on("keydown.clearPostcodeErrors",g.clearPostcodeErrors)
}})
}};
g.hideAddressDetailsDropdown=function(){b("#addressSelector").closest(".control-group").hide()
};
g.showAddressDetailsDropdown=function(){b("#addressSelector").closest(".control-group").show()
};
g.onEnterAddressManuallyClick=function(m){g.clearAddressDetails();
g.showAddressDetails();
RR.plugins.form.clearError("[name=postcode]");
b("#addressSelector").val("")
};
g.addressDetailsFieldsSelector={houseNameNumber:"[name='addressDetails[0].houseNameNumber']",addressLine1:"[name='addressDetails[0].addressLine1']",addressLine2:"[name='addressDetails[0].addressLine2']",townCity:"[name='addressDetails[0].townCity']",postcode:"[name='addressDetails[0].postcode']"};
g.populateAddressDetails=function(m){_.each(g.addressDetailsFieldsSelector,function(n,o){if(m.hasOwnProperty(o)){b(n).val(m[o])
}})
};
g.showAddressDetails=function(){RR.plugins.form.clearError(l);
RR.plugins.form.clearError(j);
_.each(g.addressDetailsFieldsSelector,function(m,n){b(m).closest(".control-group").show()
});
b("#enterAddressManually").closest(".control-group").hide();
b("[name='addressDetails[0].country']").closest(".control-group").show()
};
g.clearAddressDetails=function(){_.each(g.addressDetailsFieldsSelector,function(m,n){b(m).val("");
RR.plugins.form.clearError(m)
})
};
g.hideAddressDetails=function(){_.each(g.addressDetailsFieldsSelector,function(m,n){b(m).closest(".control-group").hide()
});
b("#enterAddressManually").closest(".control-group").show();
b("[name='addressDetails[0].country']").closest(".control-group").hide();
g.clearAddressDetails()
};
g.hideSubmitButton=function(){b(".form-actions button[type=submit]").hide()
};
g.calculatePaymentMonth=function(){var m=moment();
if(m.date()>15){m.add("month",2);
return m.format("MMMM")
}else{m.add("month",1);
return m.format("MMMM")
}};
g.validateAboutYouPanel=function(p,n){var o=RR.components.form2object("#customerDetails"),m=0;
if(!g.validatePhoneNumber()){m+=1
}if(!g.validateNationality()){m+=1
}if(m||!p){return false
}else{return true
}};
g.validateYourAddressPanel=function(p,n){var o=RR.components.form2object("#customerDetails");
var m=0;
if(o.ukResidencyConfirm==="No"){m+=1
}if(!b('input[name="addressDetails[0].houseNameNumber"]').is(":visible")){RR.plugins.form.setError(l,null,"Please enter your address.");
RR.plugins.form.setError(j,null,"");
m+=1
}if(m||!p){return false
}else{return true
}};
g.clearBankDetailsErrors=function(){RR.plugins.form.clearError("[name='bankDetails[0].accountNumber']");
b("[name=sortCode0]").closest(".control-group").removeClass("error");
b("[name='bankDetails[0].accountNumber']").off("keydown.clearBankDetailserrros");
b("[name=sortCode0]").off("keydown.clearBankDetailserrros");
b("[name=sortCode1]").off("keydown.clearBankDetailserrros");
b("[name=sortCode2]").off("keydown.clearBankDetailserrros")
};
g.clearPostcodeErrors=function(){RR.plugins.form.clearError("[name='postcode']");
b("[postcode]").closest(".control-group").removeClass("error");
b("[name='addressDetails[0].houseNameNumber']").off("keydown.clearPostcodeErrors");
b("[name='addressDetails[0].addressLine1']").off("keydown.clearPostcodeErrors");
b("[name='addressDetails[0].addressLine2']").off("keydown.clearPostcodeErrors");
b("[name='addressDetails[0].townCity']").off("keydown.clearPostcodeErrors");
b("[name='addressDetails[0].postcode']").off("keydown.clearPostcodeErrors")
};
g.validateBankDetailsPanel=function(q,n){var p=RR.components.form2object("#customerDetails");
var m=0;
var o;
if(!q){m++
}if(!b("[name=sortCode0]").is(":disabled")){if(!p.sortCode0||!p.sortCode1||!p.sortCode2){RR.plugins.form.setError("[name=sortCode0]","invalid","This value is required.");
m++
}}else{RR.plugins.form.clearError("[name=sortCode0]")
}if(m<1){b(RR).trigger("headway:showSpinner");
o=new RR.api.BankDetails();
o.validate({accountNumber:p.bankDetails[0].accountNumber,sortCode:[p.sortCode0,p.sortCode1,p.sortCode2]}).done(function(r,t){if(r===200&&t.bankDetailsValid){n.collapse("hide");
if(!b(".accordion-body.in.collapse").length){g.showSubmitButton(n,false);
if(b("form .accordion-group:nth-child(4)").length){b("form .accordion-group").last().find(".accordion-body").collapse("show")
}return true
}}else{RR.plugins.form.setError("[name='bankDetails[0].accountNumber']","invalidbankdetails","The bank details provided are invalid.");
b("[name=sortCode0]").closest(".control-group").addClass("error");
b("[name='bankDetails[0].accountNumber']").on("keydown.clearBankDetailserrros",g.clearBankDetailsErrors);
b("[name=sortCode0]").on("keydown.clearBankDetailserrros",g.clearBankDetailsErrors);
b("[name=sortCode1]").on("keydown.clearBankDetailserrros",g.clearBankDetailsErrors);
b("[name=sortCode2]").on("keydown.clearBankDetailserrros",g.clearBankDetailsErrors)
}})
}return false
};
g.validateTransferDetails=function(n,m){if(n){g.showSubmitButton(m,true)
}else{return false
}};
g.showSubmitButton=function(n,m){var o=RR.session("hasTransferDetails");
if(n){n.collapse("hide");
if(!o||(o&&m)){if(!b(".accordion-body.in.collapse").length){b(".form-actions button[type=submit]").show()
}}return true
}};
g.setAgeLimit=function(){var o,n=b(".date-select-range-html5 input"),p=n.attr("data-minage-message")||"",m=a?a.route:null;
if(m==="ISA"){o=18;
p=p.replace("{{product}}","ISA").replace("{{age}}",o)
}else{if(m==="PENSION"){o=18;
p=p.replace("{{product}}","Pension").replace("{{age}}",o)
}}if(o){n.attr("data-minage",o)
}if(p){n.attr("data-minage-message",p)
}};
g.validatePhoneNumber=function(){if(b("[name='contactDetails.mobilePhoneNumber']").parsley("isValid")===null&&b("[name='contactDetails.homePhoneNumber']").parsley("isValid")===null){c=true;
RR.plugins.form.setError("[name='contactDetails.mobilePhoneNumber']","nophonenumber","You need to enter at least one phone number.",1);
RR.plugins.form.setError("[name='contactDetails.homePhoneNumber']","nophonenumber","You need to enter at least one phone number.",1);
return false
}else{if(c){c=false;
RR.plugins.form.clearError("[name='contactDetails.mobilePhoneNumber']");
RR.plugins.form.clearError("[name='contactDetails.homePhoneNumber']")
}return true
}};
g.prepopulatePensionFields=function(){if(a&&a.route==="PENSION"){b(".input-slider").attr("data-startvalue",a.retirementAge);
b("[name=year]").val(a.year);
b("[name=month]").val(a.month);
b("[name=day]").val(a.day).change();
RR.plugins.ARIA_SLIDER.updateSliderFromElement()
}};
g.toggleResidencyStatus=function(m){if(b("[name=ukResidencyConfirm]:checked").val()==="No"){b("#addressPanel .alert").show()
}else{b("#addressPanel .alert").hide()
}};
g.hideOneOffInformation=function(){if(!a.oneOffPayment){b(".js-one-off-information").hide()
}};
g.hideMonthlyInformation=function(){if(!a.monthlyPayment){b(".js-monthly-information").hide();
b("#bankDetailsPanel-inner .alert.js-template").hide()
}};
g.showTransferDetails=function(){var m=a?a.route:null;
var o=RR.session("hasTransferDetails");
function n(q){b("[data-component='"+q+"']").remove();
var p=b("form .accordion-group");
RR.components.accordionForm.init(p.eq(3),g.validateTransferDetails);
p.eq(3).on("show",g.hideSubmitButton)
}if(m==="ISA"&&o){n("pensionTransfer")
}else{if(m==="PENSION"&&o){n("isaTransfer")
}else{b("[data-component='isaTransfer']").remove();
b("[data-component='pensionTransfer']").remove()
}}};
g.setProductTemplate=function(){var m=a&&a.route;
if(m==="PENSION"){m="Pension"
}if(m){b(".main-header").html(b(".main-header").html().replace("{PRODUCT}",m));
b(".uk-residence-message").html(b(".uk-residence-message").html().replace("{PRODUCT}",m))
}};
g.initMinRetirementAgeValidation=function(){var n=d.val(),m=RR.utils.calcAge(n);
if(!_.isNaN(m)){h.parsley().updateConstraint({min:m+1},h.data("number-message"));
h.blur()
}};
g.toggleRemoveTransferButton=function(){var n=parseFloat(a.oneOffPayment)||0;
var m=parseFloat(a.monthlyPayment)||0;
if(n<=0&&m<=0){e.hide()
}};
g.initMinValues=function(){i.parsley("addConstraint",{min:f})
};
g.init=function(){g.setProductTemplate();
var m=b("form .accordion-group");
var o=g.calculatePaymentMonth();
var n=g.calculatePaymentMonth();
g.setAgeLimit();
g.showTransferDetails();
g.prepopulatePensionFields();
g.hideAddressDetails();
g.hideAddressDetailsDropdown();
g.hideSubmitButton();
g.hideOneOffInformation();
g.hideMonthlyInformation();
b("[name='contactDetails.homePhoneNumber']").closest(".control-group").hide();
b("#addressPanel .alert").hide();
g.renderTemplate(n);
g.populateFormFromSession();
b("[name='addressDetails[0].country']").val("United Kingdom");
b("[name='contactDetails.mobilePhoneNumber']").siblings(".help-block").find("button").click(function(){b("#landlineNumberMessage").parent(".help-block").hide();
b("[name='contactDetails.homePhoneNumber']").on("focusout",function(){g.validatePhoneNumber()
});
b("[name='contactDetails.mobilePhoneNumber']").on("focusout",function(){g.validatePhoneNumber()
});
RR.plugins.form.clearError("[name='contactDetails.mobilePhoneNumber']");
b("[name='contactDetails.mobilePhoneNumber']").parsley("removeConstraint","required");
b("[name='contactDetails.homePhoneNumber']").closest(".control-group").show()
});
b('[name="addressDetails[0].addressLine1"]').parsley("updateConstraint",{type:"addressline"});
b('[name="addressDetails[0].addressLine2"]').parsley("updateConstraint",{type:"addressline"});
b("[name=ukResidencyConfirm]").click(g.toggleResidencyStatus);
b("#findMyAddress").click(g.onFindAddressDetailsButtonClick);
b("#enterAddressManually").click(g.onEnterAddressManuallyClick);
b("#addressSelector").change(g.populateAddressDetailsFromDropdown);
RR.components.accordionForm.init(m.eq(0),g.validateAboutYouPanel);
m.eq(0).on("show",g.hideSubmitButton);
RR.components.accordionForm.init(m.eq(1),g.validateYourAddressPanel);
m.eq(1).on("show",g.hideSubmitButton);
RR.components.accordionForm.init(m.eq(2),g.validateBankDetailsPanel);
m.eq(2).on("show",g.hideSubmitButton);
b("#customerDetails").parsley("addListener",{onFormSubmit:g.onFormSubmit});
g.initMinRetirementAgeValidation();
RR.utils.checkIfMarkupExists(i.is("[min]"),g.initMinValues);
g.toggleRemoveTransferButton();
d.change(function(){g.initMinRetirementAgeValidation()
})
};
return g
}(jQuery));
RR.pages.NEW_CUSTOMER_SECURITY_DETAILS=(function(d){var c={};
var e=300;
var f;
var b=d("form#orphanProfile");
var a=false;
c.populateFormFromSession=function(){var g=RR.session("NEW_CUSTOMER_SECURITY_DETAILS");
if(g){RR.components.object2form("form#orphanProfile",g)
}};
c.onFormSubmit=function(k,j){var g=d("[name^=question]");
var i={};
var h;
a=RR.plugins.PASSWORD_CREATION.validatePassword(true);
if(k&&a){j.preventDefault();
i.memorablePhrase=d("[name=memorableWord]").val();
i.securityQuestions=[];
i.password=d("#password-field").val();
g.each(function(m){var l=m+1;
var n={};
if(d(this).val()!==d(this).find("option").last().val()){n.question=d(this).find("option[value='"+d(this).val()+"']").text();
n.answer=d("[name='answer"+l+"']").val()
}else{n.question=d("[name='userQuestion"+l+"']").val().trim();
n.answer=d("[name='answer"+l+"']").val().trim()
}i.securityQuestions.push(n)
});
h=f.customer({securityDetails:i});
h.done(function(l){if(l===200){RR.session("NEW_CUSTOMER_SECURITY_DETAILS",RR.components.form2object("form#orphanProfile")).done(function(){if(RR.session("purchase").route==="ISA"){RR.url.redirect("NEW_CUSTOMER_ISA_TERMS")
}else{RR.url.redirect("NEW_CUSTOMER_PENSION_TERMS")
}})
}});
h.fail(function(){})
}else{return false
}};
c.init=function(){var h=d("[name^=question]");
var j=d("[name^=answer]");
var g=h.first().find("option");
var i=[];
f=new RR.api.Policy("interim",RR.session("policyNumber"));
RR.plugins.PASSWORD_CREATION.validatePassword(false);
d("#confirm-password-field").siblings(".confirm-icon").hide();
g.each(function(k){if(k!==0&&k!==g.length-1){i[d(this).val().replace(" ","")]=null
}});
h.each(function(m){var l=m+1;
var k=d(this);
var n=d("[name='userQuestion"+l+"']");
k.attr("data-rr-val",d(this).val());
k.on("change focusout",function(){var p=d(this).val();
var o=d(this).attr("data-rr-val");
if(p===d(this).find("option").last().val()){p=""
}if(p){h.filter("[name!='"+d(this).attr("name")+"']").find("option[value='"+p+"']").remove()
}if(o!==p&&o){h.filter("[name!='"+d(this).attr("name")+"']").find("option:eq(0)").after(g.filter("option[value='"+o+"']").clone())
}d(this).attr("data-rr-val",p)
})
});
c.populateFormFromSession();
j.on("focusout keyup",function(){d(this).siblings(".confirm-icon").remove();
d(this).removeClass("confirm-input");
if(!d(this).closest(".control-group").hasClass("error")){if(d(this).val().length>=5){d(this).addClass("confirm-input");
d(this).after('<div class="confirm-icon"><span aria-hidden="false">Confirmed</span><span class="ico" aria-hidden="true">&#xf707;</span></div>')
}}});
b.parsley("addListener",{onFormSubmit:c.onFormSubmit})
};
return c
}(jQuery));
RR.pages.NEW_CUSTOMER_ISA_TERMS=(function(d,b){var c={};
var e;
var a=d("form#termsAndConditions");
c.init=function(){c.showTermsAndConditions();
e=new b.api.Policy("interim",b.session("policyNumber"));
c.renderTemplate();
c.renderIllustrations();
a.parsley("addListener",{onFormSubmit:c.onFormSubmit});
b.utils.replaceClass(" .panel .fund-selected","fund-2","fund-"+b.utils.fundToInt(b.session("selectedFund")));
if(!b.session("NEW_CUSTOMER_PURCHASE_ISA_FORM").monthlyPayment){d("#directDebitGuarentee").hide()
}d("#amend-personal").on("click",function(){d(window).off("beforeunload")
});
d("#amend-bank").on("click",function(){d(window).off("beforeunload")
});
d("#amend-fund").on("click",function(){d(window).off("beforeunload")
})
};
c.showTermsAndConditions=function(){var f=b.session("hasTransferDetails");
if(f){d(".purchase-isa-terms").remove()
}else{d(".purchase-isa-with-transfer-terms").remove()
}};
c.renderTemplate=function(){var h=b.templateVars||{};
var j=b.session("NEW_CUSTOMER_CONFIRM_DETAILS_FORM");
var g=b.session("purchase");
var f=b.utils.convertDateFieldToNumericArray(j.Date);
h.activeUser={name:j.personalDetails.forename+" "+j.personalDetails.surname,dob:f[2]+"/"+f[1]+"/"+f[0],nin:b.utils.chunk(j.personalDetails.nationalInsuranceNumber,2),accountName:j.bankDetails[0].accountName,accountNumber:j.bankDetails[0].accountNumber,sortCode:b.utils.formatSortCode(j.sortCode0,j.sortCode1,j.sortCode2),monthlyPayment:b.utils.formatStringAsCurrency(g.monthlyPayment,""),oneOffPayment:b.utils.formatStringAsCurrency(g.oneOffPayment,""),fund:d("#fundLabel").data("fund"+b.session("selectedFund").toLowerCase()),promoCode:g.promoCode};
if(!g.promoCode){d("#voucherCodeId").remove()
}var i=b.session("hasTransferDetails");
if(i){if(j.providers==="Other"){h.activeUser.curentProvider=j.otherProvider_isa
}else{h.activeUser.curentProvider=j.providersText
}h.activeUser.transferAccNo=j.transferAccountNumber;
h.activeUser.transferISAValue=b.utils.formatStringAsCurrency(j.approxTransferValue,"")
}else{d(".detail-list").eq(2).remove()
}if(b.plugins.templates){b.plugins.templates.render()
}b.utils.rrHide()
};
c.renderIllustrations=function(){var f=d("#illustrationDummyDocument").hide(),g=e.illustration({basicProjectionOptions:{illustrationType:"N",productType:b.session("productType"),fundOption:b.session("selectedFund")}});
g.done(function(h,i){if(h===200){f.find("a").attr("href",i.filePath);
f.find(".file-descriptor").html("PDF");
f.find(".file-date").text(moment().format("D MMMM YYYY"));
f.show()
}})
};
c.collectConfirmationDetails=function(f){var h={};
var g=f.serializeObject();
h.sourceOfWealth=g.sourceOfWealth===d("[name=sourceOfWealth]").find("option").last().val()?g.sourceOfWealthOther:g.sourceOfWealth;
h.contactPreferences={email:f.find("[name=optionsCheckboxList1]:checked").length?true:false,post:f.find("[name=optionsCheckboxList2]:checked").length?true:false,sms:f.find("[name=optionsCheckboxList3]:checked").length?true:false,phone:f.find("[name=optionsCheckboxList4]:checked").length?true:false};
h.acceptKeyFeatures=f.find("[name=acceptTsAndCs]:checked").length?true:false;
return h
};
c.sendConfirmationDetails=function(g){var f=e.customer({confirmationDetails:g});
f.done(function(h){e.notify({notificationType:"verifyPurchase"}).done(function(i){if(i===200){window.location=b.route("NEW_CUSTOMER_VERIFY_EMAIL")
}}).fail(function(){})
});
f.fail(function(){})
};
c.onFormSubmit=function(h,g,f){var i;
g.preventDefault();
if(h){i=c.collectConfirmationDetails(f.$element);
c.sendConfirmationDetails(i)
}};
return c
})(jQuery,RR);
RR.pages.NEW_CUSTOMER_ISA=(function(d,b){var c={},e,a;
c.init=function(){e=d("#applyButton");
a=d("#applyWithTransferButton");
if(!b.utils.isAuthor()){c.getSavingProducts()
}};
c.getSavingProducts=function(){if(!b.utils.isUserLoggedIn()){return
}var f=b.session("email");
var h=new b.api.Account(f);
var g=h.products({});
g.done(function(i,j){if(j){c.modifyApplyButtons(j)
}})
};
c.modifyApplyButtons=function(f){if(f.products){d.each(f.products,function(g,h){if(h.type==="ISA"&&h.source==="RR"){a.hide();
e.attr("data-href",a.attr("data-href"));
return false
}})
}};
return c
})(jQuery,RR);
RR.pages.NEW_CUSTOMER_PENSION_TERMS=(function(d,b){var c={};
var e;
var a=d("form#termsAndConditions");
c.init=function(){c.showTermsAndConditions();
var h=d("[name=sourceOfWealthOneOffContributionLimit]").val()?Number(d("[name=sourceOfWealthOneOffContributionLimit]").val()):75000,g=d("[name=sourceOfWealthRegularContributionLimit]").val()?Number(d("[name=sourceOfWealthRegularContributionLimit]").val()):2000,i=b.session("purchase").oneOffPayment?Number(b.session("purchase").oneOffPayment):0,f=b.session("purchase").monthlyPayment?Number(b.session("purchase").monthlyPayment):0;
e=new b.api.Policy("interim",b.session("policyNumber"));
c.renderTemplate();
c.renderIllustrations();
a.parsley("addListener",{onFormSubmit:c.onFormSubmit});
b.utils.replaceClass(" .panel .fund-selected","fund-2","fund-"+b.utils.fundToInt(b.session("selectedFund")));
if(!b.session("NEW_CUSTOMER_PURCHASE_PENSION_FORM").monthlyPayment){d("#directDebitGuarentee").hide()
}if(i<h&&f<g){d("#paymentSizeAlert").hide()
}d("#amend-personal").on("click",function(){d(window).off("beforeunload")
});
d("#amend-bank").on("click",function(){d(window).off("beforeunload")
});
d("#amend-fund").on("click",function(){d(window).off("beforeunload")
})
};
c.showTermsAndConditions=function(){var f=b.session("hasTransferDetails");
if(f){d(".purchase-pension-terms").remove()
}else{d(".purchase-pension-with-transfer-terms").remove()
}};
c.renderTemplate=function(){var h=b.templateVars||{};
var j=b.session("NEW_CUSTOMER_CONFIRM_DETAILS_FORM");
var g=b.session("purchase");
var f=b.utils.convertDateFieldToNumericArray(j.Date);
h.activeUser={name:j.personalDetails.forename+" "+j.personalDetails.surname,dob:f[2]+"/"+f[1]+"/"+f[0],nin:b.utils.chunk(j.personalDetails.nationalInsuranceNumber,2),accountName:j.bankDetails[0].accountName,accountNumber:j.bankDetails[0].accountNumber,sortCode:b.utils.formatSortCode(j.sortCode0,j.sortCode1,j.sortCode2),monthlyPayment:b.utils.formatStringAsCurrency(g.monthlyPayment,""),oneOffPayment:b.utils.formatStringAsCurrency(g.oneOffPayment,""),fund:d("#fundLabel").data("fund"+b.session("selectedFund").toLowerCase()),promoCode:g.promoCode};
if(!g.promoCode){d("#voucherCodeId").remove()
}var i=b.session("hasTransferDetails")?b.session("hasTransferDetails"):false;
if(i){if(j.providers==="Other"){h.activeUser.curentProvider=j.otherProvider_pension
}else{h.activeUser.curentProvider=j.providersText
}h.activeUser.transferAccNo=j.transferAccountNumber;
h.activeUser.transferPensionValue=b.utils.formatStringAsCurrency(j.approxTransferValue,"")
}else{d(".detail-list").eq(2).remove()
}if(b.plugins.templates){b.plugins.templates.render()
}b.utils.rrHide()
};
c.collectConfirmationDetails=function(f){var h={};
var g=f.serializeObject();
h.sourceOfWealth=g.sourceOfWealth===d("[name=sourceOfWealth]").find("option").last().val()?g.sourceOfWealthOther:g.sourceOfWealth;
if(g.employeePensionScheme){h.employeePensionScheme=(g.employeePensionScheme.indexOf("true")>=0)
}h.contactPreferences={email:f.find("[name=optionsCheckboxList1]:checked").length?true:false,post:f.find("[name=optionsCheckboxList2]:checked").length?true:false,sms:f.find("[name=optionsCheckboxList3]:checked").length?true:false,phone:f.find("[name=optionsCheckboxList4]:checked").length?true:false};
h.acceptKeyFeatures=f.find("[name=acceptTsAndCs]:checked").length?true:false;
h.rpiConsent=b.session("purchase").confirmBoost;
return h
};
c.sendConfirmationDetails=function(g){var f=e.customer({confirmationDetails:g});
f.done(function(h){e.notify({notificationType:"verifyPurchase"}).done(function(i){if(i===200){window.location=b.route("NEW_CUSTOMER_VERIFY_EMAIL")
}}).fail(function(){})
});
f.fail(function(){})
};
c.onFormSubmit=function(h,g,f){var i;
g.preventDefault();
if(h){i=c.collectConfirmationDetails(f.$element);
c.sendConfirmationDetails(i)
}};
c.renderIllustrations=function(){var f=d("#illustrationDummyDocument").hide(),g=e.illustration({basicProjectionOptions:{illustrationType:"N",productType:b.session("productType"),fundOption:b.session("selectedFund")}});
g.done(function(h,i){if(h===200){f.find("a").attr("href",i.filePath);
f.find(".file-descriptor").html("PDF");
f.find(".file-date").text(moment().format("D MMMM YYYY"));
f.show()
}})
};
return c
})(jQuery,RR);
RR.pages.NEW_CUSTOMER_PENSION=(function(d,b){var c={},e,a;
c.init=function(){e=d("#applyButton");
a=d("#applyWithTransferButton");
if(!b.utils.isAuthor()){c.getSavingProducts()
}};
c.getSavingProducts=function(){if(!b.utils.isUserLoggedIn()){return
}var f=b.session("email");
var h=new b.api.Account(f);
var g=h.products({});
g.done(function(i,j){if(j){c.modifyApplyButtons(j)
}})
};
c.modifyApplyButtons=function(f){if(f.products){d.each(f.products,function(g,h){if(h.type==="PENSION"&&h.source==="RR"){a.hide();
e.attr("data-href",a.attr("data-href"));
return false
}})
}};
return c
})(jQuery,RR);
RR.pages.NEW_CUSTOMER_UPDATE_EMAIL=(function(c){var b={};
var a=c("form#panel-form-component-id");
b.onFormSubmit=function(f,d){if(f){b.verifyExistingCustomer()
}return false
};
b.verifyExistingCustomer=function(){var e=a.find("[name=email]").val();
var f=new RR.api.Customer("");
var d=f.search({policyNumberOrEmail:e});
d.done(function(g){if(g===200){var h="<a href='"+RR.route("SIGN_IN")+"'>Sign in</a>";
RR.plugins.form.setError("[name=email]","","Provided email address is already in use, "+h);
c(RR).trigger("hideProcessingButton")
}else{b.processUpdateEmail()
}})
};
b.processUpdateEmail=function(){var f;
var d=RR.session("policyNumber");
if(!d){d=RR.url.parameter("policyNumber")
}var e=new RR.api.Policy("interim",d);
f=a.serializeObject();
b.updateEmail(e,f.email,f.confirmEmailAddress).done(function(g){if(g===200){b.resendPolicyVerificationCode(e).done(function(h){if(h===200){if(RR.session.exists()){RR.session("email",f.email).done(function(){RR.url.redirect("NEW_CUSTOMER_VERIFY_EMAIL")
})
}else{RR.url.redirect("NEW_CUSTOMER_VERIFY_EMAIL")
}}})
}})
};
b.resendPolicyVerificationCode=function(d){return d.resendVerificationCode()
};
b.updateEmail=function(f,e,d){return f.changeUsername({newEmailAddress:e,confirmedEmailAddress:d})
};
b.setProductTemplate=function(){var d=RR.session("purchase")?RR.session("purchase").route:null;
if(d&&d.toLowerCase()==="pension"){d="Pension"
}else{if(d&&d.toLowerCase()==="isa"){d="ISA"
}else{d="Product"
}}if(d!==null){c(".main-header").html(c(".main-header").html().replace("{PRODUCT}",d))
}};
b.init=function(){var d;
a.parsley("addListener",{onFormSubmit:b.onFormSubmit});
c("#secondaryAction1").on("click",function(){c(window).off("beforeunload")
});
b.setProductTemplate()
};
return b
}(jQuery));
RR.pages.FAQS=(function(b){var a={};
a.blockEmptySearch=function(){var d=b("#searchForm"),c=d.find('input[name="q"]');
d.on("submit",function(f){if(c.val()===""){f.preventDefault();
return false
}else{return true
}})
};
a.accordionChevronToggle=function(){var c=b("#accordion1");
c.on("hidden",function(d){var f=b(d.target).attr("id");
c.find('a[href="#'+f+'"] .ico').html("&#xf70a;")
});
c.on("shown",function(d){var f=b(d.target).attr("id");
c.find('a[href="#'+f+'"] .ico').html("&#xf709;")
})
};
a.scrollLinks=function(){b("#content a[href*=#]:not([href=#]):not([data-toggle])").on("click",function(){if(location.pathname.replace(/^\//,"")===this.pathname.replace(/^\//,"")||location.hostname===this.hostname){var d=b(this.hash);
var c=b("#full-width-header").height()+20;
d=d.length?d:b("[name="+this.hash.slice(1)+"]");
if(d.length){b("html,body").animate({scrollTop:d.offset().top-c},1000);
b("#"+this.hash.slice(1)).attr("tabindex",-1);
return false
}}})
};
a.init=function(){a.blockEmptySearch();
a.accordionChevronToggle();
a.scrollLinks();
RR.components.feedback.init()
};
return a
}(jQuery));
RR.pages.FAQ_HOME=(function(b){var a={};
a.loadPopularFaqs=function(){var e=window.popularFAQsQueryString||"";
var c="/bin/querybuilder.json?"+e,d=b.get(c);
return d
};
a.displayPopularFaqs=function(f){var d='<li><a href="{{url}}">{{title}}<span aria-hidden="true" class="ico">&#xf719;</span></a></li>',g="<li>{{message}}</li>",i={message:"No popular FAQs found."},e=RR.url.pathRoot,h=".html",c=b("#popular-faq-list");
if(f.success===true){if(f.results===0){c.append(_.template(g,i))
}else{b.each(f.hits,function(k,l){var j={url:l.path.replace(e,"")+h,title:l.title};
c.append(_.template(d,j))
})
}}else{a.popularLoadError("Error loading popular FAQs.")
}return this
};
a.popularLoadError=function(e){var c=b("#popular-faq-list"),f={message:e},d="<li>{{message}}</li>";
c.append(_.template(d,f));
RR.utils.debugMessage(e)
};
a.initNavTabs=function(){b('.nav-tabs-btn a[data-toggle="tab"]').on("shown",function(c){window.location.hash="!tab_"+c.target.hash.substr(1);
b('input[name="q"]').val("");
return false
});
if(window.location.hash!==""){b('.nav-tabs-btn a[href="'+location.hash.replace("!tab_","")+'"]').tab("show")
}else{b(".nav-tabs-btn a:first").tab("show")
}};
a.setSupportPageDesign=function(){if(b("#accordion1 .accordion-body").height()===0){b("#accordion1 .accordion-body").height("auto")
}};
a.initEvents=function(){b('[href="#all"]').on("click",function(){a.setSupportPageDesign()
});
b(window).on("hashchange",function(){var c="#!tab_",e=window.location.hash,d;
if(e.length>0){d="#"+e.substr(c.length)
}else{d=b(".nav-tabs-btn li:first-child a").attr("href")
}b('.nav-tabs-btn a[href="'+d+'"]').click()
})
};
a.init=function(){var c=a.loadPopularFaqs();
c.done(function(e){a.displayPopularFaqs(e);
var d=RR.utils.detectDevice();
if(d!=="phone"){b("#accordion1 .accordion-body").collapse("show")
}else{b("#accordion1 .accordion-body").collapse("hide")
}});
c.fail(function(d){a.popularLoadError("Error loading popular FAQs.")
});
b(window).on("debouncedresize",function(){var d=RR.utils.detectDevice();
if(d!=="phone"){b("#accordion1 .accordion-body").collapse("show")
}else{b("#accordion1 .accordion-body").collapse("hide")
}});
a.initNavTabs();
RR.pages.FAQS.init();
a.initEvents();
if(window.platform.name==="IE"){b("header .btn-back").remove()
}};
return a
}(jQuery));
RR.pages.INSIGHTS=(function(b){var a={};
a.blockEmptySearch=function(){var d=b("#searchForm"),c=d.find('input[name="q"]');
d.on("submit",function(f){if(c.val()===""){f.preventDefault();
return false
}else{return true
}})
};
a.makeBackButtonWork=function(){b(".btn-back").on("click",function(c){c.preventDefault();
window.history.go(-1);
return false
})
};
a.accordionChevronToggle=function(){var c=b("#accordion1");
c.on("hidden",function(d){var f=b(d.target).attr("id");
c.find('a[href="#'+f+'"] .ico').html("&#xf70a;")
});
c.on("shown",function(d){var f=b(d.target).attr("id");
c.find('a[href="#'+f+'"] .ico').html("&#xf709;")
})
};
a.init=function(){a.blockEmptySearch();
a.makeBackButtonWork();
a.accordionChevronToggle();
RR.components.feedback.init();
a.analytics()
};
a.analytics=function(){b(".nav.nav-tabs-btn li a").click(function(){try{b(RR).trigger("analyticsevent",{event:("Tab-"+b(this)[0].hash)})
}catch(c){}})
};
return a
}(jQuery));
RR.pages.INSIGHTS_HOME=(function(b){var a={};
a.loadPopularFaqs=function(){var e=window.popularInsightsQueryString||"";
var c="/bin/querybuilder.json?"+e,d=b.get(c);
return d
};
a.displayPopularInsights=function(f){var d='<li><a href="{{url}}"><h4>{{title}}<span aria-hidden="true" class="ico">&#xf719;</span></h4> <p><span class="link-descriptor">{{description}}</span><span class="link-date">{{created}}</span></p></a></li>',g="<li>{{message}}</li>",i={message:"No popular Insights found."},e=RR.url.pathRoot,h=".html",c=b("#popular-insights-list");
if(f.success===true){if(f.results===0){c.append(_.template(g,i))
}else{b.each(f.hits,function(k,l){var j={url:l.path.replace(e,"")+h,title:l.title,description:l.excerpt,created:RR.utils.stringToDateFormatted(l.created,"")};
c.append(_.template(d,j))
})
}}else{a.popularLoadError("Error loading popular Insights.")
}return this
};
a.popularLoadError=function(e){var c=b("#popular-insights-list"),f={message:e},d="<li>{{message}}</li>";
c.append(_.template(d,f));
RR.utils.debugMessage(e)
};
a.initNavTabs=function(){b('.nav-tabs-btn a[data-toggle="tab"]').on("shown",function(c){window.location.hash="!tab_"+c.target.hash.substr(1);
b('input[name="q"]').val("");
return false
});
if(window.location.hash!==""){b('.nav-tabs-btn a[href="'+location.hash.replace("!tab_","")+'"]').tab("show")
}else{b(".nav-tabs-btn a:first").tab("show")
}};
a.init=function(){if(!RR.session("loggedIn")){b(".tabs-to-accordion").remove()
}var c=a.loadPopularFaqs();
c.done(function(e){a.displayPopularInsights(e);
var d=RR.utils.detectDevice();
if(d!=="phone"){b("#accordion1 .accordion-body").collapse("show")
}else{b("#accordion1 .accordion-body").collapse("hide")
}});
c.fail(function(d){a.popularLoadError("Error loading popular Insights.")
});
b(window).on("debouncedresize",function(){var d=RR.utils.detectDevice();
if(d!=="phone"){b("#accordion1 .accordion-body").collapse("show")
}else{b("#accordion1 .accordion-body").collapse("hide")
}});
a.initNavTabs();
RR.pages.INSIGHTS.init()
};
return a
}(jQuery));
RR.pages.INSIGHTS_SEARCH=(function(b){var a={};
a.getSelectedTags=function(){var c=[],d=b("#insight-filters");
d.find("input:checked").each(function(){var e=b(this).attr("id");
c.push(e)
});
return c
};
a.searchResultsVisibility=function(c){var d=b("#search-results");
b("#no-results-msg").remove();
if(c===true){d.find("li").show()
}else{d.find("li").hide()
}};
a.showFilteredInsights=function(e,f){var d=0,c=b("#search-results");
f=f||"containsAllTags";
c.find("li").each(function(){var j=b(this),g=j.attr("data-tags")&&j.attr("data-tags").split(","),h=_.intersection(e,g);
function i(){j.show();
d++
}if(f==="containsSomeTags"&&h.length>0){i()
}if(f==="containsAllTags"&&h.length===e.length){i()
}});
if(d===0){a.noResultsMessage({message:"No items match your filter criteria."})
}return d
};
a.setResultsAmount=function(d){var c=b("#some-results-matched-number"),e=(d!==1)?"items":"item";
c.html(d+" "+e)
};
a.noResultsMessage=function(e){var d='<li id="no-results-msg">{{message}}</li>',c=b("#search-results");
c.prepend(_.template(d,e))
};
a.resetFilters=function(){var c=b("#search-results"),e=c.find("li").length,d=b("#insight-filters");
d.find("input").removeAttr("checked");
d.find("label.c_on").removeClass("c_on");
a.searchResultsVisibility(true);
a.setResultsAmount(e)
};
a.initFiltering=function(){var c=b("#accordion1");
b("#insight-apply-filter").on("click",function(){var e=a.getSelectedTags(),d;
a.searchResultsVisibility(false);
d=a.showFilteredInsights(e,"containsAllTags");
a.setResultsAmount(d)
});
c.on("hidden",function(){a.resetFilters()
})
};
a.init=function(){RR.pages.INSIGHTS.init();
a.initFiltering()
};
return a
}(jQuery));
RR.pages.FAQ_SEARCH=(function(b){var a={};
a.getSelectedTags=function(){var c=[],d=b("#faq-filters");
d.find("input:checked").each(function(){var e=b(this).attr("id");
c.push(e)
});
return c
};
a.searchResultsVisibility=function(c){var d=b("#search-results");
b("#no-results-msg").remove();
if(c===true){d.find("li").show()
}else{d.find("li").hide()
}};
a.showFilteredFaqs=function(d,e){var f=0,c=b("#search-results");
e=e||"containsAllTags";
c.find("li").each(function(){var j=b(this),g=j.attr("data-tags")&&j.attr("data-tags").split(","),h=_.intersection(d,g);
function i(){j.show();
f++
}if(e==="containsSomeTags"&&h.length>0){i()
}if(e==="containsAllTags"&&h.length===d.length){i()
}});
if(f===0){a.noResultsMessage({message:"No items match your filter criteria."})
}return f
};
a.setResultsAmount=function(d){var c=b("#some-results-matched-number"),e=(d!==1)?"items":"item";
c.html(d+" "+e)
};
a.noResultsMessage=function(e){var d='<li id="no-results-msg">{{message}}</li>',c=b("#search-results");
c.prepend(_.template(d,e))
};
a.resetFilters=function(){var c=b("#search-results"),e=c.find("li").length,d=b("#faq-filters");
d.find("input").removeAttr("checked");
d.find("label.c_on").removeClass("c_on");
a.searchResultsVisibility(true);
a.setResultsAmount(e)
};
a.initFiltering=function(){var c=b("#accordion1");
b("#faq-apply-filter").on("click",function(){var e=a.getSelectedTags(),d;
a.searchResultsVisibility(false);
d=a.showFilteredFaqs(e,"containsAllTags");
a.setResultsAmount(d)
});
c.on("hidden",function(){a.resetFilters()
})
};
a.init=function(){RR.pages.FAQS.init();
a.initFiltering()
};
return a
}(jQuery));
RR.pages.FUND_SELECTION_ISA=(function(b){var a={};
a.init=function(){RR.plugins.RISK_PROFILER.setSelectedFund();
RR.plugins.RISK_PROFILER.setPolicyNumber(RR.session("policyNumber"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
b("#fund-selection-checkbox").html(b("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
b("#continue-button-wrapper").html(b("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"))
};
return a
}(jQuery));
RR.pages.FUND_SELECTION_PENSION=(function(b){var a={};
a.init=function(){RR.plugins.RISK_PROFILER.setSelectedFund();
RR.plugins.RISK_PROFILER.setPolicyNumber(RR.session("policyNumber"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
b("#fund-selection-checkbox").html(b("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
b("#continue-button-wrapper").html(b("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"))
};
return a
}(jQuery));
RR.pages.RISK_PROFILE_QUESTIONNAIRE=(function(d){var c={};
var a=d(".questionnaire");
var b=d("form#panel-form-component-id");
c.init=function(){if(!RR.utils.isAuthor()){c.initQuestions()
}};
c.initQuestions=function(){d(a).each(function(e){e++;
d(this).attr("data-question-no",e);
d(this).find("div label").attr("data-question-no",e)
});
c.showQuestion(1);
b.parsley("addListener",{onFormSubmit:c.goToNextQuestion});
d(".actions-secondary a").click(function(f){f.preventDefault();
c.goToPreviousQuestion(this)
});
d(".controls div label").click(function(f){f.preventDefault();
d(".questionnaire[data-question-no='"+d(this).attr("data-question-no")+"'] div label").removeClass("checked");
d(this).addClass("checked");
c.enableNextButton()
});
d(".controls div label").focus(function(){d(".questionnaire[data-question-no='"+d(this).attr("data-question-no")+"'] div label").removeClass("checked");
d(this).addClass("checked");
c.enableNextButton()
});
d(document).keypress(function(f){if(f.which===13){d("#form-button").focus()
}})
};
c.goToNextQuestion=function(){var e=d("#form-button").attr("data-question-no");
e++;
if(e===(a.length+1)){c.submitQuestionnaire()
}else{c.showQuestion(e);
try{d(RR).trigger("analyticsevent",{event:("Question-"+e)})
}catch(f){}}if(e===a.length){d("#form-button").html("Finish <span aria-hidden='true' class='ico'>&#xf719;</span>").addClass("finish")
}return false
};
c.goToPreviousQuestion=function(h){var f=d("#form-button").attr("data-question-no");
if(f==="1"){window.location=d(h).attr("href")
}else{f--;
c.showQuestion(f);
try{d(RR).trigger("analyticsevent",{event:("Question-"+f)})
}catch(g){}}};
c.enableNextButton=function(e){var f;
if(e){f=e
}else{f=d("#form-button").attr("data-question-no")
}if(d(".questionnaire[data-question-no='"+f+"'] div label").hasClass("checked")){d("#form-button").removeAttr("disabled","disabled").removeClass("inactive")
}else{d("#form-button").attr("disabled","disabled").addClass("inactive")
}};
c.showQuestion=function(e){a.hide();
c.enableNextButton();
d("#form-button").html("Next question <span aria-hidden='true' class='ico'>&#xf719;</span>").removeClass("finish");
d("#form-button").attr("data-question-no",e);
d(".questionnaire[data-question-no='"+e+"']").show();
c.enableNextButton(e);
c.updateQuestionTracker(e);
setTimeout(function(){d(RR).trigger("navigateAwayModal:activate")
},200)
};
c.updateQuestionTracker=function(e){d(".progress-tracker-short .current").html(e);
d(".progress-tracker-short .total").html(a.length);
d(".screenreader-visible").html("Section progress: "+e+" of "+a.length)
};
c.submitQuestionnaire=function(){var h=[];
d(a).each(function(){var j=d(this).attr("data-question-no");
var k=d(this).find("div label.checked").attr("data-answer-id");
var l={questionId:j,responseId:k};
h.push(l)
});
var i=new RR.api.Risk();
var g;
var f=RR.session("journey");
var e=RR.session("loggedIn");
if(f){if(f.route==="PROFILEJOURNEY"||f.route==="CHANGEFUND"||f.route==="CHANGENONRRFUND"){g=i.getScore({policyType:"rr",questionnaireResponses:h})
}}else{if(e){g=i.getScore({policyType:"rr",questionnaireResponses:h})
}else{g=i.getScore({policyType:"interim",questionnaireResponses:h})
}}g.done(function(j,k){if(j===200){RR.session({score:k.riskScore}).done(function(){window.location=RR.route("RISK_PROFILE_RESULTS")
})
}})
};
return c
}(jQuery));
RR.pages.RISK_PROFILE_RESULTS=(function(c){var b={},a;
b.init=function(){var e=RR.session("journey");
if(RR.session("score")){a=RR.session("score");
c("#continueButton").click(function(){RR.plugins.RISK_PROFILER.redirectToSelectFundPage(e)
})
}c("#sliderRail1").attr("data-startValue",a);
c(".selection-info").attr("class","selection-info");
c(".selection-info").html(c(".selection-info").html().replace("{placeholder}","<span id='riskDesc'></span>"));
c("#riskDesc").html(c(".risk-color-"+a).attr("descriptive-text"));
c(".selection-info").addClass("risk-"+a);
RR.plugins.ARIA_SLIDER.init(d)
};
function d(e){c(".risk-description").addClass("hidden");
c("#risk-description-"+e).removeClass("hidden");
RR.pages.RISK_PROFILE_RESULTS.currentRisk=e
}return b
}(jQuery));
RR.pages.RISK_PROFILE_START=(function(c){var b={},a;
b.init=function(){c('[name="button"]').on("click",function(){c(window).off("beforeunload")
})
};
return b
}(jQuery));
RR.pages.HOME=(function(b){var a={};
a.init=function(){b(".fixed-tools").remove()
};
return a
}(jQuery));
RR.pages.SAVINGS=(function(c){var b={};
var a=this;
b.init=function(){};
return b
}(jQuery));
RR.pages.BASIC_PROFILE=(function(b){var a={};
a.blockEmptySearch=function(){var d=b("#searchForm"),c=d.find('input[name="q"]');
d.on("submit",function(f){if(c.val()===""){f.preventDefault();
return false
}else{return true
}})
};
a.init=function(){a.blockEmptySearch();
RR.components.feedback.init();
RR.session("journey",{route:"PROFILEJOURNEY"})
};
return a
}(jQuery));
RR.pages.CHANGE_FUND_EDUCATION=(function(b){var a={};
a.init=function(){b("button[type=submit]").click(function(){var c=RR.session("journey");
if(_.isObject(c)){if(c.route==="ISA"){RR.url.redirect("CHANGE_FUND_ISA",{productId:c.productId})
}else{RR.url.redirect("CHANGE_FUND_PENSION",{productId:c.productId})
}}})
};
return a
}(jQuery));
RR.pages.CHANGE_FUND_ISA=(function(c){var b={};
var a;
b.init=function(){b.getCurrentFund().done(b.initRiskProfiler).fail(function(){});
c('[name="button"]').on("click",function(){c(window).off("beforeunload")
})
};
b.getCurrentFund=function(){var f=c.Deferred();
a=RR.url.parameter("productId");
if(!a){a=_.isObject(RR.session("journey"))?RR.session("journey").productId:a
}var e=new RR.api.Product(a);
e.get().done(function(d,g){if(d===200){RR.session("selectedFund",g.selectedFund).done(function(){RR.session("fundValue",g.value).done(function(){f.resolve(g.selectedFund)
})
})
}else{f.reject()
}}).fail(f.reject);
return f
};
b.initRiskProfiler=function(e){var f=c.Deferred();
RR.session("journey",{route:"CHANGEFUND",productType:"ISA",oldFund:e,productId:a}).done(function(){RR.plugins.RISK_PROFILER.setSelectedFund();
RR.plugins.RISK_PROFILER.setPolicyNumber(RR.url.parameter("productId"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
c("#fund-selection-checkbox").html(c("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
c("#continue-button-wrapper").html(c("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
c("#riskLevels").show();
f.resolve()
}).fail(f.reject);
return f
};
return b
}(jQuery));
RR.pages.CHANGE_FUND_PENSION=(function(c){var b={};
var a;
b.init=function(){b.getCurrentFund().done(b.initRiskProfiler).fail(function(){});
c('[name="button"]').on("click",function(){c(window).off("beforeunload")
})
};
b.getCurrentFund=function(){var f=c.Deferred();
a=RR.url.parameter("productId");
if(!a){a=_.isObject(RR.session("journey"))?RR.session("journey").productId:a
}var e=new RR.api.Product(a);
e.get().done(function(d,g){if(d===200){if(g.fund.type==="OTHER"&&g.source==="RR"){RR.session("autoUpgradeUser","true")
}if(g.selectedFund){RR.session("selectedFund",g.selectedFund).done(function(){RR.session("fundValue",g.value).done(function(){f.resolve(g.selectedFund)
})
})
}else{RR.plugins.RISK_PROFILER.setPolicyNumber(RR.url.parameter("productId"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.setRiskscore();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
c("#fund-selection-checkbox").html(c("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
c("#continue-button-wrapper").html(c("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
c("#riskLevels").show()
}}else{f.reject()
}}).fail(f.reject);
return f
};
b.initRiskProfiler=function(e){var f=c.Deferred();
RR.session("journey",{route:"CHANGEFUND",productType:"PENSION",oldFund:e,productId:a}).done(function(){RR.plugins.RISK_PROFILER.setSelectedFund();
RR.plugins.RISK_PROFILER.setPolicyNumber(RR.url.parameter("productId"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
c("#fund-selection-checkbox").html(c("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
c("#continue-button-wrapper").html(c("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
c("#riskLevels").show();
f.resolve()
}).fail(f.reject);
return f
};
return b
}(jQuery));
RR.pages.CHANGE_YOUR_USERNAME=(function(d,b){var c={},f,a=d("form#panel-form-component-id"),e=a.find("#verificationCode_id");
c.onFormSubmit=function(i,h){var j=a.serializeObject(),g=new b.api.Customer();
if(i){g.securityChangeUsernameInitiate({accessToken:j.verificationCode}).done(function(k){if(k===200){window.location=b.route("HOME_SIGNED_OUT")
}else{if(k===404){b.plugins.form.setError("[name=verificationCode]","notmatching","This verification code is incorrect.")
}}}).fail(function(){})
}return false
};
c.populateVerificationCode=function(){var g=b.url.parameter("token");
e.val(g)
};
c.initEvents=function(){a.parsley("addListener",{onFormSubmit:c.onFormSubmit})
};
c.init=function(){c.populateVerificationCode();
c.initEvents()
};
return c
}(jQuery,RR));
RR.pages.RESET_MEMORABLE_WORD=(function(e){var d={};
var f;
var c;
var a=false;
var b;
d.init=function(){var g;
g=RR.url.parameter("token");
f=new RR.api.Customer("");
d.validateToken(g);
RR.plugins.loader.hide("#validation, .incorrect-answer");
RR.plugins.loader.hide("#memorable-word-message, #memorable-word-form");
e("[name=answer]").keyup(function(){RR.plugins.loader.hide("#validation, .incorrect-answer")
});
e("form[name=questions-form]").parsley("addListener",{onFormSubmit:d.onQuestionsFormSubmit})
};
d.onQuestionsFormSubmit=function(h,g){g.preventDefault();
RR.plugins.loader.hide("#validation, .incorrect-answer");
RR.plugins.loader.hide("#memorable-word-message, #memorable-word-form");
if(h){d.validateAnswer()
}else{return false
}};
d.validateToken=function(g){f.resetMemorableWordInitiate({accessToken:g}).done(function(h,i){if(h===200){f=new RR.api.Customer(i.emailAddress);
d.getQuestion(false)
}})
};
d.onChangeMemorableWordFormSubmit=function(h,g){g.preventDefault();
if(h){d.changeMemorableWord()
}else{return false
}};
d.getQuestion=function(g){c=f.resetMemorableWordQuestion();
c.done(function(h,i){if(h===200){e("div.answer label").html(i.questionText);
e("div.answer label").attr("identifier",i.questionIdentifier);
if(g){e(".incorrect-answer p span").html(i.questionsRemaining);
e("#validation, .incorrect-answer").show();
e("[name=answer]").val("")
}}else{if(h===403){window.location=RR.route("ACCOUNT_LOCKED")
}else{if(h===404){window.location=RR.route("SIGN_IN")
}}}})
};
d.validateAnswer=function(){var g=e("div.answer label").attr("identifier");
var h=e("input[name=answer]").val();
c=f.resetMemorableWordAnswer({questionIdentifier:g,answer:h});
c.done(function(i,j){if(i===200){if(j.correctAnswer){e("#memorable-word-message, #memorable-word-form").show();
RR.plugins.loader.hide("#security-question-form, .confirmation");
e("form[name=memorable-word-form]").parsley("addListener",{onFormSubmit:d.onChangeMemorableWordFormSubmit})
}else{if(j.correctAnswer===0){window.location=RR.route("ACCOUNT_LOCKED")
}else{d.getQuestion(true)
}}}else{if(i===404){window.location=RR.route("SIGN_IN")
}}})
};
d.changeMemorableWord=function(){var g=e("[name=memorableWord]").val();
c=f.securityResetMemorableWord({memorableWord:g});
c.done(function(h,i){if(h===200){window.location=RR.route("SIGN_IN")
}else{if(h===403){window.location=RR.route("ACCOUNT_LOCKED")
}else{if(h===404){window.location=RR.route("SIGN_IN")
}}}})
};
return d
}(jQuery));
RR.pages.ISA_WRAPPER=(function(d){var c={};
var b={};
var a=d("form#form-purchase");
c.init=function(){a.parsley("addListener",{onFormSubmit:c.onFormSubmit});
c.productId=RR.url.parameter("productId");
c.assetId=RR.url.parameter("assetId");
c.assetSource=RR.url.parameter("assetSource");
RR.session("productId",c.productId);
var e=RR.session("transferDetails");
if(e&&e.subType){c.populateTransferDetails(e);
c.assetId=e.assetId;
c.assetSource=e.assetSource
}else{if(c.productId&&c.assetId&&c.assetSource){c.getAssetDetails()
}}};
c.getAssetDetails=function(){var g=new RR.api.Product(c.assetId);
var e;
var f;
e=g.get({source:c.assetSource});
e.done(function(i,j){if(i===200){var h={amount:j.value,subType:j.subType};
c.populateTransferDetails(h)
}})
};
c.populateTransferDetails=function(e){d("#typeOfISA").val(e.subType).change();
d("[name=approxTransferValue]").val(e.amount);
d("[name=amountPaidThisYear]").val(e.amountPaidInThisYear);
d("[name=transferAccountNumber]").val(e.accountNumber);
if(e.fundProviderId===null){e.fundProviderId="Other"
}d("#selectedProvider").val(e.fundProviderId).change();
d("[name=otherProvider]").val(e.fundProviderName)
};
c.onFormSubmit=function(h,g){g.preventDefault();
if(h){var f=RR.components.form2object("#form-purchase",["amountPaidThisYear","approxTransferValue","otherProvider","providers","transferAccountNumber","typeOfISA"],function(e){e.productId=c.productId;
e.transferDetails={amount:parseFloat(e.approxTransferValue),type:"ISA",subType:e.typeOfISA,accountNumber:e.transferAccountNumber,amountPaidInThisYear:parseInt(e.amountPaidThisYear,10),fundProviderName:(e.providers==="Other")?e.otherProvider||e.otherProvider_isa:e.providers,assetId:c.assetId,assetSource:c.assetSource}
});
f.providersText=d("#selectedProvider option:selected").text();
RR.session(f).done(function(){RR.url.redirect("ISA_WRAPPER_CONFIRM_TERMS")
})
}};
return c
}(jQuery));
RR.pages.ISA_WRAPPER_CONFIRM_TERMS=(function(f){var e={};
var b={};
var d="";
var a=f("form#termsAndConditions");
var c;
e.init=function(){a.parsley("addListener",{onFormSubmit:e.onFormSubmit});
f(":submit").attr("disabled",false);
e.productId=RR.session("productId");
if(e.productId){d=new RR.api.Product(e.productId);
e.getProductDetails()
}else{return
}f("body").on("click","#amend-transfer",function(g){g.preventDefault();
RR.url.goBack()
})
};
e.onFormSubmit=function(j,i,g){i.preventDefault();
var h=f("[for=permanent-residence-yes]").hasClass("checked");
if(!h){j=false;
scrollToElement(("[for=permanent-residence-yes]"));
f(":submit").attr("disabled",false)
}if(j){f(":submit").attr("disabled",true);
e.conslidateProduct()
}};
e.conslidateProduct=function(){var h;
var i;
var g=RR.session("transferDetails");
if(!g.assetId){g.consolidationSource="NEW_ASSET"
}else{g.consolidationSource="EXISTING_MEMO_ASSET"
}f(RR).trigger("headway:showSpinner");
h=d.consolidate(g);
h.done(function(j,k){if(j===200){RR.session("transferDetails",{}).done(function(){RR.session("transferReceived",{consolidateId:k.id,productId:e.productId}).done(function(){RR.plugins.notifications.setNotificationFlag("ISACONSOLIDATE").done(function(){f(":submit").attr("disabled",false);
RR.url.redirect("SAVINGS")
})
})
})
}else{f(":submit").attr("disabled",false)
}})
};
e.getProductDetails=function(){var g;
var h;
g=d.get({source:e.assetSource});
g.done(function(i,j){if(i===200){b.selectedFund=j.selectedFund;
e.getUserDetails();
c=j.selectedFund
}})
};
e.getUserDetails=function(){var g=RR.session("email");
var j=new RR.api.Customer(g);
var h;
var i;
h=j.details();
h.done(function(k,l){if(k===200){b.userDetails=l;
e.renderTemplate();
e.renderIllustrations()
}})
};
e.renderTemplate=function(){var i=RR.templateVars||{};
var j=b.userDetails;
var h="";
if(j.addresses){h=j.addresses[0].houseNameNumber;
h+="<br/>"+j.addresses[0].addressLine1;
h+="<br/>"+j.addresses[0].townCity+" "+j.addresses[0].country;
h+="<br/>"+j.addresses[0].postcode
}i.activeUser={name:j.firstname+" "+j.surname,dob:j.dateOfBirth[2]+"/"+j.dateOfBirth[1]+"/"+j.dateOfBirth[0],nin:RR.utils.chunk(j.niNumber,2),address:h,employementStatus:j.employmentStatus,fund:f("#fundLabel").data("fund"+b.selectedFund.toLowerCase())};
var g=RR.session("transferDetails");
if(g){if(g.fundProviderName){i.activeUser.curentProvider=g.fundProviderName
}else{if(g.fundProviderId){i.activeUser.curentProvider=RR.session("providersText")
}}i.activeUser.transferAccNo=g.accountNumber;
i.activeUser.transferISAValue=RR.utils.formatStringAsCurrency(g.amount,"")
}if(RR.plugins.templates){RR.plugins.templates.render()
}RR.utils.replaceClass(" .panel .fund-selected","fund-2","fund-"+RR.utils.fundToInt(b.selectedFund))
};
e.renderIllustrations=function(){var g=f("#illustrationDummyDocument").hide(),i=new RR.api.Policy("rr",""),h=i.illustration({basicProjectionOptions:{illustrationType:"T",productType:RR.session("transferDetails").type,accountId:RR.session("productId"),fundOption:c,fundValue:RR.session("transferDetails").amount,fundTransferOperation:"TRANSFER"}});
h.done(function(j,k){if(j===200){g.find("a").attr("href",k.filePath);
g.find(".file-descriptor").html("PDF");
g.find(".file-date").text(moment().format("D MMMM YYYY"));
g.show()
}})
};
return e
}(jQuery));
RR.pages.PENSION_WRAPPER=(function(d){var c={};
var b={};
var a=d("form#form-purchase");
c.init=function(){a.parsley("addListener",{onFormSubmit:c.onFormSubmit});
c.productId=RR.url.parameter("productId");
c.assetId=RR.url.parameter("assetId");
c.assetSource=RR.url.parameter("assetSource");
RR.session("productId",c.productId);
var e=RR.session("transferDetails");
if(e&&e.subType){c.populateTransferDetails(e);
c.assetId=e.assetId;
c.assetSource=e.assetSource
}else{if(c.productId&&c.assetId&&c.assetSource){c.getAssetDetails()
}}var f=RR.session("PENSION_TRANSFER_FORM");
RR.components.object2form("form#form-purchase",f);
d('select[name="typeOfPension"]').change(c.onTypeOfPensionChange)
};
c.getAssetDetails=function(){var g=new RR.api.Product(c.assetId);
var e;
var f;
e=g.get({source:c.assetSource});
e.done(function(i,j){if(i===200){var h={amount:j.value,subType:j.subType};
c.populateTransferDetails(h)
}})
};
c.populateTransferDetails=function(e){if(RR.session("confirmPensionTransfer")){d("#typeOfPension").val(e.subType).change()
}else{d("#typeOfPension").val(e.subType)
}d("[name=approxTransferValue]").val(e.amount);
d("[name=transferAccountNumber]").val(e.accountNumber);
if(e.fundProviderId===null){e.fundProviderId="Other"
}d("#selectedProvider").val(e.fundProviderId).change();
d("[name=otherProvider]").val(e.fundProviderName)
};
c.onFormSubmit=function(h,g){g.preventDefault();
if(h){var f=RR.components.form2object("#form-purchase",["approxTransferValue","otherProvider","providers","transferAccountNumber","typeOfPension"],function(e){e.productId=c.productId;
e.transferDetails={amount:parseFloat(e.approxTransferValue),type:"PENSION",subType:e.typeOfPension,accountNumber:e.transferAccountNumber,fundProviderName:(e.providers==="Other")?e.otherProvider||e.otherProvider_pension:e.providers,assetId:c.assetId,assetSource:c.assetSource}
});
f.providersText=d("#selectedProvider option:selected").text();
RR.session("PENSION_TRANSFER_FORM",RR.components.form2object("#form-purchase")).done(function(){RR.session(f).done(function(){RR.url.redirect("PENSION_WRAPPER_CONFIRM_TERMS")
})
})
}};
c.onTypeOfPensionChange=function(f){var g=d(f.target).val(),h=d(".actions-primary button");
if(g==="None"){h.hide()
}else{h.show()
}};
return c
}(jQuery));
RR.pages.PENSION_WRAPPER_CONFIRM_TERMS=(function(g){var f={};
var c={};
var e="";
var b=g("form#termsAndConditions");
var d;
var h,a;
f.init=function(){b.parsley("addListener",{onFormSubmit:f.onFormSubmit});
a=new RR.api.Account(RR.session("email"),"CONFIRMED_AUTO_UPGRADE");
g("#autoTermsPanel").hide();
f.productId=RR.session("productId");
if(f.productId){e=new RR.api.Product(f.productId);
f.getProductDetails()
}else{return
}g("body").on("click","#amend-transfer",function(i){i.preventDefault();
RR.url.goBack()
})
};
f.gettermsAndCondition=function(){var i=a.gettermscondition();
i.done(function(j,k){if(_.isEmpty(k)){g("#autoTermsPanel").show()
}})
};
f.onFormSubmit=function(l,k,i){k.preventDefault();
var m=g("#employeePensionScheme").val()<=2;
var j=g("[for=permanent-residence-yes]").hasClass("checked");
if(!j){l=false;
scrollToElement(("[for=permanent-residence-yes]"))
}if(l){f.conslidateProduct(m);
f.posttermsAndCondition()
}};
f.posttermsAndCondition=function(){if(g("input[name='confirm_auto_terms']").prop("checked")===true){var i={productType:"ISA",journeyType:"EXISTING_CUSTOMER_SHOP",consentType:"CONFIRMED_AUTO_UPGRADE"};
a.posttermscondition(i)
}};
f.conslidateProduct=function(k){var j;
var i=RR.session("transferDetails");
i.occPenSchemeOptOutFlag=k;
if(!i.assetId){i.consolidationSource="NEW_ASSET"
}else{i.consolidationSource="EXISTING_MEMO_ASSET"
}j=e.consolidate(i);
j.done(function(l,m){if(l===200){RR.session("PENSION_TRANSFER_FORM",{}).done(function(){RR.session("transferDetails",{}).done(function(){RR.session("transferReceived",{consolidateId:m.id,productId:f.productId}).done(function(){RR.plugins.notifications.setNotificationFlag("SIPPCONSOLIDATE").done(function(){RR.url.redirect("SAVINGS")
})
})
})
})
}})
};
f.getProductDetails=function(){var i;
var j;
i=e.get({source:f.assetSource});
i.done(function(k,l){if(k===200){c.selectedFund=l.selectedFund;
d=l.selectedFund;
h=l.fund.displayName;
if(l.source==="RR"&&l.fund.type==="OTHER"){f.gettermsAndCondition()
}f.getUserDetails()
}})
};
f.getUserDetails=function(){var i=RR.session("email");
var l=new RR.api.Customer(i);
var j;
var k;
j=l.details();
j.done(function(m,n){if(m===200){c.userDetails=n;
f.renderTemplate();
f.renderIllustrations()
}})
};
f.renderTemplate=function(){var k=RR.templateVars||{};
var l=c.userDetails;
if(d){g("#fundLabel").text(g("#fundLabel").data("fund"+c.selectedFund.toLowerCase()))
}else{g(".fund-selected").parent().addClass("fund-upgrade");
g(".fund-selected").removeClass().addClass("fund-selected fund-selected-square fund-aegon fund-aegon-nopos");
g(".fund-selected .selected p").text("");
g(".fund-selected .selected p").append("<cite>"+h+"</cite>");
g(".fund-selected .selected p").append('<span class="ico" aria-hidden="true">&#xf73c;</span>')
}var j="";
if(l.addresses){j=l.addresses[0].houseNameNumber;
j+="<br/>"+l.addresses[0].addressLine1;
j+="<br/>"+l.addresses[0].townCity+" "+l.addresses[0].country;
j+="<br/>"+l.addresses[0].postcode
}k.activeUser={name:l.firstname+" "+l.surname,dob:l.dateOfBirth[2]+"/"+l.dateOfBirth[1]+"/"+l.dateOfBirth[0],nin:RR.utils.chunk(l.niNumber,2),address:j,employementStatus:l.employmentStatus};
var i=RR.session("transferDetails");
if(i){if(i.fundProviderId){k.activeUser.curentProvider=RR.session("providersText")
}else{if(i.fundProviderName){k.activeUser.curentProvider=i.fundProviderName
}}k.activeUser.transferAccNo=i.accountNumber;
k.activeUser.transferPensionValue=RR.utils.formatStringAsCurrency(i.amount,"")
}if(RR.plugins.templates){RR.plugins.templates.render()
}RR.utils.replaceClass(" .panel .fund-selected","fund-2","fund-"+RR.utils.fundToInt(c.selectedFund))
};
f.renderIllustrations=function(){var i=g("#illustrationDummyDocument").hide(),k=new RR.api.Policy("rr",""),j=k.illustration({basicProjectionOptions:{illustrationType:"T",productType:RR.session("transferDetails").type,accountId:RR.session("productId"),fundOption:d,fundValue:RR.session("transferDetails").amount,fundTransferOperation:"TRANSFER"}});
j.done(function(l,m){if(l===200){i.find("a").attr("href",m.filePath);
i.find(".file-descriptor").html("PDF");
i.find(".file-date").text(moment().format("D MMMM YYYY"));
i.show()
}})
};
return f
}(jQuery));
RR.pages.SHOP_PAGES_OUR_INVESTMENT_FUNDS=(function(b){var a={};
a.init=function(){RR.plugins.RISK_PROFILER.setPolicyNumber(RR.session("policyNumber"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
b('[name="button"]').on("click",function(){});
b(".projections-panel").show();
if(RR.utils.isUserLoggedIn()){b("#selected-fund-details .feature-box:first").hide()
}else{b("#selected-fund-details .feature-box.secure-content").hide()
}};
return a
}(jQuery));
RR.pages.SUPPORT=(function(b){var a={};
a.loadPopularFaqs=function(){var e=window.popularFAQsQueryString||"";
var c="/bin/querybuilder.json?"+e,d=b.get(c);
return d
};
a.displayPopularFaqs=function(f){var d='<li><a href="{{url}}">{{title}}<span aria-hidden="true" class="ico">&#xf719;</span></a></li>',g="<li>{{message}}</li>",i={message:"No popular FAQs found."},e=RR.url.pathRoot,h=".html",c=b("#popular-faq-list");
if(f.success===true){if(f.results===0){c.append(_.template(g,i))
}else{b.each(f.hits,function(k,l){var j={url:l.path.replace(e,"")+h,title:l.title};
c.append(_.template(d,j))
})
}}else{a.popularLoadError("Error loading popular FAQs.")
}return this
};
a.popularLoadError=function(e){var c=b("#popular-faq-list"),f={message:e},d="<li>{{message}}</li>";
c.append(_.template(d,f));
RR.utils.debugMessage(e)
};
a.initNavTabs=function(){b('.nav-tabs-btn a[data-toggle="tab"]').on("shown",function(c){window.location.hash="!tab_"+c.target.hash.substr(1);
b('input[name="q"]').val("");
return false
});
if(window.location.hash!==""){b('.nav-tabs-btn a[href="'+location.hash.replace("!tab_","")+'"]').tab("show")
}else{b(".nav-tabs-btn a:first").tab("show")
}};
a.setSupportPageDesign=function(){if(b("#accordion1 .accordion-body").height()===0){b("#accordion1 .accordion-body").height("auto")
}};
a.initEvents=function(){b('[href="#all"]').on("click",function(){a.setSupportPageDesign()
});
b(window).on("hashchange",function(){var c="#!tab_",e=window.location.hash,d;
if(e.length>0){d="#"+e.substr(c.length)
}else{d=b(".nav-tabs-btn li:first-child a").attr("href")
}b('.nav-tabs-btn a[href="'+d+'"]').click()
})
};
a.init=function(){var c=a.loadPopularFaqs();
c.done(function(e){a.displayPopularFaqs(e);
var d=RR.utils.detectDevice();
if(d!=="phone"){b("#accordion1 .accordion-body").collapse("show")
}else{b("#accordion1 .accordion-body").collapse("hide")
}});
c.fail(function(d){a.popularLoadError("Error loading popular FAQs.")
});
b(window).on("debouncedresize",function(){var d=RR.utils.detectDevice();
if(d!=="phone"){b("#accordion1 .accordion-body").collapse("show")
}else{b("#accordion1 .accordion-body").collapse("hide")
}});
a.initNavTabs();
RR.pages.FAQS.init();
a.initEvents();
if(window.platform.name==="IE"){b("header .btn-back").remove()
}};
return a
}(jQuery));
RR.pages.SUPPORT_SIGN_OUT=(function(b){var a={};
a.loadPopularFaqs=function(){var e=window.popularFAQsQueryString||"";
var c="/bin/querybuilder.json?"+e,d=b.get(c);
return d
};
a.displayPopularFaqs=function(f){var d='<li><a href="{{url}}">{{title}}<span aria-hidden="true" class="ico">&#xf719;</span></a></li>',g="<li>{{message}}</li>",i={message:"No popular FAQs found."},e=RR.url.pathRoot,h=".html",c=b("#popular-faq-list");
if(f.success===true){if(f.results===0){c.append(_.template(g,i))
}else{b.each(f.hits,function(k,l){var j={url:l.path.replace(e,"")+h,title:l.title};
c.append(_.template(d,j))
})
}}else{a.popularLoadError("Error loading popular FAQs.")
}return this
};
a.popularLoadError=function(e){var c=b("#popular-faq-list"),f={message:e},d="<li>{{message}}</li>";
c.append(_.template(d,f));
RR.utils.debugMessage(e)
};
a.initNavTabs=function(){b('.nav-tabs-btn a[data-toggle="tab"]').on("shown",function(c){window.location.hash="!tab_"+c.target.hash.substr(1);
b('input[name="q"]').val("");
return false
});
if(window.location.hash!==""){b('.nav-tabs-btn a[href="'+location.hash.replace("!tab_","")+'"]').tab("show")
}else{b(".nav-tabs-btn a:first").tab("show")
}};
a.setSupportPageDesign=function(){if(b("#accordion1 .accordion-body").height()===0){b("#accordion1 .accordion-body").height("auto")
}};
a.initEvents=function(){b('[href="#all"]').on("click",function(){a.setSupportPageDesign()
});
b(window).on("hashchange",function(){var c="#!tab_",e=window.location.hash,d;
if(e.length>0){d="#"+e.substr(c.length)
}else{d=b(".nav-tabs-btn li:first-child a").attr("href")
}b('.nav-tabs-btn a[href="'+d+'"]').click()
})
};
a.init=function(){var c=a.loadPopularFaqs();
c.done(function(e){a.displayPopularFaqs(e);
var d=RR.utils.detectDevice();
if(d!=="phone"){b("#accordion1 .accordion-body").collapse("show")
}else{b("#accordion1 .accordion-body").collapse("hide")
}});
c.fail(function(d){a.popularLoadError("Error loading popular FAQs.")
});
b(window).on("debouncedresize",function(){var d=RR.utils.detectDevice();
if(d!=="phone"){b("#accordion1 .accordion-body").collapse("show")
}else{b("#accordion1 .accordion-body").collapse("hide")
}});
a.initNavTabs();
RR.pages.FAQS.init();
a.initEvents();
if(window.platform.name==="IE"){b("header .btn-back").remove()
}};
return a
}(jQuery));
RR.pages.SHOP_ISA_BEFORE_YOU_APPLY=(function(d){var c={},a,b;
c.init=function(){a=RR.url.parameter("t");
b=c.setPurchaseRoute();
c.apiHelper();
c.initTransferCheckbox();
c.initEvents()
};
c.initEvents=function(){d("input[type=checkbox]").click(function(){if(this.checked){d(".actions-primary button").attr("data-href",RR.route("SHOP_ISA_TRANSFER_INFO"))
}else{d(".actions-primary button").attr("data-href",RR.route(b))
}})
};
c.initTransferCheckbox=function(){if(a){d("input[type=checkbox]").attr("checked","checked").parent().addClass("c_on");
d(".actions-primary button").attr("data-href",RR.route("SHOP_ISA_TRANSFER_INFO"))
}};
c.apiHelper=function(){if(!RR.utils.isUserLoggedIn()){return
}var h=RR.session("email");
var e=RR.api.Account(h);
var g=e.products({}),i=false,f=false;
g.done(function(j,k){if(_.isArray(k.products)&&!_.isEmpty(k.products)){i=_.some(k.products,function(l){return l.type==="ISA"&&l.source==="RR"
});
if(i){d("#panel-form-component-id .form-confirmation").hide();
d("input[type=checkbox]").attr("disabled",true)
}_.some(k.products,function(l){if(l.source==="RR"){if(l.type==="PENSION"&&l.fund.type==="OTHER"){RR.session("autoUpgradeUser",true)
}}})
}if(_.isArray(k.pendingProducts)&&!_.isEmpty(k.pendingProducts)){f=_.some(k.pendingProducts,function(l){return l.productType==="ISA"
});
if(f){d("#processing-notification").removeClass("hidden");
d("button[name=update-now]").attr("disabled",true)
}}})
};
c.setPurchaseRoute=function(){if(RR.session("loggedIn")){return"REGISTERED_CUSTOMER_PURCHASE_ISA"
}else{return"NEW_CUSTOMER_PURCHASE_ISA"
}};
return c
}(jQuery));
RR.pages.SHOP_ISA_TRANSFER_INFO=(function(b){var a={};
a.init=function(){if(RR.session("loggedIn")){a.getSavingProducts()
}b("[name=get-started]").on("click",function(c){b(RR).trigger("headway:showSpinner",[true])
})
};
a.getSavingProducts=function(){var c=RR.session("email");
var f=new RR.api.Account(c);
var d;
var e;
d=f.products({});
d.done(function(g,h){if(h.products){a.loggedUserJourney(h.products)
}})
};
a.loggedUserJourney=function(d){var e=false;
var c={};
b.each(d,function(f,g){if(g.source==="RR"&&g.fund.type==="OTHER"){RR.session("autoUpgradeUser","true")
}if(g.type==="ISA"&&g.source==="RR"){e=true;
c.productId=g.id
}});
if(e){b("[name=get-started]").unbind("click").click(function(){b(RR).trigger("headway:showSpinner",[true]);
RR.url.redirect("ISA_WRAPPER",c)
})
}};
return a
}(jQuery));
RR.pages.SHOP_PENSION_BEFORE_YOU_APPLY=(function(d){var c={},a,b;
c.init=function(){a=RR.url.parameter("t");
b=c.setPurchaseRoute();
c.apiHelper();
c.initTransferCheckbox();
c.initEvents()
};
c.initEvents=function(){d("input[type=checkbox]").click(function(){if(this.checked){d(".actions-primary button").attr("data-href",RR.route("SHOP_PENSION_TRANSFER_INFO"))
}else{d(".actions-primary button").attr("data-href",RR.route(b))
}})
};
c.initTransferCheckbox=function(){if(a){d("input[type=checkbox]").attr("checked","checked").parent().addClass("c_on");
d(".actions-primary button").attr("data-href",RR.route("SHOP_PENSION_TRANSFER_INFO"))
}};
c.apiHelper=function(){if(!RR.utils.isUserLoggedIn()){return
}var h=RR.session("email");
var e=RR.api.Account(h);
var g=e.products({}),i=false,f=false;
g.done(function(j,k){if(_.isArray(k.products)&&!_.isEmpty(k.products)){i=_.some(k.products,function(l){return l.type==="PENSION"&&l.source==="RR"
});
if(i){d("#panel-form-component-id .form-confirmation").hide();
d("input[type=checkbox]").attr("disabled",true)
}}if(_.isArray(k.pendingProducts)&&!_.isEmpty(k.pendingProducts)){f=_.some(k.pendingProducts,function(l){return l.productType==="PENSION"
});
if(f){d("#processing-notification").removeClass("hidden");
d("button[name=update-now]").attr("disabled",true)
}}})
};
c.setPurchaseRoute=function(){if(RR.session("loggedIn")){return"REGISTERED_CUSTOMER_PURCHASE_PENSION"
}else{return"NEW_CUSTOMER_PURCHASE_PENSION"
}};
return c
}(jQuery));
RR.pages.SHOP_PENSION_TRANSFER_INFO=(function(b){var a={};
a.init=function(){if(RR.session("loggedIn")){a.getSavingProducts()
}b("[name=get-started]").on("click",function(c){b(RR).trigger("headway:showSpinner",[true])
})
};
a.getSavingProducts=function(){var c=RR.session("email");
var f=new RR.api.Account(c);
var d;
var e;
d=f.products({});
d.done(function(g,h){if(h.products){a.loggedUserJourney(h.products)
}})
};
a.loggedUserJourney=function(d){var e=false;
var c={};
b.each(d,function(f,g){if(g.source==="RR"&&g.fund.type==="OTHER"){RR.session("autoUpgradeUser","true")
}RR.session("autoTerms",g.acceptAutoUpgradeTerms);
if(g.type==="PENSION"&&g.source==="RR"){e=true;
c.productId=g.id
}});
if(e){b("[name=get-started]").unbind("click").click(function(){b(RR).trigger("headway:showSpinner",[true]);
RR.url.redirect("PENSION_WRAPPER",c)
})
}};
return a
}(jQuery));
RR.pages.SHOP_CONSOLIDATION=(function(b){var a={};
a.init=function(){a.initEvents()
};
a.initEvents=function(){b(".transferPension").on("click",this.onPensionTransferBtnClicked);
b(".transferIsa").on("click",this.onIsaTransferBtnClicked);
if(RR.utils.isUserLoggedIn()){b(".block-list-documents li").hide();
this.keydoc()
}else{b(".transferPension").attr("data-href",RR.route("NEW_CUSTOMER_PENSION"));
b(".transferIsa").attr("data-href",RR.route("NEW_CUSTOMER_ISA"));
b(".block-list-documents #wpsp,.block-list-documents #wpis,.block-list-documents #wptc").hide()
}};
a.keydoc=function(){var d=[];
var c=RR.url.parameter("keyDoc");
if(c){d=c.split(",");
b.each(d,function(e,f){b(".block-list-documents #"+d[e]).show()
})
}else{b(".block-list-documents #rrpn,.block-list-documents #rris,.block-list-documents #rrtc").show()
}};
a.onPensionTransferBtnClicked=function(c){c.preventDefault();
a.handleRedirect("PENSION","SHOP_PENSION_BEFORE_YOU_APPLY","NEW_CUSTOMER_PENSION","SUPPORT")
};
a.onIsaTransferBtnClicked=function(c){c.preventDefault();
a.handleRedirect("ISA","SHOP_ISA_BEFORE_YOU_APPLY","NEW_CUSTOMER_ISA","NEW_COMPARISON_ISA")
};
a.handleRedirect=function(j,l,d,e){if(RR.utils.isUserLoggedIn()){var o=false;
var c=false;
var f=false;
var m=false;
var h=RR.session("email")||"";
var k=new RR.api.Account(h);
var n=k.productsmap({}),g=false;
var i=false;
n.done(function(p,t){b.each(t.products.PENSION,function(u,v){v.type="PENSION"
});
b.each(t.products.ISA,function(u,v){v.type="ISA"
});
if(t.products.PENSION){for(var q=0;
q<t.products.PENSION.length;
q++){if(t.products.PENSION[q].source==="WORKPLACE"){o=true
}if(t.products.PENSION[q].source==="RR"){f=true
}}}if(t.products.ISA){for(var r=0;
r<t.products.ISA.length;
r++){if(t.products.ISA[r].source==="WORKPLACE"){c=true
}if(t.products.ISA[r].source==="RR"){m=true
}}}if(j==="PENSION"){if(f&&!o){a.doRedirect(l)
}else{if(o){RR.url.redirect(e)
}else{a.doRedirect(d)
}}}if(j==="ISA"){if(m&&!c&&!o){a.doRedirect(l)
}else{if(o||c){RR.url.redirect(e)
}else{a.doRedirect(d)
}}}});
n.fail(function(p){a.doRedirect(d)
})
}else{RR.url.redirect(d)
}};
a.doRedirect=function(c){var d={t:true};
RR.url.redirect(c,d)
};
return a
}(jQuery));
RR.pages.REGISTERED_CUSTOMER_PURCHASE_PENSION=(function(d,m){var h={},c=false,k,g,e,n=d("form#form-purchase"),b=d("[name=oneOffPayment]"),a=d("[name=monthlyPayment]"),f=d("#checkbox-boost"),j=d("#approxTransferValue_id");
var l=true;
var i=false;
h.clearBankDetailsErrors=function(){m.plugins.form.clearError("[name='bankDetails.accountNumber']");
d("[name='bankDetails.sortCode0']").closest(".control-group").removeClass("error");
d("[name='bankDetails.accountNumber']").off("keydown.clearBankDetailserrros");
d("[name='bankDetails.sortCode0']").off("keydown.clearBankDetailserrros");
d("[name='bankDetails.sortCode1']").off("keydown.clearBankDetailserrros");
d("[name='bankDetails.sortCode2']").off("keydown.clearBankDetailserrros")
};
h.createPolicy=function(o){if(o.typeOfPension&&o.typeOfPension!=="None"){i=true
}g=new m.api.Policy("rr");
g.create().done(function(w,u){var v=u.policyNumber;
var x=new m.api.Policy("rr",v);
var p={};
p.rpiConsent=n.find("[name=checkbox-boost]:checked").length?true:false;
var t=[];
var q;
var y;
if(o.monthlyPayment){q={frequency:"M",amount:parseFloat(o.monthlyPayment),pensionBoost:p.rpiConsent};
t.push(q)
}if(o.oneOffPayment){y={frequency:"S",amount:parseFloat(o.oneOffPayment)};
t.push(y)
}var A=[];
if(i===true){var B={amount:parseFloat(o.approxTransferValue),type:"PENSION",subType:o.typeOfPension};
A.push(B)
}var z;
if(l){z=[];
var r={bankAccountId:null,accountName:o.bankDetails.accountName,accountNumber:o.bankDetails.accountNumber,additionalSignatureRequest:o.bankDetails.dditionalSignatureRequest,sortCode:[o.bankDetails.sortCode0,o.bankDetails.sortCode1,o.bankDetails.sortCode2]};
z.push(r)
}x.customer({payments:t,transferDetails:A,confirmationDetails:p,bankDetails:z}).done(function(C,D){if(C===200){m.session({REGISTERED_CUSTOMER_PURCHASE_PENSION_FORM:o,policyNumber:v,email:o.email,fundValue:50000,purchase:{route:"PENSION",completedStep:1,policyNumber:D.policyNumber,oneOffPayment:o.oneOffPayment,monthlyPayment:o.monthlyPayment,confirmBoost:(o["checkbox-boost"]==="0"),registeredCustomer:true},hasTransferDetails:i,journey:null,selectedFund:null,registeredShop:true}).done(function(){m.url.redirect("REGISTERED_FUND_SELECTION_PENSION")
})
}})
})
};
h.onFormSubmit=function(t,r){r.preventDefault();
k=0;
var o=this;
var p=l;
if(d("#typeOfPension").val()==="None"){m.plugins.form.setError("#typeOfPension","notnull","Please select a valid pension type",1);
scrollToElement(("#confirmPensionTransfer"));
k++
}if(!h.validatePayment()){k++
}if(p){d("[name='bankDetails.sortCode0']").trigger("focusout");
d("[name='bankDetails.sortCode1']").trigger("focusout");
d("[name='bankDetails.sortCode2']").trigger("focusout");
if(d(".error [name='bankDetails.sortCode0']").length){k++
}}if(!k&&t){e=m.components.form2object("form#form-purchase");
i=false;
if(p){var q=m.post("/bankdetails/validate",[200,406],{data:{bankDetails:{accountNumber:e.bankDetails.accountNumber,sortCode:[e.bankDetails.sortCode0,e.bankDetails.sortCode1,e.bankDetails.sortCode2]}}});
q.done(function(u,v){if(u===200&&v.bankDetailsValid===true){h.createPolicy(e)
}else{d(".btn-processing").addClass("hidden");
d(".actions-primary .btn-primary").removeClass("hidden");
m.plugins.form.setError("[name='bankDetails.accountNumber']","invalidbankdetails","The bank details provided are invalid.",1);
d("[name='bankDetails.sortCode0']").closest(".control-group").addClass("error");
d("[name='bankDetails.accountNumber']").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors);
d("[name='bankDetails.sortCode0']").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors);
d("[name='bankDetails.sortCode1']").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors)
}})
}else{h.createPolicy(e)
}}};
h.validatePayment=function(){var p=parseFloat(b.val())||0;
var o=parseFloat(a.val())||0;
var q=parseFloat(j.val())||0;
if(b.parsley("isValid")===null&&a.parsley("isValid")===null&&!j.val()){c=true;
m.plugins.form.setError(b,"nopayment","You need to enter at least one payment method.",1);
m.plugins.form.setError(a,"nopayment","You need to enter at least one payment method.",1);
scrollToElement(("input[name='oneOffPayment']"));
return false
}else{if(p<=0&&o<=0&&q<=0){scrollToElement(a);
m.plugins.form.setError(b,"nopayment","At least one payment amount should be greater than zero.",1);
m.plugins.form.setError(a,"nopayment","At least one payment amount should be greater than zero.",1);
m.plugins.form.setError(j,"nopayment","At least one payment amount should be greater than zero.",1);
c=true;
return false
}else{if(c){c=false;
m.plugins.form.clearError(b);
m.plugins.form.clearError(a)
}return true
}}};
h.populateFields=function(){var o=m.session("purchase");
if(o!==undefined&&o.route==="PENSION"){b.val(o.oneOffPayment);
a.val(o.monthlyPayment);
f.attr("checked",o.confirmBoost)
}};
h.getCustomerDetails=function(){var o=m.session("email");
var p=new m.api.Customer(o);
p.details().done(function(r,q){if(r===200){if((q.bankDetails).length){d("#bankDetails").hide();
l=false
}else{d("#bankDetails").show();
l=true
}}})
};
h.initEvents=function(){b.on("change.REGISTERED_CUSTOMER_PURCHASE_PENSION focusout keyup",function(){h.validatePayment()
});
a.on("change.REGISTERED_CUSTOMER_PURCHASE_PENSION focusout keyup",function(){h.validatePayment()
});
j.on("focusout keyup",function(){h.validatePayment()
});
n.parsley("addListener",{onFormSubmit:h.onFormSubmit})
};
h.init=function(){h.populateFields();
h.getCustomerDetails();
h.initEvents()
};
return h
}(jQuery,RR));
RR.pages.GOALS_DASHBOARD=(function(b){var a={};
a.init=function(){if(!RR.utils.isAuthor()){if(RR.utils.isUserLoggedIn()){b("#redirectPublicshop").hide()
}else{b("#redirectLifplanner").hide()
}}};
return a
}(jQuery));
RR.pages.GOALS_LANDING=(function(b){var a={};
a.init=function(){if(RR.session.exists()&&!RR.utils.isAuthor()){var d=new RR.api.Score();
var c=d.retrieveScore();
c.done(function(e,g,f){if(e===200){b(RR).trigger("headway:showSpinner");
RR.url.redirect("GOALS_DASHBOARD")
}})
}};
return a
}(jQuery));
RR.pages.REGISTERED_FUND_SELECTION_PENSION=(function(b){var a={};
a.init=function(){RR.plugins.RISK_PROFILER.setSelectedFund();
RR.plugins.RISK_PROFILER.setPolicyNumber(RR.session("policyNumber"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
b("#fund-selection-checkbox").html(b("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
b("#continue-button-wrapper").html(b("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"))
};
return a
}(jQuery));
RR.pages.REGISTERED_FUND_SELECTION_ISA=(function(b){var a={};
a.init=function(){RR.plugins.RISK_PROFILER.setSelectedFund();
RR.plugins.RISK_PROFILER.setPolicyNumber(RR.session("policyNumber"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
b("#fund-selection-checkbox").html(b("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
b("#continue-button-wrapper").html(b("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"))
};
return a
}(jQuery));
RR.pages.REGISTERED_CUSTOMER_PENSION_CONFIRM_DETAILS=(function(e){var d={},c,b=e("#remove-transfer"),f=e("#approxTransferValue_id"),a=0.01;
d.onFormSubmit=function(j,i,h){var k=new RR.api.Policy("rr",RR.session("policyNumber"));
var g={};
i.preventDefault();
if(j){g=RR.components.form2object("#transferPensionDetailsPanel",["amountPaidThisYear","approxTransferValue","providers","transferAccountNumber","typeOfPension","confirmPensionNotIncludes","otherProvider"],function(l){if(l){l.transferDetails=[];
var m={amount:parseFloat(l.approxTransferValue),type:"PENSION",subType:l.typeOfPension,accountNumber:l.transferAccountNumber,amountPaidInThisYear:parseInt(l.amountPaidThisYear,10),fundProviderName:(l.providers==="Other")?l.otherProvider||l.otherProvider_pension:l.providers};
l.transferDetails.push(m);
RR.session("hasTransferDetails","true")
}});
if(_.isEmpty(g)){RR.session("hasTransferDetails","false");
g.transferDetails=null
}k.customer(g).done(function(l,m){var o=RR.components.form2object("#transferPensionDetailsPanel");
if(o){var n="#selectedProvider";
o.providersText=e(n+" option:selected").text();
RR.session("REGISTERED_CUSTOMER_CONFIRM_DETAILS_FORM",o).done(function(){RR.url.redirect("REGISTERED_CUSTOMER_PENSION_TERMS")
})
}else{RR.url.redirect("REGISTERED_CUSTOMER_PENSION_TERMS")
}})
}return false
};
d.validateTransferDetails=function(h,g){if(h){d.showSubmitButton(g,true)
}else{return false
}};
d.toggleRemoveTransferButton=function(){var i=RR.session("purchase")||{};
var h=parseFloat(i.oneOffPayment)||0;
var g=parseFloat(i.monthlyPayment)||0;
if(h<=0&&g<=0){b.hide()
}};
d.initMinValues=function(){f.parsley("addConstraint",{min:a})
};
d.init=function(){e("#transferPensionDetailsPanel").parsley("addListener",{onFormSubmit:d.onFormSubmit});
RR.utils.checkIfMarkupExists(!f.is("[min]"),d.initMinValues);
d.toggleRemoveTransferButton()
};
d.setFlashForWithdrawType=function(){var g={data:{emailAddress:RR.session("email")},modal:"moneyOutCancelConfirmation"};
return RR.session("flash",g)
};
return d
}(jQuery));
RR.pages.REGISTERED_CUSTOMER_ISA_CONFIRM_DETAILS=(function(e){var d={},c,b=e("#remove-transfer_isa"),f=e("#approxTransferValue_isa"),a=0.01;
d.onFormSubmit=function(j,i,h){var k=new RR.api.Policy("rr",RR.session("policyNumber"));
var g;
i.preventDefault();
if(j){g=RR.components.form2object("#transferISAPanel",["amountPaidThisYear","approxTransferValue","providers","transferAccountNumber","typeOfISA","otherProvider"],function(l){if(l){l.transferDetails=[];
var m={amount:parseFloat(l.approxTransferValue,10),type:"ISA",subType:l.typeOfISA,accountNumber:l.transferAccountNumber,amountPaidInThisYear:parseInt(l.amountPaidThisYear,10),fundProviderName:(l.providers==="Other")?l.otherProvider||l.otherProvider_isa:l.providers};
l.transferDetails.push(m);
RR.session("hasTransferDetails","true")
}});
if(_.isEmpty(g)){RR.session("hasTransferDetails","false");
g.transferDetails=null
}k.customer(g).done(function(l,m){var o=RR.components.form2object("#transferISAPanel");
if(o){var n="#selectedProvider_isa";
o.providersText=e(n+" option:selected").text();
RR.session("REGISTERED_CUSTOMER_CONFIRM_DETAILS_FORM",o).done(function(){RR.url.redirect("REGISTERED_CUSTOMER_ISA_TERMS")
})
}else{RR.url.redirect("REGISTERED_CUSTOMER_ISA_TERMS")
}})
}return false
};
d.validateTransferDetails=function(h,g){if(h){d.showSubmitButton(g,true)
}else{return false
}};
d.toggleRemoveTransferButton=function(){var i=RR.session("purchase")||{};
var h=parseFloat(i.oneOffPayment)||0;
var g=parseFloat(i.monthlyPayment)||0;
if(h<=0&&g<=0){b.hide()
}};
d.initMinValues=function(){f.parsley("addConstraint",{min:a})
};
d.init=function(){e("#transferISAPanel").parsley("addListener",{onFormSubmit:d.onFormSubmit});
RR.utils.checkIfMarkupExists(!f.is("[min]"),d.initMinValues);
d.toggleRemoveTransferButton()
};
return d
}(jQuery));
RR.pages.REGISTERED_CUSTOMER_PENSION_TERMS=(function(d,b){var c={};
var e;
var a=d("form#termsAndConditions");
c.init=function(){var h=d("[name=sourceOfWealthOneOffContributionLimit]").val()?Number(d("[name=sourceOfWealthOneOffContributionLimit]").val()):75000,g=d("[name=sourceOfWealthRegularContributionLimit]").val()?Number(d("[name=sourceOfWealthRegularContributionLimit]").val()):2000,i=b.session("purchase").oneOffPayment?Number(b.session("purchase").oneOffPayment):0,f=b.session("purchase").monthlyPayment?Number(b.session("purchase").monthlyPayment):0;
e=new b.api.Policy("rr",b.session("policyNumber"));
var j="CustomerDetails";
d(b).on("data"+j,c.renderTemplate);
d(b).trigger("uiNeedsCustomerDetails");
c.renderIllustrations();
a.parsley("addListener",{onFormSubmit:c.onFormSubmit});
b.utils.replaceClass(" .panel .fund-selected","fund-2","fund-"+b.utils.fundToInt(b.session("selectedFund")));
if(!b.session("REGISTERED_CUSTOMER_PURCHASE_PENSION_FORM").monthlyPayment){d("#directDebitGuarentee").hide()
}if(i<h&&f<g){d("#paymentSizeAlert").hide()
}d("#amend-personal").on("click",function(){d(window).off("beforeunload")
});
d("#amend-bank").on("click",function(){d(window).off("beforeunload")
});
d("#amend-fund").on("click",function(){d(window).off("beforeunload")
})
};
c.renderTemplate=function(j,f){var g=b.templateVars||{};
var i;
var m=b.session("REGISTERED_CUSTOMER_CONFIRM_DETAILS_FORM");
var l=b.session("hasTransferDetails");
i=f;
if(i.addresses[0].addressLine2!==null){i.addresses[0].addressLine2=", "+i.addresses[0].addressLine2
}else{i.addresses[0].addressLine2=""
}var k=b.session("REGISTERED_CUSTOMER_PURCHASE_PENSION_FORM");
if(!(i.bankDetails).length){var n={bankAccountId:null,accountName:k.bankDetails.accountName,accountNumber:k.bankDetails.accountNumber,additionalSignatureRequest:f.bankDetails.dditionalSignatureRequest,sortCode:[k.bankDetails.sortCode0,k.bankDetails.sortCode1,k.bankDetails.sortCode2]};
i.bankDetails.push(n)
}var h=b.session("purchase");
g.activeUser={name:i.firstname+" "+i.surname,gender:i.gender,nationality:i.nationality,employmentStatus:i.employmentStatus,address:i.addresses[0].houseNameNumber+", "+i.addresses[0].addressLine1+i.addresses[0].addressLine2,townCity:i.addresses[0].townCity,postcode:i.addresses[0].postcode,email:i.emailAddress,dob:i.dateOfBirth[2]+"/"+i.dateOfBirth[1]+"/"+i.dateOfBirth[0],nin:b.utils.chunk(i.niNumber,2),accountName:i.bankDetails[0].accountName,accountNumber:i.bankDetails[0].accountNumber,sortCode:b.utils.formatSortCode(i.bankDetails[0].sortCode[0],i.bankDetails[0].sortCode[1],i.bankDetails[0].sortCode[2]),monthlyPayment:b.utils.formatStringAsCurrency(h.monthlyPayment,""),oneOffPayment:b.utils.formatStringAsCurrency(h.oneOffPayment,""),fund:d("#fundLabel").data("fund"+b.session("selectedFund").toLowerCase())};
b.session("email",i.emailAddress);
l=b.session("hasTransferDetails")?b.session("hasTransferDetails"):false;
if(l){if(m.providers==="Other"){g.activeUser.curentProvider=m.otherProvider
}else{g.activeUser.curentProvider=m.providersText
}g.activeUser.transferAccNo=m.transferAccountNumber;
g.activeUser.transferPensionValue=b.utils.formatStringAsCurrency(m.approxTransferValue,"")
}else{d(".detail-list").eq(2).remove()
}if(b.plugins.templates){b.plugins.templates.render()
}b.utils.rrHide()
};
c.collectConfirmationDetails=function(f){var h={};
var g=f.serializeObject();
h.sourceOfWealth=g.sourceOfWealth===d("[name=sourceOfWealth]").find("option").last().val()?g.sourceOfWealthOther:g.sourceOfWealth;
h.acceptKeyFeatures=f.find("[name=acceptTsAndCs]:checked").length?true:false;
return h
};
c.collectPersonalDetails=function(g){var f={};
var h=g.serializeObject();
f.employmentStatus=h.employmentStatus;
return f
};
c.sendConfirmationDetails=function(h,f){var g=e.customer({confirmationDetails:h,personalDetails:f},true);
g.done(function(i){e.purchase({policyType:"rr",policyNumber:b.session("policyNumber")}).done(function(j){if(j===200){c.setFlashForPurchaseConfirmation().done(function(){window.location=b.route("HOME")
})
}}).fail(function(){})
});
g.fail(function(){})
};
c.onFormSubmit=function(j,i,g){var k;
var f;
i.preventDefault();
var h=d("[for=permanent-residence-yes]").hasClass("checked");
if(!h){j=false;
scrollToElement(("[for=permanent-residence-yes]"))
}if(j){k=c.collectConfirmationDetails(g.$element);
f=c.collectPersonalDetails(g.$element);
c.sendConfirmationDetails(k,f)
}};
c.renderIllustrations=function(){var f=d("#illustrationDummyDocument").hide(),g=e.illustration({basicProjectionOptions:{illustrationType:"N",productType:b.session("productType"),fundOption:b.session("selectedFund")}});
g.done(function(h,i){if(h===200){f.find("a").attr("href",i.filePath);
f.find(".file-descriptor").html("PDF");
f.find(".file-date").text(moment().format("D MMMM YYYY"));
f.show()
}})
};
c.setFlashForPurchaseConfirmation=function(){var f={data:{emailAddress:b.session("email")},modal:"purchase-complete-modal"};
return b.session("flash",f)
};
return c
})(jQuery,RR);
RR.pages.REGISTERED_CUSTOMER_ISA_TERMS=(function(e,c){var d={};
var f,b;
var a=e("form#termsAndConditions");
d.init=function(){var h=e("[name=sourceOfWealthContributionLimit]").val()?Number(e("[name=sourceOfWealthContributionLimit]").val()):1000;
var i=c.session("purchase").oneOffPayment?c.session("purchase").oneOffPayment:0;
var g=c.session("purchase").monthlyPayment?c.session("purchase").monthlyPayment:0;
f=new c.api.Policy("rr",c.session("policyNumber"));
e("#autoTermsPanel").hide();
b=new c.api.Account(c.session("email"),"CONFIRMED_AUTO_UPGRADE");
if(c.session("autoUpgradeUser")===true){d.gettermsAndCondition()
}var j="CustomerDetails";
e(c).on("data"+j,d.renderTemplate);
e(c).trigger("uiNeedsCustomerDetails");
d.renderIllustrations();
a.parsley("addListener",{onFormSubmit:d.onFormSubmit});
c.utils.replaceClass(" .panel .fund-selected","fund-2","fund-"+c.utils.fundToInt(c.session("selectedFund")));
if(!c.session("REGISTERED_CUSTOMER_PURCHASE_ISA_FORM").monthlyPayment){e("#directDebitGuarentee").hide()
}if(i<h&&g<h){e("#paymentSizeAlert").hide()
}e("#amend-personal").on("click",function(){e(window).off("beforeunload")
});
e("#amend-bank").on("click",function(){e(window).off("beforeunload")
});
e("#amend-fund").on("click",function(){e(window).off("beforeunload")
})
};
d.renderTemplate=function(k,g){var h=c.templateVars||{};
var i;
var n=c.session("REGISTERED_CUSTOMER_CONFIRM_DETAILS_FORM");
var m=c.session("hasTransferDetails");
i=g;
if(i.addresses[0].addressLine2!==null){i.addresses[0].addressLine2=", "+i.addresses[0].addressLine2
}else{i.addresses[0].addressLine2=""
}var l=c.session("REGISTERED_CUSTOMER_PURCHASE_ISA_FORM");
if(!(i.bankDetails).length){var o={bankAccountId:null,accountName:l.bankDetails.accountName,accountNumber:l.bankDetails.accountNumber,additionalSignatureRequest:g.bankDetails.dditionalSignatureRequest,sortCode:[l.bankDetails.sortCode0,l.bankDetails.sortCode1,l.bankDetails.sortCode2]};
i.bankDetails.push(o)
}var j=c.session("purchase");
h.activeUser={name:i.firstname+" "+i.surname,gender:i.gender,nationality:i.nationality,employmentStatus:i.employmentStatus,address:i.addresses[0].houseNameNumber+", "+i.addresses[0].addressLine1+i.addresses[0].addressLine2,townCity:i.addresses[0].townCity,postcode:i.addresses[0].postcode,email:i.emailAddress,dob:i.dateOfBirth[2]+"/"+i.dateOfBirth[1]+"/"+i.dateOfBirth[0],nin:c.utils.chunk(i.niNumber,2),accountName:i.bankDetails[0].accountName,accountNumber:i.bankDetails[0].accountNumber,sortCode:c.utils.formatSortCode(i.bankDetails[0].sortCode[0],i.bankDetails[0].sortCode[1],i.bankDetails[0].sortCode[2]),monthlyPayment:c.utils.formatStringAsCurrency(j.monthlyPayment,""),oneOffPayment:c.utils.formatStringAsCurrency(j.oneOffPayment,""),fund:e("#fundLabel").data("fund"+c.session("selectedFund").toLowerCase())};
c.session("email",i.emailAddress);
m=c.session("hasTransferDetails")?c.session("hasTransferDetails"):false;
if(m){if(n.providers==="Other"){h.activeUser.curentProvider=n.otherProvider_isa
}else{h.activeUser.curentProvider=n.providersText
}h.activeUser.transferAccNo=n.transferAccountNumber;
h.activeUser.transferIsaValue=c.utils.formatStringAsCurrency(n.approxTransferValue,"")
}else{e(".detail-list").eq(2).remove()
}if(c.plugins.templates){c.plugins.templates.render()
}c.utils.rrHide()
};
d.collectConfirmationDetails=function(g){var i={};
var h=g.serializeObject();
i.sourceOfWealth=h.sourceOfWealth===e("[name=sourceOfWealth]").find("option").last().val()?h.sourceOfWealthOther:h.sourceOfWealth;
i.acceptKeyFeatures=g.find("[name=acceptTsAndCs]:checked").length?true:false;
return i
};
d.sendConfirmationDetails=function(h){var g=f.customer({confirmationDetails:h});
g.done(function(i){f.purchase({policyType:"rr",policyNumber:c.session("policyNumber")}).done(function(j){if(j===200){d.setFlashForPurchaseConfirmation().done(function(){window.location=c.route("HOME")
})
}}).fail(function(){})
});
g.fail(function(){})
};
d.onFormSubmit=function(j,i,g){var k;
i.preventDefault();
var h=e("[for=permanent-residence-yes]").hasClass("checked");
if(!h){j=false;
scrollToElement(("[for=permanent-residence-yes]"))
}if(j){k=d.collectConfirmationDetails(g.$element);
d.sendConfirmationDetails(k);
d.posttermsAndCondition()
}};
d.renderIllustrations=function(){var g=e("#illustrationDummyDocument").hide(),h=f.illustration({basicProjectionOptions:{illustrationType:"N",productType:c.session("productType"),fundOption:c.session("selectedFund")}});
h.done(function(i,j){if(i===200){g.find("a").attr("href",j.filePath);
g.find(".file-descriptor").html("PDF");
g.find(".file-date").text(moment().format("D MMMM YYYY"));
g.show()
}})
};
d.setFlashForPurchaseConfirmation=function(){var g={data:{emailAddress:c.session("email")},modal:"purchase-complete-modal"};
return c.session("flash",g)
};
d.gettermsAndCondition=function(){var g=b.gettermscondition();
g.done(function(h,i){if(_.isEmpty(i)){e("#autoTermsPanel").show()
}})
};
d.posttermsAndCondition=function(){if(e("input[name='confirm_auto_terms']").prop("checked")===true){var g={productType:"ISA",journeyType:"EXISTING_CUSTOMER_SHOP",consentType:"CONFIRMED_AUTO_UPGRADE"};
b.posttermscondition(g)
}};
return d
})(jQuery,RR);
RR.pages.REGISTERED_CUSTOMER_PURCHASE_ISA=(function(d,m){var h={};
var c=false;
var k;
var g;
var e;
var l=true;
var i=false;
var n=d("form#form-purchase"),b=d('[name="oneOffPayment"]'),a=d('[name="monthlyPayment"]'),f=d("#checkbox-boost"),j=d("#approxTransferValue_id");
h.clearBankDetailsErrors=function(){m.plugins.form.clearError("[name='bankDetails.accountNumber']");
d("[name='bankDetails.sortCode0']").closest(".control-group").removeClass("error");
d("[name='bankDetails.accountNumber']").off("keydown.clearBankDetailserrros");
d("[name='bankDetails.sortCode0']").off("keydown.clearBankDetailserrros");
d("[name='bankDetails.sortCode1']").off("keydown.clearBankDetailserrros");
d("[name='bankDetails.sortCode2']").off("keydown.clearBankDetailserrros")
};
h.createPolicy=function(o){if(o.typeOfISA&&o.typeOfISA!=="None"){i=true
}g=new m.api.Policy("rr");
g.create().done(function(w,u){var v=u.policyNumber;
var x=new m.api.Policy("rr",v);
var p={};
p.rpiConsent=n.find("[name=checkbox-boost]:checked").length?true:false;
var t=[];
var q;
var y;
if(o.monthlyPayment){q={frequency:"M",amount:parseFloat(o.monthlyPayment)};
t.push(q)
}if(o.oneOffPayment){y={frequency:"S",amount:parseFloat(o.oneOffPayment)};
t.push(y)
}var A=[];
if(i===true){var B={amount:parseFloat(o.approxTransferValue),type:"ISA",subType:o.typeOfISA};
A.push(B)
}var z;
if(l){z=[];
var r={bankAccountId:null,accountName:o.bankDetails.accountName,accountNumber:o.bankDetails.accountNumber,additionalSignatureRequest:o.bankDetails.dditionalSignatureRequest,sortCode:[o.bankDetails.sortCode0,o.bankDetails.sortCode1,o.bankDetails.sortCode2]};
z.push(r)
}x.customer({payments:t,transferDetails:A,confirmationDetails:p,bankDetails:z}).done(function(C,D){if(C===200){m.session({REGISTERED_CUSTOMER_PURCHASE_ISA_FORM:o,policyNumber:v,email:o.email,fundValue:50000,purchase:{route:"ISA",completedStep:1,policyNumber:D.policyNumber,oneOffPayment:o.oneOffPayment,monthlyPayment:o.monthlyPayment,registeredCustomer:true},hasTransferDetails:i,journey:null,selectedFund:null,registeredShop:true}).done(function(){m.url.redirect("REGISTERED_FUND_SELECTION_ISA")
})
}})
})
};
h.onFormSubmit=function(t,r){r.preventDefault();
k=0;
var o=this;
var p=l;
if(d("#typeOfISA").val()==="None"){m.plugins.form.setError("#typeOfISA","notnull","Please select a valid ISA type",1);
scrollToElement(("#confirmIsaTransfer"));
k++
}if(!h.validatePayment()){k++
}if(p){d("[name='bankDetails.sortCode0']").trigger("focusout");
d("[name='bankDetails.sortCode1']").trigger("focusout");
d("[name='bankDetails.sortCode2']").trigger("focusout");
if(d(".error [name='bankDetails.sortCode0']").length){k++
}}if(!k&&t){e=m.components.form2object("form#form-purchase");
i=false;
if(p){var q=m.post("/bankdetails/validate",[200,406],{data:{bankDetails:{accountNumber:e.bankDetails.accountNumber,sortCode:[e.bankDetails.sortCode0,e.bankDetails.sortCode1,e.bankDetails.sortCode2]}}});
q.done(function(u,v){if(u===200&&v.bankDetailsValid===true){h.createPolicy(e)
}else{d(".btn-processing").addClass("hidden");
d(".actions-primary .btn-primary").removeClass("hidden");
m.plugins.form.setError("[name='bankDetails.accountNumber']","invalidbankdetails","The bank details provided are invalid.",1);
d("[name='bankDetails.sortCode0']").closest(".control-group").addClass("error");
d("[name='bankDetails.accountNumber']").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors);
d("[name='bankDetails.sortCode0']").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors);
d("[name='bankDetails.sortCode1']").on("keydown.clearBankDetailserrros",h.clearBankDetailsErrors)
}})
}else{h.createPolicy(e)
}}};
h.validatePayment=function(){var p=parseFloat(b.val())||0;
var o=parseFloat(a.val())||0;
var q=parseFloat(j.val())||0;
if(b.parsley("isValid")===null&&a.parsley("isValid")===null&&!j.val()){c=true;
m.plugins.form.setError(b,"nopayment","You need to enter at least one payment method.",1);
m.plugins.form.setError(a,"nopayment","You need to enter at least one payment method.",1);
scrollToElement(("input[name='oneOffPayment']"));
return false
}else{if(p<=0&&o<=0&&q<=0){m.plugins.form.setError(b,"nopayment","At least one payment amount should be greater than zero.",1);
m.plugins.form.setError(a,"nopayment","At least one payment amount should be greater than zero.",1);
m.plugins.form.setError(j,"nopayment","At least one payment amount should be greater than zero.",1);
c=true;
return false
}else{if(c){c=false;
m.plugins.form.clearError(j);
m.plugins.form.clearError(b);
m.plugins.form.clearError(a)
}return true
}}};
h.populateFields=function(){var o=m.session("purchase");
if(o!==undefined&&o.route==="ISA"){b.val(o.oneOffPayment);
a.val(o.monthlyPayment);
f.attr("checked",o.confirmBoost)
}};
h.getCustomerDetails=function(){var o=m.session("email");
var p=new m.api.Customer(o);
p.details().done(function(r,q){if(r===200){if((q.bankDetails).length){d("#bankDetails").hide();
l=false
}else{d("#bankDetails").show();
l=true
}}})
};
h.initEvents=function(){b.on("change.REGISTERED_CUSTOMER_PURCHASE_ISA focusout keyup",function(){h.validatePayment()
});
a.on("change.REGISTERED_CUSTOMER_PURCHASE_ISA focusout keyup",function(){h.validatePayment()
});
j.on("focusout keyup",function(){h.validatePayment()
});
n.parsley("addListener",{onFormSubmit:h.onFormSubmit})
};
h.init=function(){h.populateFields();
h.getCustomerDetails();
h.initEvents()
};
return h
}(jQuery,RR));
RR.pages.AUTO_PROFILE=(function(f){var h={};
var k;
var j;
var a={};
var e={};
var i={};
var b;
var d;
var g;
function c(n,o){var m=[];
function l(q,r,p){_.each(r,function(t,u){var v=q[u];
var w=(p||p===0)?p+(isNaN(Number(u))?"."+u:"["+u+"]"):u;
if(_.isObject(t)){l(q[u],t,w)
}else{if(t!==q[u]){m.push(w)
}}})
}l(n,o);
return m
}h.onFormSubmit=function(n,m,l){var o;
m.preventDefault();
if(h.areAddressDetailsValid()===false){j.eq(1).find(".accordion-body").collapse("show");
return false
}if(h.areContactDetailsValid()===false){j.eq(2).find(".accordion-body").collapse("show");
return false
}o=k.serializeObject();
i=f.extend(true,{},e);
i.confirmationDetails=i.confirmationDetails||{};
i.confirmationDetails.rpiConsent=(o.boostRPI==="1");
if(!i.contactDetails){i.contactDetails={}
}if(!i.confirmationDetails.contactPreferences){i.confirmationDetails.contactPreferences={}
}i.confirmationDetails.contactPreferences={email:k.find("[name=optionsCheckboxList1]:checked").length?true:false,post:k.find("[name=optionsCheckboxList2]:checked").length?true:false,sms:k.find("[name=optionsCheckboxList3]:checked").length?true:false,phone:k.find("[name=optionsCheckboxList4]:checked").length?true:false};
if(o.Gender==="Male"){i.personalDetails.gender="M"
}else{i.personalDetails.gender="F"
}i.contactDetails.emailAddress=o.emailAddress.replace(/\s/g,"");
i.confirmedEmailAddress=o.confirmEmailAddress.replace(/\s/g,"");
i.contactDetails.homePhoneNumber=o.homePhoneNumber.replace(/\s/g,"");
i.contactDetails.mobilePhoneNumber=o.mobilePhoneNumber.replace(/\s/g,"");
if(!i.personalDetails){i.personalDetails={}
}i.personalDetails.retirementAge=o.retirementAge;
i.personalDetails.nationality=f("[name=nationalityTog]:checked").val()==="GBR"?"GBR":o.nationality;
i.personalDetails.employmentStatus=o.employmentStatus;
i.personalDetails.dateOfBirth=RR.utils.convertDateFieldToNumericArray(k.find("input[name=Date]").val());
i.dirtyFields=["contactDetails","personalDetails","confirmationDetails.rpiConsent","confirmationDetails.contactPreferences","confirmationDetails.employeePensionScheme"];
h.validateCustomerEmail(function(){var p=RR.post("/policy/upgrade/"+RR.session("policyNumber")+"/customer",[200],{data:i});
p.done(function(q,r){RR.session({email:o.emailAddress.replace(/\s/g,""),confirmEmailAddress:o.confirmEmailAddress.replace(/\s/g,"")}).done(function(){RR.url.redirect("AUTO_SECURITY")
})
});
p.fail(function(){})
})
};
h.populateFormWithPolicyCustomerDetails=function(n,l){var m=RR.get("/policy/upgrade/"+l+"/customer",[200,404]);
m.done(function(p,o){if(p===200){e=f.extend(true,{},o);
h.populateCustomerDetails(n,o);
RR.session("regularPremiumDetails",o.regularPremiumDetails)
}});
m.fail(function(o,q,p){})
};
h.validateCustomerEmail=function(l){var n=k.find("[name=emailAddress]").val();
var o=new RR.api.Customer("");
var m=o.search({policyNumberOrEmail:n});
m.done(function(p){if(p===200){var q=(RR.route("CONTACT_US")+"?customerType=registered");
var r="<a href='"+q+"'>get in touch</a>";
RR.plugins.form.setError("[name=emailAddress]","","This email address is already in use, please "+r);
j.eq(2).find(".accordion-body").collapse("show");
f(RR).trigger("hideProcessingButton")
}else{if(_.isFunction(l)){l()
}}})
};
h.populateCustomerDetails=function(m,l){a=l;
if(!a.addressDetails){a.addressDetails=[]
}h.populateCustomerPersonalDetails(m,a.personalDetails);
h.populateCustomerAddressDetails(m,a.addressDetails[0]);
h.populateCustomerContactDetails(m,a.contactDetails);
h.initMinRetirementAgeValidation()
};
h.populateCustomerPersonalDetails=function(m,l){var n;
n=l.nationality===null?"":l.nationality;
if(l.gender==="M"){f("#Gender_id").attr("value","Male")
}if(l.gender==="F"){f("#Gender_id").attr("value","Female")
}l.day=l.dateOfBirth[2];
l.month=l.dateOfBirth[1];
l.year=l.dateOfBirth[0];
if(!n){n=""
}if(n.toUpperCase()==="GBR"||n===""){l.nationalityTog="GBR"
}else{l.nationalityTog="Other";
f("[name=nationalityTog]").click()
}RR.plugins.form.populate("form",_.omit(l,"dateOfBirth"))
};
h.populateCustomerAddressDetails=function(m,l){RR.plugins.form.populate(m,l)
};
h.populateCustomerContactDetails=function(m,l){RR.plugins.form.populate(m,l)
};
h.validateResidency=function(){if(f("[name=residency]:checked").val()==="No"){RR.plugins.form.setError("[name=residency]","noresidency","Sorry, you must be a UK resident to open a Retiready account.",1);
return false
}else{RR.plugins.form.clearError("[name=residency]");
return true
}};
h.validateTaxPayer=function(){if(f("[name=ukTax]:checked").val()==="No"){RR.plugins.form.setError("[name=ukTax]","notuktaxpayer","Sorry, you must be a UK tax payer to open a Retiready account.",1);
return false
}else{RR.plugins.form.clearError("[name=ukTax]");
return true
}};
h.validateNationality=function(){if(f("[name=nationalityTog]:checked").val()==="Other"&&f("[name=nationality]").val()===""){RR.plugins.form.setError("[name=nationality]","required","This value is required.",1);
return false
}else{RR.plugins.form.clearError("[name=nationality]");
return true
}};
h.validatePhoneNumber=function(){if(f("[name=mobilePhoneNumber]").parsley("isValid")===null&&f("[name=homePhoneNumber]").parsley("isValid")===null){g=true;
RR.plugins.form.setError("[name=mobilePhoneNumber]","nophonenumber","You need to enter at least one phone number.",1);
RR.plugins.form.setError("[name=homePhoneNumber]","nophonenumber","You need to enter at least one phone number.",1);
return false
}else{if(g){g=false;
RR.plugins.form.clearError("[name=mobilePhoneNumber]");
RR.plugins.form.clearError("[name=homePhoneNumber]")
}return true
}};
h.areAddressDetailsValid=function(){if(h.validateResidency()===false){return false
}if(h.validateNationality()===false){return false
}};
h.areContactDetailsValid=function(l){if(h.validatePhoneNumber()===false){return false
}if(f("[name=emailAddress]").closest(".control-group").hasClass("error")){return false
}if(f("[name=confirmEmailAddress]").closest(".control-group").hasClass("error")){return false
}};
h.initMinRetirementAgeValidation=function(){var l=f("select[name=day]"),n=f("select[name=month]"),m=f("select[name=year]"),p=m.val()+"-"+n.val()+"-"+l.val(),o=RR.utils.calcAge(p);
f("form [name=retireAge]").parsley("addConstraint",{min:o+1})
};
h.init=function(){b="form#orphanDetails";
var l={};
l={CUSTOMER_FIRST_NAME:RR.session("forename")||"{{activeUser.CUSTOMER_FIRST_NAME}}",CUSTOMER_LAST_NAME:RR.session("surname")||"{{activeUser.CUSTOMER_LAST_NAME}}"};
f("#full-width-header .navigation, #full-width-header .dropdown").css("visibility","hidden");
RR.plugins.templates.setTemplateVar("activeUser",l).render();
k=f(b);
j=f("form .accordion-group");
k.parsley("addListener",{onFormSubmit:h.onFormSubmit});
RR.components.accordionForm.init(j.eq(0));
RR.components.accordionForm.init(j.eq(1),h.areAddressDetailsValid);
RR.components.accordionForm.init(j.eq(2),h.areContactDetailsValid);
f("[name=ukTax]").change(function(){h.validateTaxPayer()
});
f("[name=residency]").change(function(){h.validateResidency()
});
f("[name=nationalityTog]").change(function(){RR.plugins.form.clearError("[name=nationality]")
});
f("[name=homePhoneNumber]").on("change.ORPHAN_CONFIRM_DETAILS focusout keyup",function(){h.validatePhoneNumber()
});
f("[name=mobilePhoneNumber]").on("change.ORPHAN_CONFIRM_DETAILS focusout keyup",function(){h.validatePhoneNumber()
});
f("[name=nationality]").on("change focusout",function(){h.validateNationality()
});
h.populateFormWithPolicyCustomerDetails("form#orphanDetails",RR.session("policyNumber"));
f("[name=confirmEmailAddress]").val(RR.session("confirmEmailAddress"));
var m=RR.templateVars||{}
};
return h
}(jQuery));
RR.pages.AUTO_SECURITY=(function(d){var c={};
var e=300;
var f;
var b=false;
var a=d("form#orphanProfile");
c.populateFormFromSession=function(){var g=RR.session("AUTO_SECURITY");
if(g){RR.components.object2form("form#orphanProfile",g)
}};
c.onFormSubmit=function(k,j){var g=d("[name^=question]");
var i={};
var h;
b=RR.plugins.PASSWORD_CREATION.validatePassword(true);
if(k&&b){j.preventDefault();
i.memorablePhrase=d("[name=memorableWord]").val();
i.securityQuestions=[];
i.password=d("#password-field").val();
g.each(function(m){var l=m+1;
var n={};
if(d(this).val()!==d(this).find("option").last().val()){n.question=d(this).find("option[value='"+d(this).val()+"']").text();
n.answer=d("[name='answer"+l+"']").val()
}else{n.question=d("[name='userQuestion"+l+"']").val().trim();
n.answer=d("[name='answer"+l+"']").val().trim()
}i.securityQuestions.push(n)
});
h=f.customer({securityDetails:i});
h.done(function(l){f.notify({notificationType:"autoUpgrade"}).done(function(m){if(m===200){RR.session("AUTO_SECURITY",RR.components.form2object("form#orphanProfile")).done(function(){RR.url.redirect("AUTO_EMAIL")
})
}}).fail(function(){})
});
h.fail(function(){})
}else{return false
}};
c.init=function(){var h=d("[name^=question]");
var j=d("[name^=answer]");
var g=h.first().find("option");
var i=[];
d("#full-width-header .navigation, #full-width-header .dropdown").css("visibility","hidden");
f=new RR.api.Policy("upgrade",RR.session("policyNumber"));
RR.plugins.PASSWORD_CREATION.validatePassword(false);
g.each(function(k){if(k!==0&&k!==g.length-1){i[d(this).val().replace(" ","")]=null
}});
h.each(function(m){var l=m+1;
var k=d(this);
var n=d("[name='userQuestion"+l+"']");
k.attr("data-rr-val",d(this).val());
k.on("change focusout",function(){var p=d(this).val();
var o=d(this).attr("data-rr-val");
if(p===d(this).find("option").last().val()){p=""
}if(p){h.filter("[name!='"+d(this).attr("name")+"']").find("option[value='"+p+"']").remove()
}if(o!==p&&o){h.filter("[name!='"+d(this).attr("name")+"']").find("option:eq(0)").after(g.filter("option[value='"+o+"']").clone())
}d(this).attr("data-rr-val",p)
})
});
c.populateFormFromSession();
j.on("focusout keyup",function(){d(this).siblings(".confirm-icon").remove();
d(this).removeClass("confirm-input");
if(!d(this).closest(".control-group").hasClass("error")){if(d(this).val().length>=5){d(this).addClass("confirm-input");
d(this).after('<div class="confirm-icon"><span aria-hidden="false">Confirmed</span><span class="ico" aria-hidden="true">&#xf707;</span></div>')
}}});
a.parsley("addListener",{onFormSubmit:c.onFormSubmit})
};
return c
}(jQuery));
RR.pages.AUTO_WELCOME=(function(c,a){var b={};
b.renderTemplate=function(d){var e=a.templateVars||{};
e.firstName=d||"Hello";
if(a.plugins.templates){a.plugins.templates.render()
}};
b.init=function(){var d=a.session("forename");
b.renderTemplate(d)
};
return b
}(jQuery,RR));
RR.pages.AUTO_EMAIL=(function(d,b){var c={};
var e;
var a=d("form#panel-form-component-id");
c.onFormSubmit=function(g,f){var h;
h=a.serializeObject();
if(g){e.purchase({verificationCode:h.verificationCode}).done(function(i){if(i===200){window.location=b.route("AUTO_WELCOME")
}else{if(i===500){b.plugins.form.setError("[name=verificationCode]","notmatching","This verification code is incorrect.")
}}}).fail(function(){})
}return false
};
c.renderTemplate=function(f){var g=b.templateVars||{};
g.email=f||"your email address";
if(b.plugins.templates){b.plugins.templates.render()
}};
c.init=function(){var h=b.session("email");
var g=b.session("policyNumber");
d("#full-width-header .navigation, #full-width-header .dropdown").css("visibility","hidden");
var f=b.url.parameter("verificationCode");
if(!g){g=b.url.parameter("policyNumber");
var i=d("#secondaryAction2 a").attr("href");
d("#secondaryAction2 a").attr("href",i+"?policyNumber="+g)
}if(f){b.plugins.form.populate("form",{verificationCode:f})
}b.plugins.loader.hide("#send-confirmation");
e=new b.api.Policy("upgrade",g);
c.renderTemplate(h);
a.parsley("addListener",{onFormSubmit:c.onFormSubmit});
d("#secondaryAction1").click(function(j){j.preventDefault();
var k=d("#send-confirmation");
e.resendUpgradeVerificationCode().done(function(l){if(l===200){k.removeClass("panel").addClass("alert");
k.prepend('<span class="ico" aria-hidden="true">&#xf70e;</span>');
k.show()
}})
})
};
return c
}(jQuery,RR));
RR.pages.CHANGE_FUND_NON_RR=(function(c){var b={};
var a;
b.init=function(){b.getCurrentFund();
b.getFundName();
var d=RR.url.parameter("productId");
c(".get-projection ").click(function(){RR.url.redirect("CHANGE_FUND_PENSION",{productId:d})
})
};
b.getCurrentFund=function(){var d=RR.session("email");
var i=new RR.api.Customer(d);
var f=RR.url.parameter("productId");
var e;
var g;
var h;
e=i.details();
e.done(function(j,k){if(j===200){if(RR.session("score")){h=RR.session("score")
}else{if(k.latestRiskScore){h=k.latestRiskScore.score
}else{}}if(h>0){c(".selection-info.user").show();
c(".selection-info.user").attr("class","selection-info user risk-"+h);
c(".selection-info.user").html(c(".selection-info.user").html().replace("{placeholder}",h));
c("#riskDesc").html(c(".risk-color-"+h).attr("descriptive-text"));
c(".riskAssessment").hide()
}}})
};
b.getFundName=function(){var f=RR.url.parameter("productId");
var i=new RR.api.Product(f);
var e;
var h;
var g=RR.session("fundDetails");
e=i.getBreakdown();
var d;
e.done(function(j,k){if(j===200){RR.session("journey",{route:"CHANGENONRRFUND",productType:"PENSION",productId:f}).done(function(){var l=RR.templateVars||{};
l.rrFundName=g.fundName||"fund name";
l.riskNumber=g.riskLevel||"fund risk level";
if(RR.plugins.templates){RR.plugins.templates.render()
}})
}})
};
return b
}(jQuery));
RR.pages.CHANGE_OTHER_FUND_CONFIRMATION=(function(c){var b={};
var a=this;
b.init=function(){var d=RR.session("fundDetails");
c(".fundName").html(c(".fundName").html().replace("{fundName}",d.fundName));
c(".fundRisk").html(c(".fundRisk").html().replace("{fundRisk}",d.riskLevel))
};
return b
}(jQuery));
RR.pages.NEW_COMPARISON_ISA=(function(c){var b={};
var a=this;
b.init=function(){c(".arcisa-details").find("tfoot .btn").on("click",function(){var d=c(this).attr("href");
c("a[href="+d+"]:first").parent().siblings().removeClass("active");
c("a[href="+d+"]:first").parent().addClass("active");
var e=c("a[href="+d+"]:first").text();
c("a[href='#tabButtons-arc']:first").find("h3").text(e)
});
c("#tabButtons-arc").find("a[data-toggle='tab']").on("click",function(){var d=c(this).text();
c("a[href='#tabButtons-arc']:first").find("h3").text(d)
})
};
return b
}(jQuery));
RR.pages.WORKPLACE_PROFILE=(function(f){var h={};
var k;
var j;
var a={};
var e={};
var i={};
var b;
var d;
var g;
function c(n,o){var m=[];
function l(q,r,p){_.each(r,function(t,u){var v=q[u];
var w=(p||p===0)?p+(isNaN(Number(u))?"."+u:"["+u+"]"):u;
if(_.isObject(t)){l(q[u],t,w)
}else{if(t!==q[u]){m.push(w)
}}})
}l(n,o);
return m
}h.onFormSubmit=function(n,m,l){var o;
m.preventDefault();
if(h.areAddressDetailsValid()===false){j.eq(1).find(".accordion-body").collapse("show");
return false
}if(h.areContactDetailsValid()===false){j.eq(2).find(".accordion-body").collapse("show");
return false
}o=k.serializeObject();
i=f.extend(true,{},e);
i.confirmationDetails=i.confirmationDetails||{};
if(!i.contactDetails){i.contactDetails={}
}if(!i.confirmationDetails.contactPreferences){i.confirmationDetails.contactPreferences={}
}i.confirmationDetails.contactPreferences={email:k.find("[name=optionsCheckboxList1]:checked").length?true:false,post:k.find("[name=optionsCheckboxList2]:checked").length?true:false,sms:k.find("[name=optionsCheckboxList3]:checked").length?true:false,phone:k.find("[name=optionsCheckboxList4]:checked").length?true:false};
i.contactDetails.emailAddress=o.emailAddress.replace(/\s/g,"");
i.confirmedEmailAddress=o.confirmEmailAddress.replace(/\s/g,"");
i.contactDetails.homePhoneNumber=o.homePhoneNumber.replace(/\s/g,"");
i.contactDetails.mobilePhoneNumber=o.mobilePhoneNumber.replace(/\s/g,"");
if(!i.personalDetails){i.personalDetails={}
}i.dirtyFields=["contactDetails","confirmationDetails.contactPreferences"];
h.validateCustomerEmail(function(){var p=RR.post("/policy/wps/"+RR.session("policyNumber")+"/customer",[200],{data:i});
p.done(function(q,r){RR.session({email:o.emailAddress.replace(/\s/g,""),confirmEmailAddress:o.confirmEmailAddress.replace(/\s/g,"")}).done(function(){RR.url.redirect("WORKPLACE_SECURITY")
})
});
p.fail(function(){})
})
};
h.populateFormWithPolicyCustomerDetails=function(n,l){var m=RR.get("/policy/wps/"+l+"/customer",[200,404]);
m.done(function(p,o){if(p===200){e=f.extend(true,{},o);
h.populateCustomerDetails(n,o);
RR.session("regularPremiumDetails",o.regularPremiumDetails)
}});
m.fail(function(o,q,p){})
};
h.validateCustomerEmail=function(l){var n=k.find("[name=emailAddress]").val();
var o=new RR.api.Customer("");
var m=o.search({policyNumberOrEmail:n});
m.done(function(p){if(p===200){var q=(RR.route("CONTACT_US")+"?customerType=registered");
var r="<a href='"+q+"'>get in touch</a>";
RR.plugins.form.setError("[name=emailAddress]","","This email address is already in use, please "+r);
j.eq(2).find(".accordion-body").collapse("show");
f(RR).trigger("hideProcessingButton")
}else{if(_.isFunction(l)){l()
}}})
};
h.populateCustomerDetails=function(m,l){a=l;
if(!a.addressDetails){a.addressDetails=[]
}h.populateCustomerPersonalDetails(m,a.personalDetails);
h.populateCustomerAddressDetails(m,a.addressDetails[0]);
h.populateCustomerContactDetails(m,a.contactDetails);
h.initMinRetirementAgeValidation()
};
h.populateCustomerPersonalDetails=function(m,l){var n;
n=l.nationality===null?"":l.nationality;
if(l.gender==="M"){f("#Gender_id").attr("value","Male")
}if(l.gender==="F"){f("#Gender_id").attr("value","Female")
}l.day=l.dateOfBirth[2];
l.month=l.dateOfBirth[1];
l.year=l.dateOfBirth[0];
if(!n){n=""
}if(n.toUpperCase()==="GBR"||n===""){l.nationalityTog="GBR"
}else{l.nationalityTog="Other";
f("[name=nationalityTog]").click()
}RR.plugins.form.populate("form",_.omit(l,"dateOfBirth"))
};
h.populateCustomerAddressDetails=function(m,l){RR.plugins.form.populate(m,l)
};
h.populateCustomerContactDetails=function(m,l){RR.plugins.form.populate(m,l)
};
h.validateResidency=function(){if(f("[name=residency]:checked").val()==="No"){RR.plugins.form.setError("[name=residency]","noresidency","Sorry, you must be a UK resident to open a Retiready account.",1);
return false
}else{RR.plugins.form.clearError("[name=residency]");
return true
}};
h.validateTaxPayer=function(){if(f("[name=ukTax]:checked").val()==="No"){RR.plugins.form.setError("[name=ukTax]","notuktaxpayer","Sorry, you must be a UK tax payer to open a Retiready account.",1);
return false
}else{RR.plugins.form.clearError("[name=ukTax]");
return true
}};
h.validateNationality=function(){if(f("[name=nationalityTog]:checked").val()==="Other"&&f("[name=nationality]").val()===""){RR.plugins.form.setError("[name=nationality]","required","This value is required.",1);
return false
}else{RR.plugins.form.clearError("[name=nationality]");
return true
}};
h.validatePhoneNumber=function(){if(f("[name=mobilePhoneNumber]").parsley("isValid")===null&&f("[name=homePhoneNumber]").parsley("isValid")===null){g=true;
RR.plugins.form.setError("[name=mobilePhoneNumber]","nophonenumber","You need to enter at least one phone number.",1);
RR.plugins.form.setError("[name=homePhoneNumber]","nophonenumber","You need to enter at least one phone number.",1);
return false
}else{if(g){g=false;
RR.plugins.form.clearError("[name=mobilePhoneNumber]");
RR.plugins.form.clearError("[name=homePhoneNumber]")
}return true
}};
h.areAddressDetailsValid=function(){if(h.validateResidency()===false){return false
}if(h.validateNationality()===false){return false
}};
h.areContactDetailsValid=function(l){if(h.validatePhoneNumber()===false){return false
}if(f("[name=emailAddress]").closest(".control-group").hasClass("error")){return false
}if(f("[name=confirmEmailAddress]").closest(".control-group").hasClass("error")){return false
}};
h.initMinRetirementAgeValidation=function(){var l=f("select[name=day]"),n=f("select[name=month]"),m=f("select[name=year]"),p=m.val()+"-"+n.val()+"-"+l.val(),o=RR.utils.calcAge(p);
f("form [name=retireAge]").parsley("addConstraint",{min:o+1})
};
h.init=function(){b="form#orphanDetails";
var l={};
l={CUSTOMER_FIRST_NAME:RR.session("forename")||"{{activeUser.CUSTOMER_FIRST_NAME}}",CUSTOMER_LAST_NAME:RR.session("surname")||"{{activeUser.CUSTOMER_LAST_NAME}}"};
f("#full-width-header .navigation, #full-width-header .dropdown").css("visibility","hidden");
RR.plugins.templates.setTemplateVar("activeUser",l).render();
k=f(b);
j=f("form .accordion-group");
k.parsley("addListener",{onFormSubmit:h.onFormSubmit});
RR.components.accordionForm.init(j.eq(0));
RR.components.accordionForm.init(j.eq(1),h.areAddressDetailsValid);
RR.components.accordionForm.init(j.eq(2),h.areContactDetailsValid);
f("[name=ukTax]").change(function(){h.validateTaxPayer()
});
f("[name=residency]").change(function(){h.validateResidency()
});
f("[name=nationalityTog]").change(function(){RR.plugins.form.clearError("[name=nationality]")
});
f("[name=homePhoneNumber]").on("change.ORPHAN_CONFIRM_DETAILS focusout keyup",function(){h.validatePhoneNumber()
});
f("[name=mobilePhoneNumber]").on("change.ORPHAN_CONFIRM_DETAILS focusout keyup",function(){h.validatePhoneNumber()
});
f("[name=nationality]").on("change focusout",function(){h.validateNationality()
});
h.populateFormWithPolicyCustomerDetails("form#orphanDetails",RR.session("policyNumber"));
f("[name=confirmEmailAddress]").val(RR.session("confirmEmailAddress"));
var m=RR.templateVars||{}
};
return h
}(jQuery));
RR.pages.WORKPLACE_SECURITY=(function(d){var c={};
var e=300;
var f;
var b=false;
var a=d("form#orphanProfile");
c.populateFormFromSession=function(){var g=RR.session("WORKPLACE_SECURITY");
if(g){RR.components.object2form("form#orphanProfile",g)
}};
c.onFormSubmit=function(k,j){var g=d("[name^=question]");
var i={};
var h;
b=RR.plugins.PASSWORD_CREATION.validatePassword(true);
if(k&&b){j.preventDefault();
i.memorablePhrase=d("[name=memorableWord]").val();
i.securityQuestions=[];
i.password=d("#password-field").val();
g.each(function(m){var l=m+1;
var n={};
if(d(this).val()!==d(this).find("option").last().val()){n.question=d(this).find("option[value='"+d(this).val()+"']").text();
n.answer=d("[name='answer"+l+"']").val()
}else{n.question=d("[name='userQuestion"+l+"']").val().trim();
n.answer=d("[name='answer"+l+"']").val().trim()
}i.securityQuestions.push(n)
});
h=f.customer({securityDetails:i});
h.done(function(l){f.notify({notificationType:"workplace"}).done(function(m){if(m===200){RR.session("WORKPLACE_SECURITY",RR.components.form2object("form#orphanProfile")).done(function(){RR.url.redirect("WORKPLACE_EMAIL")
})
}}).fail(function(){})
});
h.fail(function(){})
}else{return false
}};
c.init=function(){var h=d("[name^=question]");
var j=d("[name^=answer]");
var g=h.first().find("option");
var i=[];
d("#full-width-header .navigation, #full-width-header .dropdown").css("visibility","hidden");
f=new RR.api.Policy("wps",RR.session("policyNumber"));
RR.plugins.PASSWORD_CREATION.validatePassword(false);
g.each(function(k){if(k!==0&&k!==g.length-1){i[d(this).val().replace(" ","")]=null
}});
h.each(function(m){var l=m+1;
var k=d(this);
var n=d("[name='userQuestion"+l+"']");
k.attr("data-rr-val",d(this).val());
k.on("change focusout",function(){var p=d(this).val();
var o=d(this).attr("data-rr-val");
if(p===d(this).find("option").last().val()){p=""
}if(p){h.filter("[name!='"+d(this).attr("name")+"']").find("option[value='"+p+"']").remove()
}if(o!==p&&o){h.filter("[name!='"+d(this).attr("name")+"']").find("option:eq(0)").after(g.filter("option[value='"+o+"']").clone())
}d(this).attr("data-rr-val",p)
})
});
c.populateFormFromSession();
j.on("focusout keyup",function(){d(this).siblings(".confirm-icon").remove();
d(this).removeClass("confirm-input");
if(!d(this).closest(".control-group").hasClass("error")){if(d(this).val().length>=5){d(this).addClass("confirm-input");
d(this).after('<div class="confirm-icon"><span aria-hidden="false">Confirmed</span><span class="ico" aria-hidden="true">&#xf707;</span></div>')
}}});
a.parsley("addListener",{onFormSubmit:c.onFormSubmit})
};
return c
}(jQuery));
RR.pages.WORKPLACE_WELCOME=(function(c,a){var b={};
b.renderTemplate=function(d){var e=a.templateVars||{};
e.firstName=d||"";
if(a.plugins.templates){a.plugins.templates.render()
}};
b.init=function(){var d=a.session("forename");
b.renderTemplate(d)
};
return b
}(jQuery,RR));
RR.pages.REGISTERED_PROSPECT_CONFIRM_DETAILS=(function(b){var g={};
var c,m="#houseNameNumber_id",k="#postcode_id",d=b(".date-select-range-html5 input"),l=b(".sliderThumb1"),i=b(".input-slider-hidden-value"),a=RR.session("purchase")||{},f=0.01,j=a.route&&b("#approxTransferValue_"+a.route.toLowerCase()),e=a.route&&b("#remove-transfer_"+a.route.toLowerCase()),h="";
g.onFormSubmit=function(t,r,q){var v=new RR.api.Policy("rrp",RR.session("policyNumber"));
var o=new RR.api.Customer();
var n;
r.preventDefault();
var u=Number(l.attr("aria-valuenow"));
if(t){n=RR.components.form2object("#customerDetails",["addressSelector","day","nationalityTog","nationality","month","houseNameNumber","postcode","ukResidencyConfirm","employmentStatus","year","sortCode0","sortCode1","sortCode2","amountPaidThisYear","approxTransferValue","providers","transferAccountNumber","typeOfISA","typeOfPension","confirmPensionNotIncludes","otherProvider"],function(p){p.personalDetails.employmentStatus=p.employmentStatus;
p.personalDetails.dateOfBirth=RR.utils.convertDateFieldToNumericArray(p.Date);
p.personalDetails.dateOfBirthSource=h;
if(a){p.contactDetails.emailAddress=a.email;
p.confirmedEmailAddress=a.confirmedEmailAddress
}if(p.sortCode0&&p.sortCode1&&p.sortCode2){p.bankDetails[0].sortCode=[p.sortCode0,p.sortCode1,p.sortCode2]
}p.transferDetails=null;
if(p.typeOfISA){p.transferDetails=[];
var w={amount:parseFloat(p.approxTransferValue,10),type:"ISA",subType:p.typeOfISA,accountNumber:p.transferAccountNumber,amountPaidInThisYear:parseInt(p.amountPaidThisYear,10),fundProviderName:(p.providers==="Other")?p.otherProvider||p.otherProvider_isa:p.providers};
p.transferDetails.push(w)
}if(p.typeOfPension){p.transferDetails=[];
var x={amount:parseFloat(p.approxTransferValue),type:"PENSION",subType:p.typeOfPension,accountNumber:p.transferAccountNumber,amountPaidInThisYear:parseInt(p.amountPaidThisYear,10),fundProviderName:(p.providers==="Other")?p.otherProvider||p.otherProvider_pension:p.providers};
p.transferDetails.push(x)
}if(p.addressDetails[0].country==="United Kingdom"){p.addressDetails[0].country="GBR"
}p.personalDetails.nationality=b("[name=nationalityTog]:checked").val()==="GBR"?"GBR":p.nationality;
p.addressDetails[0].type="A";
p.personalDetails.retirementAge=u
});
v.customer(n).done(function(p,w){var y=RR.components.form2object("#customerDetails");
var x=(y.typeOfPension)?"#selectedProvider_pension":"#selectedProvider_isa";
y.providersText=b(x+" option:selected").text();
y.personalDetails.retirementAge=u;
RR.session("REGISTERED_PROSPECT_CONFIRM_DETAILS_FORM",y).done(function(){RR.url.redirect("REGISTERED_PROSPECT_SECURITY_DETAILS")
})
})
}return false
};
g.validateNationality=function(){if(b("[name=nationalityTog]:checked").val()==="Other"&&b("[name=nationality]").val()===""){RR.plugins.form.setError("[name=nationality]","required","This value is required.",1);
return false
}else{RR.plugins.form.clearError("[name=nationality]");
return true
}};
g.renderTemplate=function(n){var o=RR.templateVars||{};
o.bankDetails={paymentMonth:n};
if(RR.plugins.templates){RR.plugins.templates.render()
}};
g.populateFormFromSession=function(){function n(){var q=RR.session("REGISTERED_PROSPECT_CONFIRM_DETAILS_FORM");
if(q){RR.components.object2form("form#customerDetails",q);
if(q.nationalityTog!=="GBR"){g.populateNationality(q.nationality)
}g.showAddressDetails()
}}var p=new RR.api.Policy("rrp",RR.session("policyNumber"));
var o;
p.customer().done(function(q,t){var r=t.personalDetails.dateOfBirth;
h=t.personalDetails.dateOfBirthSource;
if(r){b("select[name=day]").val(r[2]);
b("select[name=month]").val(r[1]);
b("select[name=year]").val(r[0]).change()
}if(t.personalDetails.dateOfBirthSource&&t.personalDetails.dateOfBirthSource==="ACCOUNT"){b(".date-of-birth .date-select-range select, .date-of-birth .date-select-range-html5 input").attr("disabled","disabled")
}if(t.personalDetails.nationalInsuranceNumber){b('[name="personalDetails.nationalInsuranceNumber"]').attr("disabled","disabled")
}if(t.personalDetails.gender===null||t.personalDetails.gender===""){t.personalDetails.gender="M"
}RR.components.object2form("form#customerDetails",t);
n()
});
n()
};
g.populateNationality=function(p){var o=p===null?"":p;
if(!o){o=""
}var n={};
if(o.toUpperCase()==="GBR"||o===""){n.nationalityTog="GBR";
b("[name=nationality]").val("")
}else{n.nationalityTog="Other";
b("[name=nationalityTog]").click()
}RR.plugins.form.populate("form",n);
b("#british").val("GBR")
};
g.getAddressDetailsDropdownOption=function(o){var p=JSON.stringify(o);
var n="";
if(o.houseNameNumber){n+=o.houseNameNumber+", "
}if(o.addressLine1){n+=o.addressLine1+", "
}if(o.townCity){n+=o.townCity
}if(n.slice(-2)===", "){n=n.substring(0,n.length-2)
}return b("<option value='"+p+"'>"+n+"</option>")
};
g.populateAddressDetailsDropdown=function(n){var o=b("#addressSelector").find("option").eq(0);
var p=b("#addressSelector").html("");
p.append(o);
_.each(n,function(q){p.append(g.getAddressDetailsDropdownOption(q))
})
};
g.populateAddressDetailsFromDropdown=function(n){if(b(this).val()!==""){g.populateAddressDetails(JSON.parse(b(this).val()));
g.showAddressDetails()
}};
g.onFindAddressDetailsButtonClick=function(o){var n;
if(b("[name='postcode']").val()&&b("[name='postcode']").parsley("validate")){n=new RR.api.Address(b("[name='postcode']").val(),b("[name='houseNameNumber']").val());
RR.plugins.form.clearError("[name=postcode]");
g.hideAddressDetails();
g.hideAddressDetailsDropdown();
n.lookup().done(function(p,q){if(p===200){g.populateAddressDetailsDropdown(q);
g.showAddressDetailsDropdown()
}else{g.clearAddressDetails();
g.showAddressDetails();
if(p===500){RR.plugins.form.setError("[name=postcode]","servererror","Our postcode checker is currently not working. Please enter your address manually")
}else{RR.plugins.form.setError("[name=postcode]","notfound","Sorry, we can't find that postcode. Please check the format and try again or enter your address manually")
}b("[name=postcode]").closest(".control-group").addClass("error");
b("[name='addressDetails[0].addressLine1']").on("keydown.clearPostcodeErrors",g.clearPostcodeErrors);
b("[name='addressDetails[0].addressLine2']").on("keydown.clearPostcodeErrors",g.clearPostcodeErrors);
b("[name='addressDetails[0].townCity']").on("keydown.clearPostcodeErrors",g.clearPostcodeErrors);
b("[name='addressDetails[0].postcode']").on("keydown.clearPostcodeErrors",g.clearPostcodeErrors)
}})
}};
g.hideAddressDetailsDropdown=function(){b("#addressSelector").closest(".control-group").hide()
};
g.showAddressDetailsDropdown=function(){b("#addressSelector").closest(".control-group").show()
};
g.onEnterAddressManuallyClick=function(n){g.clearAddressDetails();
g.showAddressDetails();
RR.plugins.form.clearError("[name=postcode]");
b("#addressSelector").val("")
};
g.addressDetailsFieldsSelector={houseNameNumber:"[name='addressDetails[0].houseNameNumber']",addressLine1:"[name='addressDetails[0].addressLine1']",addressLine2:"[name='addressDetails[0].addressLine2']",townCity:"[name='addressDetails[0].townCity']",postcode:"[name='addressDetails[0].postcode']"};
g.populateAddressDetails=function(n){_.each(g.addressDetailsFieldsSelector,function(o,p){if(n.hasOwnProperty(p)){b(o).val(n[p])
}})
};
g.showAddressDetails=function(){RR.plugins.form.clearError(m);
RR.plugins.form.clearError(k);
_.each(g.addressDetailsFieldsSelector,function(n,o){b(n).closest(".control-group").show()
});
b("#enterAddressManually").closest(".control-group").hide();
b("[name='addressDetails[0].country']").closest(".control-group").show()
};
g.clearAddressDetails=function(){_.each(g.addressDetailsFieldsSelector,function(n,o){b(n).val("");
RR.plugins.form.clearError(n)
})
};
g.hideAddressDetails=function(){_.each(g.addressDetailsFieldsSelector,function(n,o){b(n).closest(".control-group").hide()
});
b("#enterAddressManually").closest(".control-group").show();
b("[name='addressDetails[0].country']").closest(".control-group").hide();
g.clearAddressDetails()
};
g.hideSubmitButton=function(){b(".form-actions button[type=submit]").hide()
};
g.calculatePaymentMonth=function(){var n=moment();
if(n.date()>15){n.add("month",2);
return n.format("MMMM")
}else{n.add("month",1);
return n.format("MMMM")
}};
g.validateAboutYouPanel=function(q,o){var p=RR.components.form2object("#customerDetails"),n=0;
if(!g.validatePhoneNumber()){n+=1
}if(!g.validateNationality()){n+=1
}if(n||!q){return false
}else{return true
}};
g.validateYourAddressPanel=function(q,o){var p=RR.components.form2object("#customerDetails");
var n=0;
if(p.ukResidencyConfirm==="No"){n+=1
}if(!b('input[name="addressDetails[0].houseNameNumber"]').is(":visible")){RR.plugins.form.setError(m,null,"Please enter your address.");
RR.plugins.form.setError(k,null,"");
n+=1
}if(n||!q){return false
}else{return true
}};
g.clearBankDetailsErrors=function(){RR.plugins.form.clearError("[name='bankDetails[0].accountNumber']");
b("[name=sortCode0]").closest(".control-group").removeClass("error");
b("[name='bankDetails[0].accountNumber']").off("keydown.clearBankDetailserrros");
b("[name=sortCode0]").off("keydown.clearBankDetailserrros");
b("[name=sortCode1]").off("keydown.clearBankDetailserrros");
b("[name=sortCode2]").off("keydown.clearBankDetailserrros")
};
g.clearPostcodeErrors=function(){RR.plugins.form.clearError("[name='postcode']");
b("[postcode]").closest(".control-group").removeClass("error");
b("[name='addressDetails[0].houseNameNumber']").off("keydown.clearPostcodeErrors");
b("[name='addressDetails[0].addressLine1']").off("keydown.clearPostcodeErrors");
b("[name='addressDetails[0].addressLine2']").off("keydown.clearPostcodeErrors");
b("[name='addressDetails[0].townCity']").off("keydown.clearPostcodeErrors");
b("[name='addressDetails[0].postcode']").off("keydown.clearPostcodeErrors")
};
g.validateBankDetailsPanel=function(r,o){var q=RR.components.form2object("#customerDetails");
var n=0;
var p;
if(!r){n++
}if(!b("[name=sortCode0]").is(":disabled")){if(!q.sortCode0||!q.sortCode1||!q.sortCode2){RR.plugins.form.setError("[name=sortCode0]","invalid","This value is required.");
n++
}}else{RR.plugins.form.clearError("[name=sortCode0]")
}if(n<1){b(RR).trigger("headway:showSpinner");
p=new RR.api.BankDetails();
p.validate({accountNumber:q.bankDetails[0].accountNumber,sortCode:[q.sortCode0,q.sortCode1,q.sortCode2]}).done(function(t,u){if(t===200&&u.bankDetailsValid){o.collapse("hide");
if(!b(".accordion-body.in.collapse").length){g.showSubmitButton(o,false);
if(b("form .accordion-group:nth-child(4)").length){b("form .accordion-group").last().find(".accordion-body").collapse("show")
}return true
}}else{RR.plugins.form.setError("[name='bankDetails[0].accountNumber']","invalidbankdetails","The bank details provided are invalid.");
b("[name=sortCode0]").closest(".control-group").addClass("error");
b("[name='bankDetails[0].accountNumber']").on("keydown.clearBankDetailserrros",g.clearBankDetailsErrors);
b("[name=sortCode0]").on("keydown.clearBankDetailserrros",g.clearBankDetailsErrors);
b("[name=sortCode1]").on("keydown.clearBankDetailserrros",g.clearBankDetailsErrors);
b("[name=sortCode2]").on("keydown.clearBankDetailserrros",g.clearBankDetailsErrors)
}})
}return false
};
g.validateTransferDetails=function(o,n){if(o){g.showSubmitButton(n,true)
}else{return false
}};
g.showSubmitButton=function(o,n){var p=RR.session("hasTransferDetails");
if(o){o.collapse("hide");
if(!p||(p&&n)){if(!b(".accordion-body.in.collapse").length){b(".form-actions button[type=submit]").show()
}}return true
}};
g.setAgeLimit=function(){var p,o=b(".date-select-range-html5 input"),q=o.attr("data-minage-message")||"",n=a?a.route:null;
if(n==="ISA"){p=18;
q=q.replace("{{product}}","ISA").replace("{{age}}",p)
}else{if(n==="PENSION"){p=18;
q=q.replace("{{product}}","Pension").replace("{{age}}",p)
}}if(p){o.attr("data-minage",p)
}if(q){o.attr("data-minage-message",q)
}};
g.validatePhoneNumber=function(){if(b("[name='contactDetails.mobilePhoneNumber']").parsley("isValid")===null&&b("[name='contactDetails.homePhoneNumber']").parsley("isValid")===null){c=true;
RR.plugins.form.setError("[name='contactDetails.mobilePhoneNumber']","nophonenumber","You need to enter at least one phone number.",1);
RR.plugins.form.setError("[name='contactDetails.homePhoneNumber']","nophonenumber","You need to enter at least one phone number.",1);
return false
}else{if(c){c=false;
RR.plugins.form.clearError("[name='contactDetails.mobilePhoneNumber']");
RR.plugins.form.clearError("[name='contactDetails.homePhoneNumber']")
}return true
}};
g.prepopulatePensionFields=function(){if(a&&a.route==="PENSION"){b(".input-slider").attr("data-startvalue",a.retirementAge);
b("[name=year]").val(a.year);
b("[name=month]").val(a.month);
b("[name=day]").val(a.day).change();
RR.plugins.ARIA_SLIDER.updateSliderFromElement()
}};
g.toggleResidencyStatus=function(n){if(b("[name=ukResidencyConfirm]:checked").val()==="No"){b("#addressPanel .alert").show()
}else{b("#addressPanel .alert").hide()
}};
g.hideOneOffInformation=function(){if(!a.oneOffPayment){b(".js-one-off-information").hide()
}};
g.hideMonthlyInformation=function(){if(!a.monthlyPayment){b(".js-monthly-information").hide();
b("#bankDetailsPanel-inner .alert.js-template").hide()
}};
g.showTransferDetails=function(){var n=a?a.route:null;
var p=RR.session("hasTransferDetails");
function o(r){b("[data-component='"+r+"']").remove();
var q=b("form .accordion-group");
RR.components.accordionForm.init(q.eq(3),g.validateTransferDetails);
q.eq(3).on("show",g.hideSubmitButton)
}if(n==="ISA"&&p){o("pensionTransfer")
}else{if(n==="PENSION"&&p){o("isaTransfer")
}else{b("[data-component='isaTransfer']").remove();
b("[data-component='pensionTransfer']").remove()
}}};
g.setProductTemplate=function(){var n=a&&a.route;
if(n==="PENSION"){n="Pension"
}if(n){b(".main-header").html(b(".main-header").html().replace("{PRODUCT}",n));
b(".uk-residence-message").html(b(".uk-residence-message").html().replace("{PRODUCT}",n))
}};
g.initMinRetirementAgeValidation=function(){var o=d.val(),n=RR.utils.calcAge(o);
if(!_.isNaN(n)){i.parsley().updateConstraint({min:n+1},i.data("number-message"));
i.blur()
}};
g.toggleRemoveTransferButton=function(){var o=parseFloat(a.oneOffPayment)||0;
var n=parseFloat(a.monthlyPayment)||0;
if(o<=0&&n<=0){e.hide()
}};
g.initMinValues=function(){j.parsley("addConstraint",{min:f})
};
g.init=function(){g.setProductTemplate();
var n=b("form .accordion-group");
var p=g.calculatePaymentMonth();
var o=g.calculatePaymentMonth();
g.setAgeLimit();
g.showTransferDetails();
g.prepopulatePensionFields();
g.hideAddressDetails();
g.hideAddressDetailsDropdown();
g.hideSubmitButton();
g.hideOneOffInformation();
g.hideMonthlyInformation();
b("[name='contactDetails.homePhoneNumber']").closest(".control-group").hide();
b("#addressPanel .alert").hide();
g.renderTemplate(o);
g.populateFormFromSession();
b("[name='addressDetails[0].country']").val("United Kingdom");
b("[name='contactDetails.mobilePhoneNumber']").siblings(".help-block").find("button").click(function(){b("#landlineNumberMessage").parent(".help-block").hide();
b("[name='contactDetails.homePhoneNumber']").on("focusout",function(){g.validatePhoneNumber()
});
b("[name='contactDetails.mobilePhoneNumber']").on("focusout",function(){g.validatePhoneNumber()
});
RR.plugins.form.clearError("[name='contactDetails.mobilePhoneNumber']");
b("[name='contactDetails.mobilePhoneNumber']").parsley("removeConstraint","required");
b("[name='contactDetails.homePhoneNumber']").closest(".control-group").show()
});
b('[name="addressDetails[0].addressLine1"]').parsley("updateConstraint",{type:"addressline"});
b('[name="addressDetails[0].addressLine2"]').parsley("updateConstraint",{type:"addressline"});
b("[name=ukResidencyConfirm]").click(g.toggleResidencyStatus);
b("#findMyAddress").click(g.onFindAddressDetailsButtonClick);
b("#enterAddressManually").click(g.onEnterAddressManuallyClick);
b("#addressSelector").change(g.populateAddressDetailsFromDropdown);
RR.components.accordionForm.init(n.eq(0),g.validateAboutYouPanel);
n.eq(0).on("show",g.hideSubmitButton);
RR.components.accordionForm.init(n.eq(1),g.validateYourAddressPanel);
n.eq(1).on("show",g.hideSubmitButton);
RR.components.accordionForm.init(n.eq(2),g.validateBankDetailsPanel);
n.eq(2).on("show",g.hideSubmitButton);
b("#customerDetails").parsley("addListener",{onFormSubmit:g.onFormSubmit});
g.initMinRetirementAgeValidation();
RR.utils.checkIfMarkupExists(j.is("[min]"),g.initMinValues);
g.toggleRemoveTransferButton();
d.change(function(){g.initMinRetirementAgeValidation()
})
};
return g
}(jQuery));
RR.pages.REGISTERED_PROSPECT_ISA_TERMS=(function(d,b){var c={};
var e;
var a=d("form#termsAndConditions");
c.init=function(){c.showTermsAndConditions();
e=new b.api.Policy("rrp",b.session("policyNumber"));
c.renderTemplate();
c.renderIllustrations();
a.parsley("addListener",{onFormSubmit:c.onFormSubmit});
b.utils.replaceClass(" .panel .fund-selected","fund-2","fund-"+b.utils.fundToInt(b.session("selectedFund")));
if(!b.session("REGISTERED_PROSPECT_PURCHASE_ISA_FORM").monthlyPayment){d("#directDebitGuarentee").hide()
}d("#amend-personal").on("click",function(){d(window).off("beforeunload")
});
d("#amend-bank").on("click",function(){d(window).off("beforeunload")
});
d("#amend-fund").on("click",function(){d(window).off("beforeunload")
});
c.getContactPreferences()
};
c.getContactPreferences=function(){e.customer().done(function(f,h){if(h.confirmationDetails.contactPreferences){delete h.confirmationDetails.contactPreferences.preferredContactMethod;
var g=0;
_.each(h.confirmationDetails.contactPreferences,function(j){g++;
var i=a.find("[name=optionsCheckboxList"+g+"]").prop("checked",j).attr("checked","checked");
if(j){i.parent().addClass("c_on")
}})
}})
};
c.showTermsAndConditions=function(){var f=b.session("hasTransferDetails");
if(f){d(".purchase-isa-terms").remove()
}else{d(".purchase-isa-with-transfer-terms").remove()
}};
c.renderTemplate=function(){var h=b.templateVars||{};
var j=b.session("REGISTERED_PROSPECT_CONFIRM_DETAILS_FORM");
var g=b.session("purchase");
var f=b.utils.convertDateFieldToNumericArray(j.Date);
h.activeUser={name:j.personalDetails.forename+" "+j.personalDetails.surname,dob:f[2]+"/"+f[1]+"/"+f[0],nin:b.utils.chunk(j.personalDetails.nationalInsuranceNumber,2),accountName:j.bankDetails[0].accountName,accountNumber:j.bankDetails[0].accountNumber,sortCode:b.utils.formatSortCode(j.sortCode0,j.sortCode1,j.sortCode2),monthlyPayment:b.utils.formatStringAsCurrency(g.monthlyPayment,""),oneOffPayment:b.utils.formatStringAsCurrency(g.oneOffPayment,""),fund:d("#fundLabel").data("fund"+b.session("selectedFund").toLowerCase()),promoCode:g.promoCode};
if(!g.promoCode){d("#voucherCodeId").remove()
}var i=b.session("hasTransferDetails");
if(i){if(j.providers==="Other"){h.activeUser.curentProvider=j.otherProvider_isa
}else{h.activeUser.curentProvider=j.providersText
}h.activeUser.transferAccNo=j.transferAccountNumber;
h.activeUser.transferISAValue=b.utils.formatStringAsCurrency(j.approxTransferValue,"")
}else{d(".detail-list").eq(2).remove()
}if(b.plugins.templates){b.plugins.templates.render()
}b.utils.rrHide()
};
c.renderIllustrations=function(){var f=d("#illustrationDummyDocument").hide(),g=e.illustration({basicProjectionOptions:{illustrationType:"N",productType:b.session("productType"),fundOption:b.session("selectedFund")}});
g.done(function(h,i){if(h===200){f.find("a").attr("href",i.filePath);
f.find(".file-descriptor").html("PDF");
f.find(".file-date").text(moment().format("D MMMM YYYY"));
f.show()
}})
};
c.collectConfirmationDetails=function(f){var h={};
var g=f.serializeObject();
h.sourceOfWealth=g.sourceOfWealth===d("[name=sourceOfWealth]").find("option").last().val()?g.sourceOfWealthOther:g.sourceOfWealth;
h.contactPreferences={email:f.find("[name=optionsCheckboxList1]:checked").length?true:false,post:f.find("[name=optionsCheckboxList2]:checked").length?true:false,sms:f.find("[name=optionsCheckboxList3]:checked").length?true:false,phone:f.find("[name=optionsCheckboxList4]:checked").length?true:false};
h.acceptKeyFeatures=f.find("[name=acceptTsAndCs]:checked").length?true:false;
return h
};
c.sendConfirmationDetails=function(g){var f=e.customer({confirmationDetails:g});
f.done(function(h){e.purchase({policyType:"rrp",policyNumber:b.session("policyNumber")}).done(function(i){if(i===200){d(b).trigger("uiLogoutAction",{page:"WELCOME"})
}})
})
};
c.onFormSubmit=function(h,g,f){var i;
g.preventDefault();
if(h){i=c.collectConfirmationDetails(f.$element);
c.sendConfirmationDetails(i)
}};
return c
})(jQuery,RR);
RR.pages.REGISTERED_PROSPECT_PENSION_TERMS=(function(d,b){var c={};
var e;
var a=d("form#termsAndConditions");
c.init=function(){c.showTermsAndConditions();
var h=d("[name=sourceOfWealthOneOffContributionLimit]").val()?Number(d("[name=sourceOfWealthOneOffContributionLimit]").val()):75000,g=d("[name=sourceOfWealthRegularContributionLimit]").val()?Number(d("[name=sourceOfWealthRegularContributionLimit]").val()):2000,i=b.session("purchase").oneOffPayment?Number(b.session("purchase").oneOffPayment):0,f=b.session("purchase").monthlyPayment?Number(b.session("purchase").monthlyPayment):0;
e=new b.api.Policy("rrp",b.session("policyNumber"));
c.renderTemplate();
c.renderIllustrations();
a.parsley("addListener",{onFormSubmit:c.onFormSubmit});
b.utils.replaceClass(" .panel .fund-selected","fund-2","fund-"+b.utils.fundToInt(b.session("selectedFund")));
if(!b.session("REGISTERED_PROSPECT_PURCHASE_PENSION_FORM").monthlyPayment){d("#directDebitGuarentee").hide()
}if(i<h&&f<g){d("#paymentSizeAlert").hide()
}d("#amend-personal").on("click",function(){d(window).off("beforeunload")
});
d("#amend-bank").on("click",function(){d(window).off("beforeunload")
});
d("#amend-fund").on("click",function(){d(window).off("beforeunload")
});
c.getContactPreferences()
};
c.getContactPreferences=function(){e.customer().done(function(f,h){if(h.confirmationDetails.contactPreferences){delete h.confirmationDetails.contactPreferences.preferredContactMethod;
var g=0;
_.each(h.confirmationDetails.contactPreferences,function(j){g++;
var i=a.find("[name=optionsCheckboxList"+g+"]").prop("checked",j).attr("checked","checked");
if(j){i.parent().addClass("c_on")
}})
}})
};
c.showTermsAndConditions=function(){var f=b.session("hasTransferDetails");
if(f){d(".purchase-pension-terms").remove()
}else{d(".purchase-pension-with-transfer-terms").remove()
}};
c.renderTemplate=function(){var h=b.templateVars||{};
var j=b.session("REGISTERED_PROSPECT_CONFIRM_DETAILS_FORM");
var g=b.session("purchase");
var f=b.utils.convertDateFieldToNumericArray(j.Date);
h.activeUser={name:j.personalDetails.forename+" "+j.personalDetails.surname,dob:f[2]+"/"+f[1]+"/"+f[0],nin:b.utils.chunk(j.personalDetails.nationalInsuranceNumber,2),accountName:j.bankDetails[0].accountName,accountNumber:j.bankDetails[0].accountNumber,sortCode:b.utils.formatSortCode(j.sortCode0,j.sortCode1,j.sortCode2),monthlyPayment:b.utils.formatStringAsCurrency(g.monthlyPayment,""),oneOffPayment:b.utils.formatStringAsCurrency(g.oneOffPayment,""),fund:d("#fundLabel").data("fund"+b.session("selectedFund").toLowerCase()),promoCode:g.promoCode};
if(!g.promoCode){d("#voucherCodeId").remove()
}var i=b.session("hasTransferDetails")?b.session("hasTransferDetails"):false;
if(i){if(j.providers==="Other"){h.activeUser.curentProvider=j.otherProvider_pension
}else{h.activeUser.curentProvider=j.providersText
}h.activeUser.transferAccNo=j.transferAccountNumber;
h.activeUser.transferPensionValue=b.utils.formatStringAsCurrency(j.approxTransferValue,"")
}else{d(".detail-list").eq(2).remove()
}if(b.plugins.templates){b.plugins.templates.render()
}b.utils.rrHide()
};
c.collectConfirmationDetails=function(f){var h={};
var g=f.serializeObject();
h.sourceOfWealth=g.sourceOfWealth===d("[name=sourceOfWealth]").find("option").last().val()?g.sourceOfWealthOther:g.sourceOfWealth;
if(g.employeePensionScheme){h.employeePensionScheme=(g.employeePensionScheme.indexOf("true")>=0)
}h.contactPreferences={email:f.find("[name=optionsCheckboxList1]:checked").length?true:false,post:f.find("[name=optionsCheckboxList2]:checked").length?true:false,sms:f.find("[name=optionsCheckboxList3]:checked").length?true:false,phone:f.find("[name=optionsCheckboxList4]:checked").length?true:false};
h.acceptKeyFeatures=f.find("[name=acceptTsAndCs]:checked").length?true:false;
h.rpiConsent=b.session("purchase").confirmBoost;
return h
};
c.sendConfirmationDetails=function(g){var f=e.customer({confirmationDetails:g});
f.done(function(h){e.purchase({policyType:"rrp",policyNumber:b.session("policyNumber")}).done(function(i){if(i===200){d(b).trigger("uiLogoutAction",{page:"WELCOME"})
}})
})
};
c.onFormSubmit=function(h,g,f){var i;
g.preventDefault();
if(h){i=c.collectConfirmationDetails(f.$element);
c.sendConfirmationDetails(i)
}};
c.renderIllustrations=function(){var f=d("#illustrationDummyDocument").hide(),g=e.illustration({basicProjectionOptions:{illustrationType:"N",productType:b.session("productType"),fundOption:b.session("selectedFund")}});
g.done(function(h,i){if(h===200){f.find("a").attr("href",i.filePath);
f.find(".file-descriptor").html("PDF");
f.find(".file-date").text(moment().format("D MMMM YYYY"));
f.show()
}})
};
return c
})(jQuery,RR);
RR.pages.REGISTERED_PROSPECT_PURCHASE_ISA=(function(d,b){var e={},f=false,j,m,q,g=d("form#form-purchase"),o=d("[name=oneOffPayment]"),n=d("[name=monthlyPayment]"),l=d("#email_id"),i=d("#confirm"),c=d("#voucherCodeCheck"),r=d("[name='voucherCode']"),a=d("#voucherCode_id"),p=d("#voucherCode-confirm"),h=d("#voucherCode-confirm-icon"),k=d("#approxTransferValue_id");
e.onFormSubmit=function(u,t){t.preventDefault();
if(!e.validatePayment()){return false
}e.verifyDiscountCode().done(function(v){if(u){e.submitForm()
}else{d(b).trigger("hideProcessingButton")
}})
};
e.verifyDiscountCode=function(v){var w=d.Deferred();
if(r.val()){var u=r.val();
var t=new b.api.Promo(u);
b.plugins.form.clearError("[name=voucherCode]");
t.validateCode().done(function(x,y){if(x===200){e.showConfirmationField(u);
w.resolve()
}else{b.plugins.form.setError("[name=voucherCode]","invalid","The voucher code you entered is not valid");
d("[name=voucherCode]").closest(".control-group").addClass("error");
w.reject()
}})
}else{w.resolve()
}return w.promise()
};
e.showConfirmationField=function(t){a.remove();
c.remove();
p.val(t);
p.closest(".input-append").removeClass("input-append");
p.removeClass("hidden");
h.removeClass("hidden")
};
e.getPolicyCustomerDetails=function(){j=new b.api.Policy("rrp");
j.create().done(function(t,u){m=u.policyNumber;
j=new b.api.Policy("rrp",m);
j.customer().done(function(v,w){g.find("[name='email']").val(w.contactDetails.emailAddress)
})
})
};
e.submitForm=function(){d(b).trigger("headway:showSpinner");
q=b.components.form2object("form#form-purchase");
var A=false;
if(q.typeOfISA&&q.typeOfISA!=="None"){A=true
}var x={};
x=r.val();
var w=[];
var t;
var y;
if(q.monthlyPayment){t={frequency:"M",amount:parseFloat(q.monthlyPayment)};
w.push(t)
}if(q.oneOffPayment){y={frequency:"S",amount:parseFloat(q.oneOffPayment)};
w.push(y)
}var z=[];
if(A===true){var v={amount:parseFloat(q.approxTransferValue),type:"ISA",subType:q.typeOfISA,amountPaidInThisYear:parseFloat(q.amountPaidThisYear)};
z.push(v)
}var u={emailAddress:q.email};
j.customer({payments:w,contactDetails:u,transferDetails:z,promoCode:x,confirmedEmailAddress:q.email}).done(function(B){if(B===200){b.session({REGISTERED_PROSPECT_PURCHASE_ISA_FORM:q,policyNumber:m,email:q.email,fundValue:50000,purchase:{route:"ISA",completedStep:1,policyNumber:m,oneOffPayment:q.oneOffPayment,monthlyPayment:q.monthlyPayment,email:q.email,confirmEligibility:q.confirm,registeredCustomer:false,promoCode:x,confirmedEmailAddress:q.email},hasTransferDetails:A,preRegisteredShop:true}).done(function(){b.url.redirect("REGISTERED_PROSPECT_FUND_SELECTION_ISA")
})
}})
};
e.validatePayment=function(){var u=parseFloat(o.val())||0;
var t=parseFloat(n.val())||0;
var v=parseFloat(k.val())||0;
if(o.parsley("isValid")===null&&n.parsley("isValid")===null&&!k.val()){f=true;
b.plugins.form.setError(o,"nopayment","You need to enter at least one payment method.",1);
b.plugins.form.setError(n,"nopayment","You need to enter at least one payment method.",1);
scrollToElement(g);
return false
}else{if(u<=0&&t<=0&&v<=0){b.plugins.form.setError(o,"nopayment","At least one payment amount should be greater than zero.",1);
b.plugins.form.setError(n,"nopayment","At least one payment amount should be greater than zero.",1);
b.plugins.form.setError(k,"nopayment","At least one payment amount should be greater than zero.",1);
f=true;
return false
}else{if(f){f=false;
b.plugins.form.clearError(k);
b.plugins.form.clearError(o);
b.plugins.form.clearError(n)
}return true
}}};
e.populateFields=function(){var t=b.session("purchase");
if(t!==undefined&&t.route==="ISA"){o.val(t.oneOffPayment);
n.val(t.monthlyPayment);
l.val(t.email);
i.attr("checked",t.confirmEligibility==="true")
}};
e.initEvents=function(){o.on("change.REGISTERED_PROSPECT_PURCHASE_ISA focusout keyup",function(){e.validatePayment()
});
n.on("change.REGISTERED_PROSPECT_PURCHASE_ISA focusout keyup",function(){e.validatePayment()
});
k.on("focusout keyup",function(){e.validatePayment()
});
g.parsley("addListener",{onFormSubmit:e.onFormSubmit});
d(c).on("click",function(){e.verifyDiscountCode()
})
};
e.init=function(){e.populateFields();
e.initEvents();
e.getPolicyCustomerDetails()
};
return e
}(jQuery,RR));
RR.pages.REGISTERED_PROSPECT_PURCHASE_PENSION=(function(d,b){var e={},g=false,m,o,t,z,i=d("form#form-purchase"),v=d("[name=oneOffPayment]"),u=d("[name=monthlyPayment]"),n=d("#checkbox-boost"),q=d("#email_id"),w=d(".date-select-range-html5 input"),f=d("select[name=day]"),r=d("select[name=month]"),j=d("select[name=year]"),k=d(".input-slider"),c=d("#voucherCodeCheck"),y=d("[name='voucherCode']"),a=d("#voucherCode_id"),x=d("#voucherCode-confirm"),l=d("#voucherCode-confirm-icon"),h=d(".input-slider-hidden-value"),p=d("#approxTransferValue_id");
e.onFormSubmit=function(B,A){A.preventDefault();
m=0;
if(d(".control-group.date-of-birth").hasClass("error")){m++
}if(d("#typeOfPension").val()==="None"){b.plugins.form.setError("#typeOfPension","notnull","Please select a valid pension type",1);
scrollToElement(("#confirmPensionTransfer"));
m++
}if(!e.validatePayment()){m++
}e.verifyDiscountCode().done(function(C){if(!m&&B){e.submitForm()
}else{d(b).trigger("hideProcessingButton")
}})
};
e.verifyDiscountCode=function(C){var D=d.Deferred();
if(y.val()){var B=y.val();
var A=new b.api.Promo(B);
b.plugins.form.clearError("[name=voucherCode]");
A.validateCode().done(function(E,F){if(E===200){e.showConfirmationField(B);
D.resolve()
}else{b.plugins.form.setError("[name=voucherCode]","invalid","The voucher code you entered is not valid");
d("[name=voucherCode]").closest(".control-group").addClass("error");
D.reject()
}})
}else{D.resolve()
}return D.promise()
};
e.showConfirmationField=function(A){a.remove();
c.remove();
x.val(A);
x.closest(".input-append").removeClass("input-append");
x.removeClass("hidden");
l.removeClass("hidden")
};
e.getPolicyCustomerDetails=function(){o=new b.api.Policy("rrp");
o.create().done(function(A,B){t=B.policyNumber;
o=new b.api.Policy("rrp",t);
o.customer().done(function(C,E){i.find("[name='email']").val(E.contactDetails.emailAddress);
var D=E.personalDetails.dateOfBirth;
if(D){f.val(D[2]);
r.val(D[1]);
j.val(D[0]).change()
}if(E.personalDetails.dateOfBirthSource&&E.personalDetails.dateOfBirthSource==="ACCOUNT"){i.find(".date-of-birth .date-select-range select").attr("disabled","disabled");
i.find(".date-of-birth .date-select-range-html5 input").attr("disabled","disabled")
}})
})
};
e.submitForm=function(){d(b).trigger("headway:showSpinner");
z=b.components.form2object("form#form-purchase");
var J=false;
if(z.typeOfPension&&z.typeOfPension!=="None"){J=true
}var A={};
A.rpiConsent=i.find("[name=checkbox-boost]:checked").length?true:false;
var G={};
G=y.val();
var E=[];
var B;
var H;
if(z.monthlyPayment){B={frequency:"M",amount:parseFloat(z.monthlyPayment),pensionBoost:A.rpiConsent};
E.push(B)
}if(z.oneOffPayment){H={frequency:"S",amount:parseFloat(z.oneOffPayment)};
E.push(H)
}var K=[];
if(J===true){var L={amount:parseFloat(z.approxTransferValue),type:"PENSION",subType:z.typeOfPension};
K.push(L)
}var F=Number(d(".sliderThumb1").attr("aria-valuenow"));
var D=b.utils.convertDateFieldToNumericArray(z.Date);
var C={retirementAge:F,dateOfBirth:D};
var I={emailAddress:z.email};
o.customer({payments:E,personalDetails:C,contactDetails:I,transferDetails:K,confirmationDetails:A,promoCode:G,confirmedEmailAddress:z.email},true).done(function(M,N){if(M===200){b.session({REGISTERED_PROSPECT_PURCHASE_PENSION_FORM:z,policyNumber:t,email:z.email,fundValue:50000,purchase:{route:"PENSION",completedStep:1,policyNumber:t,oneOffPayment:z.oneOffPayment,monthlyPayment:z.monthlyPayment,email:z.email,day:z.day,month:z.month,year:z.year,confirmBoost:(z["checkbox-boost"]==="0"),retirementAge:F,promoCode:G,confirmedEmailAddress:z.email},hasTransferDetails:J,preRegisteredShop:true}).done(function(){b.url.redirect("REGISTERED_PROSPECT_FUND_SELECTION_PENSION")
})
}})
};
e.validatePayment=function(){var B=parseFloat(v.val())||0;
var A=parseFloat(u.val())||0;
var C=parseFloat(p.val())||0;
if(v.parsley("isValid")===null&&u.parsley("isValid")===null&&!p.val()){g=true;
b.plugins.form.setError(v,"nopayment","You need to enter at least one payment method.",1);
b.plugins.form.setError(u,"nopayment","You need to enter at least one payment method.",1);
scrollToElement(i);
return false
}else{if(B<=0&&A<=0&&C<=0){scrollToElement(u);
b.plugins.form.setError(v,"nopayment","At least one payment amount should be greater than zero.",1);
b.plugins.form.setError(u,"nopayment","At least one payment amount should be greater than zero.",1);
b.plugins.form.setError(p,"nopayment","At least one payment amount should be greater than zero.",1);
g=true;
return false
}else{if(g){g=false;
b.plugins.form.clearError(p);
b.plugins.form.clearError(v);
b.plugins.form.clearError(u)
}return true
}}};
e.populateFields=function(){var A=b.session("purchase");
if(A!==undefined&&A.route==="PENSION"){v.val(A.oneOffPayment);
u.val(A.monthlyPayment);
n.attr("checked",A.confirmBoost);
f.val(A.day);
r.val(A.month);
j.val(A.year).change();
k.attr("data-startValue",A.retirementAge);
d(b).trigger("ariaSlider:updateSliderFromElement");
q.val(A.email)
}};
e.initMinRetirementAgeValidation=function(){var B=w.val(),A=b.utils.calcAge(B);
if(!_.isNaN(A)){h.parsley().updateConstraint({min:A+1},h.data("number-message"));
h.blur()
}};
e.initEvents=function(){d(v).on("change.REGISTERED_PROSPECT_PURCHASE_PENSION focusout keyup",function(){e.validatePayment()
});
d(u).on("change.REGISTERED_PROSPECT_PURCHASE_PENSION focusout keyup",function(){e.validatePayment()
});
p.on("focusout keyup",function(){e.validatePayment()
});
i.parsley("addListener",{onFormSubmit:e.onFormSubmit});
d(c).on("click",function(){e.verifyDiscountCode()
});
w.change(function(){e.initMinRetirementAgeValidation()
});
d("#monthlyPayment_id").on("input",function(){if(d("[name=monthlyPayment]").val()===""){d("#checkbox-boost").attr("checked",false);
d("#checkbox-boost").attr("disabled",true);
d("#checkbox-boost").parent().removeClass("focus c_on")
}else{d("#checkbox-boost").attr("disabled",false)
}})
};
e.init=function(){d("#checkbox-boost").attr("disabled",true);
e.populateFields();
e.initMinRetirementAgeValidation();
e.initEvents();
e.getPolicyCustomerDetails()
};
return e
}(jQuery,RR));
RR.pages.REGISTERED_PROSPECT_SECURITY_DETAILS=(function(c){var b={};
var d=300;
var e;
var a=c("form#profile");
b.populateFormFromSession=function(){var f=RR.session("REGISTERED_PROSPECT_SECURITY_DETAILS");
if(f){RR.components.object2form("form#profile",f)
}};
b.onFormSubmit=function(j,i){var f=c("[name^=question]");
var h={};
var g;
if(j){i.preventDefault();
h.memorablePhrase=c("[name=memorableWord]").val();
h.securityQuestions=[];
f.each(function(l){var k=l+1;
var m={};
if(c(this).val()!==c(this).find("option").last().val()){m.question=c(this).find("option[value='"+c(this).val()+"']").text();
m.answer=c("[name='answer"+k+"']").val()
}else{m.question=c("[name='userQuestion"+k+"']").val().trim();
m.answer=c("[name='answer"+k+"']").val().trim()
}h.securityQuestions.push(m)
});
g=e.customer({securityDetails:h});
g.done(function(k){if(k===200){RR.session("REGISTERED_PROSPECT_SECURITY_DETAILS",RR.components.form2object("form#profile")).done(function(){if(RR.session("purchase").route==="ISA"){RR.url.redirect("REGISTERED_PROSPECT_ISA_TERMS")
}else{RR.url.redirect("REGISTERED_PROSPECT_PENSION_TERMS")
}})
}});
g.fail(function(){})
}else{return false
}};
b.init=function(){var g=c("[name^=question]");
var i=c("[name^=answer]");
var f=g.first().find("option");
var h=[];
e=new RR.api.Policy("rrp",RR.session("policyNumber"));
f.each(function(j){if(j!==0&&j!==f.length-1){h[c(this).val().replace(" ","")]=null
}});
g.each(function(m){var l=m+1;
var k=c(this);
var n=c("[name='userQuestion"+l+"']");
k.attr("data-rr-val",c(this).val());
k.on("change focusout",function(){var o=c(this).val();
var j=c(this).attr("data-rr-val");
if(o===c(this).find("option").last().val()){o=""
}if(o){g.filter("[name!='"+c(this).attr("name")+"']").find("option[value='"+o+"']").remove()
}if(j!==o&&j){g.filter("[name!='"+c(this).attr("name")+"']").find("option:eq(0)").after(f.filter("option[value='"+j+"']").clone())
}c(this).attr("data-rr-val",o)
})
});
b.populateFormFromSession();
i.on("focusout keyup",function(){c(this).siblings(".confirm-icon").remove();
c(this).removeClass("confirm-input");
if(!c(this).closest(".control-group").hasClass("error")){if(c(this).val().length>=5){c(this).addClass("confirm-input");
c(this).after('<div class="confirm-icon"><span aria-hidden="false">Confirmed</span><span class="ico" aria-hidden="true">&#xf707;</span></div>')
}}});
a.parsley("addListener",{onFormSubmit:b.onFormSubmit})
};
return b
}(jQuery));
RR.pages.REGISTERED_PROSPECT_FUND_SELECTION_ISA=(function(b){var a={};
a.init=function(){RR.plugins.RISK_PROFILER.setSelectedFund();
RR.plugins.RISK_PROFILER.setPolicyNumber(RR.session("policyNumber"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
b("#fund-selection-checkbox").html(b("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
b("#continue-button-wrapper").html(b("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"))
};
return a
}(jQuery));
RR.pages.REGISTERED_PROSPECT_FUND_SELECTION_PENSION=(function(b){var a={};
a.init=function(){RR.plugins.RISK_PROFILER.setSelectedFund();
RR.plugins.RISK_PROFILER.setPolicyNumber(RR.session("policyNumber"));
RR.plugins.RISK_PROFILER.initCharts();
RR.plugins.RISK_PROFILER.toggleButtonBindings();
RR.plugins.RISK_PROFILER.scrollerController();
RR.plugins.RISK_PROFILER.continueController();
b("#fund-selection-checkbox").html(b("#fund-selection-checkbox").html().replace("{selected-fund}","<span class='selected-fund'></span>"));
b("#continue-button-wrapper").html(b("#continue-button-wrapper").html().replace("{selected-fund}","<span class='selected-fund'></span>"))
};
return a
}(jQuery));
$(document).ready(function(){var f=navigator.userAgent.toLowerCase();
var i=f.match(/(iphone|ipod)/);
if(i){$("html").addClass("ios");
$("html").addClass("fixed-supported")
}$.fn.mobileFix=function(n){var p=$(this),o=$(n.fixedElements);
$(document).on("focus",n.inputElements,function(q){p.addClass(n.addClass)
}).on("blur",n.inputElements,function(q){p.removeClass(n.addClass);
setTimeout(function(){$(document).scrollTop($(document).scrollTop())
},1)
});
return this
};
if(Modernizr.touch){$("body").mobileFix({inputElements:"input,textarea,select",addClass:"fixfixed"})
}function e(){var p;
var n=$(window).height();
var o=$(window).width();
if(o>n){p="landscape"
}else{p="portait"
}return p
}function m(){var o;
var n=$(window).width();
if(n<=767){o=false
}else{if(navigator.userAgent.match(/IEMobile\/10\.0/)){o=false
}else{o=true
}}return o
}function d(){var o=38;
var n;
if($(this).scrollTop()>o){n=true
}else{n=false
}return n
}function k(){if($("#full-width-header").css("no-nav")!==null){h()
}else{c()
}}function c(){$("#full-width-header").removeAttr("height")
}function h(){var n=e();
if(d()===true||$("#full-width-header .navigation").hasClass("hiddenNavigation")){$(".navigation").hide();
$("#full-width-header").css("height","48px")
}else{$(".navigation").show();
$("#full-width-header").css("height","100px")
}if(m()===true){if(n==="landscape"){$(".navigation").show();
$("#full-width-header").css("height","76px")
}if(n==="portait"){$(".navigation").show();
$("#full-width-header").css("height","76px")
}}}$(window).resize(function(){k()
}).trigger("resize");
$(window).scroll(function(){scrolledPastHeaderSet=d();
if($("#full-width-header").css("no-nav")!==null){h()
}else{c()
}});
$(window).resize(function(){$(".input-prepend, .input-append").each(function(o,p){var n=$("input",p).css("width","");
$(".add-on",p).each(function(){n.css("width","-="+$(this).outerWidth())
})
})
}).trigger("resize");
if(!Modernizr.svg){jQuery("img").each(function(n,o){if(o.src.indexOf(".svg")!=-1){o.src=o.src.replace(".svg",".png")
}})
}function g(){if($(".label_check input, .btn input").length){$(".label_check, .btn").each(function(){$(this).removeClass("c_on")
});
$(".label_check input:checked, .btn input:checked").each(function(){$(this).parent("label").addClass("c_on")
})
}if($(".label_radio input[checked=checked]").length){$(".label_radio").each(function(){$(this).removeClass("r_on")
});
$(".label_radio input[checked=checked]").each(function(){$(this).parent(".label_radio").addClass("r_on")
})
}}$("body").addClass("has-js");
$(".label_radio").click(function(){if($(".label_radio").length){$(".label_radio").each(function(){$(this).find(":radio").attr("checked",false)
})
}$(this).find(":radio").attr("checked",true)
});
$(".label_check, .label_radio, .btn").click(function(){g()
});
$(".label_check input, .label_radio input, .btn input").focusin(function(){$(this).closest(".label_check, .label_radio, .btn ").addClass("focus")
});
$(".label_check input, .label_radio input, .btn input").focusout(function(){$(".label_check, .label_radio, .btn ").removeClass("focus")
});
g();
function a(){if($("html").hasClass("ie8")){$("*:last-child").addClass("last-child");
$("*:last-of-type").addClass("last-of-type")
}}$("form input[type=text]").on("input",function(){if(jQuery(this).val().length==jQuery(this).attr("maxlength")){jQuery(this).next("input").focus()
}});
$("#cookie-statement").removeClass("hideCookie");
$("#cookie-statement").delay(1000).queue(function(){$("#cookie-statement").addClass("cookie-open");
$("#cookie-statement").dequeue()
});
$("#cookie-statement-close-btn").click(function(){var n=$(".footer").height();
$(".footer").css("margin-bottom",(n+60));
$("#cookie-statement").removeClass("cookie-open");
$("#cookie-statement").addClass("cookie-close").delay(1000).queue(function(){$("#cookie-statement").remove()
});
if($("html").hasClass("ie8")){$("#cookie-statement").remove()
}});
var l=$("#fixed-footer").height()+50;
$(".footer").css("margin-bottom",l);
a();
var b=navigator.userAgent.toLowerCase();
var j=b.indexOf("android 3.1")>-1;
if(j){$("html").removeClass("fixed-supported")
}});
var ML_img_ServerOnline=new Image();
var MetrixLab_Protocol=document.location.protocol;
ML_img_ServerOnline.src=MetrixLab_Protocol+"//invitation.opinionbar.com/popups/ServerOnline.gif";
ML_img_ServerOnline.onload=ML_ImageLoaded;
ML_img_ServerOnline.onabort=ML_ImageAborted;
ML_img_ServerOnline.onerror=ML_ImageError;
function ML_ImageLoaded(){function metrixlab_onready(el,func){this.args=new Array(el,func);
this.doTry=function(){try{var el=eval(this.args[0]);
el.onload=this.args[1];
el.onload();
clearInterval(this.args[2])
}catch(e){}};
this.doTry.bind=function(object){var method=this;
return function(){method.apply(object)
}
};
this.args[2]=setInterval(this.doTry.bind(this),250);
return this
}new metrixlab_onready("document",function(){var metrixlab_body=top.document.getElementsByTagName("body").item(0);
var metrixlab_script=top.document.createElement("script");
metrixlab_script.setAttribute("defer","defer");
metrixlab_script.src=MetrixLab_Protocol+"//invitation.opinionbar.com/popups/p20640/overlay.js";
metrixlab_script.type="text/javascript";
metrixlab_body.insertBefore(metrixlab_script,metrixlab_body.childNodes[0])
})
}function ML_ImageAborted(){}function ML_ImageError(){};